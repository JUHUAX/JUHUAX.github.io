<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>ProFuzzer On-the-fly Input Type Probing for Better Zero-day Vulnerability Discovery - Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="文译名：profuzzer：实时输入类型探测，以更好地发现零日漏洞 作者：游伟 单位：普顿大学 国家： #美国 年份： #2019年 来源： #SP 关键字： #fuzzing 代码地址： 笔记建立时间： 2023-04-26 09:31
abstract 实时的探测技术。可以自动的发现和理解关键 fields，并且自动调节变异策略 用单个字节变异，然后自动分析其 fuzz 结果，将相关字节连接在一起，并识别连接后的字段类型，依据该类型的变异策略来进一步变异。 introduction changes most of input based grammar mutation lead to the same execution path and therefore only one of the should be tested futhermore, maybe inputs that exploit vulnerabilities not follow the grammar random mutation has large input space fuzzing the type probing propose a novel technology called profuzzer which has two stages:" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="ProFuzzer On-the-fly Input Type Probing for Better Zero-day Vulnerability Discovery" />
<meta property="og:description" content="文译名：profuzzer：实时输入类型探测，以更好地发现零日漏洞 作者：游伟 单位：普顿大学 国家： #美国 年份： #2019年 来源： #SP 关键字： #fuzzing 代码地址： 笔记建立时间： 2023-04-26 09:31
abstract 实时的探测技术。可以自动的发现和理解关键 fields，并且自动调节变异策略 用单个字节变异，然后自动分析其 fuzz 结果，将相关字节连接在一起，并识别连接后的字段类型，依据该类型的变异策略来进一步变异。 introduction changes most of input based grammar mutation lead to the same execution path and therefore only one of the should be tested futhermore, maybe inputs that exploit vulnerabilities not follow the grammar random mutation has large input space fuzzing the type probing propose a novel technology called profuzzer which has two stages:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/1.%E5%AD%A6%E4%B9%A0/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/fuzzing/2.%E8%AF%A6%E7%BB%86%E7%AC%94%E8%AE%B0/profuzzer-on-the-fly-input-type-probing-for-better-zero-day-vulnerability-discovery/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-06-22T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ProFuzzer On-the-fly Input Type Probing for Better Zero-day Vulnerability Discovery"/>
<meta name="twitter:description" content="文译名：profuzzer：实时输入类型探测，以更好地发现零日漏洞 作者：游伟 单位：普顿大学 国家： #美国 年份： #2019年 来源： #SP 关键字： #fuzzing 代码地址： 笔记建立时间： 2023-04-26 09:31
abstract 实时的探测技术。可以自动的发现和理解关键 fields，并且自动调节变异策略 用单个字节变异，然后自动分析其 fuzz 结果，将相关字节连接在一起，并识别连接后的字段类型，依据该类型的变异策略来进一步变异。 introduction changes most of input based grammar mutation lead to the same execution path and therefore only one of the should be tested futhermore, maybe inputs that exploit vulnerabilities not follow the grammar random mutation has large input space fuzzing the type probing propose a novel technology called profuzzer which has two stages:"/>

	
        <link href="https://example.com/css/fonts.11a1877508139eac0b5b4852ceb110c35641b3533321e66e39149e901ed5756b.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://example.com/css/main.d902908ac6e0fab67957de5db5aea1b6455b19ae2ca98eac4c95a4a0fdc02238.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://example.com/css/dark.c95c5dcf5f32f8b67bd36f7dab66680e068fce2b303087294114aabf7a7c080b.css" media="(prefers-color-scheme: dark)"  />
	

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://example.com">Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/categories">Categories</a>
		
		<a href="/tags">Tags</a>
		
		<a href="/about">About</a>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">ProFuzzer On-the-fly Input Type Probing for Better Zero-day Vulnerability Discovery</h1>
			<div class="meta">Posted on Jun 22, 2023</div>
		</div>
		

		<section class="body">
			<p>文译名：profuzzer：实时输入类型探测，以更好地发现零日漏洞
作者：游伟
单位：普顿大学
国家： #美国
年份： #2019年
来源： #SP
关键字： #fuzzing
代码地址：
笔记建立时间： 2023-04-26  09:31</p>
<h2 id="abstract">abstract</h2>
<ul>
<li>实时的探测技术。可以自动的发现和理解关键 fields，并且自动调节变异策略</li>
<li>用单个字节变异，然后自动分析其 fuzz 结果，将相关字节连接在一起，并识别连接后的字段类型，依据该类型的变异策略来进一步变异。</li>
</ul>
<h2 id="introduction">introduction</h2>
<h3 id="changes">changes</h3>
<ul>
<li>most of input based grammar mutation lead to the same execution path and therefore  only one of the should be tested</li>
<li>futhermore, maybe inputs that exploit vulnerabilities not follow the grammar</li>
<li>random mutation has large input space</li>
</ul>
<h3 id="fuzzing-the-type-probing">fuzzing the type probing</h3>
<p>propose a novel technology called  profuzzer which has two stages:</p>
<ul>
<li>first stage: it conducts sequential probing——enumerating every values of every bytes, each time changes on byte. And it also collection information about the target&rsquo;s execution paths under different byte values. These information will used to be analyzed to recover data fields and field type.</li>
<li>second stage: utilize these imformation to mutate each field to exploit the values that could lead to an attack or explore legitimate values for better coverage.</li>
</ul>
<h2 id="overview">Overview</h2>
<p><img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230501170446.png" alt="image.png"></p>
<ul>
<li>probing engine
<ul>
<li>generate type templates
<ul>
<li>Iterates all possible value of byte of input,</li>
<li>Collects the corresponding execution profiles.</li>
<li>Extracts metrics as the features of bytes</li>
<li>Groups the consecutive bytes with similar features into a field</li>
<li>Determines the type of each field based on the relations between the changes of its possible values and the corresponding variation of observed features</li>
</ul>
</li>
</ul>
</li>
<li>Mutation engine
<ul>
<li>guid mutations based on the probed templates</li>
<li>a. increase code coverage</li>
<li>b. the filed informatin can be used to guide exploit generation</li>
</ul>
</li>
<li>Execution Engine and Report Engine
<ul>
<li>based on the AFL</li>
</ul>
</li>
</ul>
<h1 id="design-and-implementation">DESIGN AND IMPLEMENTATION</h1>
<h2 id="fuzzing-related-input-field-types">fuzzing related input field types</h2>
<p>Assertion</p>
<ul>
<li>only have one correct value</li>
</ul>
<p>Raw Data</p>
<ul>
<li>don&rsquo;t affect the execution of a program</li>
</ul>
<p>Enumeration</p>
<ul>
<li>has a set of valid values</li>
</ul>
<p>Loop Count</p>
<ul>
<li>determines the times of snippet is executed</li>
<li>it has substantial impact on path counts and negligible impact on the paths themselves</li>
</ul>
<p>Offset</p>
<ul>
<li>determines the data location</li>
<li>it may impact on the execution paths</li>
</ul>
<p>Size</p>
<ul>
<li>determines the amount of data the program should read from the input file</li>
<li>it may impact on the execution paths</li>
</ul>
<p>if a byte of input does not fall into the above categories, then used the random mutation strategy</p>
<h2 id="type-probing">Type Probing</h2>
<ul>
<li>probing method has been mentioned many time above and will not repeat again</li>
<li>it&rsquo;s worth noting that the way of storing profile (probing result) is edge vector, a campact hash arry
<ul>
<li>edge vector keeps the execution frequencies of individual control-flow edges</li>
</ul>
</li>
</ul>
<h4 id="defintions">defintions</h4>
<p>author defined two metrics based on edge vectors before execute and after execute</p>
<ul>
<li>coverage similarity: the size of the edge coverage intersection of the two vectors, dived by the size of their union</li>
<li>frequency difference: the radio between the number of edges with different frequencies and the number of edges that different coverage
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507103236.png" alt="image.png"></li>
<li>注意公式中出现的两种 edge vector 是 i 位置修改前后的两个 edge vector</li>
</ul>
<h4 id="step-1-feature-extraction">step 1 feature extraction</h4>
<p><img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507110028.png" alt="image.png">
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507110035.png" alt="image.png"></p>
<h4 id="step-ii-field-identification">STEP II: Field Identification</h4>
<p>author considers that invalid values always lead to the same termination path with an exception, which is the shortest path, as a result these invalid values must lead to the same coverage and frequency metrics
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507110703.png" alt="image.png">
(个人认为除了值相同，值的下标也应该相同吧)</p>
<h4 id="step-iii-field-type-identification">STEP III: Field Type Identification</h4>
<p>Assertion Fields
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507144715.png" alt="image.png"></p>
<ul>
<li>there exists one and only one value v for the byte that induces a similarity score 1</li>
<li>the similarity score of any other value, is less than the midrange value</li>
</ul>
<p>Raw Data Fields
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507145301.png" alt="image.png"></p>
<ul>
<li>raw data fields values do not affect the control flow of program</li>
</ul>
<p>Enumeration Fields
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507145655.png" alt="image.png">
Loop Count Fields
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507145713.png" alt="image.png">
Offset Fields
<img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230507145728.png" alt="image.png"></p>
<h3 id="reprobing">Reprobing</h3>
<p>probing is not the fuzz, it not mutate the input. It just change the byte of input sequentially and change one byte each time.
After probing, we get the field ande field type of the input to the testing program.
Then we need to mutate it, but based the seed we may get crash and may get better coverage, if the input get better coverage than before, we set this input as new seed and reprobing it</p>
<h2 id="type-guided-mutation">Type Guided Mutation</h2>
<p>two step:</p>
<ul>
<li>
<p>exploration mutation:</p>
<ul>
<li>limit the mutation to the legitimate values of the field type to achieve better coverage.</li>
<li>do not allow any mutation on raw data fields</li>
<li></li>
</ul>
</li>
<li>
<p>exploitation mutation</p>
<ul>
<li>exploit a set of special values (for the specific field type) that could lead to potential attacks.</li>
</ul>
</li>
<li>
<p>在引言部分，作者提出一个很好的观点，就是一个全面的、特定于应用程序的、语义丰富的输入规范对于模糊测试来说是不必要的。更有用的信息是识别对模糊测试至关重要的特殊类型的字段。</p>
</li>
</ul>
<p>目的：
方法：
意义：
效果：</p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB">论文阅读</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2023  © Athul |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


</div>
    </body>
</html>
