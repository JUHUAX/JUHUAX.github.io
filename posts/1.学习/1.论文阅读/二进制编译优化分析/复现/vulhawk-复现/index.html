<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>VulHawk 复现 - Blog</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="[[VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search]]
Get Started Prerequisites Windows (MacOS and Linux also work) Python 3.8.2 (64 bit) PyTorch 1.13.1 CUDA 11.7 IDA pro 7.5&#43; (only used for dataset processing) Quick Start File Environment Identification python 2_FileEnvironmentIdentification.py
Function Embedding Generation python 3_function_embedding_generation.py
Binary Function Similarity Detection python 4_binary_code_search.py
论文基本流程 整体输入是二进制文件，然后分两部分进行：
IRFM：对输入的二进制程序进行处理得到 IR，IR 作为 IRFM 的输入，输出是 IR 的词嵌入 首先进行 IR 生成和指令简化 然后使用 Masked Language Model (MLM)、根操作数预测 (ROP) 和相邻块预测 (ABP) 进行预训练 然后生成基本块嵌入 用基本块嵌入和 cfg 生成函数嵌入（GCN 网络是用来捕获 cfg 的） 基于熵的适配器： 首先计算二进制文件的熵值 使用残差神经网络作为分类器判断二进制文件属于哪种文件环境（编译器、优化级别等等） 上面两个一个得到二进制文件的函数嵌入，另一个得到二进制文件的文件环境，并且将二进制文件映射到一个中间环境中，减弱不同文件环境带来的影响。 用函数嵌入进行渐进式搜索" />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="VulHawk 复现" />
<meta property="og:description" content="[[VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search]]
Get Started Prerequisites Windows (MacOS and Linux also work) Python 3.8.2 (64 bit) PyTorch 1.13.1 CUDA 11.7 IDA pro 7.5&#43; (only used for dataset processing) Quick Start File Environment Identification python 2_FileEnvironmentIdentification.py
Function Embedding Generation python 3_function_embedding_generation.py
Binary Function Similarity Detection python 4_binary_code_search.py
论文基本流程 整体输入是二进制文件，然后分两部分进行：
IRFM：对输入的二进制程序进行处理得到 IR，IR 作为 IRFM 的输入，输出是 IR 的词嵌入 首先进行 IR 生成和指令简化 然后使用 Masked Language Model (MLM)、根操作数预测 (ROP) 和相邻块预测 (ABP) 进行预训练 然后生成基本块嵌入 用基本块嵌入和 cfg 生成函数嵌入（GCN 网络是用来捕获 cfg 的） 基于熵的适配器： 首先计算二进制文件的熵值 使用残差神经网络作为分类器判断二进制文件属于哪种文件环境（编译器、优化级别等等） 上面两个一个得到二进制文件的函数嵌入，另一个得到二进制文件的文件环境，并且将二进制文件映射到一个中间环境中，减弱不同文件环境带来的影响。 用函数嵌入进行渐进式搜索" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://example.com/posts/1.%E5%AD%A6%E4%B9%A0/1.%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%BC%96%E8%AF%91%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90/%E5%A4%8D%E7%8E%B0/vulhawk-%E5%A4%8D%E7%8E%B0/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-06-11T02:01:58+05:30" />
<meta property="article:modified_time" content="2023-06-11T02:01:58+05:30" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="VulHawk 复现"/>
<meta name="twitter:description" content="[[VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search]]
Get Started Prerequisites Windows (MacOS and Linux also work) Python 3.8.2 (64 bit) PyTorch 1.13.1 CUDA 11.7 IDA pro 7.5&#43; (only used for dataset processing) Quick Start File Environment Identification python 2_FileEnvironmentIdentification.py
Function Embedding Generation python 3_function_embedding_generation.py
Binary Function Similarity Detection python 4_binary_code_search.py
论文基本流程 整体输入是二进制文件，然后分两部分进行：
IRFM：对输入的二进制程序进行处理得到 IR，IR 作为 IRFM 的输入，输出是 IR 的词嵌入 首先进行 IR 生成和指令简化 然后使用 Masked Language Model (MLM)、根操作数预测 (ROP) 和相邻块预测 (ABP) 进行预训练 然后生成基本块嵌入 用基本块嵌入和 cfg 生成函数嵌入（GCN 网络是用来捕获 cfg 的） 基于熵的适配器： 首先计算二进制文件的熵值 使用残差神经网络作为分类器判断二进制文件属于哪种文件环境（编译器、优化级别等等） 上面两个一个得到二进制文件的函数嵌入，另一个得到二进制文件的文件环境，并且将二进制文件映射到一个中间环境中，减弱不同文件环境带来的影响。 用函数嵌入进行渐进式搜索"/>

	
        <link href="https://example.com/css/fonts.11a1877508139eac0b5b4852ceb110c35641b3533321e66e39149e901ed5756b.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://example.com/css/main.d902908ac6e0fab67957de5db5aea1b6455b19ae2ca98eac4c95a4a0fdc02238.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://example.com/css/dark.c95c5dcf5f32f8b67bd36f7dab66680e068fce2b303087294114aabf7a7c080b.css" media="(prefers-color-scheme: dark)"  />
	

	
	

	
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://example.com">Blog</a>
	</div>
	<nav>
		
		<a href="/">Home</a>
		
		<a href="/posts">All posts</a>
		
		<a href="/categories">Categories</a>
		
		<a href="/tags">Tags</a>
		
		<a href="/about">About</a>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">VulHawk 复现</h1>
			<div class="meta">Posted on Jun 11, 2023</div>
		</div>
		

		<section class="body">
			<p>[[VulHawk Cross-architecture Vulnerability Detection with Entropy-based Binary Code Search]]</p>
<h2 id="get-started">Get Started</h2>
<h3 id="prerequisites">Prerequisites</h3>
<ul>
<li>Windows (MacOS and Linux also work)</li>
<li>Python 3.8.2 (64 bit)</li>
<li>PyTorch 1.13.1</li>
<li>CUDA 11.7</li>
<li>IDA pro 7.5+ (only used for dataset processing)</li>
</ul>
<h3 id="quick-start">Quick Start</h3>
<ul>
<li>File Environment Identification</li>
</ul>
<p><code>python 2_FileEnvironmentIdentification.py</code></p>
<ul>
<li>Function Embedding Generation</li>
</ul>
<p><code> python 3_function_embedding_generation.py</code></p>
<ul>
<li>Binary Function Similarity Detection</li>
</ul>
<p><code> python 4_binary_code_search.py</code></p>
<h2 id="论文基本流程">论文基本流程</h2>
<p><img src="https://gitee.com/juhuahua/chart-bed/raw/master/20230320155928.png" alt="image.png">
整体输入是二进制文件，然后分两部分进行：</p>
<ul>
<li>IRFM：对输入的二进制程序进行处理得到 IR，IR 作为 IRFM 的输入，输出是 IR 的词嵌入
<ul>
<li>首先进行 IR 生成和指令简化</li>
<li>然后使用 Masked Language Model (MLM)、根操作数预测 (ROP) 和相邻块预测 (ABP) 进行预训练</li>
<li>然后生成基本块嵌入</li>
<li>用基本块嵌入和 cfg 生成函数嵌入（GCN 网络是用来捕获 cfg 的）</li>
</ul>
</li>
<li>基于熵的适配器：
<ul>
<li>首先计算二进制文件的熵值</li>
<li>使用残差神经网络作为分类器判断二进制文件属于哪种文件环境（编译器、优化级别等等）</li>
</ul>
</li>
</ul>
<p>上面两个一个得到二进制文件的函数嵌入，另一个得到二进制文件的文件环境，并且将二进制文件映射到一个中间环境中，减弱不同文件环境带来的影响。
用函数嵌入进行渐进式搜索</p>
<ul>
<li>采用函数嵌入的欧式距离相似度对候选函数进行粗粒度检索</li>
<li>结合基本块、字符串常量和导入函数的信息进行相似度校准</li>
</ul>
<h2 id="文件结构">文件结构</h2>
<ul>
<li>example：测试用例</li>
<li>figure：算出来的熵流图</li>
<li>剩下的几个文件夹都是主程序需要用到的包文件</li>
<li>2：文件环境识别</li>
<li>3：函数嵌入生成</li>
<li>4：二进制代码搜索</li>
<li>SimilarityCalibration. pyd 是相似度校准</li>
</ul>
<h2 id="问题">问题</h2>
<p>虽然作者说 Linux 和 MacOS 都可以，但是实际上作者给出的自定义包文件有. pyd 文件，只有 Windows 下才可以载入。
看到 GitHub 上面有人给他提了这个 issue，但是作者没有回复。
这个代码结构是清晰的，数据也有，感觉是可以复现成功的。</p>

		</section>

		<div class="post-tags">
			
			
			<nav class="nav tags">
				<ul class="tags">
					
					<li><a href="/tags/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0">论文复现</a></li>
					
				</ul>
			</nav>
			
			
		</div>
		</article>
</main>
<footer>
  <div style="display:flex"></div>
  <div class="footer-info">
    2023  © Athul |  <a
      href="https://github.com/athul/archie">Archie Theme</a> | Built with <a href="https://gohugo.io">Hugo</a>
  </div>
</footer>


</div>
    </body>
</html>
